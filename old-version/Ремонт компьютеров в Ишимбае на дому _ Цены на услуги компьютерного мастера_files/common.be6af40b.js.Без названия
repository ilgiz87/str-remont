/*! For license information please see common.be6af40b.js.LICENSE.txt */
(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[23592],{511897:(e,t,s)=>{"use strict";s.d(t,{AccountSecurityLevelEnumNames:()=>a});const a={NOTHING_TO_SAY:0,HAVE_ISSUES:1,HAVE_RECOMMENDATIONS:10,GOOD:20}},74605:(e,t,s)=>{"use strict";s.d(t,{BaseSexEnumNames:()=>a});const a={UNKNOWN:0,FEMALE:1,MALE:2}},600222:(e,t,s)=>{"use strict";function a(){return{icon:'<svg fill="none" height="8" viewBox="0 0 12 8" width="12" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.16 2.3a.75.75 0 0 1 1.05-.14L6 4.3l2.8-2.15a.75.75 0 1 1 .9 1.19l-3.24 2.5c-.27.2-.65.2-.92 0L2.3 3.35a.75.75 0 0 1-.13-1.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"dropdown_12"}}s.d(t,{getIcon12Dropdown:()=>a})},447931:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M10.48 1.07c.55.05 1.03.14 1.47.37a3.74 3.74 0 0 1 1.64 1.63c.23.44.32.92.37 1.47.04.53.04 1.18.04 2v5.48c0 .5 0 .92-.03 1.25-.03.33-.1.72-.35 1.03a1.8 1.8 0 0 1-1.35.7c-.4.01-.76-.15-1.04-.32-.3-.17-.64-.41-1.04-.7l-1.7-1.2a7.21 7.21 0 0 0-.43-.3.25.25 0 0 0-.12 0l-.08.05c-.08.04-.18.12-.35.24l-1.7 1.2c-.4.3-.75.54-1.04.71-.28.17-.64.33-1.04.32a1.8 1.8 0 0 1-1.35-.7c-.25-.32-.32-.7-.35-1.03C2 12.94 2 12.52 2 12.02V6.53c0-.7 0-1.3.03-1.79a9.01 9.01 0 0 1 .01-.2c.05-.55.14-1.03.37-1.47a3.75 3.75 0 0 1 1.64-1.63c.44-.23.92-.32 1.47-.37.23-.02.48-.03.76-.03 1.4-.03 2.82-.08 4.2.03Z"/></svg>',name:"bookmark_16"}}s.d(t,{getIcon16Bookmark:()=>a})},667309:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M6.72 1h2.56c.67 0 1.23 0 1.67.04.47.03.88.12 1.28.31a3.25 3.25 0 0 1 1.42 1.42c.2.4.28.81.31 1.28.04.44.04 1 .04 1.67v6.05c0 .56 0 1.02-.03 1.4-.04.36-.11.76-.37 1.1a1.9 1.9 0 0 1-1.45.73c-.42.01-.8-.17-1.11-.36-.32-.2-.7-.47-1.14-.8L8.5 12.8a7.25 7.25 0 0 0-.44-.3.25.25 0 0 0-.12 0s-.03 0-.08.04c-.08.05-.19.12-.37.26L6.1 13.84c-.45.33-.82.6-1.14.8-.31.19-.69.37-1.1.36a1.9 1.9 0 0 1-1.46-.73 2.06 2.06 0 0 1-.37-1.1C2 12.78 2 12.32 2 11.76V5.72c0-.67 0-1.23.04-1.67.03-.47.12-.88.31-1.28a3.25 3.25 0 0 1 1.42-1.42c.4-.2.81-.28 1.28-.31C5.49 1 6.05 1 6.72 1Zm1.22 11.5Zm.12 0Zm-2.9-9.97c-.36.03-.56.09-.7.16a1.75 1.75 0 0 0-.77.77c-.07.14-.13.34-.16.7-.03.39-.03.88-.03 1.59v5.98c0 .6 0 1 .03 1.3.02.24.05.31.06.32a.4.4 0 0 0 .3.15s.08-.02.3-.14l1.05-.75L6.6 11.6l.07-.05c.27-.2.56-.41.89-.5a1.75 1.75 0 0 1 .88 0c.33.09.62.3.89.5l.07.05 1.36 1c.49.37.8.6 1.06.76.2.12.29.14.3.14a.4.4 0 0 0 .3-.15s.03-.08.05-.32c.03-.3.03-.7.03-1.3V5.75c0-.71 0-1.2-.03-1.58a1.88 1.88 0 0 0-.16-.71 1.75 1.75 0 0 0-.77-.77 1.88 1.88 0 0 0-.7-.16c-.39-.03-.88-.03-1.59-.03h-2.5c-.71 0-1.2 0-1.58.03Z" clip-rule="evenodd"/></svg>',name:"bookmark_outline_16"}}s.d(t,{getIcon16BookmarkOutline:()=>a})},985737:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg>',name:"cancel_16"}}s.d(t,{getIcon16Cancel:()=>a})},959156:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" fill="none" viewBox="0 0 12 16"><path fill="currentColor" d="M7.23 8 3.86 4.64a.9.9 0 0 1 1.28-1.28l4 4a.9.9 0 0 1 0 1.28l-4 4a.9.9 0 0 1-1.28-1.28L7.23 8Z"/></svg>',name:"chevron_16"}}s.d(t,{getIcon16Chevron:()=>a})},706891:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 3a.75.75 0 0 1 .75.75v5.5h5.5a.75.75 0 0 1 0 1.5h-5.5v5.5a.75.75 0 0 1-1.5 0v-5.5h-5.5a.75.75 0 0 1 0-1.5h5.5v-5.5A.75.75 0 0 1 10 3Z" clip-rule="evenodd"/></svg>',name:"add_20"}}s.d(t,{getIcon20Add:()=>a})},893980:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M17.53 5.22a.75.75 0 0 1 0 1.06l-9.5 9.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.97 3.97 8.97-8.97a.75.75 0 0 1 1.06 0Z" clip-rule="evenodd"/></svg>',name:"check_20"}}s.d(t,{getIcon20Check:()=>a})},899690:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="m12.75 4.04-.8 3.3 1.91.35c.96.17 1.82.62 2.07 1.53.26.92-.25 1.84-.82 2.52l-5.08 5.75c-.33.35-.66.64-.99.81-.3.16-.8.33-1.27.05-.46-.26-.58-.76-.6-1.1-.03-.38.03-.82.15-1.3l.84-3.35-1.81-.32c-.92-.16-1.84-.59-2.2-1.45-.39-.92 0-1.9.8-2.76l1.41-1.5c.84-.91 2.07-2.26 3.68-4.05.31-.35.64-.64.96-.82.31-.16.8-.32 1.26-.07.47.25.6.74.64 1.1.03.38-.02.83-.15 1.31Zm-1.37-.75a3.95 3.95 0 0 0-.22.22A330.83 330.83 0 0 1 6.05 9.1c-.63.69-.57 1.05-.52 1.15.16.38.73.5 1.08.56l2.33.41c.56.1.95.67.8 1.24l-.96 3.86a4.71 4.71 0 0 0-.08.4 4.42 4.42 0 0 0 .23-.24l5.04-5.7c.53-.65.55-1.02.52-1.15-.02-.07-.15-.32-.88-.45l-2.45-.44c-.56-.1-.94-.68-.8-1.24l.94-3.81a4.29 4.29 0 0 0 .08-.4Z" clip-rule="evenodd"/></svg>',name:"flash_outline_20"}}s.d(t,{getIcon20FlashOutline:()=>a})},497185:(e,t,s)=>{"use strict";function a(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M2 4.75c0-.41.34-.75.75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.75zm0 5c0-.41.34-.75.75-.75h12.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 9.75zm0 5c0-.41.34-.75.75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75z"/><path clip-rule="evenodd" d="M19.28 12.22c.3.3.3.77 0 1.06l-4.5 4.5c-.29.29-.76.29-1.05 0l-2.5-2.5a.75.75 0 0 1 1.05-1.06l1.97 1.97 3.97-3.97c.3-.3.77-.3 1.06 0z" fill-rule="evenodd"/></g></svg>',name:"list_add_outline_20"}}s.d(t,{getIcon20ListAddOutline:()=>a})},472240:(e,t,s)=>{"use strict";function a(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><clipPath id="list_play_outline_20__a"><path d="M0 0h20v20H0z"/></clipPath><g clip-path="url(#list_play_outline_20__a)" fill="currentColor"><path d="M19.68 11.43c.43.25.43.89 0 1.14l-4.73 2.84c-.42.25-.95-.06-.95-.57V9.16c0-.5.53-.82.95-.57zM2 4.75c0-.41.34-.75.75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.75zm0 5c0-.41.34-.75.75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 2 9.75zm0 5c0-.41.34-.75.75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5a.75.75 0 0 1-.75-.75z"/></g></svg>',name:"list_play_outline_20"}}s.d(t,{getIcon20ListPlayOutline:()=>a})},827087:(e,t,s)=>{"use strict";function a(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M15 8.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3z" fill="currentColor"/></svg>',name:"more_20"}}s.d(t,{getIcon20More:()=>a})},433849:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12 8.13a7.85 7.85 0 0 1-1.5 2.37A7.83 7.83 0 0 1 8.13 12c.83.37 1.72.86 2.37 1.51a7.83 7.83 0 0 1 1.5 2.37c.37-.84.86-1.72 1.51-2.37a7.83 7.83 0 0 1 2.37-1.5 7.85 7.85 0 0 1-2.37-1.51 7.83 7.83 0 0 1-1.5-2.37Zm-.78-2.18c-.42 1.32-1.02 2.72-1.78 3.49-.77.77-2.17 1.36-3.49 1.78a21.07 21.07 0 0 1-1.16.34c-.38.1-.38.79 0 .9a27.15 27.15 0 0 1 .91.25l.25.08c1.32.42 2.72 1.01 3.49 1.78.76.77 1.36 2.17 1.78 3.49a20.84 20.84 0 0 1 .27.9l.07.26c.1.38.79.38.9 0a27.49 27.49 0 0 1 .25-.91l.08-.25c.42-1.32 1.01-2.72 1.78-3.49s2.17-1.36 3.49-1.78a20.84 20.84 0 0 1 .9-.27l.26-.07c.38-.1.38-.8 0-.9a27.49 27.49 0 0 1-.91-.25 20.84 20.84 0 0 1-.25-.08c-1.32-.42-2.72-1.01-3.49-1.78s-1.36-2.17-1.78-3.49a21.13 21.13 0 0 1-.34-1.16c-.1-.38-.8-.38-.9 0a27.15 27.15 0 0 1-.25.91 21.13 21.13 0 0 1-.08.25ZM4.36.76a.39.39 0 0 0-.73 0L3.24 2A1.93 1.93 0 0 1 2 3.22l-1.24.41a.39.39 0 0 0 0 .74l1.24.4A1.93 1.93 0 0 1 3.22 6l.41 1.24a.39.39 0 0 0 .74 0L4.77 6A1.93 1.93 0 0 1 6 4.78l1.24-.42a.39.39 0 0 0 0-.73L6 3.24A1.93 1.93 0 0 1 4.78 2L4.36.76Z"/></svg>',name:"stars_20"}}s.d(t,{getIcon20Stars:()=>a})},655623:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path d="M2.75 4a.75.75 0 0 0 0 1.5H6v9.75a.75.75 0 0 0 1.5 0V5.5h3.25a.75.75 0 0 0 0-1.5h-8Z"/><path d="M10.75 7.5a.75.75 0 0 0 0 1.5h2.5v6.25a.75.75 0 0 0 1.5 0V9h2.5a.75.75 0 0 0 0-1.5h-6.5Z"/></svg>',name:"text_tt_outline_20"}}s.d(t,{getIcon20TextTtOutline:()=>a})},73245:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.08 2.65A2.21 2.21 0 0 1 14.64 2c.57 0 1.14.22 1.57.65l1.14 1.14a2.21 2.21 0 0 1 0 3.13l-.94.94-9.17 9.18A3.3 3.3 0 0 1 4.9 18H3a1 1 0 0 1-1-1v-1.9a3.29 3.29 0 0 1 .96-2.33l8.13-8.13 1.99-2zm2.28 4.13.93-.92a.71.71 0 0 0 0-1.02l-1.14-1.13a.71.71 0 0 0-.5-.21.71.71 0 0 0-.51.2l-.93.93 2.15 2.15zm-3.22-1.07-8.11 8.12a1.79 1.79 0 0 0-.53 1.26v1.11a.3.3 0 0 0 .3.3h1.11c.47 0 .93-.19 1.27-.53l8.1-8.11-2.15-2.15z" fill="currentColor"/></svg>',name:"write_outline_20"}}s.d(t,{getIcon20WriteOutline:()=>a})},702510:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M11.08 3h1.84c1.05 0 1.9 0 2.58.06.7.05 1.32.17 1.88.46a4.79 4.79 0 0 1 2.1 2.1c.28.56.4 1.17.46 1.88.06.68.06 1.53.06 2.58v7.62c0 .77 0 1.41-.05 1.91-.04.5-.14 1.03-.48 1.46a2.46 2.46 0 0 1-1.9.93c-.54 0-1.02-.24-1.44-.5-.42-.27-.93-.66-1.55-1.13l-1.61-1.24c-.61-.47-.72-.53-.8-.55a.66.66 0 0 0-.34 0c-.08.02-.19.08-.8.55l-1.61 1.24c-.62.47-1.13.86-1.55 1.13-.42.26-.9.5-1.45.5a2.46 2.46 0 0 1-1.9-.93 2.68 2.68 0 0 1-.48-1.46C4 19.11 4 18.47 4 17.7v-7.62c0-1.05 0-1.9.06-2.58.05-.7.18-1.32.46-1.88a4.79 4.79 0 0 1 2.1-2.1c.56-.28 1.17-.4 1.88-.46C9.18 3 10.03 3 11.08 3Z" clip-rule="evenodd"/></svg>',name:"bookmark_24"}}s.d(t,{getIcon24Bookmark:()=>a})},880526:(e,t,s)=>{"use strict";function a(){return{icon:'<svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M11.08 3h1.84c1.05 0 1.9 0 2.59.06.7.05 1.31.17 1.88.46.9.46 1.63 1.2 2.09 2.1.29.56.4 1.17.46 1.87.06.69.06 1.54.06 2.6v7.6c0 .78 0 1.42-.05 1.92-.04.5-.14 1.03-.48 1.46-.46.58-1.15.92-1.9.93-.54 0-1.02-.24-1.44-.5-.42-.27-.93-.66-1.55-1.13l-1.61-1.24c-.61-.47-.72-.53-.8-.55a.66.66 0 0 0-.34 0c-.08.02-.19.08-.8.55l-1.61 1.24c-.62.47-1.13.86-1.55 1.13-.42.26-.9.5-1.45.5a2.46 2.46 0 0 1-1.9-.93 2.68 2.68 0 0 1-.47-1.46C4 19.11 4 18.47 4 17.7v-7.62c0-1.05 0-1.9.06-2.59.05-.7.17-1.31.46-1.88.46-.9 1.2-1.63 2.1-2.09.56-.29 1.17-.4 1.87-.46C9.18 3 10.03 3 11.1 3zM8.64 4.85c-.6.05-.94.14-1.2.28-.57.28-1.03.74-1.31 1.3-.14.27-.23.62-.28 1.21-.05.6-.05 1.38-.05 2.48v7.53c0 .83 0 1.4.04 1.8.04.41.1.5.1.5.12.16.3.25.5.25 0 0 .12 0 .47-.22.34-.22.79-.56 1.45-1.07l1.58-1.2.1-.09c.44-.33.85-.65 1.32-.78.42-.1.86-.1 1.28 0 .47.13.88.45 1.32.78l.1.08 1.58 1.21c.66.5 1.1.85 1.45 1.07.35.22.46.22.46.22.2 0 .39-.1.5-.25 0 0 .07-.09.11-.5.04-.4.04-.97.04-1.8v-7.53c0-1.1 0-1.88-.05-2.48-.05-.6-.14-.94-.28-1.2a2.99 2.99 0 0 0-1.3-1.31 3.17 3.17 0 0 0-1.21-.28 33.8 33.8 0 0 0-2.48-.05h-1.76c-1.1 0-1.88 0-2.48.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"bookmark_outline_24"}}s.d(t,{getIcon24BookmarkOutline:()=>a})},936492:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M7.54 6.26a.9.9 0 0 0-1.28 1.28L10.73 12l-4.47 4.46a.9.9 0 0 0 1.28 1.28L12 13.27l4.46 4.47a.9.9 0 1 0 1.28-1.28L13.27 12l4.47-4.46a.9.9 0 1 0-1.28-1.28L12 10.73 7.54 6.26Z"/></svg>',name:"cancel_24"}}s.d(t,{getIcon24Cancel:()=>a})},138431:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0a12 12 0 1 1 0 24 12 12 0 0 1 0-24Zm0 1.5a10.5 10.5 0 1 0 0 21 10.5 10.5 0 0 0 0-21Z" fill="currentColor"/></svg>',name:"check_circle_off_24"}}s.d(t,{getIcon24CheckCircleOff:()=>a})},740361:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 24a12 12 0 1 0 0-24 12 12 0 0 0 0 24Zm6.2-14.8a1 1 0 0 0-1.4-1.4L10 14.58l-2.8-2.8a1 1 0 0 0-1.4 1.42l3.5 3.5a1 1 0 0 0 1.4 0l7.5-7.5Z" fill="currentColor"/></svg>',name:"check_circle_on_24"}}s.d(t,{getIcon24CheckCircleOn:()=>a})},784394:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="favorite_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="favorite_24__favorite_24"><path id="favorite_24__Bounds" d="M0 0h24v24H0z"/><path d="m15.34 8.48 4.43.43c1.54.15 2.02 1.65.83 2.64l-3.47 2.88 1.29 4.7c.42 1.54-.9 2.48-2.2 1.55L12 17.7l-4.21 2.98c-1.31.92-2.63 0-2.2-1.55l1.28-4.7-3.47-2.88c-1.2-1-.72-2.5.83-2.64l4.43-.43 1.95-4.5c.6-1.4 2.17-1.4 2.78 0l1.95 4.5Z" id="favorite_24__Mask" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"favorite_24"}}s.d(t,{getIcon24Favorite:()=>a})},977202:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12.55 4.7a.6.6 0 0 0-1.1 0L9.83 8.6a.9.9 0 0 1-.77.55l-4.13.26a.6.6 0 0 0-.35 1.05l3.26 2.86a.9.9 0 0 1 .29.9l-.94 3.84a.6.6 0 0 0 .89.66l3.47-2a.9.9 0 0 1 .9 0l3.47 2a.6.6 0 0 0 .88-.66l-.93-3.85a.9.9 0 0 1 .29-.89l3.26-2.86a.6.6 0 0 0-.35-1.05l-4.13-.26a.9.9 0 0 1-.77-.56l-1.62-3.9ZM9.78 4a2.4 2.4 0 0 1 4.44 0l1.4 3.39 3.56.23a2.4 2.4 0 0 1 1.43 4.2l-2.86 2.5.8 3.32a2.4 2.4 0 0 1-3.53 2.64L12 18.54l-3.02 1.74a2.4 2.4 0 0 1-3.54-2.64l.8-3.32-2.85-2.5a2.4 2.4 0 0 1 1.43-4.2l3.56-.23L9.78 4Z" clip-rule="evenodd"/></svg>',name:"favorite_outline_24"}}s.d(t,{getIcon24FavoriteOutline:()=>a})},901098:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M6 6.6c0-.56 0-.84.1-1.05a1 1 0 0 1 .45-.44C6.76 5 7.04 5 7.6 5h.8c.56 0 .84 0 1.05.1a1 1 0 0 1 .44.45c.11.21.11.49.11 1.05v10.8c0 .56 0 .84-.1 1.05a1 1 0 0 1-.45.44c-.21.11-.49.11-1.05.11h-.8c-.56 0-.84 0-1.05-.1a1 1 0 0 1-.44-.45C6 18.24 6 17.96 6 17.4V6.6Zm8 0c0-.56 0-.84.1-1.05a1 1 0 0 1 .45-.44C14.76 5 15.04 5 15.6 5h.8c.56 0 .84 0 1.05.1a1 1 0 0 1 .44.45c.11.21.11.49.11 1.05v10.8c0 .56 0 .84-.1 1.05a1 1 0 0 1-.45.44c-.21.11-.49.11-1.05.11h-.8c-.56 0-.84 0-1.05-.1a1 1 0 0 1-.44-.45c-.11-.21-.11-.49-.11-1.05V6.6Z"/></svg>',name:"pause_24"}}s.d(t,{getIcon24Pause:()=>a})},660596:(e,t,s)=>{"use strict";function a(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M18.5 11.13a1 1 0 0 1 0 1.74l-9 5.2A1 1 0 0 1 8 17.2V6.8a1 1 0 0 1 1.5-.86l9 5.2Z"/></svg>',name:"play_24"}}s.d(t,{getIcon24Play:()=>a})},312311:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="song_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="song_24__song_24"><path id="song_24__Bounds" d="M0 0h24v24H0z"/><path d="M13 11.48v5.65c0 4.52-.87 5.39-4.37 5.85C6.96 23.19 5 22.44 5 19.8c0-1.28.8-2.5 2.46-2.81 1.27-.25-.09.02 2.78-.52.7-.13.77-.37.77-.9V3.97c0-1.24.67-1.69 2.66-2.09l4.68-.87c.37-.07.65.07.65.49v4.05c0 .42-.17.6-.59.68l-4.86.86c-.38.1-.55.36-.55.74v3.64Z" id="song_24__Mask" fill="currentColor"/></g></g></svg>',name:"song_24"}}s.d(t,{getIcon24Song:()=>a})},518996:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M28 52a24 24 0 1 0 0-48 24 24 0 0 0 0 48z" fill="#FC3"/><path fill-rule="evenodd" clip-rule="evenodd" d="M31.86 40.86a1.29 1.29 0 0 1 0 2.57h-7.72a1.29 1.29 0 0 1 0-2.57h7.72zm-1.29-12c.86-.86 1.72 1.71 6 1.71 3.43 0 6.43-1.71 6.86-.86.43.86-2.57 4.29-6.86 4.29-5.14 0-6.86-4.29-6-5.14zm-5.14 0c.86.85-.86 5.14-6 5.14-4.29 0-7.29-3.43-6.86-4.29.43-.85 3.43.86 6.86.86 4.28 0 5.14-2.57 6-1.71zm9.43-10.29c.85-.86 2.57 2.14 6 3.43s4.28 1.29 4.28 2.57c0 .86-.85 1.72-5.14 0-4.29-1.71-6-5.14-5.14-6zm-13.72 0c.86.86-.85 4.29-5.14 6-4.29 1.72-5.14.86-5.14 0 0-1.28.85-1.28 4.28-2.57 3.43-1.29 5.15-4.29 6-3.43z" fill="#805446"/></svg>',name:"pensive_face_56"}}s.d(t,{getIcon56PensiveFace:()=>a})},84463:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerHTML5:()=>_});var a=s(575753),n=s(434810),r=s(899841),d=s(63057);class _{destroy(){}getPlayedTime(){const e=this._currentAudioEl.played;let t=0;for(let s=0;s<e.length;s++)t+=e.end(s)-e.start(s);return t}getCurrentTime(){return this._currentAudioEl.currentTime}clearAudioNode(){this._currentAudioEl=this._createAudioNode(r.SILENCE)}isCurrent(e){return e===this._currentAudioEl}_createAudioNode(e){const t=new d.AudioHlsNode({onBufferUpdate:()=>{this.isCurrent(t)&&this.opts.onBufferUpdate(this.getCurrentBuffered())},onProgressUpdate:()=>{this.isCurrent(t)&&t.src!==r.SILENCE&&this.opts.onProgressUpdate(this.getCurrentProgress(),this.getPlayedTime(),this.getCurrentTime())},onEnd:()=>{this.isCurrent(t)&&t.src!==r.SILENCE&&this.opts.onEnd()},onSeeked:()=>{this.isCurrent(t)&&this.opts.onSeeked()},onSeek:()=>{this.isCurrent(t)&&this.opts.onSeek()},onFail:e=>{this._prefetchAudioEl===t?this._prefetchAudioEl=this._createAudioNode():this.isCurrent(t)&&t.src!==r.SILENCE&&(this._hlsError=e,this.opts.onFail&&this.opts.onFail())},onDurationChange:()=>{this.isCurrent(t)&&this._seekOnReady&&t.duration>0&&(this.seek(this._seekOnReady),this._seekOnReady=!1)},onCanPlay:()=>{this.isCurrent(t)&&this.opts.onCanPlay&&this.opts.onCanPlay()},onPause:(...e)=>{this.isCurrent(t)&&t.src!==r.SILENCE&&this.opts.onPause(...e)},onPlay:(...e)=>{this.isCurrent(t)&&t.src!==r.SILENCE&&this.opts.onPlay(...e)},volume:this.hasOwnProperty("_volume")?this._volume:this.opts.defaultVolume},e);return t}onReady(e){e()}prefetch(e){const t=(0,n.audioUnmaskSource)(e);this._prefetchAudioEl&&this._prefetchAudioEl.url===t||(this._prefetchAudioEl=this._createAudioNode(t))}seek(e){const t=this._currentAudioEl;t.duration>0&&t.src&&t.src!==r.SILENCE?t.currentTime=t.duration*e:this._seekOnReady=e}setVolume(e){void 0===e&&(e=this._currentAudioEl.volume),this._currentAudioEl.volume=e,this._prefetchAudioEl&&(this._prefetchAudioEl.volume=e),this._volume=e}setPlaybackRate(e){this._currentAudioEl.playbackRate=e}getCurrentProgress(){return this._currentAudioEl.currentProgress}getCurrentBuffered(){return this._currentAudioEl&&this._currentAudioEl.currentBuffered}getDuration(){return this._currentAudioEl&&this._currentAudioEl.duration}isFullyLoaded(){return this._currentAudioEl.isFullyLoaded}setUrl(e,t=(()=>{})){let s;if(!e)return t&&t(!1);const a=(0,n.audioUnmaskSource)(e);let d=this._currentAudioEl;if(this._currentAudioEl.src&&this._currentAudioEl.src!==r.SILENCE&&(this._seekOnReady=!1),this._currentAudioEl.src===a)return this.opts.onCanPlay&&this.opts.onCanPlay(),void(t&&t(!0));if(this._prefetchAudioEl){if(this._prefetchAudioEl.src===a)return this._currentAudioEl.pause(),this._currentAudioEl.setUrl(r.SILENCE),this._prefetchAudioEl.readyState>=3&&setTimeout((()=>this.opts.onCanPlay&&this.opts.onCanPlay())),this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=null,void(t&&t(!0));a!==r.SILENCE&&this._prefetchAudioEl.setUrl(r.SILENCE)}d.src!==a&&(s=d.setUrl(a).then((()=>this._stopFrequencyAnalise()))),s?s.then((()=>t(!0))).catch((()=>t(!1))):t(!0)}play(){this._stopFrequencyAnalise();const e=this._currentAudioEl;if(e.src){const t=e.play();return this._startFrequencyAnalise(),t}return Promise.resolve()}preparePlay(){if(a.browser.safari)return this._currentAudioEl.setUrl(r.SILENCE).then((()=>this._currentAudioEl.play()))}_startFrequencyAnalise(){function e(e,t,s,a){return(s-t)*e/a+t}function t(e,t){return Math.random()*(t-e)+e}this._stopFrequencyAnalise();let s=999,a=null,n=null;this._freqUpdateInterval=setInterval((()=>{let r;this._currentAudioEl.paused?r=[0,0,0,0]:(s++,s>3&&(s=0,a=n,n=[t(.7,1),t(.55,.8),t(.3,.55),t(.03,.45)],a||(a=[t(.7,1),t(.55,.8),t(.3,.55),t(.03,.45)])),r=[e(s,a[0],n[0],3),e(s,a[1],n[1],3),e(s,a[2],n[2],3),e(s,a[3],n[3],3)]),this.opts.onFrequency&&this.opts.onFrequency(r)}),50)}_stopFrequencyAnalise(){clearInterval(this._freqUpdateInterval),this.opts.onFrequency&&this.opts.onFrequency([0,0,0,0])}pause(){this._currentAudioEl.pause(),this._stopFrequencyAnalise()}stop(){this._currentAudioEl.pause(),this.seek(0),this._stopFrequencyAnalise()}_setFadeVolumeInterval(e){if(e){if(!this._fadeVolumeWorker&&window.Worker&&window.Blob){const e=new Blob(["\n          var interval;\n          onmessage = function(e) {\n            clearInterval(interval);\n            if (e.data == 'start') {\n              interval = setInterval(function() { postMessage({}); }, 20);\n            }\n          }\n        "]);try{this._fadeVolumeWorker=new Worker(window.URL.createObjectURL(e))}catch(e){this._fadeVolumeWorker=!1}}this._fadeVolumeWorker?(this._fadeVolumeWorker.onmessage=e,this._fadeVolumeWorker.postMessage("start")):this._fadeVolumeInterval=setInterval(e,60)}else this._fadeVolumeWorker&&(this._fadeVolumeWorker.terminate(),this._fadeVolumeWorker=null),this._fadeVolumeInterval&&clearInterval(this._fadeVolumeInterval)}fadeVolume(e,t,s){e=Math.max(0,Math.min(1,e));const a=this._currentAudioEl;let n=0;if(t){const s=e-a.volume;n=s/(t/20||1)}else n=e<a.volume?-.06:.001;if(Math.abs(e-a.volume)<=.001)return this._setFadeVolumeInterval(),s&&s();let r=a.volume;this._setFadeVolumeInterval((()=>{!t&&n>0&&(n*=1.35),r+=n;let a=!1;if(a=n<0?r<=e:r>=e,a)return this.setVolume(e),this._setFadeVolumeInterval(),s&&s();this.setVolume(r)}))}getErrorData(){const e=this._currentAudioEl.error||{};return{is_hls:this._currentAudioEl.hls?1:0,url:this._currentAudioEl.src,error_code:e.code,error_message:e.message,hls_error:this._hlsError?JSON.stringify(this._hlsError):null}}constructor(e){this.type="html5",this.opts=e||{},this._audioNodes=[],this._currentAudioEl=this._createAudioNode(),this._prefetchAudioEl=this._createAudioNode()}}},800418:(e,t,s)=>{"use strict";s.d(t,{AudioAds:()=>p});var a=s(898848),n=s(598129),r=s(575753),d=s(392358),_=s(251458),l=s(636576),u=s(690027),c=s(255818);class p{get isActive(){return!!this._isActive}set isActive(e){this._isActive=e,this.player.notify(d.events.PLAYER_IS_AD_CHANGED,e)}isPlaying(){return this.isActive}getCurrentAd(){return this._currentAd}setAdsConfig(e){this._adsConfig=e}getCurrentProgress(){return this._adsCurrentProgress}getDuration(){return this._duration}loadAdman(e){const t=t=>e&&e(t);if(this._admanLoaded)return void t();let s=0;(0,n.loadScript)(p.ADMAN_SRC,{onLoad:()=>{this._admanLoaded=!0,t()},onError:()=>{window.abp?(this._admanLoaded=!0,t()):(s+=1,3===s&&(this._admanLoaded=!0),t("script_load_fail"))}})}_fetchAd(e,t,s,n,r){this.loadAdman((_=>{if(!window.AdmanHTML)return this._sendEvent("no_adman",t,p.AD_TYPE,_),n&&n();this._adman=new AdmanHTML;const l=this._adsConfig||vk.audioAdsConfig||window.audioAdsConfig,u={_SITEID:276,ver:251116,vk_id:vk.id,puid1:554,duration:e.duration,content_id:m(e.ownerId,e.id),vk_catid:p.CAT_IDS[t]||p.CAT_IDS.other,sign:l?.sign||""};Object.assign(u,e.ads||{}),nav.objLoc&&nav.objLoc.preview&&(u.preview=(0,a.intval)(nav.objLoc.preview)),cur.adsPreview&&(u.preview=1,u.vk_id=398724832),this._adman.setDebug(!!u.preview),this._adman.onError((()=>n&&n())),this._adman.onReady((()=>{if(!this._adman)return;const e=this._adman.getBannersForSection(p.AD_TYPE);if(e&&e.length){const[a]=e;"statistics"===a.type?(this._play(!0,t),n&&n()):(this._sendEvent("received",t),s?(this._sendEvent("rejected",t,p.AD_TYPE,r),this.deinit(),n&&n()):(this._sendEvent("ready",t),this.player.notify(d.events.AD_READY),this._play(!1,t,n,a)))}else s||this._sendEvent("not_received",t),n&&n()})),this._adman.init({slot:3514,wrapper:document.createElement("div"),params:u,browser:{adBlock:!!window.abp,mobile:!1}}),this._sendEvent("requested",t)}))}_sendEvent(e,t,s,n){const r=s?"/"+s:"",d=n?"/"+n:"";this._adEvents.push(e+"/"+t+r+d),clearTimeout(this._adEventDelay),this._adEventDelay=setTimeout((()=>{ajax.post(this.adsStatUrl,{act:"ad_event",events:this._adEvents.join(","),v:this.playerVersion,abp:(0,a.intval)(window.abp)},{onFail:()=>!0}),this._adEvents=[]}),500)}_play(e,t,s,n){this._adman.onCompleted((()=>{this.deinit(!0),e?this._sendEvent("statistics",t):(this.player.notify(d.events.PROGRESS,0),this.player.notify(d.events.AD_COMPLETED),this.isActive=!1,this._currentAd=null,this._adsCurrentProgress=0,this._sendEvent("completed",t),this.isMvk||(window.document.title=(0,a.replaceEntities)(this._adsPrevTitle)),s&&s())})),this._adman.onStarted((()=>{e||(this.player.setIsPlaying(!0),this.player.notify(d.events.PLAY),this.player.notify(d.events.PROGRESS,0),this.player.notify(d.events.AD_STARTED,(0,c.makeAudioAdFromAdman)(n)),this.updateVolume(),this._sendEvent("started",t),window.statlogsValueEvent&&(0,l.statlogsValueEvent)("audio_web_ad_link","show"))})),this._adman.onPaused((()=>{this.player.setIsPlaying(!1),this.player.notify(d.events.PAUSE)})),this._adman.onPlayed((()=>{this.player.setIsPlaying(!0),this.player.notify(d.events.PLAY)}));const r=[.25,.5,.75];if(this._adman.onTimeRemained((e=>{this._duration=isNaN(e.duration)?0:e.duration,this._adsCurrentProgress=(isNaN(e.percent)?0:e.percent)/100,this.player.notify(d.events.PROGRESS,this._adsCurrentProgress,this._duration),(0,a.each)(r,((e,s)=>{if(this._adsCurrentProgress>=s)return r.shift(),this._sendEvent("progress_"+(0,a.intval)(100*s),t),!1}))})),this._adman.start(p.AD_TYPE),e)return s&&s();this._currentAd=(0,c.makeAudioAdFromAdman)(n),this.isActive=!0,this._adsPrevTitle=document.title,this.isMvk||(window.document.title=getLang("global_audio_ad"))}updateVolume(){this._adman&&this._adman.setVolume(.7*this.player.getVolume())}deinit(e){this._adman=null,!e&&this.player.notify(d.events.AD_DEINITED)}pause(){this._adman&&(this.player.setIsPlaying(!1),this._adman.pause())}stop(){this._adman&&(this.player.setIsPlaying(!1),this._adman.stop())}resume(){this._adman&&(this.player.setIsPlaying(!0),this._adman.resume(),this.player.notify(d.events.PLAY))}checkPlay(e,t){const s=this.player._getPlayingContextSection(),{type:a,reason:n}=this._isAllowed(e),r=()=>t&&t();switch(a){case p.ALLOW_ALLOWED:this._fetchAd(e,s,!1,r);break;case p.ALLOW_DISABLED:r();break;case p.ALLOW_REJECT:this._fetchAd(e,s,!0,!1,n),r()}}hasAdsSupport(){const e=(0,a.intval)(r.browser.version.split(".")[0]);return!(r.browser.ios||r.browser.safari&&this.isMvk||r.browser.chrome&&e<50)}_isAllowed(e){if(vk.widget||(0,_.isPodcast)(e)||(0,u.isExternalStream)(e))return{type:p.ALLOW_DISABLED};const t=this._adsConfig||vk.audioAdsConfig||window.audioAdsConfig;if(t){if(!t.enabled||!this.hasAdsSupport())return{type:p.ALLOW_DISABLED};if(cur.adsPreview)return{type:p.ALLOW_ALLOWED};if(t.day_limit_reached)return{type:p.ALLOW_REJECT,reason:p.REJECT_REASON_LIMIT};return"im"!==this.player._getPlayingContextSection()?{type:p.ALLOW_ALLOWED}:{type:p.ALLOW_REJECT,reason:p.REJECT_REASON_SECTION}}return{type:p.ALLOW_REJECT,reason:p.REJECT_REASON_UNKNOWN}}startPlay(e,t){this.checkPlay(e,t)}constructor(e,t,s){this._isActive=!1,this._currentAd=null,this._adsCurrentProgress=0,this._adman=null,this._admanLoaded=!1,this._adEvents=[],this.player=e||{},this.playerVersion=t||null,this._startAdsTO=null,this._adsConfig=null,this._duration=0,this.isMvk=Boolean(s),this.adsStatUrl=this.isMvk?"audio":"al_audio.php"}}function m(e,t){const s=e.toString(16);let a=t.toString(16);for(;a.length<8;)a="0"+a;return s+a}p.ADMAN_SRC="//ad.mail.ru/static/admanhtml/rbadman-html5.min.js",p.CAT_IDS={my:101,my_playlists:101,audio_feed:109,recent:113,user_wall:104,group_wall:104,user_list:102,group_list:103,user_playlists:102,group_playlists:103,feed:105,search:110,global_search:110,replies:104,im:106,group_status:104,user_status:104,recs:107,recs_audio:107,recs_album:107,other:114},p.AD_TYPE="preroll",p.ALLOW_DISABLED=1,p.ALLOW_ALLOWED=2,p.ALLOW_REJECT=3,p.REJECT_REASON_UNKNOWN="unknown",p.REJECT_REASON_LIMIT="track_limit_exceeded",p.REJECT_REASON_SECTION="section_not_allowed"},899841:(e,t,s)=>{"use strict";s.d(t,{DEFAULT_VOLUME:()=>n,SILENCE:()=>a});const a="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",n=.4761515102104643},434810:(e,t,s)=>{"use strict";s.d(t,{audioUnmaskSource:()=>d});var a=s(898848);const n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMN0PQRSTUVWXYZO123456789+/=",r={v:function(e){return e.split("").reverse().join("")},r:function(e,t){let s;e=e.split("");const a=n+n;let r=e.length;for(;r--;)s=a.indexOf(e[r]),~s&&(e[r]=a.substr(s-t,1));return e.join("")},s:function(e,t){let s=e.length;if(s){const a=function(e,t){const s=e.length,a=[];if(s){let e=s;for(t=Math.abs(t);e--;)t=(s*(e+1)^t+e)%s,a[e]=t}return a}(e,t);let n=0;for(e=e.split("");++n<s;)e[n]=e.splice(a[s-1-n],1,e[n])[0];e=e.join("")}return e},i:function(e,t){return r.s(e,t^vk.id)},x:function(e,t){const s=[];return t=t.charCodeAt(0),(0,a.each)(e.split(""),(function(e,a){s.push(String.fromCharCode(a.charCodeAt(0)^t))})),s.join("")}};function d(e){if((!window.wbopen||!~(window.open+"").indexOf("wbopen"))&&~e.indexOf("audio_api_unavailable")){let t,s,a=e.split("?extra=")[1].split("#"),n=""===a[1]?"":_(a[1]);if(a=_(a[0]),"string"!=typeof n||!a)return e;n=n?n.split(String.fromCharCode(9)):[];let d=n.length;for(;d--;){if(s=n[d].split(String.fromCharCode(11)),t=s.splice(0,1,a)[0],!r[t])return e;a=r[t].apply(null,s)}if(a&&"http"===a.substr(0,4))return a}return e}function _(e){if(!e||e.length%4==1)return!1;let t,s,a=0,r=0,d="";for(;s=e.charAt(r++);)s=n.indexOf(s),~s&&(t=a%4?64*t+s:s,a++%4)&&(d+=String.fromCharCode(255&t>>(-2*a&6)));return d}},280213:(e,t,s)=>{"use strict";function a(e,t){let s="";return e.forEach((function(a,n){let r="/audio?performer=1&q="+encodeURIComponent(a.name),d=window.getWebHost?window.getWebHost():"";a.id&&(r=`/artist/${a.id}`),s+=t?`<a class="artist_link" href="${d}${r}">${a.name}</a>`:a.name,n<e.length-1&&(s+=", ")})),s}s.d(t,{getAudioArtistsString:()=>a})},349581:(e,t,s)=>{"use strict";s.d(t,{getAudioPerformers:()=>d});var a=s(251458),n=s(280213),r=s(867366);function d(e,t=!0){let s="";const d=!(0,a.isPodcast)(e)&&t;if(Array.isArray(e[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS])&&(s=(0,n.getAudioArtistsString)(e[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS],d)),Array.isArray(e[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS])&&(s+=" feat. ",s+=(0,n.getAudioArtistsString)(e[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS],d)),!s){let t=e[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]?e[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER].replace(/<\/?em>/g,""):"";if(d){s=`<a class="artist_link" data-performer="${t}" href="${"/audio?performer=1&q="+encodeURIComponent(t)}">${t}</a>`}else s=t}return s}},251458:(e,t,s)=>{"use strict";s.d(t,{isPodcast:()=>r});var a=s(867366),n=s(898848);function r(e){if(!e)return!1;let t=(0,n.isObject)(e)?e.extra:e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA];return(0,n.isObject)(t)||(t=JSON.parse(t||"{}")),!!t.podcast}},8236:(e,t,s)=>{"use strict";s.d(t,{serializeAudio:()=>n});var a=s(867366);function n(e){if(!e)return null;if(Array.isArray(e))return e;const t=[e.addHash,e.editHash,e.actionHash,e.deleteHash,e.replaceHash,e.urlHash,e.restoreHash].join("/"),s=[e.coverUrl_l,e.coverUrl_p].join(","),n=[];return n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=e.id,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=e.owner_id,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=e.url,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=e.title,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=e.performer,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=e.duration,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_ID]=e.albumId,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]=e.authorLink,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=e.lyrics,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=e.flags,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]=e.context,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=e.extra,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]=t,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]=s,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]=e.ads,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]=e.subTitle,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]=e.mainArtists,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]=e.featArtists,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=e.album,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]=e.trackCode,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=e.restrictionStatus,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=e.albumPart,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]=e.accessKey,n[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=e.chartInfo,n}},762701:(e,t,s)=>{"use strict";function a(e,t){if(!window.Worker||!window.Blob)return setTimeout(e,t);{const s=new Blob([`\n      var timeout;\n      onmessage = function(e) {\n        clearTimeout(timeout);\n        if (e.data == 'start') {\n          timeout = setTimeout(function() { postMessage({}); }, ${t});\n        }\n      }\n    `]);try{const t=new Worker(window.URL.createObjectURL(s));return t.onmessage=function(){t.terminate(),e()},t.postMessage("start"),t}catch(s){return setTimeout(e,t)}}}s.d(t,{setWorkerTimeout:()=>a})},43866:(e,t,s)=>{"use strict";function a(e){try{return e.play()||Promise.resolve()}catch(e){return Promise.reject(e)}}s.d(t,{wrapAudioPlay:()=>a})},613715:(e,t,s)=>{"use strict";s.d(t,{EMOJI_HINTS:()=>_,EMOJI_PREFIXED_REPLACES:()=>r,EMOJI_REPLACES:()=>d,emojiRegex:()=>a,skinToneModifierRegex:()=>n});const a=()=>/\u{1F3F4}(?:\u{E0067}\u{E0062}(?:\u{E0065}\u{E006E}\u{E0067}|\u{E0077}\u{E006C}\u{E0073}|\u{E0073}\u{E0063}\u{E0074})\u{E007F}|\u{200D}\u{2620}\u{FE0F}?)|\u{1F469}\u{200D}\u{1F469}\u{200D}(?:\u{1F466}\u{200D}\u{1F466}|\u{1F467}\u{200D}[\u{1F466}\u{1F467}])|\u{1F468}(?:\u{200D}(?:\u{2764}\u{FE0F}?\u{200D}(?:\u{1F48B}\u{200D})?\u{1F468}|[\u{1F468}\u{1F469}]\u{200D}(?:\u{1F466}\u{200D}\u{1F466}|\u{1F467}\u{200D}[\u{1F466}\u{1F467}])|\u{1F466}\u{200D}\u{1F466}|\u{1F467}\u{200D}[\u{1F466}\u{1F467}]|[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}])|[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}])|\u{1F469}\u{200D}(?:\u{2764}\u{FE0F}?\u{200D}(?:\u{1F48B}\u{200D}[\u{1F468}\u{1F469}]|[\u{1F468}\u{1F469}])|[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}])|\u{1F469}\u{200D}\u{1F466}\u{200D}\u{1F466}|(?:\u{1F441}\u{FE0F}?\u{200D}\u{1F5E8}|\u{1F469}[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2695}\u{2696}\u{2708}]|\u{1F468}(?:[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2695}\u{2696}\u{2708}]|\u{200D}[\u{2695}\u{2696}\u{2708}])|(?:[\u{26F9}\u{1F3CB}\u{1F3CC}\u{1F575}]\u{FE0F}?|[\u{1F46F}\u{1F93C}\u{1F9DE}\u{1F9DF}])\u{200D}[\u{2640}\u{2642}]|[\u{26F9}\u{1F3CB}\u{1F3CC}\u{1F575}][\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2640}\u{2642}]|[\u{1F3C3}\u{1F3C4}\u{1F3CA}\u{1F46E}\u{1F471}\u{1F473}\u{1F477}\u{1F481}\u{1F482}\u{1F486}\u{1F487}\u{1F645}-\u{1F647}\u{1F64B}\u{1F64D}\u{1F64E}\u{1F6A3}\u{1F6B4}-\u{1F6B6}\u{1F926}\u{1F937}-\u{1F939}\u{1F93D}\u{1F93E}\u{1F9B8}\u{1F9B9}\u{1F9D6}-\u{1F9DD}](?:[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{2640}\u{2642}]|\u{200D}[\u{2640}\u{2642}])|\u{1F469}\u{200D}[\u{2695}\u{2696}\u{2708}])\u{FE0F}?|\u{1F469}\u{200D}\u{1F467}\u{200D}[\u{1F466}\u{1F467}]|\u{1F469}\u{200D}\u{1F469}\u{200D}[\u{1F466}\u{1F467}]|\u{1F468}(?:\u{200D}(?:[\u{1F468}\u{1F469}]\u{200D}[\u{1F466}\u{1F467}]|[\u{1F466}\u{1F467}])|[\u{1F3FB}-\u{1F3FF}])|\u{1F3F3}\u{FE0F}?\u{200D}\u{1F308}|\u{1F469}\u{200D}\u{1F467}|\u{1F469}[\u{1F3FB}-\u{1F3FF}]\u{200D}[\u{1F33E}\u{1F373}\u{1F393}\u{1F3A4}\u{1F3A8}\u{1F3EB}\u{1F3ED}\u{1F4BB}\u{1F4BC}\u{1F527}\u{1F52C}\u{1F680}\u{1F692}\u{1F9B0}-\u{1F9B3}]|\u{1F469}\u{200D}\u{1F466}|\u{1F1F6}\u{1F1E6}|\u{1F1FD}\u{1F1F0}|\u{1F1F4}\u{1F1F2}|\u{1F469}[\u{1F3FB}-\u{1F3FF}]|\u{1F1ED}[\u{1F1F0}\u{1F1F2}\u{1F1F3}\u{1F1F7}\u{1F1F9}\u{1F1FA}]|\u{1F1EC}[\u{1F1E6}\u{1F1E7}\u{1F1E9}-\u{1F1EE}\u{1F1F1}-\u{1F1F3}\u{1F1F5}-\u{1F1FA}\u{1F1FC}\u{1F1FE}]|\u{1F1EA}[\u{1F1E6}\u{1F1E8}\u{1F1EA}\u{1F1EC}\u{1F1ED}\u{1F1F7}-\u{1F1FA}]|\u{1F1E8}[\u{1F1E6}\u{1F1E8}\u{1F1E9}\u{1F1EB}-\u{1F1EE}\u{1F1F0}-\u{1F1F5}\u{1F1F7}\u{1F1FA}-\u{1F1FF}]|\u{1F1F2}[\u{1F1E6}\u{1F1E8}-\u{1F1ED}\u{1F1F0}-\u{1F1FF}]|\u{1F1F3}[\u{1F1E6}\u{1F1E8}\u{1F1EA}-\u{1F1EC}\u{1F1EE}\u{1F1F1}\u{1F1F4}\u{1F1F5}\u{1F1F7}\u{1F1FA}\u{1F1FF}]|\u{1F1FC}[\u{1F1EB}\u{1F1F8}]|\u{1F1FA}[\u{1F1E6}\u{1F1EC}\u{1F1F2}\u{1F1F3}\u{1F1F8}\u{1F1FE}\u{1F1FF}]|\u{1F1F0}[\u{1F1EA}\u{1F1EC}-\u{1F1EE}\u{1F1F2}\u{1F1F3}\u{1F1F5}\u{1F1F7}\u{1F1FC}\u{1F1FE}\u{1F1FF}]|\u{1F1EF}[\u{1F1EA}\u{1F1F2}\u{1F1F4}\u{1F1F5}]|\u{1F1F8}[\u{1F1E6}-\u{1F1EA}\u{1F1EC}-\u{1F1F4}\u{1F1F7}-\u{1F1F9}\u{1F1FB}\u{1F1FD}-\u{1F1FF}]|\u{1F1EE}[\u{1F1E8}-\u{1F1EA}\u{1F1F1}-\u{1F1F4}\u{1F1F6}-\u{1F1F9}]|\u{1F1FF}[\u{1F1E6}\u{1F1F2}\u{1F1FC}]|\u{1F1EB}[\u{1F1EE}-\u{1F1F0}\u{1F1F2}\u{1F1F4}\u{1F1F7}]|\u{1F1F5}[\u{1F1E6}\u{1F1EA}-\u{1F1ED}\u{1F1F0}-\u{1F1F3}\u{1F1F7}-\u{1F1F9}\u{1F1FC}\u{1F1FE}]|\u{1F1E9}[\u{1F1EA}\u{1F1EC}\u{1F1EF}\u{1F1F0}\u{1F1F2}\u{1F1F4}\u{1F1FF}]|\u{1F1F9}[\u{1F1E6}\u{1F1E8}\u{1F1E9}\u{1F1EB}-\u{1F1ED}\u{1F1EF}-\u{1F1F4}\u{1F1F7}\u{1F1F9}\u{1F1FB}\u{1F1FC}\u{1F1FF}]|\u{1F1E7}[\u{1F1E6}\u{1F1E7}\u{1F1E9}-\u{1F1EF}\u{1F1F1}-\u{1F1F4}\u{1F1F6}-\u{1F1F9}\u{1F1FB}\u{1F1FC}\u{1F1FE}\u{1F1FF}]|[#\*0-9]\u{FE0F}?\u{20E3}|\u{1F1F1}[\u{1F1E6}-\u{1F1E8}\u{1F1EE}\u{1F1F0}\u{1F1F7}-\u{1F1FB}\u{1F1FE}]|\u{1F1E6}[\u{1F1E8}-\u{1F1EC}\u{1F1EE}\u{1F1F1}\u{1F1F2}\u{1F1F4}\u{1F1F6}-\u{1F1FA}\u{1F1FC}\u{1F1FD}\u{1F1FF}]|\u{1F1F7}[\u{1F1EA}\u{1F1F4}\u{1F1F8}\u{1F1FA}\u{1F1FC}]|\u{1F1FB}[\u{1F1E6}\u{1F1E8}\u{1F1EA}\u{1F1EC}\u{1F1EE}\u{1F1F3}\u{1F1FA}]|\u{1F1FE}[\u{1F1EA}\u{1F1F9}]|[\u{1F3C3}\u{1F3C4}\u{1F3CA}\u{1F46E}\u{1F471}\u{1F473}\u{1F477}\u{1F481}\u{1F482}\u{1F486}\u{1F487}\u{1F645}-\u{1F647}\u{1F64B}\u{1F64D}\u{1F64E}\u{1F6A3}\u{1F6B4}-\u{1F6B6}\u{1F926}\u{1F937}-\u{1F939}\u{1F93D}\u{1F93E}\u{1F9B8}\u{1F9B9}\u{1F9D6}-\u{1F9DD}][\u{1F3FB}-\u{1F3FF}]|[\u{26F9}\u{1F3CB}\u{1F3CC}\u{1F575}][\u{1F3FB}-\u{1F3FF}]|[\u{261D}\u{270A}-\u{270D}\u{1F385}\u{1F3C2}\u{1F3C7}\u{1F442}\u{1F443}\u{1F446}-\u{1F450}\u{1F466}\u{1F467}\u{1F470}\u{1F472}\u{1F474}-\u{1F476}\u{1F478}\u{1F47C}\u{1F483}\u{1F485}\u{1F4AA}\u{1F574}\u{1F57A}\u{1F590}\u{1F595}\u{1F596}\u{1F64C}\u{1F64F}\u{1F6C0}\u{1F6CC}\u{1F918}-\u{1F91C}\u{1F91D}\u{1F91E}\u{1F91F}\u{1F930}-\u{1F936}\u{1F9B5}\u{1F9B6}\u{1F9D1}-\u{1F9D5}][\u{1F3FB}-\u{1F3FF}]|[\u{231A}\u{231B}\u{23E9}-\u{23EC}\u{23F0}\u{23F3}\u{25FD}\u{25FE}\u{2614}\u{2615}\u{2648}-\u{2653}\u{267F}\u{2693}\u{26A1}\u{26AA}\u{26AB}\u{26BD}\u{26BE}\u{26C4}\u{26C5}\u{26CE}\u{26D4}\u{26EA}\u{26F2}\u{26F3}\u{26F5}\u{26FA}\u{26FD}\u{2705}\u{270A}\u{270B}\u{2728}\u{274C}\u{274E}\u{2753}-\u{2755}\u{2757}\u{2795}-\u{2797}\u{27B0}\u{27BF}\u{2B1B}\u{2B1C}\u{2B50}\u{2B55}\u{1F004}\u{1F0CF}\u{1F18E}\u{1F191}-\u{1F19A}\u{1F1E6}-\u{1F1FF}\u{1F201}\u{1F21A}\u{1F22F}\u{1F232}-\u{1F236}\u{1F238}-\u{1F23A}\u{1F250}\u{1F251}\u{1F300}-\u{1F320}\u{1F32D}-\u{1F335}\u{1F337}-\u{1F37C}\u{1F37E}-\u{1F393}\u{1F3A0}-\u{1F3CA}\u{1F3CF}-\u{1F3D3}\u{1F3E0}-\u{1F3F0}\u{1F3F4}\u{1F3F8}-\u{1F43E}\u{1F440}\u{1F442}-\u{1F4FC}\u{1F4FF}-\u{1F53D}\u{1F54B}-\u{1F54E}\u{1F550}-\u{1F567}\u{1F57A}\u{1F595}\u{1F596}\u{1F5A4}\u{1F5FB}-\u{1F64F}\u{1F680}-\u{1F6C5}\u{1F6CC}\u{1F6D0}-\u{1F6D2}\u{1F6EB}\u{1F6EC}\u{1F6F4}-\u{1F6F9}\u{1F910}-\u{1F93A}\u{1F93C}-\u{1F93E}\u{1F940}-\u{1F945}\u{1F947}-\u{1F970}\u{1F973}-\u{1F976}\u{1F97A}\u{1F97C}-\u{1F9A2}\u{1F9B0}-\u{1F9B9}\u{1F9C0}-\u{1F9C2}\u{1F9D0}-\u{1F9FF}]|[\xA9\xAE\u{203C}\u{2049}\u{2122}\u{2139}\u{2194}-\u{2199}\u{21A9}\u{21AA}\u{231A}\u{231B}\u{2328}\u{23CF}\u{23E9}-\u{23F3}\u{23F8}-\u{23FA}\u{24C2}\u{25AA}\u{25AB}\u{25B6}\u{25C0}\u{25FB}-\u{25FE}\u{2600}-\u{2604}\u{260E}\u{2611}\u{2614}\u{2615}\u{2618}\u{261D}\u{2620}\u{2622}\u{2623}\u{2626}\u{262A}\u{262E}\u{262F}\u{2638}-\u{263A}\u{2648}-\u{2653}\u{265F}\u{2660}\u{2663}\u{2665}\u{2666}\u{2668}\u{267B}\u{267E}\u{267F}\u{2692}-\u{2697}\u{2699}\u{269B}\u{269C}\u{26A0}\u{26A1}\u{26AA}\u{26AB}\u{26B0}\u{26B1}\u{26BD}\u{26BE}\u{26C4}\u{26C5}\u{26C8}\u{26CE}\u{26CF}\u{26D1}\u{26D3}\u{26D4}\u{26E9}\u{26EA}\u{26F0}-\u{26F5}\u{26F7}-\u{26FA}\u{26FD}\u{2702}\u{2705}\u{2708}-\u{270D}\u{270F}\u{2712}\u{2714}\u{2716}\u{271D}\u{2721}\u{2728}\u{2733}\u{2734}\u{2744}\u{2747}\u{274C}\u{274E}\u{2753}-\u{2755}\u{2757}\u{2763}\u{2764}\u{2795}-\u{2797}\u{27A1}\u{27B0}\u{27BF}\u{2934}\u{2935}\u{2B05}-\u{2B07}\u{2B1B}\u{2B1C}\u{2B50}\u{2B55}\u{3030}\u{303D}\u{3297}\u{3299}\u{1F004}\u{1F0CF}\u{1F170}\u{1F171}\u{1F17E}\u{1F17F}\u{1F18E}\u{1F191}-\u{1F19A}\u{1F1E6}-\u{1F1FF}\u{1F201}\u{1F202}\u{1F21A}\u{1F22F}\u{1F232}-\u{1F23A}\u{1F250}\u{1F251}\u{1F300}-\u{1F321}\u{1F324}-\u{1F393}\u{1F396}\u{1F397}\u{1F399}-\u{1F39B}\u{1F39E}-\u{1F3F0}\u{1F3F3}-\u{1F3F5}\u{1F3F7}-\u{1F4FD}\u{1F4FF}-\u{1F53D}\u{1F549}-\u{1F54E}\u{1F550}-\u{1F567}\u{1F56F}\u{1F570}\u{1F573}-\u{1F57A}\u{1F587}\u{1F58A}-\u{1F58D}\u{1F590}\u{1F595}\u{1F596}\u{1F5A4}\u{1F5A5}\u{1F5A8}\u{1F5B1}\u{1F5B2}\u{1F5BC}\u{1F5C2}-\u{1F5C4}\u{1F5D1}-\u{1F5D3}\u{1F5DC}-\u{1F5DE}\u{1F5E1}\u{1F5E3}\u{1F5E8}\u{1F5EF}\u{1F5F3}\u{1F5FA}-\u{1F64F}\u{1F680}-\u{1F6C5}\u{1F6CB}-\u{1F6D2}\u{1F6E0}-\u{1F6E5}\u{1F6E9}\u{1F6EB}\u{1F6EC}\u{1F6F0}\u{1F6F3}-\u{1F6F9}\u{1F910}-\u{1F93A}\u{1F93C}-\u{1F93E}\u{1F940}-\u{1F945}\u{1F947}-\u{1F970}\u{1F973}-\u{1F976}\u{1F97A}\u{1F97C}-\u{1F9A2}\u{1F9B0}-\u{1F9B9}\u{1F9C0}-\u{1F9C2}\u{1F9D0}-\u{1F9FF}]\u{FE0F}?|[\u{261D}\u{26F9}\u{270A}-\u{270D}\u{1F385}\u{1F3C2}-\u{1F3C4}\u{1F3C7}\u{1F3CA}-\u{1F3CC}\u{1F442}\u{1F443}\u{1F446}-\u{1F450}\u{1F466}-\u{1F469}\u{1F46E}\u{1F470}-\u{1F478}\u{1F47C}\u{1F481}-\u{1F483}\u{1F485}-\u{1F487}\u{1F4AA}\u{1F574}\u{1F575}\u{1F57A}\u{1F590}\u{1F595}\u{1F596}\u{1F645}-\u{1F647}\u{1F64B}-\u{1F64F}\u{1F6A3}\u{1F6B4}-\u{1F6B6}\u{1F6C0}\u{1F6CC}\u{1F918}-\u{1F91C}\u{1F91E}\u{1F91F}\u{1F926}\u{1F930}-\u{1F939}\u{1F93D}\u{1F93E}\u{1F9B5}\u{1F9B6}\u{1F9B8}\u{1F9B9}\u{1F9D1}-\u{1F9DD}]/gu,n=/\uFE0F?\uD83C[\uDFFB-\uDFFF]/,r={e29da4:/(\s|^)([0OО]:\))([\s\.,]|$)/g,f09f9887:/(\s|^)(;-\)+)([\s\.,]|$)/g,f09f9889:/(\s|^)([XХxх]-?D)([\s\.,]|$)/g,f09f9886:/(\s|^)(B-\))([\s\.,]|$)/g,f09f988e:/(\s|^)(3-\))([\s\.,]|$)/g,f09f988c:/(\s|^)(&gt;\()([\s\.,]|$)/g,f09f98a0:/(\s|^)(;[oоOО])([\s\.,]|$)/g,f09f98b0:/(\s|^)(8\|)([\s\.,]|$)/g,f09f98b3:/(\s|^)(8-?[oоOО])([\s\.,]|$)/g,f09f98b2:/(\s|^)(8-\))([\s\.,]|$)/g,f09f988d:/(\s|^)(:[XХ])([\s\.,]|$)/g,f09f98b7:/(\s|^)(:[oоOО])([\s\.,]|$)/g,f09f98a8:/(\s|^)(&lt;3)([\s\.,]|$)/g},d={f09f988a:/(:-\))([\s\.,]|$)/g,f09f9883:/(:-D)([\s\.,]|$)/g,f09f989c:/(;-[PР])([\s\.,]|$)/g,f09f988b:/(:-[pр])([\s\.,]|$)/g,f09f9892:/(:-\()([\s\.,]|$)/g,e298ba:/(:-?\])([\s\.,]|$)/g,f09f988f:/(;-\])([\s\.,]|$)/g,f09f9894:/(3-?\()([\s\.,]|$)/g,f09f98a2:/(:&#039;\()([\s\.,]|$)/g,f09f98ad:/(:_\()([\s\.,]|$)/g,f09f98a9:/(:\(\()([\s\.,]|$)/g,f09f9890:/(:\|)([\s\.,]|$)/g,f09f98a1:/(&gt;\(\()([\s\.,]|$)/g,f09f989a:/(:-\*)([\s\.,]|$)/g,f09f9888:/(\}:\))([\s\.,]|$)/g,f09f918d:/(:like:)([\s\.,]|$)/g,f09f918e:/(:dislike:)([\s\.,]|$)/g,e2989d:/(:up:)([\s\.,]|$)/g,e29c8c:/(:v:)([\s\.,]|$)/g,f09f918c:/(:ok:|:ок:)([\s\.,]|$)/g},_={e29da4:[0,"<3"],f09f988a:[1,":-)"],f09f9883:[2,":-D"],f09f9889:[3,";-)"],f09f9886:[4,"xD"],f09f989c:[5,";-P"],f09f988b:[6,":-p"],f09f988d:[7,"8-)"],f09f988e:[8,"B-)"],f09f9892:[9,":-("],f09f988f:[10,";-]"],f09f9894:[11,"3("],f09f98a2:[12,":'("],f09f98ad:[13,":_("],f09f98a9:[14,":(("],f09f98a8:[15,":o"],f09f9890:[16,":|"],f09f988c:[17,"3-)"],f09f98a0:[18,">("],f09f98a1:[19,">(("],f09f9887:[20,"O:)"],f09f98b0:[21,";o"],f09f98b3:[22,"8|"],f09f98b2:[23,"8o"],f09f98b7:[24,":X"],f09f989a:[25,":-*"],f09f9888:[26,"}:)"],f09f918d:[27,":like:"],f09f918e:[28,":dislike:"],e2989d:[29,":up:"],e29c8c:[30,":v:"],f09f918c:[31,":ok:"]}},573859:(e,t,s)=>{"use strict";s.d(t,{emojiReplace:()=>u,emojiToHTML:()=>_,getEmojiHTML:()=>l});var a=s(575753),n=s(613715),r=s(261347),d=s(8520);function _(e,t){if(a.browser.ipad||a.browser.iphone)return e;e=(e+"").replace(/&nbsp;/g," ").replace(/<br>/g,"\n");for(let t=0;t<2;t++)Object.keys(n.EMOJI_PREFIXED_REPLACES).forEach((t=>{e.replace(n.EMOJI_PREFIXED_REPLACES[t],((e,s,a,n)=>(s||"")+l(t)+(n||"")))}));return Object.keys(n.EMOJI_REPLACES).forEach((t=>{e=e.replace(n.EMOJI_REPLACES[t],((e,s,a)=>l(t)+(a||"")))})),e=e.replace(/\n/g,"<br>"),t&&(e=e.replace(/\uFE0F/g,"").replace((0,n.emojiRegex)(),u)),e}function l(e,t,s,n){if(!s&&t)return t;if(n){return`<i class="emoji @${e}" emoji="${e}"${t?` title="${t}"`:""}></i>`}return`<img class="emoji" src="/emoji/e/${e}${window.devicePixelRatio>=2?"_2x":""}.png"${t?` alt="${t}"`:""}${a.browser.msie&&Number(a.browser.version)>8?' contenteditable="false"':""}>`}function u(e){return l((0,r.emojiSymbolToByteHex)(e),(0,d.encodeHTMLEntities)((0,d.escape)(e)),!0)}},261347:(e,t,s)=>{"use strict";s.d(t,{emojiByteHexToSymbol:()=>r,emojiRemoveSkinToneModifiers:()=>d,emojiSymbolToByteHex:()=>n});var a=s(613715);function n(e){return encodeURIComponent(e.replace(/\uFE0F/giu,"")).replace(/%/gi,"").toLowerCase()}function r(e){const t=e.length%2==1,s=t?e.slice(0,1):"",a=t?e.slice(1):e;let n="";try{n=decodeURIComponent("%"+(r=a,r.split("").reduce(((e,t,s)=>e+t+((s+1)%2==0?" ":"")),"").trim().split(/\s+/)).join("%"))}catch(e){}var r;return s+n}function d(e){return e.replace((0,a.emojiRegex)(),_)}function _(e){return e.replace(a.skinToneModifierRegex,"")}},312641:(e,t,s)=>{"use strict";s.d(t,{MASS_MENTION_ALIASES:()=>n,MASS_MENTION_REGEXP:()=>r,PINNED_CONVERSATION_BIT_MASK:()=>a,VK_OFFICIAL_PEER_ID:()=>d});const a=112,n={all:["all","everyone","все"],online:["online","here","здесь","тут"]},r=new RegExp(['(?!,|;|:|\\.|\\s|<br ?/?>|"|\\(|\\)|\\[|\\]|!|\\?)',"(",[].concat(n.all).concat(n.online).map((e=>`@${e}|\\*${e}`)).join("|"),")",'(?=$|,|;|:|\\.(?![a-z0-9_-])|\\s|<br ?/?>|"|\\(|\\)|\\[|\\]|!|\\?)'].join(""),"gi"),d=-22822305},34231:(e,t,s)=>{"use strict";s.d(t,{checkIfInternal:()=>_,wrapAway:()=>d,wrapAwayIfExternal:()=>r});var a=s(105330);const n=new RegExp(`^(https?:\\/\\/)?([a-z0-9_\\-.]+\\.)?${a.VK_SITE_REGEX_SOURCE_UNSAFE}(\\/.*)?`);function r(e,t=!1){return _(e)?e:d(e,t)}function d(e,t){return"/away.php?to="+encodeURIComponent(decodeURIComponent(e))+(t?"&utf=1":"")}function _(e){const t=decodeURIComponent(e);return/^\/[^/]/.test(t)||n.test(t)}},740342:(e,t,s)=>{"use strict";function a(e,t,s){let a;return function(){const n=arguments,r=s&&!a;clearTimeout(a),a=setTimeout((()=>{a=null,s||e.apply(this,n)}),t),r&&e.apply(this,n)}}s.d(t,{debounce:()=>a})},556216:(e,t,s)=>{"use strict";s.d(t,{decodeHTMLEntitiesDEPRECATED:()=>r,prepareToWriting:()=>d});var a=s(8520),n=s(573859);function r(e){return(0,a.decodeHTMLEntities)(e)}function d(e){let t=(0,a.decodeHTMLEntities)(e);return t=t.replace(/\n\r/gi,"\n"),t=(0,a.escape)(t),t=(0,n.emojiToHTML)(t,!0),t}},166583:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(353440);const n={getConnection:a.getConnection,getConnectionType:a.getConnectionType,getConnectionEffectiveType:a.getConnectionEffectiveType,getConnectionTypeID:a.getConnectionTypeID,getConnectionEffectiveTypeID:a.getConnectionEffectiveTypeID}},826981:(e,t,s)=>{"use strict";function a(e){const t="string"==typeof e?e.match(/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/):null;return t?(3600*t[1]||0)+(60*t[2]||0)+(+t[3]||0):0}function n(e){let t="";return e>=3600&&(t+=Math.floor(e/3600)+"h",e%=3600),e>=60&&(t+=Math.floor(e/60)+"m",e%=60),e>0&&(t+=Math.floor(e)+"s"),t}s.d(t,{fromString:()=>a,toString:()=>n})},628459:(e,t,s)=>{"use strict";s.d(t,{DEFAULT_MEDIA_SESSION:()=>d,HAS_MEDIA_SESSION:()=>r,clear:()=>_,updateMediaSessionMetadata:()=>l});var a=s(899841);let n;const r=window&&window.navigator&&"mediaSession"in window.navigator&&"MediaMetadata"in window,d=r?navigator.mediaSession:null;async function _(){if(r){n=n||document.createElement("audio"),n.src=a.SILENCE;try{await n.play()}catch(e){}}}function l(e,t=d){if(!t||!r)return;(location.hostname+e.album).length>30&&(e.album=e.album.substring(0,30-location.hostname.length)+"…");const s=t.metadata;s?(s.title=e.title,s.artist=e.artist,s.album=e.album,s.artwork=e.artwork):t.metadata=new MediaMetadata(e)}},636111:(e,t,s)=>{"use strict";s.d(t,{isAdvertBlocked:()=>n});var a=function(){function e(e,t){var s=document.createElement("div"),a=function(e,t){for(var s,a,n=e.length,r=0;r<t;r++)a=Math.floor(Math.random()*n),s=e[r],e[r]=e[a],e[a]=s;return e.slice(0,t)}(String.fromCharCode(97,100,118,98,108,111,99,107,32,97,100,118,101,114,116,98,108,111,99,107,32,97,100,118,101,114,116,66,108,111,99,107,32,98,45,114,98,32,98,97,110,110,101,114,95,50,52,48,32,112,45,116,97,114,103,101,116,32,112,117,98,95,51,48,48,120,50,53,48,32,112,117,98,95,51,48,48,120,50,53,48,109,32,112,117,98,95,55,50,56,120,57,48,32,114,98,95,98,111,100,121,32,114,98,45,102,108,111,97,116,105,110,103,32,114,98,45,115,108,111,116,32,114,98,45,118,105,100,101,111,45,119,105,100,103,101,116,32,116,101,120,116,45,97,100,32,116,101,120,116,45,97,100,45,108,105,110,107,115,32,116,101,120,116,45,97,100,115,32,116,101,120,116,45,98,97,110,110,101,114,32,116,101,120,116,95,97,100,32,116,101,120,116,95,97,100,115,32,116,101,120,116,65,100,32,116,101,120,116,97,100,32,116,101,120,116,65,100,115,32,116,101,120,116,97,100,115,32,116,103,98,45,98,97,110,110,101,114,32,116,114,103,45,98,45,98,97,110,110,101,114,45,98,108,111,99,107).split(" "),7);s.setAttribute("class",a.join(" ")),s.setAttribute("style","position: absolute !important; top: -9999px !important; left: -9999px !important; width: 1px !important; height: 1px !important;"),s.setAttribute("id","trg-b-banners-1"),s.setAttribute("data-view","SlotView.mimic"),this.bait=document.body.appendChild(s),this.bait.offsetParent,this.bait.offsetHeight,this.bait.offsetLeft,this.bait.offsetTop,this.bait.offsetWidth,this.bait.clientHeight,this.bait.clientWidth,this.loopNumber=0,this.fnPositive=e||null,this.fnNegative=t||null;var n=this;setTimeout((function(){n._checkBait.call(n)}),1)}return e.prototype._checkBait=function(){var e=null!==document.body.getAttribute("abp")||!function(e,t){if(null===e.offsetParent||0==e.offsetHeight||0==e.offsetWidth||0==e.clientHeight||0==e.clientWidth)return!1;if(t&&(0==e.offsetLeft||0==e.offsetTop))return!1;if(void 0!==window.getComputedStyle){var s=window.getComputedStyle(e,null);return"none"!==s.display&&"hidden"!==s.visibility}return!0}(this.bait,!0);if((!0===e||++this.loopNumber>=10)&&this._stop(),e&&this.fnPositive)try{(0,this.fnPositive)()}catch(e){}else if(!e&&this.loopNumber<10){var t=this;setTimeout((function(){t._checkBait.call(t)}),50*this.loopNumber)}else try{(0,this.fnNegative)()}catch(e){}},e.prototype._stop=function(){try{document.body.removeChild(this.bait)}catch(e){}},function(t,s){new e(t,s)}}();function n(){return new Promise(((e,t)=>a(t,e))).then((()=>!1)).catch((()=>!0))}},150681:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var a=s(593159),n=s(672277),r=s(754866),d=s(972332);const _="idle",l="pend_rows",u="pend_prefetch",c="done_prefetch",p="done";class m{getListEl(){return this._containerEl}setListEl(e,t){let s;this._containerEl=(0,r.ge)(e),this._scrollNode=t||m.closestOverflowParent(this._containerEl),s=this._scrollNode===window?0:(0,r.getXY)(this._scrollNode)[1],this._contentYOffset=(0,r.getXY)(this._containerEl)[1]-s}options(e){(0,a.extend)(this._opts,e)}_countRows(e){const t=this;let s=0;return(0,a.each)(e,(function(e,n){"string"==typeof n&&(n=(0,r.se)(n)),t._rowClasses?(0,a.each)(t._rowClasses,(function(e,t){if((0,r.hasClass)(n,t))return s++,!1})):s++})),s}_drawRows(e){const t=this;this._opts.drawRows?this._opts.drawRows(t._containerEl,e):(0,a.each)(e,(function(e,s){"string"==typeof s&&(s=(0,r.se)((0,a.trim)(s))),s&&t._containerEl.appendChild(s)})),this.toggleProgress(this._state!==p),!this._forceDrawCalled&&this._opts.onRendered&&this._opts.onRendered(this._offset)}toggleProgress(e){e?!this._isProgressShown&&this._opts.showProgress&&this._opts.showProgress():this._isProgressShown&&this._opts.hideProgress&&this._opts.hideProgress(),this._isProgressShown=e}drawMore(){(0,a.inArray)(this._state,[_,c])?(this._forceDrawCalled=!0,this._drawRows(this._prefetched),this._setState(u),this._prefetched=[],this._requestRows(),this._forceDrawCalled=!1):this._state===p&&this._opts.onNoMore&&this._opts.onNoMore(this._containerEl.childElementCount)}destroy(){this._ev_scroll&&((0,d.removeEvent)(this._scrollNode,"scroll",this._ev_scroll),this._ev_scroll=!1),this._ev_window_resize&&(0,d.removeEvent)(window,"resize",this._ev_window_resize),this._setState(p),this.toggleProgress(!1)}getOffset(){return this._offset}_requestRows(){if(!this.isDone()&&this._state!==c){function e(){this._opts.onNeedRows(this._onRowsProvided.bind(this),this._offset,this._page++,this._state===u,this)}this._initialRender=!1,e.apply(this)}}_onRowsProvided(e,t){if(this.isDone())return;if(!1===e)return this._requestRows();e=e||[];let s=!1;this._needUseExternalOffset?(this._offset=t??0,s=Boolean(t)):(this._offset+=void 0===t?this._countRows(e):t,s=Boolean(e.length));const a=this._containerEl.childElementCount;switch(this._state){case u:0!==e.length&&(this._prefetched=this._prefetched.concat(e)),s?(this._setState(_),this._opts.onHasMore&&this._opts.onHasMore()):(this._setState(c),this._opts.onNoMore&&this._opts.onNoMore(a),0===this._prefetched.length&&this._setState(p)),(s||0!==this._prefetched.length)&&this._onScroll();break;case l:this._drawRows(e),s?(this._setState(u),this._requestRows()):(this._setState(p),this._opts.onNoMore&&this._opts.onNoMore(a)),this.toggleProgress(!1);break;case _:this._prefetched=this._prefetched.concat(e)}}_setState(e){this._state=e}isDone(){return this._state===p}static closestOverflowParent(e){let t,s=e;for(;s&&s.tagName&&(t=(0,r.getStyle)(s,"overflow"),"visible"===t||"page_wrap"===s.id);)s=(0,r.domPN)(s);return s!==window.document&&s!==document.body&&s||(s=window),s}_onScroll(){if(this._forceDrawCalled)return;if(this._state===l)return;const e=this._scrollNode;let t,s,a;e===window?(a=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=(0,n.scrollGetY)()):(a=(0,r.getSize)(e)[1],t=this._scroll?this._scroll.data.scrollTop:e.scrollTop),a<10||(s=this._containerEl.scrollHeight,s-a-t+this._contentYOffset<10&&(this._state===l||!this._prefetched.length&&this._state===u?(this.toggleProgress(!0),this._setState(l)):this._state===u||this._state===_?(this._drawRows(this._prefetched),this._prefetched=[],this._setState(u),this._requestRows()):this._state===c&&(this._drawRows(this._prefetched),this._prefetched=[],this._setState(p),this._opts.onNoMore&&this._opts.onNoMore(),this.destroy())))}constructor(e,t){if(this.constructor!==m)throw new Error("AutoList: AutoList was called without 'new' operator");if(m._counter=m._counter||0,this._id=m._counter++,this.setListEl(e,t.scrollNode),this._opts=(0,a.extend)({threshold:0,renderImmediate:!1,fetchImmediate:!0},t),!this._containerEl)throw new Error("AutoList: container not found");this._rowClasses=!!this._opts.rowClass&&this._opts.rowClass.split(" "),delete this._opts.rowClass,this._initialRender=this._opts.renderImmediate,this._needUseExternalOffset=this._opts.needUseExternalOffset??!1,this._isProgressShown=!1,this._prefetched=[],this._needUseExternalOffset?this._offset=this._opts.offset??0:this._initialRender?this._offset=0:this._opts.offset?this._offset=this._opts.offset:this._opts.rowClasses?this._offset=this._countRows(this._containerEl.children):this._offset=this._containerEl.children.length,this._page=this._offset>0?1:0,(0,d.addEvent)(this._scrollNode,"scroll",this._ev_scroll=this._onScroll.bind(this)),(0,d.addEvent)(window,"resize",this._ev_window_resize=this._onScroll.bind(this)),this._setState(this._opts.renderImmediate?l:u),this._opts.fetchImmediate?this._requestRows():(this._setState(_),this._onScroll())}}},131455:(e,t,s)=>{"use strict";s.d(t,{initSw:()=>d,onSwReady:()=>n});const a=(0,s(558137).makeSharedState)("sw-loading-state",(()=>({isReady:!1,onReadyCallbacks:[]})),{version:1}),n=e=>{a().isReady?e():a().onReadyCallbacks.push(e)},r=()=>{a().isReady=!0;for(let e of a().onReadyCallbacks)e();a().onReadyCallbacks=[]};async function d(){if(!window.vk.disableSW)try{const[{SWClient:e},{default:t}]=await Promise.all([Promise.all([s.e(8716),s.e("langs/web/webSwClient")]).then(s.bind(s,510486)),Promise.all([s.e(41837),s.e("langs/web/webPushNotifier")]).then(s.bind(s,419970))]);window.sw=new e,await window.sw.register(),window.pushNotifier=new t(window.sw,e),window.sw.storePushHash(),r()}catch(e){console.log(e)}}},146175:(e,t,s)=>{"use strict";s.d(t,{PIN_HIDDEN_ID_OP:()=>l,RECENT_SEARCH_OP:()=>_,imDbGet:()=>c,mount:()=>y});var a=s(740342),n=s(898848),r=s(636576),d=s(593159);const _="recent_search",l="pin_hide";function u(e){return"im_store_"+e}function c(e){return ls.get(u(e))||{}}function p(e,t,s){if(ls.checkVersion()){const a=JSON.stringify(t);(0,n.rand)(0,1e5)<=1&&(0,r.statlogsValueEvent)("im_local_store_size",a.length),s(u(e),a)}}function m(e,t,s){s.key===u(e)&&(t.db=JSON.parse(s.newValue),t.checkTime=Date.now())}function y(e){const t=(0,a.debounce)(((e,t)=>{localStorage.setItem(e,t)}),300);ls.checkVersion()&&function(e,t){const s=["fwd","draft","bind_attach"],a=c(e);let n=!1;for(let e=s.length;e--;)s[e]in a&&(delete a[s[e]],n=!0);n&&p(e,a,t)}(e,t);const s={db:c(e),checkTime:Date.now()},n=m.bind(null,e,s);return window.addEventListener("storage",n,!1),{select:(t,a)=>(Date.now()-s.checkTime>1e3&&(s.db=c(e)),function(e,t,s){return t===_?e[t]||[]:t===l?e[t]&&e[t][s]:e[t]?(0,d.extend)(!0,{},e[t][s]):null}(s.db,t,a)),selectByKey:t=>(Date.now()-s.checkTime>1e3&&(s.db=c(e)),s.db[t]),update(a,n){const r=function(e,t,s){switch(e[t]||(e[t]={}),t){case _:const a=s;a&&a.length>0?e[t]=a:delete e[t];break;case l:const[n,r]=s;r?e[t][n]=+r:delete e[t][n]}return e}(s.db,a,n);return s.db=r,s.checkTime=Date.now(),p(e,r,t)},updateByKey:(a,n)=>(s.db[a]=n,s.checkTime=Date.now(),p(e,s.db,t)),unmount(){window.removeEventListener("storage",n,!1)}}}},196829:(e,t,s)=>{"use strict";s.d(t,{Gifts:()=>f});var a=s(683234),n=s(866467),r=s(270959),d=s(972332),_=s(593159),l=s(246429),u=s(754866),c=s(584427),p=s(664822),m=s(801746),y=s(985737),g=s(120101);const f={deleteGift:function(e,t,s,a={}){window.ajax.post("al_gifts.php",{act:"delete",mid:a.mid,gift:s,hash:a.hash},{onDone:function(e){const s=(0,u.ge)("gift"+t);s&&((0,u.domNS)((0,u.domFC)(s))?(0,u.domNS)((0,u.domFC)(s)).innerHTML=e:(s.appendChild((0,u.ce)("div",{className:"gift_deleted",innerHTML:e})),(0,u.hide)((0,u.domFC)(s)),window.Pagination&&!(0,l.curBox)()&&window.Pagination.recache(-1)),(0,g.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module&&window.Profile?.updateGiftBlock())},showProgress:()=>{e.classList.add("gift_delete--loading"),e.innerHTML="",e.appendChild((0,u.ce)("div",{className:"gift_delete__spinner",innerHTML:(0,m.getIcon16Spinner)().icon}))},hideProgress:()=>{e.classList.remove("gift_delete--loading"),e.innerHTML=(0,y.getIcon16Cancel)().icon}})},restoreGift:function(e,t,s,a){a=a||{},ajax.post("al_gifts.php",{act:"restore",mid:a.mid,gift:s,hash:a.hash},{onDone:function(){const e=(0,u.ge)("gift"+t);e&&(0,u.domNS)((0,u.domFC)(e))&&((0,u.re)((0,u.domNS)((0,u.domFC)(e))),(0,u.show)((0,u.domFC)(e)),(0,g.isVKCOMProfileRedesignedEnabled)()&&"profile"===window.cur.module&&window.Profile?.updateGiftBlock())}})},markSpamGift:function(e,t,s,a){a=a||{},ajax.post("al_gifts.php",{act:"mark_spam",mid:a.mid,gift:s,hash:a.hash},{onDone:function(e){(0,u.ge)("gift_mark_spam"+t).innerHTML=e}})},initGiftsBox:function(e,t){e.setOptions({width:638,bodyStyle:"padding: 0",grey:!0,hideButtons:!0,onShow:function(){cur.gftbxWasScroll&&(boxLayerWrap.scrollTop=cur.gftbxWasScroll,cur.gftbxWasScroll=!1)}}),t.lang&&(cur.lang=(0,_.extend)(cur.lang||{},t.lang)),(0,_.extend)(cur,{gftbxOffset:t.offset,gftbxAutoload:!0,gftbxWasScroll:!1,gftbxMid:t.mid}),ajax.preload("al_gifts.php",{act:"box",mid:t.mid,offset:t.offset},t.preload),window.uiScrollBox&&window.uiScrollBox.init(e,{onShow:function(){(0,d.addEvent)(boxLayerWrap,"scroll",f.onGiftsScroll),setTimeout(cur.chooseAudioScroll,0)},onHide:function(){(0,d.removeEvent)(boxLayerWrap,"scroll",f.onGiftsScroll)}}),(0,d.addEvent)(boxLayerWrap,"scroll",f.onGiftsScroll);const s=boxLayerWrap.scrollTop;(0,u.elfocus)((0,u.geByClass1)("_scroll_node",e.bodyNode)),boxLayerWrap.scrollTop=s,onBodyResize(),f.onGiftsScroll()},moreGifts:function(){const e=(0,u.ge)("gifts_more_link");(0,a.buttonLocked)(e)||(ajax.post("al_gifts.php",{act:"box",mid:cur.gftbxMid,offset:cur.gftbxOffset},{onDone:function(t,s,a){const n=(0,u.ce)("div",{innerHTML:t}),r=(0,u.ge)("gifts_rows");if(r){for(let e=(0,u.domFC)(n);e;e=(0,u.domFC)(n))r.appendChild(e);cur.gftbxOffset=s,a?f.preloadGifts():(0,u.hide)(e)}},showProgress:a.lockButton.pbind(e),hideProgress:a.unlockButton.pbind(e),cache:1}),cur.gftbxAutoload=!0)},preloadGifts:function(){ajax.post("al_gifts.php",{act:"box",mid:cur.gftbxMid,offset:cur.gftbxOffset},{cache:1})},onGiftsScroll:function(){if(!cur.gftbxAutoload)return;const e=lastWindowHeight,t=(0,u.ge)("gifts_more_link");(0,u.isVisible)(t)&&e>(0,u.getXY)(t,!0)[1]&&t.click()},showGiftBox:function(e,t,s){return window.Profile?window.Profile.showGiftBox(e,t,s):(cur.gftbxWasScroll=boxLayerWrap.scrollTop,boxLayerWrap.scrollTop=0,cur.viewAsBox?cur.viewAsBox():!(0,r.showBox)("al_gifts.php",{act:"get_gift_box",mid:e,fr:e==vk.id?1:0,ref:s},{stat:["gifts.css",window.jsc("web/wide_dd.js"),"wide_dd.css"],cache:1},t))},processBoxOptions(e,t){-1e3!=t&&t&&(requestAnimationFrame((()=>{(0,l.hideBoxLoader)()})),(0,_.extend)(cur,{paymentsOfferPreview:t.paymentsOfferPreview,paymentsPreload:t.paymentsPreload,paymentsAppOrder:t.paymentsAppOrder,paymentsOfferPreload:t.paymentsOfferPreload}),t.orderData&&p.AppOrderBox.initialize(t.orderData.orderId,t.orderData.appId,t.orderData.testMode,t.orderData.hash,t.orderData.votes,t.orderData.discount,t.orderData.billPeriod),(0,_.extend)(cur,{paymentsAuthPayment:t.paymentsAuthPayment,paymentsOrderNotice:t.paymentsOrderNotice,paymentsTryCompleteOrder:t.paymentsTryCompleteOrder,isPaymentsAppOrder:t.isPaymentsAppOrder,paymentsOfferApp:t.paymentsOfferApp,checkoutEnabled:t.checkoutEnabled}),t.showProgress&&c.PaymentsBox.showProgress(""),(0,_.extend)(cur,{votesAmountsData:t.votesAmountsData,paymentsPreferVotes:t.paymentsPreferVotes,votesTypeInit:t.votesTypeInit,psList:t.psList,paymentsWideBox:t.paymentsWideBox,paymentsTooltips:t.paymentsTooltips,paymentsChangeType:0===t.paymentsWideBox?(0,n.getLang)("payments_go_change_pay_type"):"",payments_get_votes:(0,n.getLang)("payments_get_votes_new"),getVotesDoneHide:!0,paymentsWaitingCache:{},isPaymentComplete:!1,isPaymentAttemted:!1,usdRate:t.usdRate,paymentsHash:t.paymentsHash,paymentComplete:c.PaymentsBox.complete,paymentCanceled:c.PaymentsBox.paymentCanceled,paymentsShowProgress:c.PaymentsBox.showProgress,statSessionId:t.statSessionId}),c.PaymentsBox.initialize(e),cur.checkoutEnabled||(c.PaymentsBox.initPhoneCountry(t.countries,t.country),c.PaymentsBox.initPhoneNumber((0,u.ge)("phone"))),(0,_.extend)(cur,{paymentsTypesSum:t.paymentsTypesSum,instantNeedCVV:t.instantNeedCVV,votesType:t.votesType,paymentsWPreload:t.paymentsWPreload,isMidas:t.isMidas,isHideButtonBackAndText:t.isHideButtonBackAndText}),t.getVotesAmountsOnDone&&c.PaymentsBox.getVotesAmountsOnDone.apply(this,cur.paymentsWPreload))},showGetMoneyBox(e=null){return(0,r.showBox)("al_gifts.php",{act:"get_money",...e},{onDone:this.processBoxOptions})}}},471984:(e,t,s)=>{"use strict";s.d(t,{clipboardProcessPaste:()=>p,copyToClipboard:()=>_._copyWithFakeElement,getFiles:()=>l});var a=s(967495),n=s(593159),r=s(972332),d=s(754866),_=s(695847);function l(e){let t=function(e){return e&&e.clipboardData?e.clipboardData:e&&e.originalEvent&&e.originalEvent.clipboardData?e.originalEvent.clipboardData:window.clipboardData}(e);if(!t)return[];let s=t.items;if(!s)return[];let a=[];for(let e=0;e<s.length;e++)0==s[e].type.indexOf("image")&&a.push(s[e].getAsFile());return a}let u=!1,c=null;function p(e){return new Promise(((t,s)=>{if(u)return(0,r.cancelEvent)(e),s();let[_,l,p,m,y]=(0,a.rangeGet)();if(_){if("paste"===e.type){let s=e.clipboardData||e.originalEvent&&e.originalEvent.clipboardData;if(s&&s.types&&s.getData){(0,r.cancelEvent)(e),u=!0;let d=s.getData("text/html")||(0,n.clean)(s.getData("text/plain"))||"";return t([d,e=>{(0,a.rangeInsert)(_,e),u=!1}])}let c=(0,d.cf)(),g=e.target||window.event.srcElement;for(;g.firstChild;)c.appendChild(g.firstChild);return new Promise((e=>setTimeout((()=>{let t=g.innerHTML||"";g.innerHTML="",g.appendChild(c),e([t,e=>{_=(0,a.rangeCreate)(l,p,m,y),(0,a.rangeInsert)(_,e),u=!1}])}),0)))}if("beforepaste"===e.type)return u=!0,function(){if(!c){let e=(0,d.ge)("utils");c=(0,d.ce)("div",{},{width:"10px",height:"10px",overflow:"hidden"}),(0,d.attr)(c,"contenteditable","true"),e.appendChild(c)}}(),c.focus(),void(c.onpaste=()=>{setTimeout((()=>{let e=c.innerHTML||"";c.innerHTML="",delete c.onpaste,t([e,e=>{_=(0,a.rangeCreate)(l,p,m,y),(0,a.rangeInsert)(_,e),u=!1}])}),0)})}return s()}))}},250598:(e,t,s)=>{"use strict";s.r(t),s.d(t,{ElementTooltip:()=>c,default:()=>p});var a=s(754866),n=s(593159),r=s(972332),d=s(672277),_=s(137771),l=s(153659),u=s(317216);class c{_initEvents(e){this._opts.autoShow&&(this._el_me_event=this._onMouseEnter.bind(this),(0,r.addEvent)(e,"mouseenter",this._el_me_event),this._opts.showOnKeyboard&&(this._el_kd_event=t=>{t.target!==e||t.keyCode!==r.KEY.ENTER&&t.keyCode!==r.KEY.SPACE||this.toggle()}),(0,r.addEvent)(e,"keydown",this._el_kd_event)),(this._opts.autoShow||this._opts.autoHide)&&(this._el_ml_event=this._onMouseLeave.bind(this),(0,r.addEvent)(e,"mouseleave",this._el_ml_event)),this._opts.autoShow||this._opts.customShow||(this._el_c_event=()=>{this._isShown&&this._opts.noHideOnClick||this.toggle(!this._isShown)},(0,r.addEvent)(e,"click",this._el_c_event))}_onMouseEnter(e){clearTimeout(this._hto),this._hto=!1,!this._isShown&&this._opts.autoShow&&(clearTimeout(this._reTimeout),this._reTimeout=!1,clearTimeout(this._sto),this._sto=setTimeout(this.show.bind(this),this._opts.delay))}_onMouseLeave(e){this._clearTimeouts(),this._hto=setTimeout(this._hide.bind(this),200)}_onMouseWindowClick(e){if(this._opts.noAutoHideOnWindowClick)return;let t=e.target;for(;t&&t!==this._ttel&&t!==document.body&&t!==this._el;)t=(0,a.domPN)(t);return(0,a.hasClass)(e.target,"_ap_layer__close")||t&&t!==document.body?void 0:(0,n.isFunction)(this._opts.onWindowClick)?(this._opts.onWindowClick(),(0,r.cancelEvent)(e)):(this.hide(!0),(0,r.cancelEvent)(e))}destroy(){let e;this._el_me_event&&(0,r.removeEvent)(this._el,"mouseenter",this._el_me_event),this._el_ml_event&&(0,r.removeEvent)(this._el,"mouseleave",this._el_ml_event),this._el_c_event&&(0,r.removeEvent)(this._el,"click",this._el_c_event),this._el_kd_event&&(0,r.removeEvent)(this._el,"keydown",this._el_kd_event),this._clearTimeouts(),(0,a.removeData)(this._el,"ett"),(0,a.re)(this._ttel),this._ev_wclick&&(0,r.removeEvent)(document,"mousedown",this._ev_wclick),this._ttel&&(e=(0,a.geByClass1)("_eltt_content",this._ttel)),this._opts.onDestroy&&this._opts.onDestroy(e)}hide(e,t){this._hide(e,t)}_onTooltipMouseEnter(e){this._clearTimeouts()}_onTooltipMouseLeave(e){this._onMouseLeave()}build(){if(!this._ttel){const e=this._opts.withCloseButton?"eltt_with_close_button":"";this._ttel=(0,a.se)(`\n        <div class="eltt ${this._opts.cls||""} ${e}" id="${this._opts.id}">\n          <div class="eltt_arrow_back _eltt_arrow_back">\n            <div class="eltt_arrow"></div>\n          </div>\n          <div class="eltt_content _eltt_content"></div>\n        </div>`),this._ttArrowEl=(0,a.geByClass1)("_eltt_arrow_back",this._ttel);const t=(0,a.geByClass1)("_eltt_content",this._ttel);if(this._opts.content&&((0,n.isString)(this._opts.content)?t.innerHTML=this._opts.content:t.appendChild(this._opts.content)),this._opts.withCloseButton){const e='\n          <div class="eltt_close_button"></div>\n        ';this._ttel.insertAdjacentHTML("beforeend",e),this._closeButton=this._ttel.lastElementChild;const t=e=>{e.stopPropagation(),this.hide(null,!0),this._opts.onCloseButtonClick&&this._opts.onCloseButtonClick()};this._closeButton.addEventListener("click",t),cur.destroy.push((()=>this._closeButton.removeEventListener("click",t)))}this._appendToEl&&this._appendToEl.appendChild(this._ttel),this._opts.onClick&&(this._ttel.addEventListener("click",this._opts.onClick),window.cur.destroy.push((()=>this._ttel.removeEventListener("click",this._opts.onClick))))}}show(){if(this._isShown)return void this.updatePosition();if(this._tooltipStats.handleShow(),this._opts.skipShow)return;if(this._clearTimeouts(),this._ttel||(this.build(),(this._opts.autoShow||this._opts.autoHide)&&(this._ev_ttenter=this._onTooltipMouseEnter.bind(this),this._ev_ttleave=this._onTooltipMouseLeave.bind(this),(0,r.addEvent)(this._ttel,"mouseenter",this._ev_ttenter),(0,r.addEvent)(this._ttel,"mouseleave",this._ev_ttleave))),this._opts.width){const e=(0,n.isFunction)(this._opts.width)?this._opts.width.call(this):this._opts.width;(0,a.setStyle)(this._ttel,"width",e)}(0,a.show)(this._ttel);const e=(0,a.geByClass1)("_eltt_content",this._ttel);this._opts.onFirstTimeShow&&!this._firstTimeShown&&this._opts.onFirstTimeShow.call(this,e,this._ttel),this._opts.onShow&&this._opts.onShow(e,!this._firstTimeShown),this._firstTimeShown=!0,this.updatePosition(),this._isShown=!0,this._el.setAttribute("aria-expanded","true"),this._visTO=setTimeout(a.addClass.pbind(this._ttel,"eltt_vis"),10),this._opts.elClassWhenShown&&(0,a.addClass)(this._el,this._opts.elClassWhenShown),this._ev_wclick&&(0,r.removeEvent)(document,"mousedown",this._ev_wclick),this._ev_wclick=this._onMouseWindowClick.bind(this),(0,r.addEvent)(document,"mousedown",this._ev_wclick)}static getType(e){switch(e){case"top":case"bottom":return c.TYPE_VERTICAL;case"right":case"left":return c.TYPE_HORIZONTAL}}getOptions(){return this._opts}updatePosition(){let e=this._opts.forceSide,t=!!this._opts.getTargetBoundingBox&&this._opts.getTargetBoundingBox(this);if(!t){const e=(0,a.getXY)(this._el),s=(0,a.getSize)(this._el);t={left:e[0],top:e[1],width:s[0],height:s[1]}}const s=this._opts.getWrapEl?this._opts.getWrapEl(this):(0,a.gpeByClass)("audio_layer_container",this._ttel),r=s||(0,a.domClosestOverflowHidden)(this._ttel),l=r!==document.body?(0,a.getXY)(r):[(0,d.scrollGetX)(),(0,d.scrollGetY)()+(0,_.getPageHeaderHeight)()],u=r!==document.body?(0,a.getSize)(r):[window.innerWidth,window.innerHeight],p=(0,a.getSize)(this._ttel),m=this._arrowSize,y=this._opts.noBorder?0:1,g=(0,n.isFunction)(this._opts.offset)?this._opts.offset():this._opts.offset;let f;const E=(e,s)=>{const n={},r=[vk.rtl?"marginRight":"marginLeft","marginTop"].indexOf(e);let d;d=this._opts.align===(vk.rtl?c.ALIGN_LEFT:c.ALIGN_RIGHT)?p[r]-Math.max(y+m+(s||0),Math.min(p[r],t[r?"height":"width"])/2):this._opts.align===(vk.rtl?c.ALIGN_RIGHT:c.ALIGN_LEFT)?Math.max(y+m+(s||0),Math.min(p[r],t[r?"height":"width"])/2):p[r]/2,n[e]=Math.floor(d)-y-m-(s||0),this._opts.onSetArrowPosition(n),(0,a.setStyle)(this._ttArrowEl,n)};if(this._opts.setPos)f=this._opts.setPos(this)||{},c.getType(e)===c.TYPE_VERTICAL?void 0!==f.arrowPosition?(0,a.setStyle)(this._ttArrowEl,{marginLeft:f.arrowPosition}):vk.rtl?E("marginRight"):E("marginLeft"):void 0!==f.arrowPosition?(0,a.setStyle)(this._ttArrowEl,{marginTop:f.arrowPosition}):E("marginTop");else{if(!e&&this._prevSide&&this._opts.preventSideChange)e=this._prevSide;else if(!e)if(this._opts.type===c.TYPE_VERTICAL){const s=document.body.classList.contains("body_im")?this._opts.bottomGap||60:this._opts.bottomGap||0,a=t.top-l[1]>p[1]+m-g[1],n=(0,d.scrollGetY)()+u[1]-(t.top+t.height+m)-s>p[1];e="top"===this._opts.defaultSide?a?"top":"bottom":n?"bottom":"top"}else e=t.left-l[0]<p[0]?"right":"left";let s,n,r,_,y,f,A=(0,a.getXY)(this._appendToEl),P=[t.left-A[0],t.top-A[1]],b=g[0]+P[0];this._opts.centerShift?(b+=this._opts.centerShift||0,s=this._opts.centerShift):this._opts.rightShift&&(s=-(p[0]/2-this._opts.rightShift),b+=s),this._prevSide=e;let I=20;const T=!this._opts.autoAdjustToViewport;switch(this._opts.align===(vk.rtl?c.ALIGN_LEFT:c.ALIGN_RIGHT)?(n=t.width-p[0],r=t.height-p[1]):this._opts.align===(vk.rtl?c.ALIGN_RIGHT:c.ALIGN_LEFT)?(n=0,r=0):(n=-p[0]/2+t.width/2,r=t.height/2-p[1]/2),e){case"bottom":y=n+b,f=t.height+m-g[1]+P[1],s||T||(_=n+t.left+g[0]+p[0]+I-(l[0]+u[0]),_<0&&(_=0),y-=_,s=-_),(0,a.setStyle)(this._ttel,{left:y,top:f});break;case"top":y=n+b,s||T||(_=n+t.left+g[0]+p[0]+I-(l[0]+u[0]),_<0&&(_=0),y-=_,s=-_),(0,a.setStyle)(this._ttel,{left:y}),f=-(0,a.getSize)(this._ttel)[1]-m+g[1]+P[1],(0,a.setStyle)(this._ttel,{top:f});break;case"right":y=t.width+m+b,f=r+g[1]+P[1],s||T||(_=r+t.top+g[1]-(l[1]+I),_>0&&(_=0),f-=_,s=-_),(0,a.setStyle)(this._ttel,{left:y,top:f});break;case"left":y=-p[0]-m+b,f=r+g[1]+P[1],s||T||(_=r+t.top+g[1]-(l[1]+I),_>0&&(_=0),f-=_,s=-_),(0,a.setStyle)(this._ttel,{left:y,top:f})}this._opts.type===c.TYPE_VERTICAL?vk.rtl?E("marginRight",s):E("marginLeft",s):E("marginTop",s)}(0,n.each)(["top","bottom","left","right"],function(t,s){e!==s&&(0,a.removeClass)(this._ttel,"eltt_"+s)}.bind(this)),(0,a.addClass)(this._ttel,"eltt_"+e),(0,a.setStyle)(this._ttel,f)}_hide(e,t){if(this.tempPreventHide)return;let s;if(e&&(s=u.ETooltipEventTypes.TOOLTIP_HIDE_BY_CLICK),t&&(s=u.ETooltipEventTypes.TOOLTIP_HIDE_BY_CROSS),this._tooltipStats.handleHide(s),this._isShown=!1,this._clearTimeouts(),this._reTimeout=setTimeout(function(){(0,a.hide)(this._ttel),this._el.setAttribute("aria-expanded","false"),this._opts.elClassWhenShown&&(0,a.removeClass)(this._el,this._opts.elClassWhenShown),this._opts.onHide&&this._opts.onHide(this._ttel,!!e,!!t)}.bind(this),c.FADE_SPEED),this._opts.onBeforeHide)try{this._opts.onBeforeHide(this._ttel,!!e,!!t)}catch(e){}(0,a.removeClass)(this._ttel,"eltt_vis"),this._ev_wclick&&(0,r.removeEvent)(document,"mousedown",this._ev_wclick)}isShown(){return this._isShown}toggle(){this.isShown()?this.hide():this.show()}_clearTimeouts(){this._visTO&&clearTimeout(this._visTO),this._visTO=!1,this._sto&&clearTimeout(this._sto),this._sto=!1,this._hto&&clearTimeout(this._hto),this._hto=!1,this._reTimeout&&clearTimeout(this._reTimeout),this._reTimeout=!1}getContent(){return(0,a.geByClass1)("_eltt_content",this._ttel)}constructor(e,t){if(this.constructor!==c)throw new Error("ElementTooltip was called without 'new' operator");if(!(e=(0,a.ge)(e))||!e.nodeType)throw new Error("First argument not a DOM element");if((0,a.data)(e,"ett"))return(0,a.data)(e,"ett");if(this._tooltipStats=new l.TooltipsStat(t.helpHintId||"unknown",t.skipShow||!1),this._opts=(0,n.extend)({delay:100,offset:[0,0],type:c.TYPE_VERTICAL,id:"",cls:"",width:null,appendToParent:!1,autoAdjustToViewport:!0,autoShow:!0,autoHide:!1,noHideOnClick:!1,arrowSize:"normal",customShow:!1,align:c.ALIGN_CENTER,withCloseButton:!1,skipShow:!1,onSetArrowPosition:()=>{}},t),this._opts.customShow&&(this._opts.autoShow=!1),this._opts.defaultSide||(this._opts.defaultSide=this._opts.type===c.TYPE_VERTICAL?"top":"left"),this._opts.cls+=" eltt_arrow_size_"+this._opts.arrowSize,this._opts.cls+=" eltt_align_"+this._opts.align,this._opts.noBorder&&(this._opts.cls+=" eltt_noborder"),this._opts.setPos&&!this._opts.forceSide)throw new Error("forceSide parameter should be set if you use setPos");if(this._appendToEl=this._opts.appendTo?this._opts.appendTo:this._opts.appendToParent?(0,a.domClosestPositioned)(e,{noOverflow:!0}):e,this._arrowSize={mini:c.ARROW_SIZE_MINI,normal:c.ARROW_SIZE_NORMAL,big:c.ARROW_SIZE_BIG}[this._opts.arrowSize],this._opts.forceSide){const e=c.getType(this._opts.forceSide);if(void 0===e)throw new Error("ElementTooltip: invalid 'forceSide' option provided: ",this._opts.forceSide);0,this._opts.type=e}this._opts.type===c.TYPE_HORIZONTAL&&void 0===t?.autoAdjustToViewport&&(this._opts.autoAdjustToViewport=!1),this._el=e,(0,a.data)(this._el,"ett",this),this._initEvents(e),this._clearTimeouts(),this._isShown=!1,this._el.setAttribute("aria-expanded","false")}}c.TYPE_VERTICAL=0,c.TYPE_HORIZONTAL=1,c.FADE_SPEED=100,c.ARROW_SIZE_MINI=9,c.ARROW_SIZE_NORMAL=8,c.ARROW_SIZE_BIG=16,c.ALIGN_LEFT="left",c.ALIGN_CENTER="center",c.ALIGN_RIGHT="right";const p=c},193694:(e,t,s)=>{"use strict";s.d(t,{initFavIcon:()=>r,setFavIcon:()=>n});var a=s(754866);function n(e,t){if(!window.icoNode)return;if(e=e+"?"+((stVersions||{}).favicon||""),icoNode.getAttribute("href")===e&&!t)return;const s=(0,a.ce)("link",{rel:"shortcut icon",type:"image/gif",href:e});headNode.replaceChild(s,icoNode),icoNode=s}function r(){window._iconAdd=window.devicePixelRatio>=2?"_2x":""}},788789:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{giftsBox:()=>giftsBox,imageStatusPopup:()=>imageStatusPopup,mobilePromo:()=>mobilePromo,moneyTransferBox:()=>_moneyTransferBox__WEBPACK_IMPORTED_MODULE_11__.moneyTransferBox,reportAd:()=>reportAd,showAudioClaimWarning:()=>showAudioClaimWarning,showPollBox:()=>showPollBox,showSettingsAddressBox:()=>showSettingsAddressBox,showWriteMessageBox:()=>showWriteMessageBox,sureDeleteAll:()=>sureDeleteAll});var _web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(270959),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(909436),_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(683234),_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(754866),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(972332),_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(102088),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(237625),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(246429),_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(101272),_web_settings_addressBox__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(880789),_icons_desktop__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(936492),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(952661),_moneyTransferBox__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(205597);function showSettingsAddressBox(){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_settings.php",{act:"address_box"},{stat:[window.jsc("web/settings.js"),"settings.css"],params:{bodyStyle:"padding: 0;",hideButtons:!0},onDone(e,{hash:t}){(0,_web_settings_addressBox__WEBPACK_IMPORTED_MODULE_9__.initSettingsAddressBox)(e,t)}})}function showWriteMessageBox(e,t,s={}){cur.onFriendMessage&&cur.onFriendMessage(),window.stManager.add([window.jsc("web/page.js"),window.jsc("web/wide_dd.js")]);const a=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_im.php",{act:"a_write_box",to:t,...s.params},{stat:[window.jsc("web/writebox.js"),"writebox.css","wide_dd.css","page.css","post.css",window.jsc("web/emoji.js"),"notifier.css"],cache:1},e);return a&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e),window.WriteBox&&WriteBox.extractEmoji(),!a}function giftsBox(e,t,s){return cur.viewAsBox?cur.viewAsBox():!(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_gifts.php",{act:"box",tab:s||"received",mid:e},{cache:1,stat:["gifts.css",window.jsc("web/gifts.js")]},t)}function reportAd(e,t){{let s="",a=null;const n=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("/reports.php",{act:"report_ad_box",ad_data:t},{onDone:function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.geByClass)("radiobtn","ad_report");window.radioBtns.ad_report={val:0,els:e};const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ge)("ad_csrf");s=t?t.value:s,a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_3__.ge)("ad_comment")},params:{width:370,onClean:()=>{delete window.radioBtns.ad_report}},stat:["reports.css"]});n.removeButtons(),n.addButton((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("box_send"),(r=>{ajax.post("reports.php",{act:"a_report_ad",ad_id:e,reason:window.radioBtns.ad_report.val,comment:a?a.value:"",ad_data:t,hash:s},{onDone:()=>{n.hide(),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.showDoneBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("reports_thanks_for_report"))},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.lockButton)(r),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.unlockButton)(r)})})),n.addButton((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_cancel"),!1,"no")}}const mobilePromo=()=>(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_login.php",{act:"mobile",box:1});function showAudioClaimWarning(e,t,s){const{id:a,ownerId:n,title:r}=e,d=t.id,{reason:_,original:l}=t,u={width:470};let c,p;if(e.restrictionStatus)return _web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.showAudioRestriction(e);"geo"===_?(c=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claimed_geo"),p=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claim_warning_title")):"site_rules_violation"===_?(c=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_site_rules_violation_warning"),p=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_site_rules_violation_header")):"replace"===_?(c=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claimed_replacement_available"),p=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claim_warning_title")):"subscription"===_?(u.hideButtons=!0,u.bodyStyle="padding: 0; border-radius: 4px;",u.width=450,p=!1,c=`\n      <div class="audio_claim_popup">\n        <div class="audio_claim_popup__title">${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_audio_only_with_subscription_title")}</div>\n        <div class="audio_claim_popup__text">${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_audio_only_with_subscription_text")}</div>\n        <div class="audio_claim_popup__close" onclick="curBox().hide()">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_12__.getIcon24Cancel)().icon}</div>\n        ${_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__.FlatButton.render({appearance:_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__.FlatButtonAppearance.PRIMARY,size:_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_10__.FlatButtonSize.M,round:!0,restAttrs:{onclick:"AudioPlayer.showSubscriptionPopup()"},children:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_audio_only_with_subscription_btn")}).outerHTML}\n      </div>`):(c=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claim_warning"),p=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claim_warning_title")),u.title=p,c=c.replace(/\{audio\}/g,`<b>${r}</b>`),c=c.replace(/\{objection_link\}/g,`<a href="/help?act=cc_objection&claim=${d}&content=audio${n}_${a}">${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claim_objection")}</a>`),c=c.replace(/\{delete_link\}/g,`<a onclick="deleteAudioOnClaim(${n}, ${a}); return false;">${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claim_delete")}</a>`);const m=[u,c];let y=null;if(s&&l){const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.drawAudio(l,"no_extra");m[1]=c.replace(/\{original\}/g,l[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]+" - "+l[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.AUDIO_ITEM_INDEX_TITLE])+"<br/><br/>"+e,m.push((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_replace_with_original"),(function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.lockButton)(y.btns.ok[0]),s((()=>y.hide()))})),u.textControls=`<a onclick="deleteAudioOnClaim(${n}, ${a}); return false;">${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("audio_claim_delete_capital")}</a>`}cur.claimWarning=y=_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showFastBox.apply(null,m)}function sureDeleteAll(title,text,where,objectId,toId,fromId,hash,event){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.checkEvent)(event))return;const box=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showFastBox)({title},text,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_delete"),(function(btn){ajax.post("/delete_all.php",{act:where,object_id:objectId,to_id:toId,from_id:fromId,hash,loc:nav.objLoc[0]},{onDone:function(res){if(__debugMode)eval(res);else try{eval(res)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__.logEvalError)(e,res)}box.hide()},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.lockButton)(btn),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_2__.unlockButton)(btn)})}),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_cancel"));return!1}function imageStatusPopup(e,t){Object.assign(t,{act:"image_status"});const s=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("special_event.php",t,{containerClass:"ImageStatusPopup__container",params:{hideButtons:!0,needShadow:!1},onFail:function(){return window.cur.imageStatusBox&&window.cur.imageStatusBox.hide(),!0},onDone:function(e,t){const{status_id:s}=t;s&&(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_8__.saveStatlogEvents)({name:"image_status",value:s,keys:["show_popup"]})}},e);s&&((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e),window.cur.imageStatusBox=s)}function showPollBox(e,{ref:t,className:s}={}){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_0__.showBox)("al_voting.php",{act:"get_layout",voting_id:e,for_box:!0,ref:t},{containerClass:s,params:{hideButtons:!0,width:510}})}},205597:(e,t,s)=>{"use strict";s.d(t,{moneyTransferBox:()=>c});var a=s(270959),n=s(593159),r=s(683234),d=s(754866),_=s(102088),l=s(246429),u=s(641608);function c(e,t,s,p,m,y,g){if(cur.viewAsBox)return cur.viewAsBox();if(m){if(!g){let n,r;return 2===m?(n=(0,_.curLang)("mail_money_transfer_cancel_confirm")||(0,_.getLang)("mail_money_transfer_cancel_confirm"),r=(0,_.curLang)("mail_money_transfer_cancel_btn")||(0,_.getLang)("mail_money_transfer_cancel_btn")):(n=(0,_.curLang)("mail_money_transfer_decline_confirm")||(0,_.getLang)("news_fb_money_transfer_decline_confirm"),r=(0,_.curLang)("mail_money_transfer_decline_btn")||(0,_.getLang)("news_fb_money_transfer_decline_btn")),void(cur.confirmBox=(0,a.showFastBox)((0,_.getLang)("global_action_confirmation"),n,r,c.pbind(e,t,s,p,m,!1,1),(0,_.getLang)("global_cancel")))}const n=(0,d.hasClass)((0,d.domPN)(p),"wall_postlink_preview_btn")||(0,d.hasClass)(p,"money_transfer__decline_button"),u=(0,d.geByClass1)("flat_button",(0,d.domPN)(p)),y=()=>{n?((0,d.addClass)(p.firstChild,"round_spinner"),(0,d.removeClass)(p.firstChild,"button")):(0,r.lockButton)(p)},f=()=>{n?((0,d.addClass)(p.firstChild,"button"),(0,d.removeClass)(p.firstChild,"round_spinner")):(0,r.unlockButton)(p)};return 2!==g&&((0,r.disableButton)(u,!0),y(p),cur.confirmBox&&cur.confirmBox.hide()),void ajax.post("al_payments.php?act=a_cancel_money_transfer",{tx_id:e,hash:t,from:n?"snippet":""},{onDone:function(a,r,_){0!==a?(n?((0,d.re)(p),(0,d.hasClass)(u,"secondary")||(0,d.domReplaceEl)(u,_)):(0,d.re)((0,d.domPN)(p)),(0,l.showDoneBox)(r),window.TopNotifier.invalidate()):setTimeout((()=>c(e,t,s,p,m,!1,2)),2e3)},onFail:function(e){return(0,r.disableButton)(u,!1),f(p),setTimeout((0,a.showFastBox)((0,_.getLang)("global_error"),e).hide,2e3),!0}})}return cur.acceptMoneyBtn=p,y?!u.MoneyTransfer.showMoneyTransferBox({request_id:e,request:y,hash:t},{stat:["payments.css",window.jsc("web/payments_legacy.js")]},(e=>((0,l.curBox)()&&(0,l.curBox)().hide(),setTimeout((0,a.showFastBox)((0,_.getLang)("global_error"),e).hide,2e3),!0))):!(0,a.showBox)("al_payments.php",{act:"accept_money_transfer_box",tx_id:e,hash:t},{stat:["payments.css",window.jsc("web/payments_legacy.js")],onFail:e=>((0,l.curBox)()&&(0,l.curBox)().hide(),setTimeout((0,a.showFastBox)((0,_.getLang)("global_error"),e).hide,2e3),!0),onDone(e,t){u.MoneyTransfer.initHandlers(),window.cur=(0,n.extend)(window.cur,{paymentsOptions:t,paymentsPopupWrite(e){e.document.innerHTML!=cur._popup_text&&(e.document.write(window.cur._popup_text),e.document.close(),e.blur(),e.focus(),window.cur._popup_callback&&window.cur._popup_callback())}}),e.setOptions({width:510,bodyStyle:"padding: 0;",hideButtons:!0,onClean(){window.cur.moneyTranferCheckInt&&clearInterval(window.cur.moneyTranferCheckInt),window.removeEventListener("message",u.MoneyTransfer.frameMessage,!1)}}),u.MoneyTransfer.initAccept(t.chkData,t.frame)}},s)}},458840:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AudioMessagePlayer:()=>se,articlePrepare:()=>S.articlePrepare,bookmark:()=>j,bookmarkArticle:()=>G,bookmarkEvent:()=>ee,bookmarkLink:()=>Y,bookmarkNarrative:()=>Z,bookmarkPodcast:()=>z,bookmarkPost:()=>$,deleteAudioOnClaim:()=>ie,ensureShowPhoto:()=>L.ensureShowPhoto,getIconBookmarked:()=>X,initTopAudioPlayer:()=>oe,initTopNotifier:()=>B,isArticleLayerOpen:()=>O.isArticleLayerOpen,isPhotoeditor3Available:()=>x,mentionClick:()=>ae,openArticleEditor:()=>D.openArticleEditor,podcastStartFrom:()=>H,sendBookmarkLink:()=>q,sendImageStatusStat:()=>ne,setIconBookmarked:()=>Q,setNewIconBookmarked:()=>J,shareAudioPlaylist:()=>te,showAlbum:()=>k.showAlbum,showAlbums:()=>k.showAlbums,showApp:()=>V,showManyPhoto:()=>F,showNftInfo:()=>W,showPhoto:()=>L.showPhoto,showPhotoTags:()=>R.showPhotoTags,showPodcast:()=>K,showVideoTags:()=>U,showWiki:()=>M.showWiki,videoCallback:()=>N});var a=s(905366),n=s(909436),r=s(898848),d=s(754866),_=s(593159),l=s(246429),u=s(972332),c=s(270959),p=s(575753),m=s(866467),y=s(6898),g=s(101272),f=s(194025),E=s(977202),A=s(784394),P=s(447931),b=s(702510),I=s(667309),T=s(880526),C=s(974010),O=s(613253),M=s(414623),S=s(416362),D=s(741791),k=s(862471),L=s(254551),R=s(100538);function B(){const e=[window.jsc("web/notifier.js"),"notifier.css"];return{preload:function(){window.stManager.add(e,(()=>window.TopNotifier.preload()))},show:function(t){if(!0!==(0,u.checkEvent)(t))return window.stManager.add(e,(()=>window.TopNotifier.show(t))),(0,u.cancelEvent)(t)},showTooltip:function(t){window.stManager.add(e,(()=>window.TopNotifier.showTooltip(t)))},invalidate:()=>{},setCount:()=>{},createNewEventsBox:()=>{},onBellClick:t=>{window.stManager.add(e,(()=>window.TopNotifier.onBellClick(t)))},onBellMouseDown:t=>{window.stManager.add(e,(()=>window.TopNotifier.onBellMouseDown(t)))},checkClick:(t,s)=>{window.stManager.add(e,(()=>window.TopNotifier.checkClick(t,s)))}}}function x(){return!p.browser.msie||parseInt(p.browser.version)>10}function F(e,t,s,a){Page.showManyPhoto(e,t,s,a)}function U(e,t,s){return cur.viewAsBox?cur.viewAsBox():(0,u.checkEvent)(s)?void 0:(window.stManager.add([window.jsc("web/video.js"),"video.css",window.jsc("web/photoview.js"),"photoview.css"],(function(){Photoview.showVideoTags(e,t)})),!1)}function N(e){const t=e.shift();if(window.Videoview&&Videoview.playerCallback[t])return Videoview.playerCallback[t].apply(Videoview,e);throw Error("Unregistered player callback: "+t)}function W(e,t){return(0,l.curBox)()||(0,c.showBox)("al_nft.php",{act:"token_details_modal",tokenId:t},{params:{hideButtons:!0,noCloseButton:!0,titleTransparent:!0,bodyStyle:"padding: 16px 24px"}}),(0,u.cancelEvent)(e)}function V(e,t,s,a,n,r){r||(r={});let d=!1,l=(0,_.extend)({w:"app"+t},r);if(s=(0,_.intval)(s),a&&((0,_.isObject)(a)?l=(0,_.extend)(l,a):l.ref=a),r.layer&&(d=!0),(cur.apps&&cur.apps[t]||!s)&&!d){delete l.w;const s="app"+t+(n?"_"+n:""),a=nav.objLoc&&!nav.objLoc[1]&&nav.objLoc[0]===s;return nav.go("/"+s+nav.toStr(l),e,{nocur:a})}n&&(l.mid=n);const u={stat:[window.jsc("web/wkview.js"),"wkview.css",window.jsc("web/apps.js"),"apps.css"],...r?.wikiOptions};r.queue&&(u.queue=1);const c=cur.module;if(u.onHide=()=>{cur.module=c,r.onHide&&r.onHide()},r.urlHash&&(l.url_hash=r.urlHash),l["#"]){const e=l["#"];delete l["#"],u.onLoaded=()=>{nav.setLoc((0,_.extend)(nav.objLoc,{"#":e}))}}return(0,M.showWiki)(l,!1,e,u)}function K(e,t,a,n,r){if(!vk.widget)return(0,d.show)(boxLoader),(0,d.show)(boxLayerWrap),(0,l.boxRefreshCoords)(boxLoader),Promise.all([s.e(91498),s.e(89631),s.e(85172),s.e(762),s.e(21529),s.e(79210),s.e(97468),s.e(23089),s.e(36509),s.e(88309),s.e(85648),s.e(6827),s.e("langs/web/podcasts_web")]).then(s.bind(s,525166)).then((function(s){s.default.show(e,t,null,n,r)})),a&&(0,u.cancelEvent)(a)}function H(e,t,a,n){return Promise.all([s.e(91498),s.e(89631),s.e(85172),s.e(762),s.e(21529),s.e(79210),s.e(97468),s.e(23089),s.e(36509),s.e(88309),s.e(85648),s.e(6827),s.e("langs/web/podcasts_web")]).then(s.bind(s,525166)).then((function(s){s.default.goToTime(e,t,a,n)})),a&&(0,u.cancelEvent)(a)}function j(e,t,s,a,n=!1,u="",p="",y="",g=1,f){ajax.post("al_bookmarks.php",{act:"bookmark",owner_id:e,object_id:t,type:s,state:n?1:0,hash:a,item_access_hash:u,ref:p||cur.module,track_code:y,show_snack:g,source:f},{onDone:(a,n,u,p)=>{if(a&&!vk.widget){const y=function(a){const l=(0,d.geByClass1)("bookmarks_tag_set",a);if(l&&!(0,r.isEmpty)(n)){const a=[];(0,_.each)(n,((e,t)=>{a.push(t)})),a.sort(((e,t)=>e.order-t.order));let r='<div class="bookmarks_tags_list">';for(let e=0;e<a.length;e++){const t=a[e];r+=`<div class="bookmarks_tags_list_item" data-id="${t.id}">${t.name}</div>`}r+="</div>",r=(0,d.se)(r),r.addEventListener("click",(s=>{const a=(0,d.domClosest)("bookmarks_tags_list_item",s.target);if(a){const s=(0,d.domData)(a,"id"),n=(0,d.toggleClass)(a,"bookmarks_tags_list_item--selected");ajax.post("al_bookmarks.php",{act:"set_tag",item_type:u,item_oid:e,item_id:t,hash:p,tag_id:s,is_tagged:(0,_.intval)(!n),is_from_snackbar:!0},{onFail:e=>((0,c.showFastBox)((0,m.getLang)("global_error"),e),!0)})}})),cur.setBookmarksTagTooltip&&cur.setBookmarksTagTooltip.destroy(),window.stManager.add(["ui_common.css",window.jsc("web/ui_common.js")],(()=>{}));let y=new ElementTooltip(l,{content:r,appendToParent:!0,cls:"bookmarks_tag_set_tt",autoShow:!0,offset:"video"===s?[-95,-10]:[0,-36],onFirstTimeShow:e=>{window.stManager.add(["ui_common.css",window.jsc("web/ui_common.js")],(()=>{cur.setBookmarksTagTooltipScrolls||(cur.setBookmarksTagTooltipScrolls=[]),cur.setBookmarksTagTooltipScrolls.push(new uiScroll((0,d.domFC)(e),{theme:"dark"}))}))},onShow:function(){Notifier.freezeEvents(),curNotifier.tooltipShown=!0},onHide:function(){curNotifier.tooltipShown=!1,curNotifier.unfreezeAfterTooltipHide&&Notifier.unfreezeEvents()}});cur.destroy.push((()=>{cur.setBookmarksTagTooltipScrolls&&(cur.setBookmarksTagTooltipScrolls.forEach((function(e){e.destroy()})),delete cur.setBookmarksTagTooltipScrolls),y.destroy()}))}};(0,l.showDoneBox)(a,{tooltipHandler:y,link:"/bookmarks"})}}})}async function $(e,t,a,n,r,l,u="",c="",p=""){if(p){const{bookmarkClipPost:t}=await Promise.all([s.e(76495),s.e(88651),s.e("langs/web/bookmarkClipPost")]).then(s.bind(s,697698));return t(e,p,X(e))}if((0,_.isObject)(window.cur)&&(0,_.isFunction)(window.cur.viewAsBox))return window.cur.viewAsBox();const m=X(e);e.innerHTML=m?(0,d.domData)(e,"add"):(0,d.domData)(e,"remove"),(0,d.domData)(e,"state",m?0:1),j(t,a,n,r,m,l,u,c)}function G(e,t,s,a,n,r,d,_=!1){return t&&(d=X(t),_?J(t,d,24):Q(t,d)),j(s,a,n,r,d),document.querySelectorAll(`._article_${s}_${a}`).forEach((e=>{const t=e.querySelector("._bookmark_btn");_?J(t,d,24):Q(t,d)})),(0,u.cancelEvent)(e)}function q(e,t,s,a,n,r){ajax.post("al_bookmarks.php",{act:"bookmark_link",state:e?1:0,hash:t,url:s,img:a,title:n,ref:cur.module,track_code:r},{onDone:e=>{e&&!vk.widget&&(0,l.showDoneBox)(e)}})}function Y(e,t,s){const a=X(t);return Q(t,a),q(a,s,(0,d.domData)(t,"link-url"),(0,d.domData)(t,"link-img"),(0,d.domData)(t,"link-title"),(0,d.domData)(t,"track-code")),(0,u.cancelEvent)(e)}function z(e,t,a,n,r){return Promise.all([s.e(91498),s.e(89631),s.e(85172),s.e(762),s.e(21529),s.e(79210),s.e(97468),s.e(23089),s.e(36509),s.e(88309),s.e(85648),s.e(6827),s.e("langs/web/podcasts_web")]).then(s.bind(s,525166)).then((function(s){s.default.toggleFave(e,t,a,r)})),n&&(0,u.cancelEvent)(n)}function X(e){return parseInt(e.dataset.state)}function Q(e,t){e.dataset.state=String(t?0:1),e.innerHTML=t?(0,E.getIcon24FavoriteOutline)().icon:(0,A.getIcon24Favorite)().icon}function J(e,t,s=16){e.dataset.state=String(t?0:1);const a={16:(0,P.getIcon16Bookmark)().icon,24:(0,b.getIcon24Bookmark)().icon}[s],n={16:(0,I.getIcon16BookmarkOutline)().icon,24:(0,T.getIcon24BookmarkOutline)().icon}[s];e.innerHTML=t?n:a}function Z(e,t,s,a,n,r){const d=X(t);return Q(t,d),j(s,a,n,r,d),d||(0,f.sendNarrativeAnalytic)(f.NarrativeAnalyticEventType.addToBookmarks,{ownerId:s,id:a},window.cur.module),(0,u.cancelEvent)(e)}function ee(e,t,s,a){const n=X(t);return Q(t,n),ajax.post("fave.php",{act:n?"a_delete_group":"a_add_group",gid:s,hash:a},{onDone:(e,t)=>{n||vk.widget||(0,l.showDoneBox)(t)}}),(0,u.cancelEvent)(e)}function te(e,t,s,a){return(0,c.showBox)("like.php",{act:"publish_box",object:"audio_playlist"+t+"_"+s,list:a},{stat:[window.jsc("web/wide_dd.js"),"wide_dd.css",window.jsc("web/sharebox.js")],params:{shareButtonElement:e?.target??null}}),(0,u.cancelEvent)(e)}function ie(e,t){const s=e+"_"+t,a=(0,d.geByClass1)("_audio_row_"+s);n.AudioUtils.deleteAudio(a,n.AudioUtils.getAudioFromEl(a,!0)),cur.claimWarning&&cur.claimWarning.hide()}function oe(){window.TopAudioPlayer.init()}const se={loaded:!1,events:{on(e,t){(0,C.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.events.on(e,t)}))}},togglePlay:function(e){(0,C.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.togglePlay(e)}))},toggleTranscript:function(e){(0,C.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.toggleTranscript(e)}))},detachPlayer:function(e){(0,C.voiceMessagePlayerLoader)().then((()=>{window.AudioMessagePlayer.detachPlayer(e)}))}};function ae(e,t,s={}){e&&e.tt&&e.tt.hide&&e.tt.hide({fasthide:1});let n=e,r=!1;if((0,O.isArticleLayerOpen)()&&ArticleLayer.isStandalone()&&(r=!0),n.tagName&&"a"===n.tagName.toLowerCase()&&!n.getAttribute("target")&&!nav.baseBlank){const e=n.getAttribute("hrefparams");let t;e&&(s.params=(0,_.extend)(s.params||{},(0,y.fromQueryString)(e))),n=n.href||"",n=(0,a.stripVKSiteURLOrigin)(n),n.match(/#$/)||!(t=n.match(/^\/(.*?)(\?|#|$)/))?r=!0:(t=t[1],(t.indexOf(".php")>0||t.match(/^(doc\-?\d+_\d+|graffiti\d+|reg\d+|images|utils|\.js|js\/|\.css|css\/)/))&&(r=!0))}if(r){if(!!!(s&&s.params&&s.params._post&&s.params._post_click_type))return!0;e.setAttribute("data-change-location-with-post-away",1),n=e}return nav.go(n,t,s)}function ne(e){e&&(0,g.saveStatlogEvents)({name:"image_status",value:e,keys:["popup_action"]})}},568775:(e,t,s)=>{"use strict";s.d(t,{audioShowActionTooltip:()=>m,bookmarkTooltip:()=>g,mentionOver:()=>y,mobileOnlineTip:()=>c,pageVerifiedTip:()=>p});var a=s(342879),n=s(909436),r=s(593159),d=s(754866),_=s(540462),l=s(120101),u=s(927848);function c(e,t){const s=t.asrtl?0:t.right?289:35,n=t.asrtl?" mobile_tt_asrtl":t.right?" mobile_tt_right":"";return(0,a.showTooltip)(e,{url:"al_login.php",params:{act:"mobile_tt",mid:t.mid,was:t.was},slide:15,ajxdt:200,showdt:200,hidedt:200,forcetoup:t.forcetoup,toup:!1,dir:"auto",asrtl:t.asrtl,appendParentCls:t.appendParentCls,shift:[s,8,7],className:"mobile_tt"+n})}function p(e,t){return(0,a.showTooltip)(e,{url:"/al_page.php",params:{act:"verified_tt",type:t.type,oid:t.oid,force_new_tab:t.forceNewTab?1:0,with_action:t.withAction},slide:15,ajxdt:200,showdt:200,hidedt:200,dir:"auto",shift:t.shift&&t.shift.length?t.shift:[95,5,7],className:"verified_tt",forcetodown:t.forceToDown,appendEl:t.appendEl})}function m(e,t,s){if(cur._addRestoreInProgress)return;const _=(0,d.gpeByClass)("_audio_row",e),l=n.AudioUtils.getAudioFromEl(_,!0);if(!l)return;const c=(0,d.domData)(e,"action"),p=n.AudioUtils.getRowActionName(c,l,_);if("snippet"===c){const t=u.AudioLongtapTooltip.ensure();if(t.isOpen)return;if(t.canShow())return void t.show(e)}const m={text:()=>p,black:1,shift:t||[7,4,0],needLeft:!0,forcetodown:s,noZIndex:!0};(0,r.each)(["_im_mess_stack","top_notify_wrap","_ape_audio_item","wk_history_audio_content"],(function(t,s){if((0,d.gpeByClass)(s,e))return m.appendParentCls=s,!1})),(0,d.gpeByClass)("_im_mess_stack",e)&&(m.shift=[7,10,0],m.noZIndex=!0);const y=e.closest(".CatalogBlock");y&&(m.appendEl=y),(0,a.showTooltip)(e,m)}function y(e,t={}){if(!(0,_.partConfigEnabled)("mail_history_mention_popover")||"im"!==window.cur.module||window.TopNotifier.shown()||window.layers.visible)(0,a.showTooltip)(e,{url:"al_wall.php",params:{act:"mention_tt",mention:e.getAttribute("mention_id"),from:"wall"},shift:t.shift||[52,7,7],hidedt:t.hidedt||500,showdt:500,needLeft:t.needLeft,slide:15,checkLeft:!0,reverseOffset:t.reverseOffset||112,dir:"auto",appendEl:t.appendEl||(0,d.domClosest)("im-page-history-w",e)||(0,d.domClosest)("rb_box_wrap",e)||(0,d.domClosest)("wk_cont",e)||(0,l.isVKCOMProfileRedesignedEnabled)()&&(0,d.domClosest)("box_layout",e)||(0,d.domClosest)("scroll_fix_wrap",e)});else{const t=e.getAttribute("mention_id").match(/^(id|club)(\d+)$/);if(!t)return;let s;switch(t[1]){case"id":s=parseInt(t[2],10);break;case"club":s=-parseInt(t[2],10)}if(!s)return;window.reforgedME&&window.reforgedME.profileInfo&&window.reforgedME.profileInfo.mountProfileInfo({peerId:s,targetElement:e})}}function g(e){let t="";(0,d.gpeByClass)("_im_mess_stack",e)?t="_im_mess_stack":(0,d.gpeByClass)("wall_text",e)&&(t="scroll_fix_wrap"),(0,a.showTooltip)(e,{className:"bookmarks_tt ",shift:[32,8],text:()=>"1"===(0,d.domData)(e,"state")?(0,d.domData)(e,"remove"):(0,d.domData)(e,"add"),black:1,appendParentCls:t})}},265167:(e,t,s)=>{"use strict";s.d(t,{handleGlobalEsc:()=>C,hideCookiesPolicy:()=>O,onCtrlEnter:()=>T,onDocumentClick:()=>b,onEnter:()=>I});var a=s(31580),n=s(905366),r=s(636576),d=s(101148),_=s(540462),l=s(754866),u=s(972332),c=s(593159),p=s(983567),m=s(604723),y=s(575753),g=s(469004),f=s(633009),E=s(6898),A=s(701563),P=s(298077);function b(e){if((0,_.partConfigEnabled)("ignore_navgo_if_prevented")&&e.defaultPrevented)return;if((0,u.checkEvent)(e))return!0;if(g.ls.set("last_reloaded",[]),cur.onMouseClick&&cur.onMouseClick(e))return;if(!(e=window.event||e.originalEvent||e))return!0;e.target?.dataset?.donutLogEvent&&(0,A.logDonutEvent)(e.target.dataset.donutLogEvent);let t,s=8,p=e.target||e.srcElement;for(;p&&p!==document.body&&"A"!==p.tagName&&s--;)p=p.parentNode;if(!p||"A"!==p?.tagName)return!0;const m=p.onclick||p.onmousedown;if((0,_.partConfigEnabled)("react_global_nav_handling")?Boolean(p.getAttribute("onclick")||p.getAttribute("onmousedown")):!(0,a.isAllowLinkOnclickWebForLink)(p)&&m)return!0;let y=p.href;const f=p.getAttribute("target")||nav.baseBlank;if(y&&f){if((0,l.domClosest)("bookmarks_row_type_link",p)){const e=(nav.fromStr(y)||{}).to;(0,r.statlogsValueEvent)("bookmarks_product_analytics",{link_url:e,time:(0,d.getServerTime)()})}return!0}y=(0,n.stripVKSiteURLOrigin)(y);const b={};if((t=y.match(/^\/(.+?)#[\!\/](.+?)$/))&&!t[1].match(/^app(\d+)/)&&!(0,_.partConfigEnabled)("mini_apps_navgo_hash_fix")){const e=y;b.permanent=t[1],y="/"+t[2],(0,_.partConfigEnabled)("mini_apps_navgo_hash_stats")&&(0,P.logError)("Legacy hash navigation",{breadcrumb:{data:{oldHref:e,newHref:`${y}?_permanent=${b.permanent}`}}})}const I=!!(p.getAttribute&&p.getAttribute("data-post-click-type")&&p.getAttribute("data-post-id"));if(y.match(/#$/)&&!I)return!0;const T=(0,l.domData)(p,"post-id");let C;T&&(b.postId=T);let O=y,M=null;const S=y.match(/^\/(.*?)(\?|#|$)/);if(S)M=S[1];else{if(p.hostname)C=p.hostname,M=p.pathname+p.search;else{const e=/^([^:\/]+)?(?::(\d+))?(\/?[^#]*)(#?.*)$/i.exec(y);if(!e)return!0;C=e[1],M=e[3]||"/"}if(!C||!I)return!0;p.setAttribute("data-change-location-with-post-away",1),O=p}if("add_community_app"===M)return(0,l.attr)(p,"target","_blank"),!0;if(M.indexOf(".php")>0||M.match(/^(doc\-?\d+_\d+|graffiti\d+|reg\d+|images\/|utils\/|\.js|js\/|\.css|css\/|source\b)/)){if(!I)return!0;p.setAttribute("data-change-location-with-post-away",1),O=p}const D=p.getAttribute("hrefparams");D&&(b.params=(0,c.extend)(b.params||{},(0,E.fromQueryString)(D)));try{return nav.go(O,e,(0,c.extend)({},b,{throwErrorOnDisabledPath:!0})),(0,u.cancelEvent)(e)}catch(e){return!0}}function I(e,t){(t=t||window.event).keyCode===u.KEY.ENTER&&(e(),(0,u.cancelEvent)(t))}function T(e,t){(10===(e=e||window.event).keyCode||13===e.keyCode&&(e.ctrlKey||e.metaKey&&y.browser.mac))&&(t(),(0,u.cancelEvent)(e))}function C(e){if(window._wf=1,e.keyCode===u.KEY.ESC&&boxQueue.count()&&!cur._noEscHide)return boxQueue.hideLast(),-1;if(e.keyCode===u.KEY.ESC&&window.articleCloseImageFullSize&&window.articleCloseImageFullSize())return(0,u.cancelEvent)(e);if(e.keyCode===u.KEY.ESC&&window.isArticleLayerOpen&&window.isArticleLayerOpen())return window.ArticleLayer.close(!0),(0,u.cancelEvent)(e);if(e.keyCode===u.KEY.ESC&&window.AuthorPage&&!cur.articleEditorLayer)return window.AuthorPage.close(),(0,u.cancelEvent)(e);if(e.keyCode===u.KEY.ESC&&(0,_.partConfigEnabled)("vkm_reforged_in_vkcom")&&"im"===window.cur?.module)return void((0,f.getCancelStack)().length&&((0,f.cancelStackPop)(),(0,u.cancelEvent)(e)));if(e.keyCode===u.KEY.ESC)return(0,f.cancelStackPop)(),(0,u.cancelEvent)(e);const t=[176,177,178,179];let s=!1;window.audioPlayer&&(t.push(u.KEY.LEFT),t.push(u.KEY.RIGHT)),(0,c.each)(t,(function(t,a){if(e.keyCode===a)return s=!0,!1})),s&&(0,p.getAudioPlayer)().onMediaKeyPressedEvent(e),m.Chat.inited&&191===e.keyCode&&(e.ctrlKey||e.metaKey&&y.browser.mac)&&m.Chat.showFriends()}function O(){(0,l.re)("cookies_policy_wrap"),ajax.post("/settings",{act:"a_hide_cookies_policy"})}},749284:(e,t,s)=>{"use strict";s.d(t,{isInputActive:()=>c,placeholderInit:()=>y,placeholderSetup:()=>m});var a=s(754866),n=s(972332),r=s(939646),d=s(593159),_=s(575753),l=s(540462),u=s(342018);function c(){return document.activeElement&&((0,a.attr)(document.activeElement,"contenteditable")||"INPUT"===document.activeElement.tagName||"textarea"===document.activeElement.tagName)}function p(e,t={},s,n){const d=e.phshown,l=e.phcont,{back:u,editable:c,hideBackAfter:p,timeout:m,phColor:y="#8C8E91",activeColor:g="#C0C8D0"}=t,f=m||0===m?m:100,E=t.period||200;let A;if(A=c?(void 0!==e.textContent?e.textContent:e.innerText)||(0,a.geByTag)("img",e).length:e.value,d&&(u&&A||!u&&(s&&!s.type||A))?((0,a.hide)(l),e.phshown=!1):d||A||!u&&!n||((0,a.show)(l),e.phshown=!0,_.browser.opera&&n&&(e.setAttribute("placeholder",""),e.removeAttribute("placeholder",""))),u&&!A){if(s&&!s.type){const t=p?a.hide.pbind(l.firstChild.firstChild):null;clearTimeout(e.phanim),e.phanim=setTimeout((function(){(0,r.animate)(l.firstChild.firstChild,{color:g},E,t)}),f)}n&&(clearTimeout(e.phanim),p&&(0,a.show)(l.firstChild.firstChild),e.phanim=setTimeout((function(){(0,r.animate)(l.firstChild.firstChild,{color:y},E)}),f))}}function m(e,t){const s=(0,a.ge)(e);if(!s)return!1;if(!(s.getAttribute?s.getAttribute("contenteditable"):s.contenteditable)&&(0,l.partConfigEnabled)("native_placeholder_enable"))return!1;const r=t?(0,d.clone)(t):{};if(s.phevents&&!r.reload)return;const u=s.getAttribute?s.getAttribute("placeholder"):s.placeholder;if(!u)return;s.removeAttribute("placeholder");let c={},m=!1;const y=["Top","Bottom","Left","Right"];if(r.pad)c=r.pad;else{if(r.fast){for(let e=0;e<4;e++)c["padding"+y[e]]=3,c["margin"+y[e]]=0,c["border"+y[e]+"Width"]=1;(0,d.extend)(c,r.styles||{})}else{const e=[];for(let t=0;t<4;t++)e.push("margin"+y[t]),e.push("padding"+y[t]),e.push("border"+y[t]+"Width");c=(0,a.getStyle)(s,e)}for(let e=0;e<4;e++){const t="margin"+y[e],s="border"+y[e]+"Width";c[t]=(0,d.intval)(c[t])+(0,d.intval)(c[s])+"px",delete c[s]}}if(r.reload){const e=s.previousSibling;e&&(0,a.hasClass)(e,"input_back_wrap")&&(0,a.re)(e)}const g=r.big?" big":"",f=(0,a.getSize)(s)[0]-20,E=s.phcont=s.parentNode.insertBefore((0,a.ce)("div",{className:"input_back_wrap no_select",innerHTML:`<div class="input_back"><div class="input_back_content${g}" style="width: ${f}px;">${u}</div></div>`}),s),A=(0,a.domFC)(E);(0,a.setStyle)(A,c);const P=p.pbind(s,r),b=_.browser.mobile?P:(e,t)=>setTimeout(P.pbind(e,t),0);_.browser.msie&&_.browser.version<8&&(0,a.setStyle)(A,{marginTop:1}),s.phonfocus=function(e){m||(s.focused=!0,cur.__focused=s,!0===e&&((0,a.setStyle)(s,{backgroundColor:"#FFF"}),(0,a.hide)(A)),b(!0,!1))},s.phonblur=function(){m||(cur.__focused=s.focused=!1,(0,a.show)(A),b(!1,!0))},s.phshown=!0,s.phanim=null,(s.value||r.editable&&((void 0!==s.textContent?s.textContent:s.innerText)||(0,a.geByTag)("img",s).length))&&(s.phshown=!1,(0,a.hide)(E)),_.browser.opera_mobile||((0,n.addEvent)(E,"focus click",(function(e){m||(r.editableFocus?(setTimeout(r.editableFocus.pbind(s),0),s.phonfocus()):(s.blur(),s.focus()))})),(0,n.addEvent)(s,"focus"+(r.editable?" click":""),s.phonfocus),(0,n.addEvent)(s,"keydown paste cut input",b)),(0,n.addEvent)(s,"blur",s.phonblur),s.check=b,s.getValue=()=>r.editable?s.innerHTML:s.value,s.setPlaceholder=e=>(0,a.geByClass1)("input_back_content",E).textContent=e,s.setDisabled=e=>m=e,s.setValue=function(e){r.editable?s.innerHTML=e:s.value=e,p(s,r)},s.phevents=!0,s.phonsize=function(){},r.global||r.reload||(cur.__phinputs||(cur.__phinputs=[],cur.destroy.push(function(e){for(let t=0,s=e.length;t<s;t++)(0,a.removeData)(e[t])}.pbind(cur.__phinputs))),cur.__phinputs.push(s))}function y(e,t){const s=(0,a.ge)(e);if(!s)return!1;if(!(s.getAttribute?s.getAttribute("contenteditable"):s.contenteditable)&&(0,l.partConfigEnabled)("native_placeholder_enable"))return!1;const r=t?(0,d.clone)(t):{},c=void 0===(0,a.ce)("input").placeholder||s&&s.getAttribute&&s.getAttribute("contenteditable");if(s.phevents&&!r.reload)return;const p=s.getAttribute?s.getAttribute("placeholder"):s.placeholder;if(!p)return;if(s.getValue=function(){return r.editable?s.innerHTML:s.value},s.setValue=function(e){r.editable?s.innerHTML=e:s.value=e,c&&m(s,r)},s.phonfocus=function(){},s.phonblur=function(){},!c)return;function m(e,t={}){const s=e.phshown,n=e.phcont;let r;t.editable?(r=void 0!==e.textContent?e.textContent:e.innerText,r&&_.browser.opera&&r.match(/^[ ]+$/)&&(r=""),r||(r=(0,a.geByTag)("img",e).length>0),r||(r=(0,a.geByTag)("br",e).length>1),r||(r=(0,a.geByTag)("p",e).length>1)):r=e.value,s&&r?((0,a.hide)(n),e.phshown=!1):s||r||((0,a.show)(n),e.phshown=!0)}if(s.removeAttribute("placeholder"),r.reload){const e=(0,a.domNS)(s);e&&(0,a.hasClass)(e,"placeholder")&&(0,a.re)(e)}const y=s.phcont=(0,a.domInsertAfter)((0,a.ce)("div",{className:"placeholder",innerHTML:'<div class="ph_input"><label class="ph_content" for="'+s.id+'">'+p+"</label></div>"}),s),g=m.pbind(s,r),f=_.browser.mobile?g:(e,t)=>setTimeout(g.pbind(e,t),0);s.phonfocus=function(){s.focused=!0,cur.__focused=s,f(!0,!1)},s.phonblur=function(){cur.__focused=s.focused=!1,f(!1,!0)},s.phshown=!0,(s.value||r.editable&&((void 0!==s.textContent?s.textContent:s.innerText)||(0,a.geByTag)("img",s).length))&&(s.phshown=!1,(0,a.hide)(y)),_.browser.opera_mobile||((0,n.addEvent)(y,"focus click contextmenu",(function(e){r.editableFocus?(setTimeout(r.editableFocus.pbind(s),0),"contextmenu"===e.type&&_.browser.msie&&r.editableFocus(s),s.phonfocus()):(s.blur(),s.focus())})),(0,n.addEvent)(s,"focus"+(r.editable?" click":""),s.phonfocus),(0,n.addEvent)(s,"keydown paste cut input",f)),(0,n.addEvent)(s,"blur",s.phonblur),s.check=f,s.phevents=!0,s.phonsize=function(){},r.global||r.reload||(cur.__phinputs||(cur.__phinputs=[],(0,u.pushNavDestroy)((()=>{if(cur.__phinputs)for(let e=0,t=cur.__phinputs.length;e<t;++e)(0,a.removeData)(cur.__phinputs[e])}))),cur.__phinputs.push(s))}},226220:(e,t,s)=>{"use strict";s.d(t,{TopMenu:()=>I,autosizeSetup:()=>b,checkPageBlocks:()=>E.checkPageBlocks,getProgressBarEl:()=>C,getProgressHtml:()=>T,leftBlockOut:()=>P,leftBlockOver:()=>A});var a=s(593159),n=s(754866),r=s(939646),d=s(972332),_=s(575753),l=s(633009),u=s(314309),c=s(187403),p=s(590151),m=s(540462),y=s(957994),g=s(64323),f=s(965494),E=s(420839);function A(e){let t=1;e.id||(e=(0,n.ge)("left_hide"+e),t=0),!t&&e.timer||(e.showing?(0,n.removeAttr)(e,"showing"):((0,r.animate)(e,{opacity:t?1:.5},200),t&&(e.showing=1))),e.timer&&(clearTimeout(e.timer),(0,n.removeAttr)(e,"timer"))}function P(e){let t=.5;e.id||(e=(0,n.ge)("left_hide"+e),t=0),e.timer=setTimeout((function(){(0,r.animate)(e,{opacity:t},200),(0,n.removeAttr)(e,"timer")}),1)}function b(e,t={}){if(!(e=(0,n.ge)(e)))return;if(e.autosize)return void e.autosize.update();t.minHeight=(0,a.intval)(t.minHeight)||(0,a.intval)((0,n.getStyle)(e,"height")),t.maxHeight=(0,a.intval)(t.maxHeight);let s=(0,n.getSize)(e)[0]||(0,a.intval)((0,n.getStyle)(e,"width")),r=(0,n.getStyle)(e,"fontSize"),l=(0,n.getStyle)(e,"lineHeight");s<1&&(s=(0,a.intval)((0,n.getStyle)(e,"width",!1))),r.indexOf("em")>0&&(r=(0,a.floatval)(r)*parseInt(window.getComputedStyle(document.body).fontSize)),r=(0,a.intval)(r);const u={width:s,height:10,fontFamily:(0,n.getStyle)(e,"fontFamily"),fontSize:r+"px",lineHeight:l,boxSizing:(0,n.getStyle)(e,"boxSizing")};(0,a.each)(["Top","Bottom","Left","Right"],(function(){u["padding"+this]=(0,n.getStyle)(e,"padding"+this)})),e.autosize={options:t,helper:(0,n.ce)("textarea",{className:"ashelper"},u),handleEvent:function(t,s){let a=s.charCode?String.fromCharCode(s.charCode):s.charCode;if(void 0===a&&(a=String.fromCharCode(s.keyCode),10===s.keyCode||13===s.keyCode?a="\n":!_.browser.msie&&s.keyCode<=40&&(a="")),!a)return t;if(!_.browser.msie)return t.substr(0,e.selectionStart)+a+t.substr(e.selectionEnd);const n=document.selection.createRange();return n.text&&(t=t.replace(n.text,"")),t+a},update:function(t){let s=e.value;!t||"blur"===t.type||"keyup"===t.type||_.browser.msie&&"keypress"!==t.type||t.ctrlKey||t.altKey||t.metaKey||(s=e.autosize.handleEvent(s,t)),s||(s=" "),e.autosize.helper.value!==s&&(e.autosize.helper.value=s);const r=e.autosize.options,d=(0,n.getSize)(e,!0)[1];let u=e.autosize.helper.scrollHeight;const c=u%l;r.exact&&c>2&&(u-=c-2),u<r.minHeight&&(u=r.minHeight);const p={overflow:"hidden"},m=(0,n.getStyle)(e,"overflow").indexOf("auto")>-1?"auto":"hidden";r.maxHeight&&u>r.maxHeight&&(u=r.maxHeight,(0,a.extend)(p,{overflow:"auto",overflowX:"hidden"})),r.addHeight&&(u+=r.addHeight),d===u&&m===p.overflow||(p.height=u,(0,n.setStyle)(e,p),(0,a.isFunction)(r.onResize)&&r.onResize(u))}},t.exact&&("normal"===l&&(l="120%"),l.indexOf("%")>0&&(l=r*(0,a.intval)(l)/100)),utilsNode.appendChild(e.autosize.helper),_.browser.opera_mobile?((0,n.setStyle)(e,{overflow:"hidden"}),e.autosize.update(),(0,d.addEvent)(e,"blur",e.autosize.update)):((0,d.addEvent)(e,"keydown keyup keypress change",e.autosize.update),setTimeout((()=>{(0,n.setStyle)(e,{overflow:"hidden",resize:"none"});const t=(0,n.val)(e);(0,n.val)(e," ",!0),(0,n.val)(e,t,!0),e.autosize.update()}),0))}const I={init:function(){if(this.inited)return!1;this.ecoPlateAnalytics=new f.EcoPlateAnalytics;const e=(0,n.ge)("top_profile_link"),t=(0,n.ge)("top_profile_menu");if(!e||!t)return!1;(0,d.addEvent)(e,"mousedown",I.clicked),this.inited=!0,(0,c.initColorSchemeDropdowns)()},clicked:function(e){return(0,d.checkEvent)(e)||"mousedown"===e.type&&(0,d.checkKeyboardEvent)(e)||I.toggle(),!1},toggle:function(e){if((0,m.partConfigEnabled)("logout_save_user_dialog")){if(document.querySelector(".SaveUserForQuickLoginBox"))return}const t=(0,n.ge)("top_profile_link"),s=(0,n.ge)("top_profile_menu"),a=(0,n.hasClass)(s,"shown");if(void 0!==e&&a===e)return;void 0===e&&(e=!a);const r=(0,n.$)("[data-warning]")?.getAttribute("data-warning"),d=(0,n.$)("[data-security-svg]");((0,n.hasClass)(s,"top_profile_menu_new")||(0,n.hasClass)(s,"top_profile_menu_react"))&&(e?(u.vkConnectNavigationCollector.logAccountActionsOpen(r),(0,p.logSwitcherAccounts)(),(0,m.partConfigEnabled)("vkprotect_security_recommendation")&&null!==d&&(d.remove(),(0,y.api)("account.setSecurityIndicatorShown",{}))):u.vkConnectNavigationCollector.logAccountActionsClose(r)),this.ecoPlateAnalytics&&this.ecoPlateAnalytics.logTopNavToggle(e),(0,n.toggleClass)(t,"active",e),(0,n.toggleClass)(s,"shown",e),e?((0,l.cancelStackPush)("top_menu",I.toggle.bind(this,!1),!0),cur.introExitTooltipHide&&(cur.introExitTooltipHide(),delete cur.introExitTooltipHide)):(0,l.cancelStackFilter)("top_menu",!0)},show:function(){I.hidetimer&&(clearTimeout(I.hidetimer),I.hidetimer=0),I.toggle(!0)},hide:function(){I.hidetimer||(I.hidetimer=setTimeout((function(){I.toggle(!1),I.hidetimer=0}),200))},select:function(e,t){return!!(0,d.checkEvent)(t)||((0,g.logTopNavElements)(e.href),I.toggle(!1),nav.go(e,t,{noback:!0}))}};function T(e,t){return(0,n.rs)(vk.pr_tpl,{id:e||"",cls:t||""})}function C(e){return(0,n.geByClass1)("ui_progress_bar",e)}},604723:(e,t,s)=>{"use strict";s.d(t,{Chat:()=>m,__qlClear:()=>b,cssAnim:()=>y,hideNewsAnnounce:()=>g,initLegacyBrowserDetectionInAttribute:()=>P,initPostsLegacyVars:()=>D,leftAdBlockClose:()=>f,leftBlockFriendTooltip:()=>A,leftBlockToggleFriend:()=>E,nodeUpdated:()=>S,onLoginCaptcha:()=>O,onLoginDone:()=>T,onLoginFailed:()=>C,onLoginReCaptcha:()=>M,storePasswordCredential:()=>I});var a=s(342879),n=s(683234),r=s(754866),d=s(939646),_=s(972332),l=s(593159),u=s(270959),c=s(575753),p=s(102088);const m={maxHeight:300,tabs:{},counters:{},showFriends:function(){curFastChat.clistBox.visible?curFastChat.clistBox.options.fixed?window.FastChat.clistHide():curFastChat.clistBox.show():(window.FastChat.clistShow(),m.cont.tt&&m.cont.tt.destroy&&m.cont.tt.destroy())},showTT:function(){if(!document.querySelector(".WideScreenAppPage")&&!(0,r.hasClass)(m.wrap,"chat_active")&&!(0,r.hasClass)(m.wrap,"chat_expand")){const e=c.browser.mac?"Cmd":"Ctrl";(0,a.showTooltip)(m.cont,{text:`${(0,p.getLang)("head_fr_online_tip")} (${e}+?)`,shift:[-2,4,0],showdt:0,black:1})}},init:function(){m.wrap=(0,r.ce)("div",{id:"chat_onl_wrap",className:"chat_onl_wrap",innerHTML:'\n<div class="chat_tt_wrap"></div>\n<div class="chat_onl_inner">\n  <div class="chat_cont_scrolling"><div class="chat_onl_height"></div></div>\n  <div class="chat_cont_sh_top"></div>\n  <div class="chat_cont_sh_bottom"></div>\n  <a class="chat_tab_wrap" id="chat_tab_wrap" onclick="Chat.showFriends()" onmouseover="Chat.showTT();">\n    <div class="chat_onl_cont">\n      <div class="chat_onl" id="chat_onl"></div>\n    </div>\n  </a>\n</div>'}),utilsNode.appendChild(m.wrap),m.scrollNode=(0,r.geByClass1)("chat_cont_scrolling",m.wrap),m.ttNode=(0,r.geByClass1)("chat_tt_wrap",m.wrap),m.itemsCont=m.scrollNode.firstChild,m.onl=(0,r.ge)("chat_onl"),m.cont=m.onl.parentNode.parentNode,(0,r.hide)(m.wrap),m.inited=!0,window.stManager._addCss(".layers_shown .chat_onl_wrap {margin-right: "+(0,n.sbWidth)()+"px;}")}};function y(e,t,s,a){const n=(0,l.intval)(c.browser.version);if(e&&(c.browser.chrome&&n>14||c.browser.mozilla&&n>13||c.browser.opera&&n>2)){const n="all "+s.duration+"ms "+(s.func||"ease-out");e.style.WebkitTransition=n,e.style.MozTransition=n,e.style.OTransition=n,e.style.transition=n;const d=function(){return c.browser.opera&&(0,l.intval)(c.browser.version)<=12?e.removeEventListener("oTransitionEnd",d):(0,_.removeEvent)(e,"webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",d),e.style.WebkitTransition="",e.style.MozTransition="",e.style.OTransition="",e.style.transition="",a&&a(),!1};a&&(c.browser.opera&&(0,l.intval)(c.browser.version)<=12?e.addEventListener("oTransitionEnd",d):(0,_.addEvent)(e,"webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",d)),setTimeout(r.setStyle.pbind(e,t),0)}else(0,d.animate)(e,t,(0,l.extend)(s,{onComplete:a}))}function g(e,t){const s={act:"hide_block",block:e,hash:t};ajax.post("al_index.php",s),(0,r.hide)("news_announce_"+e)}function f(e,t,s){(0,r.setStyle)("left_hide"+e,{visibility:"hidden"}),function(e,t,s){let a="";const _=(0,u.showBox)("reports.php",{act:"hide_ad_box",ad_data:s},{onDone:function(){const e=(0,r.geByClass)("radiobtn","ad_hide");window.radioBtns.ad_hide={val:0,els:e};const t=(0,r.ge)("ad_csrf");a=t?t.value:a},params:{width:370,onClean:()=>{delete window.radioBtns.ad_hide}},stat:["reports.css"]});_.removeButtons(),_.addButton((0,p.getLang)("box_send"),(l=>{(0,n.lockButton)(l),ajax.post("reports.php",{act:"hide_ad",reason_id:window.radioBtns.ad_hide.val,ad_data:s,hash:a}),function(e,t,s){function a(t){if(!t.done)return;if("function"==typeof s&&s(),"ya_direct"===e)return(0,d.animate)(e,{opacity:0},200,(function(){(0,r.re)("ya_direct"),setTimeout((function(){AdsLight.updateBlock("force_hard",2)}),5e3)})),void(window.vk__adsLight.yaDirectAdActive=!1);const a=(0,r.ge)("ads_ad_close_info_"+e);if(!a)return!1;(0,r.setStyle)(a,{opacity:0}),a.style.setProperty("display","block","important"),setTimeout(n,0)}function n(){(0,d.animate)("ads_ad_close_info_"+e,{opacity:1},200,_)}function _(){(0,r.setStyle)("ads_ad_box2_"+e,{visibility:"hidden"})}ajax.post(t,{},{noAds:!0,onDone:a})}(e,t,(()=>{(0,n.unlockButton)(l),_.hide()}))})),_.addButton((0,p.getLang)("global_cancel"),!1,"no")}(e,t,s)}function E(e,t,s,a,n){a&&window.stManager.add(["tooltips.css",window.jsc("web/tooltips.js")]),cur.mfid=e,ajax.post("al_friends.php",{act:a?"add":"remove",mid:e,mf_type:t,hash:s,from:"leftblock"},{onDone:function(t,s,a){if(!t)return nav.reload();const n=(0,r.ge)("left_friend_status_"+e);(0,r.cleanElems)(n.firstChild),t?((0,r.show)(n),(0,r.val)(n,t)):(0,r.hide)(n),s&&(ajax.preload("al_friends.php",{act:"friend_tt",mid:e},[s,a]),setTimeout(A,0))},showProgress:function(){const t=((0,r.ge)("left_friend_subscribed")||{}).tt;t&&(t.hide({fasthide:1}),t.destroy()),(0,r.ge)("left_friend_status_"+e).innerHTML='<img src="/images/upload'+(window.devicePixelRatio>=2?"_2x":"")+'.gif" width="32" />'},hideProgress:()=>(0,r.hide)("left_friend_status_"+e),onFail:function(e){if(e)return(0,u.showFastBox)({title:(0,p.getLang)("global_error")},e),!0}}),(0,_.cancelEvent)(n)}function A(){return(0,a.showTooltip)((0,r.ge)("left_friend_subscribed"),{url:"al_friends.php",params:{act:"friend_tt",mid:cur.mfid,from:"leftblock"},slide:15,hidedt:500,shift:[40,-1,3],className:"preq_tt",forcetodown:!0})}function P(){let e=[];(0,l.each)(c.browser,(function(t,s){s&&!(0,l.inArray)(t,["version","mac","search_bot"])&&"flash"!==t.substr(0,5)&&e.push(t)})),e=e.join(" "),document.body.setAttribute("data-useragent",e)}function b(){clearTimeout(window.__qlTimer),setTimeout((()=>clearTimeout(window.__qlTimer)),2e3)}function I(e){if(!c.browserFeatures.cmaEnabled||!window.ResizeObserver||!(0,r.val)("quick_email"))return;if(void 0===window.PasswordCredential)return;const t=new PasswordCredential({id:(0,r.ge)("quick_email").value,password:(0,r.ge)("quick_pass").value,name:e.name,iconURL:e.photo_50});navigator.credentials.store(t)}function T(e,t){b(),I(t),nav.reload({force:!0,from:6})}function C(e,t){switch(b(),e){case-1:location.href=location.href.replace(/^http:/,"https:");break;case 4:let e="/login?m=1"+(t.expire?"&s=0":"");(0,l.each)(["email","ul","pch","to"],(function(s,a){t[a]&&(e+="&"+a+"="+t[a])})),location.href=e;break;case 7:location.href="/login?m=7";break;default:location.href="/login"}}function O(e,t){b(),(0,n.unlockButton)(window.__qfBtn),window.qloginBox=(0,u.showCaptchaBox)(e,t,window.qloginBox,{onSubmit:function(e,t){!function(){const e=(0,r.ge)("quick_captcha_sid"),t=(0,r.ge)("quick_captcha_key"),s=(0,r.ge)("quick_recaptcha"),a=(0,r.ge)("quick_login_form");e||a.appendChild((0,r.ce)("input",{type:"hidden",name:"captcha_sid",id:"quick_captcha_sid",value:""})),t||a.appendChild((0,r.ce)("input",{type:"hidden",name:"captcha_key",id:"quick_captcha_key",value:""})),s||a.appendChild((0,r.ce)("input",{type:"hidden",name:"recaptcha",id:"quick_recaptcha",value:""}))}(),(0,r.ge)("quick_captcha_sid").value=e,(0,r.ge)("quick_captcha_key").value=t,(0,r.ge)("quick_login_form").submit()},onHide:()=>window.qloginBox=!1})}function M(e,t){b(),(0,n.unlockButton)(window.__qfBtn),window.qloginBox=(0,u.showReCaptchaBox)(e,t,window.qloginBox,{onSubmit:function(e){(0,r.ge)("quick_recaptcha").value=e,(0,r.ge)("quick_login_form").submit()},onHide:()=>window.qloginBox=!1})}function S(e,t){(0,r.setStyle)(e,{backgroundColor:"#F5F7FA"}),(0,d.animate)(e,{backgroundColor:"#FFF"},t||6e3,(function(e){(0,r.setStyle)(e,{backgroundColor:null})}))}function D(){window._postsSeen=window._postsSeen??{},window._postsSaved=window._postsSaved??{},window._postsSaveTimer=window._postsSaveTimer??void 0,window._postsSendTimer=window._postsSendTimer??void 0,window._postsCleanTimer=window._postsCleanTimer??void 0,window._postsSeenModules=window._postsSeenModules??{},window._postsExtras=window._postsExtras??{}}},191468:(e,t,s)=>{"use strict";s.d(t,{shortCurrency:()=>r});var a=s(593159),n=s(754866);function r(){const e={};(0,a.each)((0,n.geByClass)("_short_currency"),(function(){const t=(0,n.domData)(this,"short")||"";if(!t)return!0;const s=this.innerHTML,r=(0,a.winToUtf)(s).length,d=(0,n.getStyle)(this,"fontFamily")||"tahoma,arial,sans-serif";if(void 0===e[d]){let t="";for(let e=r-1;e>=0;e--)t+="&#8399;";const a=(0,n.ce)("div",{innerHTML:`<b>${s}</b><b>${t}</b>`},{fontFamily:d,fontSize:"24px"});(0,n.ge)("utils").appendChild(a),e[d]=Math.abs(a.firstChild.offsetWidth-a.lastChild.offsetWidth)>=2*r,(0,n.re)(a)}!1===e[d]&&(0,n.val)(this,t)}))}},967495:(e,t,s)=>{"use strict";s.d(t,{rangeCreate:()=>_,rangeGet:()=>r,rangeInsert:()=>l});var a=s(754866),n=s(575753);function r(){let e=null,t=window.getSelection();t.getRangeAt&&t.rangeCount&&(e=t.getRangeAt(0));let s=null,a=null,n=0,r=0,d=document.activeElement;return e&&("selectionStart"in d?(s=d,a=d,n=d.selectionStart,r=d.selectionEnd):t.rangeCount&&(s=e.startContainer,a=e.endContainer,n=e.startOffset,r=e.endOffset)),[e,s,n,a,r]}function d(e){let t=window.getSelection();return t.removeAllRanges(),t.addRange(e),e}function _(e,t,s,a){let n=document.createRange();return n.setStart(e,t),n.setEnd(s,a),d(n)}function l(e,t){if(t=t?t+"":"",!n.browser.msie&&document.execCommand)document.execCommand("insertHTML",!1,t);else if(e){e.deleteContents();let s=(0,a.cf)(t),n=s.lastChild;e.insertNode(s),n&&((e=e.cloneRange()).setStartAfter(n),e.collapse(!0),d(e))}return e}},568129:(e,t,s)=>{"use strict";s.d(t,{blockNameEmpty:()=>Oe,blockNameOwn:()=>Me,blockNameSearch:()=>Se,blockNameSearchGeoGroups:()=>ke,blockNameSearchGroups:()=>De,clickTypeAddFriendOut:()=>be,clickTypeJoinGroupOut:()=>we,clickTypeLeaveGroupOut:()=>Pe,clickTypeRemoveFriendOut:()=>Ie,generateQID:()=>gt,logLeftMenuClicks:()=>mt,outOfSerpGroup:()=>Te,outOfSerpProfile:()=>Ce,removeOutOfSerpClickLogging:()=>ut,removeSearchPositionTracker:()=>ht,saveSearchAttemptStats:()=>yt,serviceApps:()=>L,serviceAppsList:()=>k,serviceAppsManage:()=>R,serviceAudio:()=>V,serviceBookmarksGroups:()=>S,serviceBookmarksUsers:()=>D,serviceDocs:()=>N,serviceEvents:()=>f,serviceFriends:()=>E,serviceFriendsFind:()=>P,serviceGamesCatalog:()=>Y,serviceGroups:()=>m,serviceGroupsCatalog:()=>y,serviceManage:()=>K,serviceMarketV2:()=>$,serviceMessages:()=>W,serviceNews:()=>O,servicePhotos:()=>U,serviceSearchAudio:()=>M,serviceSearchClips:()=>x,serviceSearchCommunities:()=>g,serviceSearchPeople:()=>A,serviceSearchStatuses:()=>C,serviceSearchVideo:()=>B,serviceTopSearch:()=>F,serviceUserFriends:()=>q,serviceVideo:()=>H,serviceWall:()=>T,serviceWallGroups:()=>I,serviceWallUsers:()=>b,tryLogOutOfSerpClick:()=>lt});var a=s(898848),n=s(972332),r=s(593159),d=s(754866),_=s(636576),l=s(553608),u=s(952661),c=s(540462);const p={},m="groups",y="groups_catalog",g="search_communities",f="events",E="friends",A="search_people",P="friends_find",b="wall_users",I="wall_groups",T="wall",C="search_statuses",O="news",M="search_audio",S="bookmarks_groups",D="bookmarks_users",k="apps_list",L="apps",R="apps_manage",B="search_video",x="search_clips",F="top_search",U="photos",N="docs",W="messages",V="audio",K="manage",H="video",j="market",$="market_v2",G="market_groups",q="profile_user_friends",Y="games_catalog",z="",X="tap",Q="join_group",J="leave_group",Z="fave",ee="unfave",te="write_msg",ie="add_friend",oe="remove_friend",se="restore_friend",ae="show_photo",ne="add",re="remove",de="play",_e="open_artist",le="open_author_group",ue="open_author_user",ce="open_author",pe="show_similar",he="search_by_tag",me="edit",ye="like",ge="open_comments",fe="share",Ee="expand",ve="mark_as_spam",Ae="stats",we="join_group_out",Pe="leave_group_out",be="add_friend_out",Ie="remove_friend_out",Te="group",Ce="profile",Oe="",Me="own",Se="search",De="search_groups",ke="search_communities_geo",Le="own_playlists",Re="global_clips",Be="own_audios",xe="search_artists",Fe="search_playlists",Ue="search_global_playlists",Ne="search_audios",We="own_conversations",Ve="own_messages",Ke="own_albums",He="own_videos",je="video_playlists",$e="search_videos",Ge="serps",qe="SERPS_LOGS_DATA_LOCK",Ye=180,ze=100,Xe="",Qe="user",Je="group",Ze="app",et="event",tt="public",it="grid",ot="list";function st(e,t,s,n="",r=void 0,_=void 0){let l=0,u="",c=0,p=1,m=0,y=0;return e&&((0,a.isArray)(s)||(s=[s]),s.some((s=>{const a=e.classList.contains(s)?e:(0,d.gpeByClass)(s,e);let g=0;if(a){let s;if(s=n?document.querySelectorAll(n):a.parentNode.children,s){if(l=[...s].indexOf(a)+1,l&&r)for(const e in r)if(r.hasOwnProperty(e)){const t=document.querySelectorAll(r[e]);if(t){const s=[...t].indexOf(a)+1;if(s){c=s,u=e;break}}p++,g++}if(_)for(const t of _){const s=(0,d.gpeByClass)(t,e);s&&(p=s.getAttribute("data-block-num"))}return[m,y]=t(a,g),!0}}}))),[l,m,y,u,c,p]}function at(e,t,s,a,n,r,_){if(!p[e])return;const l=_.target;if(l&&l.classList)switch(e){case m:return void function(e,t,s,a,n,r){if(!t)return;const _=r.classList,l=r.outerHTML,c=r.tagName;let[,p,m,y,g]=st(r,(e=>{let t=e.getAttribute("id")||e.getAttribute("data-id");return t=t?t.replace("gl_groups","").replace("gl_admin",""):0,[0,"-"+t]}),["_gl_row","search_row"],"#groups_list_tab_groups ._gl_row, #groups_list_search_wrap ._gl_row, #results .search_row, #groups_list_search_wrap .search_row",{[Me]:"#groups_list_tab_groups ._gl_row",[Se]:"#groups_list_search_wrap ._gl_row, #groups_list_search_wrap .search_row"});if(!g)return;y===Me&&(a=0,n="");let f=z;if(_.contains("group_row_title")||_.contains("group_row_img")||_.contains("highlight")||_.contains("search_item_img")||"A"===c&&-1!==l.indexOf("return nav.go")){let e=(0,d.gpeByClass)("group_list_row",r)||(0,d.gpeByClass)("groups_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),f=X}(u.FlatButton.isFlatButton(r)&&u.FlatButton.getAppearance(r)!==u.FlatButtonAppearance.SECONDARY||_.contains("search_sub_button"))&&(f=Q);(u.FlatButton.isFlatButton(r)&&u.FlatButton.getAppearance(r)===u.FlatButtonAppearance.SECONDARY||_.contains("search_unsub_button"))&&(f=J);if(y===Me&&-1!==l.indexOf("GroupsList.subscribe")){if(_.contains("ui_actions_menu"))return;f=Q,!cur.scrollList.deleted[-m]&&(f=J)}if(y===Me&&-1!==l.indexOf("GroupsList.toggleFave")){if(_.contains("ui_actions_menu"))return;f=Z,"1"===r.getAttribute("data-value")&&(f=ee)}if(f===z)return;_t(),f===X&&dt(Te,e,y,g,s,t,m,p,a,n);ct(e,y,g,f,s,t,m,p,a,n,Xe)}(e,t,s,a,n,l);case g:return(0,c.partConfigEnabled)("search_communities_web_blocks_enabled")?void function(e,t,s,a,n,r,_){const l=_.classList,u=_.tagName,c=_.outerHTML,p=Boolean(_?.closest(".block_geo_groups"))||Boolean(_?.closest(".search_communities_block.section_page"))?ke:De,m=_?.closest(".search_row")?.dataset?.id||0,y=(()=>{const e=document.querySelector("#results .block_user_groups"),t=document.querySelector("#results .block_other_groups"),s=document.querySelector("#results .block_geo_groups"),a=document.querySelector("#results .search_communities_block.section_page");if(s&&_?.closest(".block_geo_groups")){const e=[...s.querySelectorAll(".search_row")].findIndex((e=>+e?.dataset?.id==+m));if(-1!==e)return e+1}return[...e?.querySelectorAll(".search_row")||[],...t?.querySelectorAll(".search_row")||[],...a?.querySelectorAll(".search_row")||[]].findIndex((e=>+e?.dataset?.id==+m))+1})(),g=document.querySelector("#results .block_geo_groups")?p===ke?1:2:1;if(!y)return;let f=z;if(l.contains("search_item_img")||l.contains("highlight")||"A"===u&&-1!==c.indexOf("return nav.go")){let e=(0,d.gpeByClass)("groups_row",_);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),f=X}l.contains("search_sub_button")&&(f=Q);l.contains("search_unsub_button")&&(f=J);if(f===z)return;_t(),f===X&&dt(Te,e,p,y,s,t,m,0,a,n,r,g);ct(e,p,y,f,s,t,m,0,a,n,Xe,"",r,g)}(e,t,s,a,n,r,l):void function(e,t,s,a,n,r,_){if(!t)return;const l=_.classList,u=_.outerHTML,c=_.tagName;let[p,m,y]=st(_,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,"-"+t]}),"search_row","#results .search_row");const g=_?.closest(".search_communities_block.section_page")?ke:Oe;if(!p)return;let f=z;if(l.contains("search_item_img")||l.contains("highlight")||"A"===c&&-1!==u.indexOf("return nav.go")){let e=(0,d.gpeByClass)("groups_row",_);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),f=X}l.contains("search_sub_button")&&(f=Q);l.contains("search_unsub_button")&&(f=J);if(f===z)return;_t(),f===X&&dt(Te,e,g,p,s,t,y,m,a,n);ct(e,g,p,f,s,t,y,m,a,n,Xe,"",r)}(e,t,s,a,n,r,l);case y:return void function(e,t,s,a,n,r){if(!t)return;const _=r.classList,l=r.outerHTML,u=r.tagName;let[c,p,m]=st(r,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,"-"+t]}),"search_row","#results .search_row"),y=z;if(_.contains("search_item_img")||_.contains("highlight")||"A"===u&&-1!==l.indexOf("return nav.go")){let e=(0,d.gpeByClass)("groups_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),y=X}_.contains("search_sub_button")&&(y=Q);_.contains("search_unsub_button")&&(y=J);if(y===z)return;_t(),y===X&&dt(Te,e,Oe,c,s,t,m,p,a,n);ct(e,Oe,c,y,s,t,m,p,a,n,Xe)}(e,t,s,a,n,l);case f:return void function(e,t,s,a,n,r){const _=r.classList,l=r.outerHTML,u=r.parentElement?r.parentElement.classList:null;let[c,p,m]=st(r,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,"-"+t]}),"search_row","#groups_list_in_tab_search_all .search_row");if(!c)return;let y=z;if(_.contains("search_item_img")||-1!==l.indexOf("return nav.go")&&u&&u.contains("title")){let e=(0,d.gpeByClass)("search_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),y=X}_.contains("search_sub_button")&&(y=Q);_.contains("search_unsub_button")&&(y=J);if(y===z)return;_t(),y===X&&dt(Te,e,Oe,c,s,t,m,p,a,n);ct(e,Oe,c,y,s,t,m,p,a,n,Xe)}(e,t,s,a,n,l);case E:case q:return void function(e,t,s,a,n,r){const _=r.classList,l=r.outerHTML,u=r.tagName;let[,c,p,m,y]=st(r,(e=>{let t=e.getAttribute("id");return t=t?t.replace("friends_user_row",""):0,[0,t]}),"friends_user_row","#list_content .friends_user_row, #friends_search_cont .friends_user_row",{[Me]:"#list_content .friends_user_row",[Se]:"#friends_search_cont .friends_user_row"});if(!y)return;let g=z;m===Me&&-1!==l.indexOf("showWriteMessageBox")&&(g=te);m===Me&&-1!==l.indexOf("deleteFriend")&&(g=oe);m===Me&&_.contains("friends_restore_link")&&(g=se);_.contains("ui_zoom_icon")&&(g=ae);m===Se&&r.id&&-1!==r.id.indexOf("friends_subsc")&&(g=ie);m===Se&&r.id&&-1!==r.id.indexOf("friends_unsubsc")&&(g=oe);if(_.contains("friends_photo_img")||m===Me&&"A"===u&&-1!==l.indexOf("return nav.go")||m===Se&&"A"===u&&0===_.length){let e=(0,d.gpeByClass)("friends_user_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),g=X}if(g===z)return;_t(),g===X&&dt(Ce,e,m,y,s,t,p,c,a,n);ct(e,m,y,g,s,t,p,c,a,n,Xe)}(e,t,s,a,n,l);case P:return void function(e,t,s,a,n,r){const _=r.classList,l=r.outerHTML,u=r.parentElement?r.parentElement.classList:null;if(!t)return;let[c,p,m]=st(r,(e=>[0,e.getAttribute("data-id")||0]),"search_row","#results .search_row");if(!c)return;let y=z;if(_.contains("search_item_img")||-1!==l.indexOf("return nav.go")&&u&&u.contains("name")){let e=(0,d.gpeByClass)("people_row",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),y=X}_.contains("search_sub_button")&&(y=ie);_.contains("search_unsub_button")&&(y=oe);if(y===z)return;_t(),y===X&&dt(Ce,e,Oe,c,s,t,m,p,a,n);ct(e,Oe,c,y,s,t,m,p,a,n,Xe)}(e,t,s,a,n,l);case A:return void function(e,t,s,a,n,r,_){const l=_.classList,u=_.outerHTML,c=_.parentElement?_.parentElement.classList:null;if(!t)return;let[p,m,y]=st(_,(e=>[0,e.getAttribute("data-id")||0]),"search_row","#results .search_row");if(!p)return;let g=z;if(l.contains("search_item_img")||l.contains("AvatarRich")||(-1!==u.indexOf("return nav.go")||-1!==u.indexOf("searcher.openProfileNps"))&&c&&(c.contains("name")||c.contains("img"))){let e=(0,d.gpeByClass)("people_row",_);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),g=X}l.contains("search_sub_button")&&(g=ie);l.contains("search_unsub_button")&&(g=oe);if(g===z)return;_t(),g===X&&dt(Ce,e,Oe,p,s,t,y,m,a,n);ct(e,Oe,p,g,s,t,y,m,a,n,Xe,"",r)}(e,t,s,a,n,r,l);case S:return void function(e,t,s,a,n,r){const _=r.classList,l=r.outerHTML;let[u,c,p]=st(r,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,t]}),"_bookmark_page_item");if(!u)return;let m=z;if(_.contains("group_link")||_.contains("bookmark_page_item__image")){let e=(0,d.gpeByClass)("_bookmark_page_item",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),m=X}(_.contains("ui_zoom")||_.contains("ui_zoom_icon"))&&(m=ae);-1!==l.indexOf("Bookmarks.removeBookmark")&&(m=ee);if(m===z)return;_t(),m===X&&dt(Te,e,Oe,u,s,t,p,c,a,n);ct(e,Oe,u,m,s,t,p,c,a,n,Xe)}(e,t,s,a,n,l);case D:return void function(e,t,s,a,n,r){const _=r.classList,l=r.outerHTML,[u,c,p]=st(r,(e=>{let t=e.getAttribute("data-id");return t||(t=0),[0,t]}),"_bookmark_page_item");if(!u)return;let m=z;if(_.contains("mem_link")||_.contains("bookmark_page_item__image")){let e=(0,d.gpeByClass)("_bookmark_page_item",r);if(!e)return;if(e.hasAttribute("data-clicked"))return;e.setAttribute("data-clicked",!0),m=X}(_.contains("ui_zoom")||_.contains("ui_zoom_icon"))&&(m=ae);-1!==l.indexOf("Bookmarks.removeBookmark")&&(m=ee);if(m===z)return;_t(),m===X&&dt(Ce,e,Oe,u,s,t,p,c,a,n);ct(e,Oe,u,m,s,t,p,c,a,n,Xe)}(e,t,s,a,n,l);case M:!function(e,t,s,a,n,r){const _=r.classList,l=r.tagName;let u=(0,d.gpeByClass)("ap_layer_wrap",r);if(u)return;let c=(0,d.gpeByClass)("search_results",r);if(!c)return;let[p,m,y]=st(r,(e=>{let t=e.getAttribute("data-full-id");return t&&t.indexOf("_")?t.split("_"):[0,0]}),"_audio_row");if(!p)return;let g=z;(_.contains("audio_row__cover_icon")||_.contains("audio_row__performer_title")||_.contains("audio_row__title")||_.contains("audio_row__title_inner")||_.contains("audio_row__title_inner_subtitle")||_.contains("audio_row__inner")||_.contains("audio_player__place")||_.contains("audio_row__action_next")||_.contains("audio_row__performers"))&&(g=de);_.contains("audio_row__action_add")&&(g=ne);"A"===l&&(g=_e);if(g===z)return;ct(e,Oe,p,g,s,t,y,m,a,n,Xe)}(e,t,s,a,n,l);break;case B:return void function(e,t,s,a,n,r,d){const _=d.classList;let[l,u,c]=st(d,(e=>{let t=e.getAttribute("data-id");return t&&t.indexOf("_")?t.split("_"):[0,0]}),"_video_item","#results ._video_item");if(!l)return;let p=z;(_.contains("video_thumb_play")||_.contains("video_item_controls")||_.contains("video_thumb_label_item")||_.contains("video_thumb_label")||_.contains("video_item_title")||_.contains("mv_subtitle"))&&(p=de);(_.contains("icon_add")||_.contains("video_thumb_action_add")||_.contains("VideoCard__action--add"))&&(p=ne);_.contains("icon_added")&&(p=re);_.contains("group_link")&&(p=le);_.contains("al_need_login")&&(p=_e);_.contains("mem_link")&&(p=ue);if(p===z)return;ct(e,Oe,l,p,s,t,c,u,a,n,Xe,"",r)}(e,t,s,a,n,r,l);case x:return void function(e,t,s,a,n,r,d){const _=d.classList;let[l,u,c]=st(d,(e=>{let t=e.parentNode.getAttribute("href");return t=t.replace("/clip",""),t&&t.indexOf("_")?t.split("_"):[0,0]}),"ShortVideoGridItem__thumb",".ShortVideoGridItem__thumb");if(!l)return;let p=z;_.contains("ShortVideoGridItem__thumb")&&(p=de);if(p===z)return;ct(e,Oe,l,p,s,t,c,u,a,n,Xe,"",r)}(e,t,s,a,n,r,l);case V:return void function(e,t,s,a,n,r){const d=r.classList,_=r.tagName,l=r.parentElement?r.parentElement.classList:null,[,u,c,p,m]=st(r,((e,t)=>{let s="";switch(t){case 1:case 4:case 2:s=e.getAttribute("data-full-id");break;case 0:case 3:case 6:s=e.getAttribute("data-raw-id")}return s&&s.indexOf("_")?s.split("_"):s?[s,0]:[0,0]}),["_audio_pl_item","audio_block_small_item","_audio_row","_video_item"],"\n        ._audio_section__search ._audio_pl_item,\n        ._audio_section__search ._audio_row,\n        ._audio_section__search .audio_block_small_item,\n        ._audio_section__search .video_item,\n        ._audio_search_blocks ._audio_row,\n        ._audio_search_blocks ._video_item,\n        ._audio_search_blocks ._audio_pl_item,\n        ._audio_search_blocks .audio_block_small_item\n      ",{[Fe]:".CatalogBlock__search_global_albums ._audio_pl_item",[Be]:".CatalogBlock__search_owned_audios ._audio_row",[Ne]:".CatalogBlock__search_global_audios ._audio_row",[xe]:".CatalogBlock__search_global_artists .audio_block_small_item",[Re]:".CatalogBlock__search_global_clips .video_item",[Le]:'._audio_page_block__playlists_items[data-audio-context="search_owned_playlist"] ._audio_pl_item',[Ue]:".CatalogBlock__search_global_playlists ._audio_pl_item"});if(!m)return;let y=z;d.contains("audio_row__action_more")||l&&l.contains("audio_row__actions")||(y=de);d.contains("audio_row__action_next")&&(y=de);p===Be&&d.contains("audio_row__action_recoms")&&(y=pe);p===Be&&d.contains("audio_row__action_delete")&&(y=re);p===Be&&d.contains("audio_row__action_add")&&(y=ne);p===Ne&&d.contains("audio_row__action_add")&&(y=ne);p===Re&&d.contains("icon_add")&&(y=ne);p===Re&&d.contains("icon_added")&&(y=re);p===xe&&"A"===_&&(y=_e);if(y===z)return;ct(e,p,m,y,s,t,c,u,a,n,Xe)}(e,t,s,a,n,l);case F:return void function(e,t,s,a,n,r){const _=r.classList;let l=r;_.contains("ts_contact")||(l=(0,d.gpeByClass)("ts_contact",r,"div#ts_cont_wrap"));let[u,c,p]=st(l,(()=>[0,(l.id||"").replace("ts_contact","")]),"ts_contact","#ts_cont_wrap .ts_contact");if(!u)return;let m=X,y=Xe;switch(l.getAttribute("hinttype")){case"h_friends":y=Qe,_.contains("ts_contact_status")&&(m=te);break;case"h_mutual_friends":case"s_people":case"h_mail_peers":y=Qe;break;case"h_vk_apps":case"h_apps":y=Ze;break;case"h_events":y=et;break;case"h_publics":y=tt;break;case"h_visited":case"s_groups":y=Je}ct(e,Oe,u,m,s,t,p,c,a,n,y)}(e,t,s,a,n,l);case H:return void function(e,t,s,a,n,r,d){const _=d.classList;let[,l,u,p,m]=st(d,((e,t)=>{let s="";switch(t){case 1:case 3:s=e.getAttribute("data-id");break;case 2:s=e.getAttribute("data-name")}return s&&s.indexOf("_")?s.split("_"):[0,0]}),["video_playlist_item","_video_item","ui_gallery_item"],"\n        #video_layout_search .video_playlist_item,\n        #video_layout_search ._video_item,\n        #video_subtab_pane_search_promo_albums .ui_gallery_item\n      ",{[Ke]:"#video_subtab_pane_search_albums .video_playlist_item",[He]:"#video_subtab_pane_search_videos ._video_item",[je]:"#video_subtab_pane_search_promo_albums .ui_gallery_item",[$e]:"#video_subtab_pane_search_global_videos ._video_item"});if(!m)return;let y=z;(_.contains("icon_add")||_.contains("video_thumb_action_add")||_.contains("VideoCard__action--add"))&&(y=ne);_.contains("icon_added")&&(y=re);const g=(0,c.partConfigEnabled)("video_remove_restore_video_act")?"video-restore-button-widget"===d.id:_.contains("video_restore_act");p===He&&g&&(y=ne);p===He&&_.contains("video_thumb_action_delete")&&(y=re);(_.contains("video_item_title")||_.contains("video_item_controls")||_.contains("video_thumb_label_item")||_.contains("video_thumb_play"))&&(y=de);_.contains("group_link")&&(y=le);_.contains("al_need_login")&&(y=_e);_.contains("mem_link")&&(y=ue);y===z&&p===je&&(_.contains("VideoCard__controlsOverlay")||_.contains("VideoCard__title")||_.contains("VideoCard__icon")||_.contains("VideoCard__controlsOverlayText"))&&(y=X);if(y===z)return;ct(e,p,m,y,s,t,u,l,a,n,Xe,"",r)}(e,t,s,a,n,r,l);case j:case G:return void function(e,t,s,a,n,r){const _=r.classList;let l=it;const u=(0,d.gpeByClass)("market_row_line",r,".marketplace_content_search");u&&(l=ot);const c=l===it?"_market_row":"market_row_line";let[p,m,y]=st(r,(e=>[0,e.getAttribute("data-id")||0]),c,"#marketplace_content ."+c);if(!p)return;let g=z;switch(l){case ot:(_.contains("market_row_img")||_.contains("link"))&&(g=X),_.contains("market_favourite")&&!_.contains("selected")&&(g=Z),_.contains("market_favourite")&&_.contains("selected")&&(g=ee),_.contains("mem_link")&&(g=ue),_.contains("group_link")&&(g=le);break;case it:g=X,(_.contains("icon")||_.contains("fav"))&&(g=Z)}if(g===z)return;ct(e,Oe,p,g,s,t,y,m,a,n,Xe)}(e,t,s,a,n,l);case $:return void function(e,t,s,a,n,r){const d=r.classList,_="ClassifiedsCatalogProduct__serpItem",[l,u,c]=st(r,(e=>[+e.getAttribute("data-owner-id"),+e.getAttribute("data-id")]),_);if(!l)return;let p=z;d.contains("ClassifiedsCatalogProduct__serpTap")&&(p=X);d.contains("MarketplaceCatalogProductFavouriteButton--favorite")&&(p=Z);d.contains("MarketplaceCatalogProductFavouriteButton--notFavorite")&&(p=ee);d.contains("ClassifiedsCatalogProduct__serpOwnerGroup")&&(p=le);d.contains("ClassifiedsCatalogProduct__serpOwnerUser")&&(p=ue);if(p===z)return;ct(e,Oe,l,p,s,t,c,u,a,n,Xe)}(e,t,s,a,n,l);case W:return void function(e,t,s,a,n,r){let[,d,_,l,u]=st(r,(e=>{let t=e.getAttribute("data-peer");return t||(t=0),[0,t]}),"_im_dialog","._im_page_dcontent ._im_dialog",{[We]:"._im_page_dcontent ._im_dialog:not(._im_search)",[Ve]:"._im_page_dcontent ._im_dialog._im_search"});if(!u)return;ct(e,l,u,X,s,t,_,d,a,n,Xe)}(e,t,s,a,n,l);case N:return void function(e,t,s,a,n,r){const d=r.classList,_=r.outerHTML;let[,l,u,c,p]=st(r,(e=>{let t=e.getAttribute("id");return t&&(t=t.replace("docs_file_","")),t&&t.indexOf("_")?t.split("_"):[0,0]}),"_docs_item","#docs_list ._docs_item, #docs_search_list ._docs_item",{[Me]:"#docs_list ._docs_item",[Se]:"#docs_search_list ._docs_item"});if(!p)return;let m=z;c===Se&&d.contains("docs_add_row")&&(m=ne);c===Me&&d.contains("docs_delete_row")&&(m=re);c===Me&&-1!==_.indexOf("Docs.restoreItem")&&(m=ne);c===Me&&d.contains("docs_edit_row")&&(m=me);(d.contains("highlight")||d.contains("docs_item_thumb_img")||d.contains("docs_item_icon")||d.contains("docs_item_name"))&&(m=X);-1!==_.indexOf("Docs.tagSearch")&&(m=he);if(m===z)return;ct(e,c,p,m,s,t,u,l,a,n,Xe)}(e,t,s,a,n,l);case k:case L:return void function(e,t,s,a,n,r){const[d,_,l]=st(r,(e=>{let t=e.getAttribute("id");return t=t?t.replace("app",""):0,[0,t]}),"_apps_cat_row");if(!d)return;let u=X;if(u===z)return;ct(e,Oe,d,u,s,t,l,_,a,n,Xe)}(e,t,s,a,n,l);case Y:return void function(e,t,s,a,n,r){const d=r.classList,[_,l,u]=st(r,(e=>[0,e.getAttribute("data-app-id")||0]),"GameCatalogSearchCard");if(!_)return;let c=z;(d.contains("GameCatalogSearchCard__screenshotImg")||d.contains("GameCatalogSearchCard__run")||d.contains("GameCatalogSearchCard__avatar")||d.contains("GameCatalogSearchCard__name"))&&(c=de);if(c===z)return;ct(e,Oe,_,c,s,t,u,l,a,n,Xe)}(e,t,s,a,n,l);case U:return void function(e,t,s,a,n,r){const[d,_,l]=st(r,(()=>{let e=r.getAttribute("href")||"";e=e.replace("/photo","");let t=e.split("_");return 2!==t.length?[0,0]:[t[0],t[1]]}),"page_post_thumb_wrap","._feed_rows .page_post_thumb_wrap");if(!d)return;ct(e,Oe,d,X,s,t,l,_,a,n,Xe)}(e,t,s,a,n,l);case b:case I:case T:case C:case O:return void function(e,t,s,a,n,r){const _=r.classList,l=r.outerHTML,u=(0,d.gpeByClass)("replies",r,".post");if(u)return;let c="feed_row",p="";e!==C&&e!==b&&e!==I||(c="post");e!==b&&e!==I||(p="#page_search_posts .post");const[m,y,g]=st(r,(e=>{let t;if(e.classList.contains("post"))t=e;else{const s=e.getElementsByClassName("post");if(0===s.length)return[0,0];t=s[0]}if(!t)return[0,0];const s=(t.getAttribute("data-post-id")||"").split("_");return 2===s.length?s:[0,0]}),c,p);if(!m)return;let f=z;const E=(0,d.gpeByClass)("wall_text",r,".post");(E||_.contains("wall_text"))&&(f=X);(_.contains("author")||_.contains("post_img")||_.contains("copy_author")||_.contains("copy_post_img")||_.contains("_copy_post_img")||_.contains("PostHeader__avatar"))&&(f=ce);const A=(0,d.gpeByClass)("PostHeaderSubtitle__link",r,"_post");(_.contains("rel_date")||_.contains("published_by_date")||A)&&(f=X);const P=(0,d.gpeByClass)("like",r,".post"),T=(0,d.gpeByClass)("PostBottomActionContainer",r,"_post");(P||_.contains("like")||T)&&(f=ye);const O=(0,d.gpeByClass)("comment",r,".post");(O||_.contains("comment"))&&(f=ge);const M=(0,d.gpeByClass)("share",r,".post");(M||_.contains("share"))&&(f=fe);_.contains("ui_actions_menu_item")&&-1!==l.indexOf("bookmarkPost")&&(f=Z);_.contains("ui_actions_menu_item")&&-1!==l.indexOf("wall.markAsSpam")&&(f=ve);const S=(0,d.gpeByClass)("PostTextMore",r,"_post");S&&(f=Ee);if(f===z)return;ct(e,Oe,m,f,s,t,g,y,a,n,Xe)}(e,t,s,a,n,l);case K:case R:return void function(e,t,s,a,n,r){const d=r.classList,_=r.tagName,[l,u,c]=st(r,(e=>{let t=e.getAttribute("id");return t=t?t.replace("app",""):0,[0,t]}),"_apps_settings_row");if(!l)return;let p=z;d.contains("apps_settings_stats")&&(p=Ae);"A"!==_&&"img"!==_||(p=X);if(p===z)return;ct(e,Oe,l,p,s,t,c,u,a,n,Xe)}(e,t,s,a,n,l)}}function nt(){const e=window.vk.id;let t={[e]:{}};const s=l.vkLocalStorage.getItem(Ge);if(!s)return t;try{t=JSON.parse(s)}catch(e){t={}}return t&&e&&(t={...t,[e]:{...t[e]}}),t}function rt(e){if("locked"===l.vkLocalStorage.getItem(qe))setTimeout((()=>rt(e)),100);else{l.vkLocalStorage.setItem(qe,"locked");try{e()}catch(e){}l.vkLocalStorage.setItem(qe,"free")}}function dt(e,t,s,a,n,r,d,_,u,c,p=!1,m=0){rt((()=>{const y=window.vk.id;let g=Math.round(+new Date/1e3),f=nt();f[y][e]=f[y][e]||{};const E=Object.keys(f[y][e]);if(E.length>=ze){let t=E[0],s=f[y][e][t][0];E.forEach((a=>{let n=f[y][e][a][0];n<s&&(s=n,t=a)})),delete f[y][e][t]}f[y][e][d]=[g,t,s,a,n,r,_,u,c,p,m],l.vkLocalStorage.setItem(Ge,JSON.stringify(f))}))}function _t(){rt((()=>{let e=nt();if(!e)return;const t=Math.round(+new Date/1e3);Object.keys(e).forEach((s=>{Object.keys(e[s]).forEach((a=>{let n=e[s][a];Object.keys(n).forEach((e=>{let s=n[e][0];t-s>Ye&&delete n[e]})),e[s][a]=n,0===Object.keys(n).length&&delete e[s][a]}))})),l.vkLocalStorage.setItem(Ge,JSON.stringify(e))}))}function lt(e,t,s){const a=window.vk.id;let n=nt();n[a][e]=n[a][e]||{};const r=n[a][e][t];if(!r)return;Math.round(+new Date/1e3)-r[0]>Ye?ut(!0,e,t):ct(r[1],r[2],r[3],s,r[4],r[5],t,r[6],r[7],r[8],Xe,"",r[9],r[10])}function ut(e,t,s){e&&rt((()=>{const e=window.vk.id;let a=nt();a[e][t]=a[e][t]||{},a[e][t][s]&&(delete a[e][t][s],l.vkLocalStorage.setItem(Ge,JSON.stringify(a)))}))}function ct(e,t,s,a,n,r,d,l,u,c,p,m="",y=!1,g=0){if(!s)return;const f=-(new Date).getTimezoneOffset();(0,_.statlogsValueEvent)("search_position",e,p,a,t,s,y,l,d,r,f,n,u,c,m,g)}function pt(){for(let e in p)p.hasOwnProperty(e)&&ht(e)}function ht(e){if(p[e]){const t=p[e];(0,n.removeEvent)(window,"click",t),delete p[e]}}function mt(e,t){const s=t||e.target.getAttribute("data-stats-key");s&&s.length>0&&(0,_.statlogsValueEvent)("submenu_clicks",0,s)}function yt(e,t,s,a,r="0",d=0,l="0",u="",c=Oe,m="",y=!1,g=0,f=null,E=0,A=!1){s=s?1:0,r=r&&"0"!==r?r:gt(),A||function(e,t,s,a,n,r,d,l,u="",c=!1,p=0,m=0,y=0){const g=-(new Date).getTimezoneOffset();(0,_.statlogsValueEvent)("search_attempts",e,c,r,a,g,s,d,n,l,t,u,p,m,y)}(e,c,r,a,l,s,d,u,m,y,g,f,E),p[e]&&ht(e);const P=at.pbind(e,a,r,d,u,y);p[e]=P,(0,n.addEvent)(window,"click",P,!1,!1,!0),cur.destroy||(cur.destroy=[]),cur.destroy.some((e=>e===pt))||cur.destroy.push(pt)}function gt(){return(0,r.rand)(-9223372035,9223372035).toFixed(0).concat((0,r.rand)(0,999999999).toFixed(0))}},856771:(e,t,s)=>{"use strict";s.r(t),s.d(t,{sendMask:()=>I,showNarrative:()=>E,showStory:()=>f,storiesPreloadStatic:()=>P});var a=s(270959),n=s(246429),r=s(102088),d=s(226220),_=s(754866),l=s(194065),u=s(530888),c=s(540462),p=s(319756),m=s(852487);let y=!1,g=!1;function f(e,t={},s=void 0){if(cur.storiesNotSupported)return void(0,a.showFastBox)((0,r.getLang)("global_error"),(0,r.getLang)("stories_bad_browser"));(0,l.trackStoryOpeningStart)({nonce:e,isColdStart:!g,isAnimated:null!=t.fromEl,viewSource:t.source,navigationSource:u.StoryTypeOpen.OPEN_STORY_BY_CLICK});const n=`stories_viewer_loader_${performance.now()}`;let f=!1;clearTimeout(y),y=setTimeout((function(){document.body.appendChild((0,_.ce)("div",{id:"stories_loader",innerHTML:(0,d.getProgressHtml)("stories_loader_pr","pr_baw pr_medium")+'<div class="back"></div>'})),f=!0,(0,l.trackShowViewerLoader)({nonce:n,isColdStart:!g})}),1e3);const E=[window.jsc("web/stories.js"),"stories.css",window.jsc("web/emoji.js"),window.jsc("web/videoview.js"),"videoplayer.css"];(0,c.partConfigEnabled)("web_stories_resource_preload_manager")?Promise.all([(0,p.ensureDIRootWebContainer)().resolve(m.VideoPlayerConfigProvider).ensure({module:"stories"}),window.stManager.add(E)]).then((([a])=>{clearTimeout(y),(0,_.re)("stories_loader"),g=!0,f&&(0,l.trackHideViewerLoader)({nonce:n}),window.Stories.show(e,{...t,vkVideoPlayerConfig:a},s)})):window.stManager.add(E,(function(){clearTimeout(y),(0,_.re)("stories_loader"),g=!0,f&&(0,l.trackHideViewerLoader)({nonce:n}),window.Stories.show(e,t,s)}))}function E(e,t,s=0,a="",n={}){const r=`narrative${t}`;s=s?`_${s}`:"";let d=a.match(/^narrative(-?\d+)_(\d+)(?:_(\d+))?(?:\/([a-z0-9_\-]+))?(?:\/([a-z0-9_:;\-]+))?$/i);if(d){const[,,,,s,n]=d;a=s||(n?`narrative${e}_${t}/${n}`:`narrative${e}_${t}`)}else a=a||`narrative${e}_${t}`;f(a=`${e}${s}&${r}/${a}`,n)}let A=!1;function P(){A||cur.storiesNotSupported||(A=!0,window.stManager.add([window.jsc("web/stories.js"),"stories.css",window.jsc("web/story_publisher.js")]))}let b=!1;function I(e,t,s=!1){b||(b=!0,ajax.post("al_stories.php",{act:"send_mask",mask_id:e,hash:t,is_short_video:s},{loader:!0,onDone:(e,t,s,d)=>{"cant_send"===e?(0,a.showFastBox)({title:t,width:460},s,d):(0,n.showDoneBox)((0,r.getLang)("stories_mask_sent")),b=!1},onFail:()=>(b=!1,(0,a.showFastBox)({title:(0,r.getLang)("global_box_error_title")},(0,r.getLang)("global_unknown_error")),!0)}))}},342879:(e,t,s)=>{"use strict";s.d(t,{destroyAllTooltips:()=>c,hideAllTooltips:()=>u,showHint:()=>l,showTitle:()=>_,showTooltip:()=>d});var a=s(754866),n=s(972332),r=s(593159);function d(e,t){(vk.loaded||t.noload)&&e&&(e.temphide||(e.temphide=function(){e.showing=!1},(0,n.addEvent)(e,"mouseout",e.temphide)),e.showing=!0,"loadingstat"!==e.tt&&(e.tt||(e.tt="loadingstat"),cur.cancelTooltip=!1,t.stat&&window.stManager.add(t.stat),window.stManager.add([window.jsc("web/tooltips.js"),"tooltips.css"],(function(){"loadingstat"===e.tt&&(e.tt=!1),e.showing&&!cur.cancelTooltip&&(!function(e){e.temphide&&((0,n.removeEvent)(e,"mouseout",e.temphide),(0,a.removeAttr)(e,"temphide"),(0,a.removeAttr)(e,"showing"))}(e),e.tt&&e.tt.el&&!t.force||(tooltips.create(e,t),t.onCreate&&t.onCreate()),tooltips.show(e,t))}))))}function _(e,t,s,n){e=(0,a.ge)(e);if(!s){s=[Math.round(20-(0,a.getSize)(e)[0]/2),8]}d(e,(0,r.extend)({text:function(){return t||e.getAttribute("data-title")},shift:s,black:1},n||{}))}function l(e,t){t=t||{};d(e=(0,a.ge)(e),(0,r.extend)({text:function(){return e.getAttribute("data-title")},dir:"auto",width:300,shift:[22,8]},t))}function u(e){tooltips.hideAll(e)}function c(e){tooltips.destroyAll(e)}},449299:(e,t,s)=>{"use strict";s.d(t,{arrayUnique:()=>b,checkTextLength:()=>O,getAct:()=>F,getDropdownValue:()=>x,getSelectionText:()=>M,goAway:()=>S,hashCode:()=>C,isClaimContent:()=>U,isFullScreen:()=>D,lplog:()=>A,onlinePlatformClass:()=>R,parallel:()=>T,parseJSON:()=>g.parseJSON,showErrorBox:()=>B,shuffle:()=>f.shuffle,throttle:()=>I,throttleAccumulate:()=>E,toArray:()=>P,toggleOnline:()=>L,unpackStore:()=>y.unpackStore,updateMoney:()=>k});var a=s(105330),n=s(593159),r=s(396858),d=s(898848),_=s(270959),l=s(754866),u=s(102088),c=s(575753),p=s(576854),m=s(972332),y=s(687903),g=s(261910),f=s(787661);function E(e,t){let s=[],a=0;return function(n){s.push(n),a||(a=setTimeout((()=>{a=!1,e(s),s=[]}),t))}}function A(e,t){let s,a;if(window.__debugMode){switch(t){case"error":s="color: red",a="background: red; color: white";break;case"success":s="color: green",a="background: green; color: white";break;default:s="color: blue;",a="background: #000; color: #fff;"}try{let t=new Date;console.debug(`%cLP:[${t.getHours()}:${t.getMinutes()}:${t.getSeconds()}:${t.getMilliseconds()}]%c ${e}`,a,s)}catch(e){}}}function P(e){let t=[];if(void 0===e.length)return Object.keys(e).map((t=>e[t]));for(let s=0;s<e.length;s++)t.push(e[s]);return t}function b(e){let t={},s=[];for(let a=0;a<e.length;a++)t[e[a]]||(s.push(e[a]),t[s[a]]=1);return s}function I(e,t){let s;return function(){s||(e.apply(this,arguments),s=setTimeout((function(){s=!1}),t))}}function T(){const e=[].slice.call(arguments),t=e.pop(),s=new CallHub(t,e.length);(0,n.each)(e,((e,t)=>t((()=>s.done()))))}function C(e){let t=0;if(0===e.length)return t;for(let s=0,a=e.length;s<a;s++){t=(t<<5)-t+e.charCodeAt(s),t|=0}return t}function O(e,t,s,a,n,r,d,_,c){if(!t)return;const p=t.getValue?t.getValue():t.value,m=t.lastLen||0;if(t.lastLen===p.length&&!r)return;t.lastLen=p.length;const y={"&":5,"<":4,">":4,'"':6,"\n":a?1:4,"\r":0,"!":5,"'":5,$:6,"\\":6},g={1168:1,1169:1,8211:1,8212:1,8216:1,8217:1,8218:1,8230:1,8240:1,8249:1,8250:1,8364:1,8470:1,8482:1,65533:1},f={1037:1,1104:1,1117:1};n&&(y[","]=5);const E=function(e){let t=0;for(let s=0,a=e.length;s<a;s++){const a=c?void 0:y[e.charAt(s)],n=e.charCodeAt(s);t+=void 0!==a?a:!d&&n>=128&&(n<1025||f[n]||n>1119)&&!g[n]&&(n<8220||n>8222)&&(n<8224||n>8226)?("&#"+n+";").length:1}return t}(p);if(s=(0,l.ge)(s),E>Math.max(e-100,.75*e))if((0,l.show)(s),E>e)if(n){const a=(0,l.val)(t,function(e,t){let s=0,a="";for(let n=0,r=e.length;n<r;n++){const r=e.charAt(n),_=c?void 0:y[r],l=e.charCodeAt(n);if(s+=void 0!==_?_:!d&&l>=128&&(l<1025||f[l]||l>1119)&&!g[l]&&(l<8220||l>8222)&&(l<8224||l>8226)?("&#"+l+";").length:1,s>t)break;a+=r}return a}(p,Math.min(e,m)));t.lastLen=a.length,s.innerHTML=(0,u.getLang)("text_N_symbols_remain",0),_&&s.classList.contains(_)&&s.classList.remove(_)}else s.innerHTML=(0,u.getLang)("text_exceeds_symbol_limit",E-e),_&&!s.classList.contains(_)&&s.classList.add(_);else s.innerHTML=(0,u.getLang)("text_N_symbols_remain",e-E),_&&s.classList.contains(_)&&s.classList.remove(_);else(0,l.hide)(s)}function M(){let e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e}function S(e,t,s){if(-1!==(t||{}).h||(0,m.checkEvent)(s))return!0;if(-1!==(t||{}).h){const s=e.match(a.VK_URL_REGEX_STRICT);if(s&&"api."!==s[1].toLowerCase())return location.href=e,!1;const _=(0,n.intval)((0,r.getCookie)("remixsettings_bits"));if(a.VK_URL_REGEX_STRICT.test((0,d.locBase)())||1&_)return window.open("/away.php?to="+encodeURIComponent(e)+(t&&void 0!==t.h?"&h="+t.h:""),"_blank"),!1}const l=(0,n.extend)({act:"a_go",to:e},t||{});return!(0,_.showBox)("away.php",l,{},s)}function D(){return!!(document.fullscreenElement||document.fullScreenElement||document.msFullscreenElement||document.mozFullScreen||document.webkitIsFullScreen||cur.pvPartScreen)}function k(e,t){if(void 0===e||!1===e)return;if("object"==typeof e)return;let s="";!0===t?(vk.balanceEx=e,s="_ex"):vk.balance=e;const a=(0,l.geByClass)("votes_balance_nom"+s);(0,n.each)(a,((t,s)=>s.innerHTML=`${e} ${(0,u.getLang)("votes_flex",e)}`));const r=e*(vk.vcost||7),d=(0,l.geByClass)("money_balance_nom"+s);(0,n.each)(d,((e,t)=>t.innerHTML=(0,u.getLang)("global_money_amount_rub",r,!0))),void 0!==t&&!1!==t&&!0!==t&&k(t,!0),window.GamesCatalog&&window.GamesCatalog.updateMoney(e);const _=document.getElementById("topmenu-balance");_&&(_.textContent=e)}function L(e,t){const s=R(t).split(" "),a=[];["online","mobile","_online"].forEach((function(t){(0,n.inArray)(t,s)&&!(0,l.hasClass)(e,t)?a.push(t):!(0,n.inArray)(t,s)&&(0,l.hasClass)(e,t)&&(0,l.removeClass)(e,t)})),a.length>0&&(0,l.addClass)(e,a.join(" "))}function R(e){let t=" _online";return e&&(t+=" online"),c.mobPlatforms[e]&&(t+=" mobile"),(0,p.updateOnlineText)(),t}function B(e,t){return void 0===t&&(t=1e4),setTimeout((0,_.showFastBox)({title:(0,u.getLang)("global_error")},e).hide,t)}function x(e){let t=(0,l.ge)(e+"_container");if(t||(t=(0,l.ge)(e)),t&&t.dropdown)return t.dropdown.val()}function F(){return window.nav.objLoc.act}function U(){return Boolean(window.nav&&window.nav.objLoc&&window.nav.objLoc.claim)}},432081:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{VideoConstants:()=>VideoConstants,initVideo:()=>initVideo,loadInlineVideo:()=>loadInlineVideo,showInlineVideo:()=>showInlineVideo,showVideo:()=>showVideo});var _shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(636576),_web_lib_date__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(101148),_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(754866),_dom_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(972332),_utils_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(593159),_lang__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(102088),_message_box__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(270959),_layout_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(226220),_web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(672263),_web_video_video_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(826619),_shared_lib_site__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(105330),_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(892848),_shared_video__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(856289),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(540462);const rtrgQuery=`//${(0,_shared_lib_site__WEBPACK_IMPORTED_MODULE_10__.getHostName)()}/rtrg?r=w*Z1Flwi3QdbWaoLMc7zOA*7Cr4Nrtojr9otHjsjIhsb2CVqRWalgbvxZw3MzxZa6be3Siu2XY3gvK5fysYtWLWgNwHMpjRTupSGZrcGRNlj7fduqq9*t7ij6CX4aMcBTD5be8mIXJsbTsvP8Zl2RZEd76a4FTuCOFqzMxqGtFc-`;function showVideo(e,t,s={},a){if(cur.viewAsBox)return cur.viewAsBox();if((0,_dom_events__WEBPACK_IMPORTED_MODULE_3__.checkEvent)(a))return;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_13__.partConfigEnabled)("vk_live_integration")&&s.vkLiveUrl)return void(window.location.href=s.vkLiveUrl);if((0,_web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__.isUnauthorizedMediaLayerBoxAvailable)()&&(a||s.openInPopup)&&!s.forceUnauth&&!cur.is_showcase)return _web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__.Unauthorized.showMoreBox(null,0,_web_unauthorized_unauthorized__WEBPACK_IMPORTED_MODULE_8__.UnauthorizedSourceType.VIDEO,(()=>{showVideo(e,t,{...s,openInPopup:!1,forceUnauth:!0},a)})),!1;if(s.forceUnauth=!0,window.mvcur&&mvcur.mvShown&&mvcur.minimized&&mvcur.videoRaw==e)return s.fromPlayer||Videoview.unminimize(),!1;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_13__.partConfigEnabled)("video_page_notifications_redirect")&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_13__.partConfigEnabled)("video_new_video_page")&&(0,_shared_video__WEBPACK_IMPORTED_MODULE_12__.isVideoStandalone)()&&!s.shortVideo&&void 0!==s.replyId)return void window.nav.go(`/video${e}`);const n=nav.objLoc.claim,r=!(!s.addParams||!/^-?\d+_\d+$/.test(s.addParams.post_id))&&s.addParams.post_id;if(!s.playlistId&&r&&(/^public|groups|profile$/.test(cur.module)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hasClass)("post"+r,"own")?s.playlistId="wall_"+cur.oid:s.playlistId="post_"+s.addParams.post_id),s.playlistId)if(s.addParams=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(s.addParams,{playlist_id:s.playlistId}),window.VideoPlaylist&&VideoPlaylist.getList(s.playlistId))e||(s.addParams.load_playlist=1);else if(/^wall_/.test(s.playlistId)){const e=cur.wallVideos&&cur.wallVideos[s.playlistId];s.addParams.load_playlist=e?.list.length>=50?0:1,s.addParams.show_next=e?.list.length>=1?1:0}else{const e=/^(?:post_)?-?\d+_-?\d+$/.test(s.playlistId)&&!(cur.pageVideosList&&cur.pageVideosList[s.playlistId]);s.addParams.load_playlist=e?1:0,s.addParams.show_next=e?1:0}s.expandPlayer||!cur.videoInlinePlayer||cur.videoInlinePlayer.getVideoId()!=e&&cur.videoInlinePlayer.getProjectId()!=e||!cur.videoInlinePlayer.canExpand()||(s.expandPlayer=cur.videoInlinePlayer),s.expandPlayer&&(s.addParams=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(s.addParams,{expand_player:1}),delete cur.videoInlinePlayer),cur.simple_description&&(s.addParams=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(s.addParams||{},{simple_description:cur.simple_description}));const d=new CallHub((function(){s.hidden?s.hidden(d.data,s,t,e):Videoview.showVideo.apply(Videoview,d.data)}),2);window.stManager.add([window.jsc("web/videoview.js"),"videoview.css",window.jsc("web/page.js"),"page.css"],(()=>{d.failed||(s.hidden||((0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__.revertLastInlineVideo)(),Videoview.show(a,e,t,s)),d.done())})),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(s,{onDone:function(){const t=Array.prototype.slice.call(arguments);t.unshift(e),d.data=t,d.done()},onFail:function(t){if(d.failed=1,!s.hidden){if(window.mvcur&&mvcur.mvShown)window.Videoview.hide();else{const t=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.clone)(nav.objLoc);t.z==="video"+e&&delete t.z,t[0]==="video"+e&&(t[0]="videos"+e.split("_")[0]),nav.setLoc(t)}const s=t&&"object"==typeof t?t?.data:t;if((0,_message_box__WEBPACK_IMPORTED_MODULE_6__.showFastBox)((0,_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_error"),s||(0,_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_error_occured")),window.Videoview?.isMinimized())if(mvcur&&mvcur.fallbackData){const{videoRaw:e,options:t,listId:s,mvData:a}=mvcur.fallbackData;mvcur.videoRaw=e,mvcur.options=t,mvcur.listId=s,mvcur.myData=a,mvcur.fallbackData=null,Videoview.initPlaylistBlock(e,t.playlistId,t.catLoadMore),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.show)("mv_player_box"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hide)("mv_progress_box")}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)("mv_player_box","");d.done()}return!0},cache:"status"!==t}),window.VideoPlaylist&&(window.VideoPlaylist.module=null);let _=s.params;if(!_){const a=s.module||window.Videoview&&window.Videoview.getVideoModule();_={act:"show",video:e,list:t,autoplay:s.autoplay?1:0,ad_video:s.ad_video,module:(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_13__.partConfigEnabled)("video_show_set_module_web")?a??cur?.module??"":a||"",webcast:nav.objLoc.webcast?1:0,screen:nav.objLoc.screen?1:0}}return cur.is_showcase&&!_.context&&cur.ref_context&&(_.context=cur.ref_context),s.addParams&&(_=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(_,s.addParams)),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(_.module)||(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(_,{_nol:JSON.stringify(nav.objLoc)}),_.module&&(window.VideoPlaylist&&(window.VideoPlaylist.module=_.module),s.is_similar&&(_.module+=":similar")),n&&(_.claim=n),ajax.post(`al_video.php?act=${_.act}`,_,s),(0,_web_video_video_utils__WEBPACK_IMPORTED_MODULE_9__.idlizeCall)((()=>{(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.vkImage)().src=`${locProtocol}${rtrgQuery}`})),!1}function showInlineVideo(videoId,listId,options,ev,thumb){if((0,_dom_events__WEBPACK_IMPORTED_MODULE_3__.checkEvent)(ev))return!0;if(options=options||{},window.mvcur&&mvcur.mvShown||options.hasRestriction)return showVideo(videoId,listId,options,ev);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.attr)(thumb,"data-loading"))return!1;let h=thumb.clientHeight,w=thumb.clientWidth;h&&w||!thumb.parentElement||!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_13__.partConfigEnabled)("feed_video_primary_attachment_web_enable")||(h=thumb.parentElement.clientHeight,w=thumb.parentElement.clientWidth);const btn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domByClass)(thumb,"page_post_video_play_inline"),onLoaded=options.onLoaded;onLoaded&&delete options.onLoaded;const params={video:videoId,list:listId,autoplay:options.autoplay,module:options.module};return thumb.className.includes("page_video_croppable")&&(params.with_crop=!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domData)(thumb,"stretch-vertical")&&(params.stretch_vertical=1),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)(params,options.addParams),window.VideoPlaylist&&(window.VideoPlaylist.module=params.module),showProgress(),loadInlineVideo(params,(function(e,t){hideProgress(),e?onDone.apply(null,t):onFail.apply(null,t)}),options.cache),cur.videoInlinePlayerDestroyerSet||(cur.destroy.push(_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__._destroyInlineVideoPlayer),cur.videoInlinePlayerDestroyerSet=1),(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.vkImage)().src=rtrgQuery,!1;function onDone(title,html,js,opts){(0,_web_lib_revertLastInlineVideo__WEBPACK_IMPORTED_MODULE_11__.revertLastInlineVideo)(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.hide)(thumb);const isMt=thumb.dataset.mtId,isDirectMp4=!!thumb.dataset.directMp4,mtAspectRatio=thumb.dataset.mtAspectRatio?Number(thumb.dataset.mtAspectRatio):0,videoWrap=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ce)("div",{innerHTML:html,className:"inline_video_wrap"},{width:w,height:isMt&&mtAspectRatio?Math.round(w*mtAspectRatio):h});if(opts&&opts.mvData&&-195297477!==opts.mvData.authorId&&(window._videoLastInlined=[videoWrap,thumb]),thumb.parentNode.appendChild(videoWrap),cur.mvOpts=!(!opts||!opts.mvData)&&opts.mvData,opts.player){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domByClass)(videoWrap,"video_box_wrap");(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.isFunction)(onLoaded)&&(opts.player.params[0].onPlayerLoaded=onLoaded);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.attr)(thumb,"data-link-attr");if(t&&(opts.player.params[0].link_attr=t),isMt){opts.player.params[0].ad_block_id=isMt;const e=thumb.dataset.mtVideoMp4;e&&(opts.player.params[0].direct_mp4=e);const t=thumb.dataset.mtVideoHls;t&&(opts.player.params[0].hls=t),mtAspectRatio&&(opts.player.params[0].aspect_ratio=mtAspectRatio);const s=thumb.firstChild&&thumb.firstChild.firstChild&&thumb.firstChild.firstChild.src;s&&(opts.player.params[0].jpg=s);const a=thumb.firstChild,n=a.dataset.mtLink,r=a.getAttribute("onclick");n&&(opts.player.params[0].link_attr=`href="${n}" onclick="${r}"`)}isDirectMp4&&(opts.player.params[0].direct_mp4=thumb.dataset.directMp4,opts.player.params[0].hls=void 0,opts.player.params[0].dash_sep=void 0,Object.keys(opts.player.params[0]).forEach((e=>{e.startsWith("url")&&(opts.player.params[0][e]=void 0)}))),VideoInitializer.initPlayer(e,opts.player.type,opts.player.params)}try{eval("(function () {"+js+"})();")}catch(e){}if(!params.from_autoplay){const e=window.Notifier;e&&setTimeout((()=>e.lcSend("video_start")),0);const t=window.ap;t&&t.isPlaying()&&(t.pauseByChangeChannel(),t.pausedByVideo=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.vkNow)())}ev&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.domClosest)("bookmarks_row_type_video",ev.target)&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_0__.statlogsValueEvent)("bookmarks_product_analytics",{item_type:"video",item_owner_id:cur.mvOpts.oid,item_id:cur.mvOpts.vid,time:(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_1__.getServerTime)()}),thumb.setAttribute("data-playing",1)}function onFail(e){params.from_autoplay||(0,_message_box__WEBPACK_IMPORTED_MODULE_6__.showFastBox)((0,_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_error"),e||(0,_lang__WEBPACK_IMPORTED_MODULE_5__.getLang)("global_error_occured"))}function showProgress(){thumb.setAttribute("data-loading",1),options.no_progress||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.addClass)(btn,"page_post_video_play_inline_loading"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(btn,(0,_layout_utils__WEBPACK_IMPORTED_MODULE_7__.getProgressHtml)()))}function hideProgress(){thumb.removeAttribute("data-loading"),options.no_progress||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.removeClass)(btn,"page_post_video_play_inline_loading"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.val)(btn,""))}}function loadInlineVideo(e,t,s){const a=(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.extend)({autoplay:0,module:cur.module},e);(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.trim)(a.module)||(a._nol=JSON.stringify(nav.objLoc));const n=[window.jsc("web/videoview.js"),"videoview.css"];function r(e,s){(0,_utils_common__WEBPACK_IMPORTED_MODULE_4__.isFunction)(t)&&t(e,s)}a.from_autoplay&&n.push("videoplayer.css"),ajax.post("al_video.php?act=video_box",a,{onDone:function(){r(!0,[].slice.call(arguments))},onFail:function(){return r(!1,[].slice.call(arguments)),!0},stat:n,local:1,cache:s})}const VideoConstants={VIDEO_ITEM_INDEX_OWNER_ID:0,VIDEO_ITEM_INDEX_ID:1,VIDEO_ITEM_INDEX_THUMB:2,VIDEO_ITEM_INDEX_TITLE:3,VIDEO_ITEM_INDEX_FLAGS:4,VIDEO_ITEM_INDEX_DURATION:5,VIDEO_ITEM_INDEX_HASH:6,VIDEO_ITEM_INDEX_OWNER:8,VIDEO_ITEM_INDEX_DATE:9,VIDEO_ITEM_INDEX_VIEWS:10,VIDEO_ITEM_INDEX_PLATFORM:11,VIDEO_ITEM_INDEX_BLOCKED:12,VIDEO_ITEM_INDEX_MUSIC_VIDEO_META:13,VIDEO_ITEM_INDEX_ARIA:14,VIDEO_ITEM_INDEX_RESTRICTION_BLOCK:15,VIDEO_ITEM_INDEX_RESTRICTION_CLASSES:16,VIDEO_ITEM_INDEX_ADMIN_INFO:17,VIDEO_ITEM_INDEX_CARD_MENU_TOGGLE:18,VIDEO_ITEM_INDEX_RAW_DURATION:19,VIDEO_ITEM_INDEX_LINK:20,VIDEO_ITEM_INDEX_TRAILER:21,VIDEO_ITEM_INDEX_VIEWED_DURATION:22,VIDEO_ITEM_INDEX_VIEWED_DAY:23,VIDEO_ITEM_INDEX_LIST_ID:24,VIDEO_ITEM_INDEX_PLAYLIST_ID:25,VIDEO_ITEM_INDEX_CARD_ACTIONS:26,VIDEO_ITEM_INDEX_CARD_PRIVACY_ICONS:27,VIDEO_ITEM_INDEX_SMALL_THUMB:28,VIDEO_ITEM_INDEX_ML_THUMB_ID:29,VIDEO_ITEM_INDEX_PLAY_FROM:30,VIDEO_ITEM_INDEX_RECOMMENDATION_SOURCES:31,VIDEO_ITEM_INDEX_RECOMMENDATION_USERS:32,VIDEO_ITEM_TRACK_CODE:33,VIDEO_ITEM_INDEX_SUBTITLE_PLACE:34,VIDEO_ITEM_INDEX_AVATAR_IMAGE:35,VIDEO_ITEM_INDEX_AVATAR_PLACE:36,VIDEO_ITEM_INDEX_DESCRIPTON:37,VIDEO_ITEM_INDEX_DOWNLOAD_URL:38,VIDEO_ITEM_INDEX_OWNER_HREF:39,VIDEO_ITEM_PUBLISH_DATE:40,VIDEO_ITEM_BOOKMARKED:41,VIDEO_ITEM_BOOKMARK_HASH:42,VIDEO_ITEM_INDEX_UPCOMING_LIVE_DATE:43,VIDEO_ITEM_INDEX_INTERACTIVE:44,VIDEO_ITEM_INDEX_LABEL_PLACE:45,VIDEO_ITEM_INDEX_VK_LIVE_CHANNEL_URL:46,VIDEO_ITEM_INDEX_VK_LIVE_CHANNEL_NAME:47,VIDEO_ITEM_INDEX_CLICK_EVENT:48,VIDEO_ITEM_INDEX_SHOULD_OPEN_MODAL:49,VIDEO_TEMPLATE_INDEX_SUBTITLE_DURATION_WITH_VIEWS:0,VIDEO_TEMPLATE_INDEX_SUBTITLE_LABEL:1,VIDEO_TEMPLATE_INDEX_SUBTITLE_SCHEDULED:2,VIDEO_TEMPLATE_INDEX_SUBTITLE_UPCOMING_LIVE:3,VIDEO_ITEM_FLAG_EXTERNAL:1,VIDEO_ITEM_FLAG_ACTIVE_LIVE:2,VIDEO_ITEM_FLAG_CAN_DOWNLOAD:32,VIDEO_ITEM_FLAG_CAN_EDIT:64,VIDEO_ITEM_FLAG_CAN_DELETE:128,VIDEO_ITEM_FLAG_CAN_ADD:256,VIDEO_ITEM_FLAG_PRIVATE:512,VIDEO_ITEM_FLAG_NO_AUTOPLAY:1024,VIDEO_ITEM_FLAG_ADDED:2048,VIDEO_ITEM_FLAG_SKIP_THUMB_LOAD:4096,VIDEO_ITEM_FLAG_NEED_SIGN_IN:8192,VIDEO_ITEM_FLAG_HD:16384,VIDEO_ITEM_FLAG_DELETED:32768,VIDEO_ITEM_FLAG_CAN_MOVE:65536,VIDEO_ITEM_FLAG_CAN_DELETE_FROM_HISTORY:1<<17,VIDEO_ITEM_FLAG_PRIVATE_BY_LINK:1<<18,VIDEO_ITEM_FLAG_LIVE:1<<19,VIDEO_ITEM_FLAG_PRIVATE_NOT_PUBLISHED:1<<20,VIDEO_ITEM_FLAG_PRIVATE_MEMBERS:1<<21,VIDEO_ITEM_FLAG_HORIZONTAL:1<<22,VIDEO_ITEM_FLAG_NFT_AVATAR:1<<23,VIDEO_ITEM_FLAG_SCHEDULED:1<<24,VIDEO_ITEM_FLAG_CAN_BOOKMARK:1<<25,VIDEO_ITEM_FLAG_BOOKMARKED:1<<26,VIDEO_ITEM_FLAG_UPCOMING_LIVE:1<<27,VIDEO_ITEM_FLAG_INTERACTIVE:1<<28,VIDEO_ITEM_FLAG_MUSIC_VIDEO:1<<29};function initVideo(){window._videoLastInlined=!1}},664822:(e,t,s)=>{"use strict";s.d(t,{AppOrderBox:()=>p});var a=s(754866),n=s(866467),r=s(593159),d=s(246429),_=s(683234),l=s(270959),u=s(449299),c=s(196829);class p{static instantSkipAppOrder(e,t){const s=(0,a.gpeByClass)("payments_instant_progress_wrap",e);let n={act:"a_order",aid:cur.paymentsOrderAppId,order_id:cur.paymentsOrderId,votes:cur.paymentsPreferVotes,test_mode:cur.paymentsOrderTestMode,_skip_instant:t||1,hash:cur.paymentsOrderHash};void 0!==cur.checkedMaxVotes&&(n.checked_max_votes=cur.checkedMaxVotes),ajax.post("al_apps.php",n,{forceDone:1,onDone:()=>{cur.paymentsCheckOrderCnt=1,(0,d.curBox)().hide(),cur.paymentsCheckOrderCnt=0,cur.fromInstantPay=!0},showProgress:()=>s&&s.classList.add("loading"),hideProgress:()=>s&&s.classList.remove("loading")})}static processOrder(e,t){t||(t=(0,d.curBox)());const s=(0,a.isVisible)("payments_box")?2:0;let r=!1;e||(e=s),s&&(r=t.btns.ok[0],(0,_.lockButton)(r));let m={act:"a_order",aid:cur.paymentsOrderAppId,order_id:cur.paymentsOrderId,votes:cur.paymentsPreferVotes,from:nav.objLoc[0],test_mode:cur.paymentsOrderTestMode,_votes_ok:e,hash:cur.paymentsOrderHash};1==e&&cur.paymentsOrderBillPeriod&&(m.payment_type=cur.votesType),!cur.paymentsOrderBillPeriod&&(0,a.ge)("payments_order_auto_confirm")&&(m.auto_confirm=(0,_.isChecked)("payments_order_auto_confirm")),ajax.post("al_apps.php",m,{forceDone:3==+e?1:0,onDone:(m,y,g,f,E)=>{if(f&&-1e3!==f&&(cur.votesBoxOptions=f),3==e&&-1e3==g)return c.Gifts.processBoxOptions((0,d.curBox)(),f),cur.paymentsCheckOrderCnt=1,t.hide(),void(cur.paymentsCheckOrderCnt=0);if(0===g||g>0)return cur.paymentsPreferVotes=1,s?cur.paymentsShowBoxError(y):(t.hide(),(0,l.showFastBox)((0,n.getLang)("global_error"),y)),void((cur.paymentsOrderBillPeriod||E)&&cur.onSubscriptionFail?cur.onSubscriptionFail(g):cur.onAppOrderFail&&cur.onAppOrderFail(g));if(m.result){let e=(0,d.curBox)();return cur.isPaymentsAppOrder=!1,e&&e.hide(),(0,d.showDoneBox)(y),m.balance&&(0,u.updateMoney)(m.balance),void(cur.onSubscriptionDone&&m.subscriptionStatus&&(cur.onSubscriptionDone(m.subscriptionStatus),cur.onSubscriptionDone=!1))}const A=m.orderId;if(!A)return void(cur.paymentGetOrderItemTO=setTimeout(p.processOrder.pbind(!1,t),1e3));y&&(t=(0,l.showFastBox)("",y)).setOptions({title:!1,width:520,bodyStyle:"padding: 0;",hideButtons:!0}),r&&(0,_.unlockButton)(r),cur.isPaymentsAppOrder=!1,cur.paymentsOrderId=A,m.subscriptionId&&(cur.paymentsSubscriptionId=m.subscriptionId),cur.paymentsOrderCheckHash=m.checkHash;const P=(0,n.getLang)("payments_waiting_app_order_complete");(0,a.ge)("payments_box_progress_msg_wrap")?((0,a.val)("payments_box_progress_msg_wrap",`<span id="payments_box_progress_msg">${P}</span>`),cur.paymentsShowProgress()):(0,a.val)("apps_paymentbox_progress_msg_wrap",P),cur.paymentsCheckOrderCnt=0,cur.paymentsCheckOrderInt=setInterval(p.checkOrder,2e3)},onFail:function(e){return!e||(cur.onSubscriptionFail?cur.onSubscriptionFail():cur.onAppOrderFail&&cur.onAppOrderFail(),(0,a.isVisible)("payments_box")?cur.paymentsShowBoxError(e):(t.hide(),(0,l.showFastBox)((0,n.getLang)("global_error"),e)),!0)}})}static checkOrder(){if(15==cur.paymentsCheckOrderCnt)(0,a.ge)("payments_box_progress_msg").innerHTML=(0,n.getLang)("payments_waiting_payment_complete_still");else if(cur.paymentsCheckOrderCnt>30)return clearInterval(cur.paymentsCheckOrderInt),(0,d.curBox)().hide(),void(0,l.showFastBox)((0,n.getLang)("payments_app_order_box_title"),(0,n.getLang)("payments_app_add_votes_delay"),(0,n.getLang)("global_close"),(()=>{cur.paymentsOrderBillPeriod&&cur.onSubscriptionCancel?cur.onSubscriptionCancel():cur.onAppOrderCancel&&cur.onAppOrderCancel(),(0,d.curBox)().hide()}));cur.paymentsCheckOrderCnt++,ajax.post("al_apps.php",{act:"a_check_order",aid:cur.paymentsOrderAppId,order_id:cur.paymentsOrderId,test_mode:cur.paymentsOrderTestMode,from:nav.objLoc[0],hash:cur.paymentsOrderCheckHash},{onDone:(e,t,s,a,n)=>{e&&((0,d.curBox)()&&(0,d.curBox)().hide(),clearInterval(cur.paymentsCheckOrderInt),cur.paymentsCheckOrderCnt=0,(0,d.showDoneBox)(t,{out:1e3}),s&&(0,u.updateMoney)(s),1==e?(cur.paymentsOrderBillPeriod&&cur.onSubscriptionSuccess?(cur.onSubscriptionSuccess(cur.paymentsSubscriptionId),TopNotifier&&TopNotifier.invalidate()):cur.onAppOrderSuccess&&cur.onAppOrderSuccess(cur.paymentsOrderId),cur.onSubscriptionDone&&n&&(cur.onSubscriptionDone(n),cur.onSubscriptionDone=!1)):cur.paymentsOrderBillPeriod&&cur.onSubscriptionFail?cur.onSubscriptionFail(a):cur.onAppOrderFail&&cur.onAppOrderFail(a))},onFail:function(e){return clearInterval(cur.paymentsCheckOrderInt),cur.paymentsShowBoxError(e),!0}})}static initialize(e,t,s,a,n,d,_){(0,r.extend)(cur,{isPaymentsAppOrder:!0,paymentsAuthPayment:!1,paymentsOrderNotice:!1,paymentsOrderId:e,paymentsOrderAppId:t,paymentsOrderTestMode:s,paymentsOrderHash:a,paymentsPreferVotes:n,paymentsOrderDiscount:d,paymentsOrderBillPeriod:_})}}},641608:(e,t,s)=>{"use strict";s.d(t,{MoneyTransfer:()=>U});var a=s(683234),n=s(575753),r=s(191468),d=s(898848),_=s(749284),l=s(972332),u=s(246429),c=s(270959),p=s(754866),m=s(560377),y=s(449299),g=s(593159),f=s(237625),E=s(636576),A=s(866467),P=s(126645),b=s.n(P),I=s(584427),T=s(150681),C=s(338329),O=s(342879),M=s(443291),S=s(105330),D=s(952661),k=s(810068),L=s(377803),R=s(428374);const B=1,x=2,F=-1,U={initHandlers(){(0,C.tq)().setInteractiveHandler("MoneyTransfer/receive_method_change",(e=>{const t=e.payload.event.target;if((0,p.hasClass)(t,"disabled"))return;const{value:s,name:a}=e.payload.dataAttrs;U.onReceiveMethodChange(t,s,a)})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/in_chat_focus_amount",(()=>{(0,p.elfocus)("transfer_amount")})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/check_user_message",(()=>{U.checkUserMessage()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/show_hint",(e=>{(0,O.showHint)(e.payload.event.target)})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/send",(e=>{U.send(Boolean(e.payload.dataAttrs.newWindow))})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/check_participate",(e=>{(0,a.checkbox)(e.payload.event.target),U.checkRequestParticipate()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/check",(e=>{(0,a.checkbox)(e.payload.event.target)})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/check_auto_accept",(e=>{(0,a.checkbox)(e.payload.event.target),U.checkAutoAccept()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/about",(e=>{U.aboutBox(e.payload.dataAttrs.aboutKey)})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/history",(()=>{U.historyBox()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/hide_pin_box",(()=>{U.hidePinBox()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/check_vk_pay_offer",(()=>{U.checkVkPayOfferBox()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/clean_amount",(e=>{U.cleanAmount(e.payload.event.target,e.payload.event,Boolean(e.payload.dataAttrs.onlyClean))})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/send_amount_on_enter",(e=>{13===e.payload.event.keyCode&&U.send(),U.autosizeAmount()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/focus_from_to",(e=>{(0,p.elfocus)(e.payload.event,0,1e4)})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/focus_and_hide_link",(e=>{(0,p.elfocus)(e.payload.event,0,1e4),U.hideLinkCopied()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/copy_link",(e=>{U.copyLinkToClipboard((0,p.ge)(e.payload.dataAttrs.element))})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/share_qr",(()=>{U.shareQRCode()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/download_qr",(()=>{U.downloadQRCode()})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/switch_to_transfer_box",(e=>{U.switchBoxSection(e.payload.event.target,"transfer")})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/switch_to_request_box",(e=>{U.switchBoxSection(e.payload.event.target,"request")})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/switch_to_link_box",(e=>{U.switchBoxSection(e.payload.event.target,"link")})),(0,C.tq)().setInteractiveHandler("MoneyTransfer/init_accept",(()=>{U.initAccept(cur.paymentsOptions.chkData,cur.paymentsOptions.frame,!0)}))},init(){this.initHandlers();const e=(0,u.curBox)();if((0,p.ge)("payments_box")!=(0,p.geByClass1)("payments_money_transfer_box",e.bodyNode)&&_message_boxes.length>1){let e=!0;_message_boxes.forEach((function(t,s){e&&(0,p.ge)("payments_box")==(0,p.geByClass1)("payments_money_transfer_box",t.bodyNode)&&(boxLayer.removeChild((0,p.gpeByClass)("popup_box_container",t.bodyNode)),boxQueue._boxes.splice(s,1),delete _message_boxes[s],e=!1)}))}if(cur.moneyLinksTooltip&&(cur.moneyLinksTooltip.destroy(),delete cur.moneyLinksTooltip),e.setOptions({grey:!0}),cur.paymentsOptions.requestId&&!cur.paymentsOptions.vkpayAvailable&&(e.changed=!0,e.setOptions({width:510}),U.send()),(0,_.placeholderInit)("transfer_amount"),(0,_.placeholderInit)("transfer_comment"),cur.paymentsOptions.isChat){if((0,_.placeholderInit)("transfer_chunk_amount"),cur.autoacceptCardDD=new R.InlineDropdown("transfer_autoaccept_card",{items:cur.paymentsOptions.cards,selected:cur.paymentsOptions.cardSeleceted,withArrow:!0,onShow:U.enableAutoaccept,onSelect:e=>{-1==e?U.sendBind():cur.paymentsOptions.vkpayAvailable&&U.checkAmount((0,p.val)("transfer_amount"))}}),cur.autoacceptCardEl=(0,p.ge)("transfer_autoaccept_card"),(0,p.toggleClass)("transfer_autoaccept_card","disabled",!cur.paymentsOptions.autoAcceptEnabled),cur.paymentsOptions.autoAcceptEnabled&&(0,a.checkbox)("transfer_autoaccept",!0),cur.paymentsOptions.cards.length<2){let e=(0,p.ce)("a",{id:"payments_money_transfer_new_card_lnk",innerHTML:(0,A.getLang)("payments_money_transfer_new_card")});(0,l.addEvent)(e,"mousedown",U.sendBind),(0,p.hide)(cur.autoacceptCardEl),cur.autoacceptCardEl.parentNode.appendChild(e)}}else if((0,p.ge)("transfer_to")){(0,p.hide)("payments_money_transfer_user");let e="transfer"===cur.paymentsOptions.boxTab;cur.uiTransferTo=new Dropdown((0,p.ge)("transfer_to"),cur.paymentsOptions.friends.filter((function(t){return e||!0===t[7]})),{big:!0,introText:(0,A.getLang)("votes_transfer_start_typing_recipient"),noResult:"",placeholder:(0,A.getLang)("votes_transfer_choose_recipients"),multiselect:!1,enableCustom:!0,autocomplete:!0,imageId:"transfer_to_photo",indexkeys:[1,4],noImageSrc:"/images/blank.gif",onChange:e=>{if(!e||-1==e)return;const t=cur.uiTransferTo.val_full();cur.paymentsOptions.toId=t[0],cur.paymentsOptions.hash=t[5],(0,p.val)("payments_money_transfer_summary",t[6]),setTimeout(p.elfocus.pbind("transfer_amount"),100),cur.paymentsOptions.vkpayAvailable&&U.updateMethods()}})}else(0,p.ge)("transfer_method")&&U.initMethods();setTimeout(p.elfocus.pbind("transfer_amount"),100),(0,r.shortCurrency)(),"link"===cur.paymentsOptions.boxTab&&U.genQRCode();let t=(0,p.val)("transfer_amount");t&&U.checkAmount(t,!1,!0),U.autosizeAmount(),U.showMoneyLinksTooltip(),cur.transferPageLoaded=!1,cur.destroy.push(U.destroy)},destroy(){U.stopCheckFrameLoad(),cur.uiTransferTo&&cur.uiTransferTo.destroy(cur.uiTransferTo),cur.qrFrame&&(0,p.re)(cur.qrFrame)},initMethods(){cur.paymentsOptions.onlyCards=!(0,p.isVisible)("payments_money_transfer_receive_methods");let e=cur.paymentsOptions.cardSelected;if([x,B].includes(parseInt(cur.paymentsOptions.forceType)))for(const[t]of cur.paymentsOptions.cards)t===F&&(e=F);if(cur.uiTransferCard=new Dropdown((0,p.ge)("transfer_method"),cur.paymentsOptions.cards,{big:!0,selectedItems:e,onChange:(e,t)=>{if(-2===parseInt(e)){const e=(0,p.se)(t);nav.go(e.getAttribute("data-url"));const s=document.querySelector("#payments_money_transfer_send");return D.FlatButton.lock(s),!1}U.updateTransferType(),U.updateCardFee(!0),(0,p.val)("transfer_amount")||setTimeout(p.elfocus.pbind("transfer_amount"),100)}}),!cur.paymentsOptions.onlyCards){(0,p.geByClass1)("payments_money_transfer_receive_options","payments_money_transfer_receive_methods")&&(window.radioBtns.receiveOptions={els:Array.prototype.slice.apply((0,p.geByClass)("radiobtn")),val:e==F?"vkpay":"cards"})}if(void 0!==cur.paymentsOptions.vkpayBalance&&((0,g.each)((0,p.geByClass)("_code","payments_money_transfer_code_wrap"),(function(){(0,l.addEvent)(this,"mousedown",U.onPinClick),(0,l.addEvent)(this,"keyup",U.onPinKeyUp),(0,l.addEvent)(this,"keypress",U.onPinEnter)})),U.isVKPayFillUpEnabled())){const e=U.getBindCards();e.length>0&&(cur.uiFillUpCard=new Dropdown((0,p.ge)("fill_up_card"),e,{big:!0,selectedItems:cur.paymentsOptions.fillUpCardSelected}))}const t=!cur.paymentsOptions.transferType||cur.paymentsOptions.forceType;t&&U.updateTransferType(),U.updateCardFee(!t)},updateLocalStorageNewWindowSign(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()+20+20*Math.random());return localStorage.setItem("money_transfer_new_window",t.getTime()),t},getLocalStorageNewWindowSign(){let e=parseInt(localStorage.getItem("money_transfer_new_window")??0);if(1===e)e=U.updateLocalStorageNewWindowSign().getTime();else if(0===e)return!1;return e>(new Date).getTime()},updateMethods(){const e=cur.paymentsOptions.toId;if(!e||!cur.paymentsOptions.vkpayAvailable||!k.Ranges.isUserIdTransitional(e)&&!k.Ranges.isChatOrChannelPeer(e))return;const t=document.querySelector("#payments_money_transfer_send");(0,p.val)("payments_box_error",""),cur.moneyTranferMethodsReq&&(cur.moneyTranferMethodsReq.abort(),cur.moneyTranferMethodsReq=null),"request"!==cur.paymentsOptions?.boxTab&&(cur.moneyTranferMethodsReq=ajax.post("al_payments.php?act=a_get_money_transfer_methods",{to_id:e},{onDone:(e,s)=>{D.FlatButton.unlock(t),(0,p.val)("payments_money_transfer_methods",e),cur.paymentsOptions=(0,g.extend)(cur.paymentsOptions,s),cur.paymentsOptions.transferType=s.transferType,U.initMethods()},onFail:e=>(e&&(0,d.isString)(e)&&(D.FlatButton.unlock(t),U.showError(e)),!0),showProgress:()=>D.FlatButton.lock(t)}))},send(e=!1,t=!1){const s=(0,u.curBox)(),n=document.querySelector("#payments_money_transfer_send");if(D.FlatButton.isLocked(n))return;if(!cur.paymentsOptions.toId&&cur.uiTransferTo)return void(0,a.notaBene)(cur.uiTransferTo.container);let r=0;if(U.resetTransferWindow(),!(0,p.isVisible)("payments_money_transfer_no_amount_wrap")){if(r=(0,p.val)("transfer_amount"),!r||r<=0)return(0,p.addClass)("payments_money_transfer_amount_wrap","money_error"),setTimeout(p.removeClass.pbind("payments_money_transfer_amount_wrap","money_error"),500),void(0,p.elfocus)("transfer_amount");if(!U.checkAmount(r,!0))return;if((0,a.isChecked)("transfer_participate")){r-=U.getChunkAmount(r,!0)}}if(U.hideMoneyLinksTooltip(),cur.paymentsOptions.onSendStart&&cur.paymentsOptions.onSendStart(),"request"===cur.paymentsOptions.boxTab)return void U.sendRequest(r);U.createFrame();let d={act:"a_init_money_transfer",to_id:cur.paymentsOptions.toId,owner_id:cur.paymentsOptions.ownerId,amount:r,currency:cur.paymentsOptions.currency,comment:(0,p.val)("transfer_comment"),from:cur.paymentsOptions.from,hash:cur.paymentsOptions.hash,accept_vk_pay_offer:cur.paymentsOptions.shouldAcceptVkPayOffer};if(cur.paymentsOptions.vkpayAvailable&&(d.card_id=cur.uiTransferCard.val(),cur.paymentsOptions.onlyCards||(d.receive_method=(0,a.radioval)("receiveOptions")),"-1"===d.card_id)){if(!t)return void U.showPinBox();d.vkpay_pin=t}if(U.isVKPayTransfer()&&U.isVKPayFillUpEnabled()&&U.isFillUpCardSelectionVisible()&&(d.fill_up_card_id=cur.uiFillUpCard.val()),cur.paymentsOptions.requestId&&(d.request_id=cur.paymentsOptions.requestId),cur.paymentsOptions.statSessionId&&(d.stat_session_id=cur.paymentsOptions.statSessionId),(0,p.val)("payments_box_error",""),e||!localStorage||this.isVKPayTransfer()||"-1"===d.card_id||(e=U.getLocalStorageNewWindowSign()),e){cur.paymentsOptions.qid&&(d.act="a_continue_money_transfer",d.qid=cur.paymentsOptions.qid),cur.transferWindow=window.open("","Money Transfer");let e=I.PaymentsBox.popupHtml((0,A.getLang)("payments_cards_redirect"),"","");cur.transferWindow.document.write(e)}ajax.post("al_payments.php",d,{onDone:(t,n)=>{if(n)if(cur.paymentsOptions.qid=t.qid,e)cur.transferWindow?U.updateTransferWindow(n):U.showError((0,A.getLang)("payments_payment_cancelled"),"info_msg");else{let e;cur._popup_text=n,cur._popup_callback=function(){(0,p.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_money_transfer_prg","payments_iframe_cookie_disabled_div"),(0,p.show)("payments_money_transfer_iframe","payments_iframe_container"),cur.uiTransferTo&&((0,p.hide)("payments_money_transfer_user_select"),(0,p.show)("payments_money_transfer_user")),(0,p.ge)("payments_iframe_container").scrollTop=0,window.addEventListener("message",U.frameMessage,!1),s.changed=!0,s.setOptions({width:510}),!cur.paymentsOptions.requestId&&(0,p.isVisible)(s.titleWrap)&&s.setBackTitle(U.resetSendBox),(0,p.setStyle)(e,{width:(0,p.ge)("payments_iframe_container").parentNode.offsetWidth-(0,a.sbWidth)()+"px"})},e=(0,p.ge)("transfer_iframe"),e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(n),e.contentWindow.document.close(),cur._popup_callback(),U.startCheckFrameLoad(+new Date)}else cur.paymentsOptions.receiptRedesign&&window.addEventListener("message",U.frameMessage,!1),(0,p.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_iframe_container",(0,p.geByClass1)("payments_money_transfer_mc_info_msg","payments_money_transfer_iframe")),cur.uiTransferTo&&((0,p.hide)("payments_money_transfer_user_select"),(0,p.show)("payments_money_transfer_user")),(0,p.show)("payments_money_transfer_iframe","payments_money_transfer_prg");U.startCheckStatus(t,e)},onFail:e=>(U.resetTransferWindow(),U.showError(e),!0),showProgress:()=>D.FlatButton.lock(n),hideProgress:()=>D.FlatButton.unlock(n)})},sendRequest(e){let t=document.querySelector("#payments_money_transfer_send"),s={to_id:cur.paymentsOptions.toId,owner_id:cur.paymentsOptions.ownerId,amount:e,currency:cur.paymentsOptions.currency,comment:(0,p.val)("transfer_comment"),from:cur.paymentsOptions.from,hash:cur.paymentsOptions.hash};if(cur.paymentsOptions.statSessionId&&(s.stat_session_id=cur.paymentsOptions.statSessionId),cur.paymentsOptions.isChat){if(s.total_amount=parseInt(e),s.amount=parseInt((0,p.val)("transfer_chunk_amount")),s.pin_message=(0,a.isChecked)("transfer_pin_message")?1:0,(0,a.isChecked)("transfer_autoaccept")&&(cur.autoacceptCardDD&&(s.accept_card=cur.autoacceptCardDD.val()),!s.accept_card||-1==s.accept_card))return U.showError((0,A.getLang)("payments_money_request_error_no_accept_card")),!1;let t=!1;const n=U.getTransferLimit("minAmount"),r=U.getTransferLimit("maxAmount");if(n&&s.amount<n?t=(0,A.getLang)("payments_money_request_error_min_chunk_amount_currency"):r&&s.amount>r?t=(0,A.getLang)("payments_money_request_error_max_chunk_amount_currency"):s.total_amount&&s.amount>s.total_amount&&(t=(0,A.getLang)("payments_money_request_error_chunk_amount_too_big")),t)return U.showError(t),(0,a.notaBene)("transfer_chunk_amount"),!1}(0,p.val)("payments_box_error",""),ajax.post("al_payments.php?act=a_send_money_request",s,{onDone:e=>{(0,u.curBox)().hide(),(0,u.showDoneBox)(e,{out:6e3})},onFail:e=>(U.showError(e),!0),showProgress:()=>D.FlatButton.lock(t),hideProgress:()=>D.FlatButton.unlock(t)})},sendBind(){const e=(0,u.curBox)();U.createFrame(),(0,p.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_money_transfer_summary_wrap","payments_iframe_container",(0,p.geByClass1)("msg","payments_money_transfer_iframe"),(0,p.geByClass1)("tb_tabs_wrap",e.bodyNode)),(0,p.show)("payments_money_transfer_iframe","payments_money_transfer_prg"),e.setBackTitle(U.resetSendBox),e.setOptions({width:510});const t={type:"card",only_auth:1,hash:cur.paymentsOptions.bindHash};(0,p.val)("payments_box_error",""),ajax.post("al_payments.php?act=a_getvotes_charge",t,{onDone:(t,s)=>{let n;cur._popup_text=s,cur._popup_callback=function(){(0,p.hide)("payments_money_transfer_prg"),(0,p.show)("payments_iframe_container"),(0,p.ge)("payments_iframe_container").scrollTop=0,window.addEventListener("message",U.frameMessage,!1),cur.autoacceptCardDD&&(0,p.isVisible)(cur.autoacceptCardEl)&&cur.autoacceptCardDD.select(cur.paymentsOptions.cards[0][0]),e.changed=!0,(0,p.setStyle)(n,{width:(0,p.ge)("payments_iframe_container").parentNode.offsetWidth-(0,a.sbWidth)()+"px"})},n=(0,p.ge)("transfer_iframe"),n.contentWindow.document.open("text/html","replace"),n.contentWindow.document.write(s),n.contentWindow.document.close(),cur._popup_callback(),cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.moneyTranferCheckInt=setInterval((function(){U.checkBindStatus(t),(cur.isPaymentCanceled||cur.isPaymentFailed)&&(clearInterval(cur.moneyTranferCheckInt),cur.isPaymentFailed?U.showError((0,A.getLang)("payments_landing_cancelled")):U.showError((0,A.getLang)("payments_payment_cancelled"),"info_msg"))}),2e3)},onFail:e=>(U.showError(e),!0)})},createFrame(){let e=(0,p.ge)("payments_iframe_container"),t=(0,p.ce)("iframe",{id:"transfer_iframe",name:"transfer_iframe"},{border:0,height:"445px",width:510-(0,a.sbWidth)()+"px",overflowX:"hidden",overflowY:"hidden"});t.frameBorder=0,e.innerHTML="",e.appendChild(t)},popupWrite(e){if(e.document.innerHTML!==cur._popup_text){e.document.write(cur._popup_text),e.document.close();try{e.document.charset="windows-1251"}catch(e){}e.blur(),e.focus(),cur._popup_callback&&cur._popup_callback()}},resetSendBox(){const e=(0,u.curBox)();if(!e)return;const t=(0,p.geByClass1)("tb_tabs_wrap",e.bodyNode);(0,p.hide)("payments_money_transfer_iframe"),(0,p.show)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_money_transfer_summary_wrap",t,(0,p.geByClass1)("payments_money_transfer_mc_info_msg","payments_money_transfer_iframe")),cur.uiTransferTo&&((0,p.hide)("payments_money_transfer_user"),(0,p.show)("payments_money_transfer_user_select")),t&&e.setOptions({title:""}),e.changed=!1,e.setOptions({width:510}),(0,p.isVisible)(e.titleWrap)&&e.setBackTitle(!1)},resetTransferWindow(){cur.transferWindow&&((0,p.show)("payments_money_transfer_wrap","payments_money_transfer_buttons"),(0,p.hide)("payments_money_transfer_prg","payments_money_transfer_iframe"),cur.transferWindow.location=window.location,cur.transferWindow.close()),cur.transferWindow=void 0},updateTransferWindow(e){const t=cur.transferWindow.document.getElementById("wait_text_container");t&&(t.innerHTML=""),cur.transferWindow.document.write(e),setTimeout((()=>{cur.transferWindow.document.getElementById("popup_payment_form")?.submit()}),1500),window.addEventListener("message",U.frameMessage,!1),(0,p.hide)("payments_money_transfer_wrap","payments_money_transfer_buttons","payments_box_error","payments_iframe_safari_trouble_div","payments_iframe_container"),(0,p.val)("payments_transfer_box_progress_msg",(0,A.getLang)("payments_waiting_transfer_complete")),(0,p.show)("payments_money_transfer_iframe","payments_money_transfer_prg")},startCheckStatus(e,t=!1){cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.moneyTransferRedirected=!1,cur.moneyTranferCheckInt&&clearInterval(cur.moneyTranferCheckInt),cur.moneyTranferCheckInt=setInterval((function(){if(U.checkStatus(e,t),cur.isPaymentCanceled||cur.isPaymentFailed){let t=U.resetTransferWindow();if(t&&t(),clearInterval(cur.moneyTranferCheckInt),e.accept)return void(0,u.curBox)().hide();cur.isPaymentFailed?U.showError((0,A.getLang)("payments_landing_cancelled")):U.showError((0,A.getLang)("payments_payment_cancelled"),"info_msg")}}),2e3)},hideBoxQueue(){for(;boxQueue.count();)boxQueue.hideLast(!1)},stopListeningFrameMessages(){window.removeEventListener("message",U.frameMessage,!1)},checkStatus(e,t){const s={act:"a_check_money_transfer",qid:e.qid,hash:e.hash};e.accept&&(s.accept=e.accept),ajax.post("al_payments.php",s,{onDone:(s,n,r,d)=>{if(!s||4==s&&cur.moneyTransferRedirected)t&&cur.transferWindow?.closed&&(U.showError((0,A.getLang)("payments_payment_cancelled")),U.stopListeningFrameMessages(),U.resetTransferWindow(),cur.isPaymentFailed=!1,cur.isPaymentCanceled=!1);else{if(1==s||3==s){if(t){0===cur.paymentsOptions.transferType||cur.paymentsOptions.transferType===B?cur.transferWindow&&!cur.transferWindow.closed&&(U.resetTransferWindow(),U.hideBoxQueue()):(U.resetTransferWindow(),U.hideBoxQueue())}else cur.paymentsOptions.transferType===x?(U.resetTransferWindow(),U.hideBoxQueue()):cur.paymentsOptions.receiptRedesign&&((0,p.hide)(document.querySelector(".payments_money_transfer_footer")),d?.receipt_link&&U.setIframeByLink(d.receipt_link));d||(0,u.showDoneBox)(n,{out:6e3});const a=nav.objLoc;e.accept||"settings"!==a[0]||"payments"!==a.act||"transfer"!==a.section||(cur.historyOffset||(cur.historyOffset={}),cur.historyOffset.transfer=0,(0,M.showNextPaymentsHistory)(!1,a.section)),3==s&&(d&&d.title&&(0,c.showFastBox)({title:d.title},n,(0,A.getLang)("payments_remember_card_btn"),U.rememberAcceptCard.pbind(d),(0,A.getLang)("payments_dont_remember_card_btn")),TopNotifier.invalidate(),cur.acceptMoneyBtn&&(0,p.hasClass)((0,p.domPN)(cur.acceptMoneyBtn),"feedback_buttons")?((0,p.re)((0,p.domPN)(cur.acceptMoneyBtn)),cur.acceptMoneyBtn=!1):cur.acceptMoneyBtn&&((0,p.re)((0,p.geByClass1)("_decline_btn",(0,p.domPN)(cur.acceptMoneyBtn))),(0,p.domReplaceEl)(cur.acceptMoneyBtn,r),cur.acceptMoneyBtn=!1))}else if(2==s||5==s)U.showError(n),U.stopListeningFrameMessages(),cur.isPaymentFailed=!1,cur.isPaymentCanceled=!1;else{if(4==s){if(cur.moneyTransferRedirected=!0,cur._popup_text=r,t&&cur.transferWindow)U.updateTransferWindow(r);else{let e;cur._popup_callback=function(){(0,p.hide)("payments_money_transfer_prg"),(0,p.show)("payments_iframe_container"),(0,p.ge)("payments_iframe_container").scrollTop=0,window.addEventListener("message",U.frameMessage,!1),(0,u.curBox)().changed=!0,(0,p.setStyle)(e,{width:(0,p.ge)("payments_iframe_container").parentNode.offsetWidth-(0,a.sbWidth)()+"px"})},e=(0,p.ge)("transfer_iframe"),e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(r),e.contentWindow.document.close(),cur._popup_callback()}return}if(6==s)return void((0,p.isVisible)("payments_money_transfer_prg")||((0,p.hide)("payments_iframe_container"),(0,p.show)("payments_money_transfer_iframe","payments_money_transfer_prg")))}clearInterval(cur.moneyTranferCheckInt)}},onFail:e=>(clearInterval(cur.moneyTranferCheckInt),U.resetTransferWindow()(),U.showError(e),!0)})},checkBindStatus(e){let t={act:"a_getvotes_check",type:"card"};e&&(e.oid||e.qid)&&(t.oid=e.oid,t.qid=e.qid,t.hash=e.hash),ajax.post("al_payments.php",t,{onDone:(e,t,s)=>{e&&(1==e?(U.resetSendBox(),U.enableAutoaccept(),s&&cur.autoacceptCardDD&&((0,p.isVisible)(cur.autoacceptCardEl)||((0,p.hide)((0,p.geByTag)("A",cur.autoacceptCardEl.parentNode)[0]),(0,p.show)(cur.autoacceptCardEl)),cur.paymentsOptions.cards.unshift([s.bindingId,s.bin]),cur.autoacceptCardDD.setItems(cur.paymentsOptions.cards),cur.autoacceptCardDD.select(s.bindingId))):2!=e&&10!=e||U.showError(t),clearInterval(cur.moneyTranferCheckInt))},onFail:e=>(clearInterval(cur.moneyTranferCheckInt),U.showError(e),!0)})},paymentCanceled(e){e?cur.isPaymentFailed=!0:cur.isPaymentCanceled=!0,U.frameHeight()},frameHeight(e,t){let s=(0,p.ge)("transfer_iframe");e?(e=Math.max(e,250),cur.prevFrameHeight=s.style.height,s.style.height=e+"px"):(s.style.height=cur.prevFrameHeight,(0,p.removeClass)("payments_iframe_container","payments_threeds_frame")),t||((0,p.ge)("payments_iframe_container").style.height=(e||cur.prevFrameHeight)+15+"px"),(0,p.ge)("payments_iframe_container").scrollTop=0},frameMessage(e){if(!(0,u.curBox)()&&cur.paymentsOptions.receiptRedesign)return void U.stopListeningFrameMessages();if(!(e.origin.match(/^https?:\/\/([a-zA-Z0-9\-.]+\.)?money\.mail\.ru$/)||e.origin.match(new RegExp(`^https?:\\/\\/([a-zA-Z0-9\\-.]+\\.)?${S.VK_SITE_REGEX_SOURCE_UNSAFE}$`))&&cur.paymentsOptions?.receiptRedesign))return!1;let t={};if(e.data){switch(typeof e.data){case"object":t=e.data;break;case"string":"{"===e.data.substr(0,1)&&(t=(0,y.parseJSON)(e.data))}if("billing"!==t.type)return!1}vk.dev&&(0,f.debugLog)(t);const s=(0,p.geByClass1)("payments_iframe_container",(0,u.curBox)().bodyNode)||(0,p.ge)("payments_iframe_container");if(cur.transferPageLoaded=!0,"resizeFrame"===t.action?setTimeout(U.frameHeight.pbind(t.action_params.height),200):"submit"===e.data||"3dsPage"===t.action?(setTimeout(U.frameHeight.pbind(600,!0),200),(0,p.addClass)(s,"payments_threeds_frame")):"3dsFinish"===t.action?(U.frameHeight(),(0,p.removeClass)(s,"payments_threeds_frame")):"session_fail"===t.action?((0,p.hide)(s),U.resetTransferWindow(),(0,p.show)("payments_iframe_safari_trouble_div"),U.updateLocalStorageNewWindowSign()):"putPixel"===t.action&&"page_load"===t.action_params.alias?(I.PaymentsBox.finishFormMeasure("dmr_transfer"),(0,E.statlogsValueEvent)("money_transfers",0,"iframe_loaded")):"paySuccess"===t.action?setTimeout(U.frameHeight.pbind(500),300):"payError"===t.action&&(0,p.isVisible)("payments_iframe_container")&&((0,p.hide)("payments_iframe_container"),(0,p.val)("payments_transfer_box_progress_msg",(0,A.getLang)("payments_waiting_transfer_complete")),(0,p.show)("payments_money_transfer_iframe","payments_money_transfer_prg")),cur.paymentsOptions.receiptRedesign){if("make_one_more_transfer"===t.action||"close_window"===t.action)switch(clearInterval(cur.moneyTranferCheckInt),U.resetTransferWindow(),U.stopListeningFrameMessages(),t.action){case"make_one_more_transfer":U.resetSendBox();break;case"close_window":U.hideBoxQueue()}if("get_transfer_source"===t.action){let e=vk.dev?"*":window.location.origin;cur.transferWindow&&cur.transferWindow.postMessage(JSON.stringify({from:cur.paymentsOptions.from}),e);let t=(0,p.ge)("transfer_iframe");t&&t.contentWindow.postMessage(JSON.stringify({action:"set_transfer_source",source:cur.paymentsOptions.from}),e)}}},setIframeByLink(e){let t=(0,p.geByClass1)("payments_iframe_container",(0,u.curBox)().bodyNode)||(0,p.ge)("payments_iframe_container"),s=(0,p.ce)("iframe",{id:"transfer_iframe",name:"transfer_iframe"},{border:0,height:"445px",width:"510px",overflowX:"hidden",overflowY:"hidden"});s.frameBorder=0,t.innerHTML="",t.appendChild(s),(0,p.hide)((0,p.ge)("payments_money_transfer_prg")),(0,p.show)(t),s.src=e},startCheckFrameLoad(e){cur.frameLoadChecker=setInterval((function(){if(cur.transferPageLoaded)U.stopCheckFrameLoad();else{+new Date-e>5e3&&(U.stopCheckFrameLoad(),U.resetTransferWindow(),(0,p.hide)("payments_iframe_container"),(0,p.show)("payments_iframe_safari_trouble_div"),U.updateLocalStorageNewWindowSign())}}),1e3)},stopCheckFrameLoad(){clearInterval(cur.frameLoadChecker)},initAccept(e,t,s=!1){if(s)cur.transferWindow=window.open("/","Money transfer"),cur.transferWindow.document.write(t),(0,p.hide)("payments_box_error","payments_iframe_container","payments_iframe_safari_trouble_div","payments_iframe_container"),(0,p.val)("payments_transfer_box_progress_msg",(0,A.getLang)("payments_waiting_transfer_complete")),(0,p.show)("payments_money_transfer_iframe","payments_money_transfer_prg");else{let e=(0,p.geByClass1)("payments_iframe_container",(0,u.curBox)().bodyNode)||(0,p.ge)("payments_iframe_container");(0,p.show)(e);let s=(0,p.ce)("iframe",{id:"transfer_iframe",name:"transfer_iframe"},{border:0,height:"445px",width:"510px",overflowX:"hidden",overflowY:"hidden"});s.frameBorder=0,e.innerHTML="",e.appendChild(s),s.contentWindow.document.open("text/html","replace"),s.contentWindow.document.write(t),s.contentWindow.document.close(),U.startCheckFrameLoad(+new Date)}window.addEventListener("message",U.frameMessage,!1),U.startCheckStatus(e,s)},rememberAcceptCard(e){const t=(0,u.curBox)()||{};let s=t.btns.ok[0];ajax.post("al_payments.php?act=a_remember_money_transfer_accept_card",{card_id:e.card_id,hash:e.hash},{onDone:t.hide,showProgress:()=>D.FlatButton.lock(s),hideProgress:()=>D.FlatButton.unlock(s)})},cleanAmount(e,t,s){if(13===t.keyCode)return;let a=e.value.replace(/[^0-9]/g,"");a=a.replace(/^0+/,""),e.value!=a&&(e.value=a),s||(U.checkAmount(a),U.autosizeAmount(),cur.paymentsOptions.cardsFee&&U.updateCardFee(!0))},getTransferLimit(e){let t="request"===cur.paymentsOptions.boxTab?0:cur.paymentsOptions.transferType;return"balance"===e&&parseInt(t)===x?cur.paymentsOptions.vkpayBalance:(cur.paymentsOptions.isChat&&"request"===cur.paymentsOptions.boxTab&&"maxAmount"===e&&cur.autoacceptCardDD&&-2===cur.autoacceptCardDD.val()&&(t=2),cur.paymentsOptions.limits[t][e])},checkAmount(e,t,s){let n=!1;const r=(0,p.hasClass)("payments_money_transfer_amount_wrap","money_error"),d=parseInt(cur.uiTransferCard?.val())===F,_=U.isVKPayTransfer(),l=U.isVKPayFillUpEnabled();if(t&&r)return _&&e>U.getTransferLimit("balance")&&!l&&(0,c.showFastBox)({title:(0,A.getLang)("payments_vkpay_low_balance_title"),width:420},(0,A.getLang)("payments_vkpay_low_balance_text"),(0,A.getLang)("payments_vkpay_topup_button"),nav.go.pbind("/vkpay#action=refill"),(0,A.getLang)("global_close")),!1;const u=cur.paymentsOptions.isChat&&"request"===cur.paymentsOptions.boxTab,m=u&&(0,a.isChecked)("transfer_participate"),y=U.getTransferLimit("minAmount")*(m?2:1),g=U.getTransferLimit("maxAmount"),f=U.getTransferLimit("balance"),E=(0,A.langNumeric)(y,cur.paymentsOptions.currencyStr,!0),P=(0,A.getLang)("payments_money_transfer_amount_limits").replace("{min_amount}",E);let b=!u;if(u&&cur.autoacceptCardDD&&-2===cur.autoacceptCardDD.val()&&(b=!0),d&&_&&l&&!(void 0!==f&&e<=f)||U.hideFillUpCardSelection(),t&&y&&e<y)n=(0,A.getLang)("payments_money_transfer_error_min_amount_currency").replace("{min_amount}",E);else if(g&&b&&e>g){const e=(0,A.langNumeric)(g,cur.paymentsOptions.currencyStr,!0);n=(0,A.getLang)("payments_money_transfer_error_max_amount_currency").replace("{max_amount}",e)}else if(d&&void 0!==f&&e>f)if(_&&l){U.getBindCards().length>0?U.showFillUpCardSelection():n=(0,A.getLang)("payments_money_transfer_low_balance")}else n=(0,A.getLang)("payments_money_transfer_low_balance");const I=(0,p.ge)("payments_money_transfer_notice");if(0!=n)return(0,p.val)(I,n),(0,p.addClass)("payments_money_transfer_amount_wrap","money_error"),!1;if((r||s||e<y)&&((e<y||"request"===cur.paymentsOptions.boxTab)&&(0,p.val)(I,P),(0,p.removeClass)("payments_money_transfer_amount_wrap","money_error")),!t&&u){const t=U.getChunkAmount(e,m);if((0,p.val)("transfer_chunk_amount",t),y&&e<y)(0,p.val)(I,P);else{const s=m?e-t:e,a=(0,A.langNumeric)(s,cur.paymentsOptions.currencyStr,!0);(0,p.val)(I,(0,A.getLang)("payments_money_transfer_will_be_requested").replace("{amount}",a))}}return!0},getChunkAmount(e,t){const s=U.getTransferLimit("minAmount"),a=U.getTransferLimit("maxAmount");let n=Math.max(s||100,Math.ceil(e/Math.max(1,cur.paymentsOptions.chatCount-(t?0:1))));return a&&(n=Math.min(n,a)),n},autosizeAmount(){let e=(0,p.ge)("transfer_amount"),t=(0,p.ce)("span",{innerHTML:e.value||"0"},{fontFamily:(0,p.getStyle)(e,"fontFamily"),fontSize:(0,p.getStyle)(e,"fontSize"),fontWeight:(0,p.getStyle)(e,"fontWeight")});(0,p.ge)("utils").appendChild(t);let s=Math.floor((0,p.getSize)(t)[0])+50;(0,p.re)(t),cur.amountMinSize||(cur.amountMinSize=80),s<cur.amountMinSize&&(s=cur.amountMinSize),(0,p.setStyle)(e,{width:s})},checkUserMessage(){(0,y.checkTextLength)(cur.paymentsOptions.maxTextLength,(0,p.ge)("transfer_comment"),(0,p.ge)("transfer_comment_limit_message"),!1,!0),((0,p.val)("transfer_comment_limit_message")&&(0,p.isVisible)("transfer_comment_limit_message")?p.hide:p.show)("payments_money_transfer_fee_link")},checkRequestParticipate(){U.checkAmount((0,p.val)("transfer_amount"))},checkRequestNoAmount(e,t){e&&uiTabs.switchTab(e),t?((0,p.hide)("payments_money_transfer_amount_wrap","transfer_participate"),(0,p.show)("payments_money_transfer_no_amount_wrap")):((0,p.hide)("payments_money_transfer_no_amount_wrap"),(0,p.show)("payments_money_transfer_amount_wrap","transfer_participate"),(0,p.elfocus)("transfer_amount"))},checkAutoAccept(){(0,p.toggleClass)("transfer_autoaccept_card","disabled",!(0,a.isChecked)("transfer_autoaccept"))},enableAutoaccept(){(0,a.isChecked)("transfer_autoaccept")||((0,a.checkbox)("transfer_autoaccept",!0),(0,p.removeClass)("transfer_autoaccept_card","disabled"))},showMoneyTransferBox:(e,t,s=void 0,a=null)=>(0,c.showBox)("al_payments.php",{...e,act:"money_transfer_box"},{...t,onDone(e,t){a?.(),cur.paymentsOptions=t,e.setOptions({width:510,bodyStyle:"padding: 0;",hideButtons:!0,onClean(){cur.moneyTranferCheckInt&&clearInterval(cur.moneyTranferCheckInt),nav.objLoc.z&&"moneysend"===nav.objLoc.z.substr(0,9)&&(delete nav.objLoc.z,nav.setLoc(nav.objLoc))}}),U.init()},onFail:s}),aboutBox:e=>!(0,c.showFastBox)({title:(0,A.getLang)("payments_money_transfer_about_title"),width:560},(0,A.getLang)(e)),showError(e,t){e&&((0,p.ge)("payments_box_error").innerHTML="",(0,m.showMsg)("payments_box_error",e,t||"error"),(0,p.show)("payments_box_error")),(0,p.ge)("payments_money_transfer_wrap")&&(U.resetSendBox(),cur.moneyTranferCheckInt&&(clearInterval(cur.moneyTranferCheckInt),cur.moneyTranferCheckInt=!1))},switchBoxSection(e,t){if(cur.paymentsOptions.boxTab!==t){if(e&&uiTabs.switchTab(e),"transfer"===cur.paymentsOptions.boxTab&&(0,p.isVisible)("payments_money_transfer_iframe")&&(U.resetSendBox(),cur.moneyTranferCheckInt&&(clearInterval(cur.moneyTranferCheckInt),cur.moneyTranferCheckInt=!1)),"transfer"===cur.paymentsOptions.boxTab&&cur.paymentsMoneyBoxTTHide&&cur.paymentsMoneyBoxTTHide(),"link"===cur.paymentsOptions.boxTab&&((0,p.hide)("payments_money_link_box"),(0,p.show)("payments_money_transfer_request_box"),U.hideMoneyLinksTooltip()),cur.paymentsOptions.boxTab=t,"link"===t)(0,p.hide)("payments_money_transfer_request_box"),(0,p.show)("payments_money_link_box"),U.hideMoneyLinksTooltip(),U.genQRCode(),U.showMoneyLinksTooltip();else{(0,p.val)("payments_money_transfer_summary",cur.paymentsOptions.boxSections[t].summary);const e=document.querySelector("#payments_money_transfer_send");D.FlatButton.setLabel(e,cur.paymentsOptions.boxSections[t].btn),(0,p.val)("payments_money_transfer_user_select_label",cur.paymentsOptions.boxSections[t].user_select_label),U.checkAmount((0,p.val)("transfer_amount"),!1,!0),"transfer"===t&&U.updateCardFee(!0)}(0,p.toggle)("payments_money_transfer_nf_warning","transfer"===t),(0,p.toggle)("payments_money_transfer_methods","transfer"===t),(0,p.toggle)("payments_money_transfer_vk_pay_offer","transfer"===t),U.renderSelectBox(),setTimeout(p.elfocus.pbind("transfer_amount"),100)}},genQRCode(){const e=(0,p.ge)("payments_money_transfer_qr");if(e.childNodes.length)return;const t={isShowLogo:!0,isShowBackground:!1,foregroundColor:L.default.colorTextPrimary.normal.value,logoColor:L.default.colorIconAccent.normal.value};(0,p.val)(e,b().createQR(cur.paymentsOptions.transferLink,115,"qr-code",t))},shareQRCode(){U.hideMoneyLinksTooltip(!0),(0,c.showBox)("like.php",{act:"publish_box",object:"moneysend"+vk.id+"_0",list:""})},downloadQRCode(){if(!cur.paymentsOptions.qrUrl)return!1;let e=(0,p.ce)("iframe",{src:cur.paymentsOptions.qrUrl});return utilsNode.appendChild(e),cur.qrFrame&&(0,p.re)(cur.qrFrame),cur.qrFrame=e,!1},hideLinkCopied(){(0,g.each)((0,p.geByClass)("_link_copied","payments_money_link_box"),p.hide.pbind(this))},copyLinkToClipboard(e){U.hideLinkCopied(),U.hideMoneyLinksTooltip(!0),e.select(),document.execCommand("copy");const t=(0,p.geByClass1)("_link_copied",(0,p.gpeByClass)("_link_wrap",e));(0,p.show)(t)},renderSelectBox(){if(!cur.uiTransferTo)return;const e="transfer"===cur.paymentsOptions.boxTab;cur.uiTransferTo.setData([]),cur.uiTransferTo.setOptions({autocomplete:!1}),cur.uiTransferTo.setData(cur.paymentsOptions.friends.filter((function(t){return e||!0===t[7]}))),cur.uiTransferTo.setOptions({autocomplete:!0}),cur.paymentsOptions.toId=null,cur.paymentsOptions.hash=null,cur.uiTransferTo.clear(),cur.uiTransferTo.deselectTokens(),(0,p.val)("payments_money_transfer_methods","")},updateImHistory(e,t,s){const a=(0,p.geByClass1)("_money_transfer"+t,e);if(!a)return;let n=(0,p.geByClass1)("_accept_btn",a);n&&((0,p.re)((0,p.geByClass1)("_decline_btn",(0,p.domPN)(n))),(0,p.domReplaceEl)(n,s))},initHistoryBox(e,t,s,r){let d=(0,p.ge)("ui_money_transfer_load_more");if(d){let _=(0,p.ge)("settings_transfer_history").tBodies[0];cur.userAutoScroll=new T.default(_,{offset:s,onNoMore:p.re.pbind(d),onNeedRows:(s,a)=>{let n={act:"money_transfer_history_box",offset:a,owner_id:e};t&&(n.request_id=t),r&&(n.hash=r),ajax.post("al_payments.php",n,{onDone:s})},drawRows:(e,t)=>{if(n.browser.msie){const s=(0,p.se)("<table>"+t+"</table>");t=(0,p.geByTag)("tr",s);for(let s in t)1==t[s].nodeType&&e.appendChild(t[s])}else e.insertAdjacentHTML("beforeEnd",t)},showProgress:()=>(0,a.lockButton)(d),hideProgress:()=>(0,a.unlockButton)(d),rowClass:"settings_history_row"})}},historyBox(){(0,c.showBox)("al_payments.php?act=money_transfer_history_box")},showMoneyLinksTooltip(){if(!cur.paymentsOptions.moneylinks_feature_tooltip||cur.moneyLinksTooltip)return;let e,t,s;(0,p.isVisible)("payments_money_link_box")?(e=(0,p.geByClass1)("payments_money_transfer_link_copy_btn","payments_money_link_box"),t=(0,A.getLang)("payments_money_link_btn_feature_text"),s={forceSide:"right",width:320,offset:[6,0]}):(e=(0,p.geByClass1)("ui_tab",(0,p.geByClass1)("_moneylink_tab","box_layer")),e&&(t=(0,A.getLang)("payments_money_link_tab_feature_text"),s={forceSide:"bottom",width:250,offset:[0,4]})),e&&setTimeout((function(){cur.moneyLinksTooltip=new ElementTooltip(e,(0,g.extend)({content:'<div class="feature_tooltip__close" onclick="cur.moneyLinksTooltip.hide();"></div>'+t,cls:"feature_intro_tt feature_info_tooltip moneylinks_feature_tooltip",autoShow:!1,noHideOnClick:!0,noAutoHideOnWindowClick:!0,appendTo:(0,p.geByClass1)("ui_tabs","box_layer"),onHide:U.hideMoneyLinksTooltip.pbind(!0)},s)),cur.moneyLinksTooltip.show(),cur.destroy.push(U.hideMoneyLinksTooltip)}),500)},hideMoneyLinksTooltip(e){e&&ajax.post("al_index.php",{act:"hide_feature_tt",hash:cur.paymentsOptions.moneylinks_feature_tooltip_hash,type:"moneylinks"}),cur.moneyLinksTooltip&&(cur.moneyLinksTooltip.destroy(),delete cur.moneyLinksTooltip)},showPinBox(){(0,p.addClass)((0,u.curBox)().bodyNode,"payments_box_code_showed"),(0,p.show)("payments_money_transfer_layer_bg","payments_money_transfer_code_box"),(0,g.each)((0,p.geByClass)("_code","payments_money_transfer_code_wrap"),(function(){(0,p.val)(this,"")})),(0,p.elfocus)("payments_code1"),(0,u.curBox)().changed=!0;const e=document.querySelector("#payments_money_transfer_send");e&&(e.style.pointerEvents="none",setTimeout((()=>{e.style.pointerEvents="auto"}),0))},hidePinBox(){(0,p.hide)("payments_money_transfer_layer_bg","payments_money_transfer_code_box"),(0,p.removeClass)((0,u.curBox)().bodyNode,"payments_box_code_showed"),(0,u.curBox)().changed=!1},checkVkPayOfferBox(){const e="payments_money_transfer_vk_pay_offer_box",t=!(0,a.isChecked)(e),s=document.querySelector("#payments_money_transfer_send");D.FlatButton.setDisabled(s,!t),(0,a.checkbox)(e)},onPinKeyUp(e){const t=e.target;if(8==e.keyCode){const e=(0,p.domPS)(t);if(e){const t=e.getAttribute("data-index");(0,p.val)(e,""),cur.paymentsOptions.vkpcode[t]="",cur.paymentsOptions.vkpcode[t-1]="",(0,p.elfocus)(e)}}},onPinEnter(e){const t=e.target;if(!(e.keyCode>=47&&e.keyCode<=57))return(0,l.cancelEvent)(e);{const s=t.getAttribute("data-index");cur.paymentsOptions.vkpcode||(cur.paymentsOptions.vkpcode=[]),cur.paymentsOptions.vkpcode[s-1]=e.key,(0,p.val)(t,String.fromCharCode(9679));const a=(0,p.domNS)(t);a?setTimeout(p.elfocus.pbind(a),10):setTimeout((function(){t.blur(),U.checkPin()}),10)}},onPinClick(e){const t=e.target,s=(0,p.domPS)(t);if(s&&!(0,p.val)(s))return(0,l.cancelEvent)(e)},checkPin(){const e=cur.paymentsOptions.vkpcode.join("");delete cur.paymentsOptions.vkpcode,(0,p.val)("payments_money_transfer_code_error",""),ajax.post("al_payments.php?act=a_check_vkpay_pin",{code:e,hash:cur.paymentsOptions.pinHash},{onDone:t=>{if(1==t)return(0,p.hide)((0,p.geByClass1)("_code_enter","payments_money_transfer_code_box")),void(0,p.show)((0,p.geByClass1)("_code_recover","payments_money_transfer_code_box"));U.hidePinBox(),U.send(!1,e)},onFail:e=>(e&&(0,p.val)("payments_money_transfer_code_error",e),(0,g.each)((0,p.geByClass)("_code","payments_money_transfer_code_wrap"),(function(){(0,p.val)(this,""),(0,a.notaBene)(this)})),(0,p.elfocus)("payments_code1"),!0),showProgress:function(){(0,p.hide)("payments_money_transfer_code_wrap"),(0,p.show)("payments_money_transfer_spinner")},hideProgress:function(){(0,p.hide)("payments_money_transfer_spinner"),(0,p.show)("payments_money_transfer_code_wrap")}})},onReceiveMethodChange(e,t,s){(0,a.radiobtn)(e,t,s),U.updateTransferType(e),U.updateCardFee(!0)},updateTransferType(e){void 0!==cur.paymentsOptions.forceType?cur.paymentsOptions.transferType=cur.paymentsOptions.forceType:parseInt(cur.uiTransferCard.val())===F?cur.paymentsOptions.transferType=x:cur.paymentsOptions.onlyCards?cur.paymentsOptions.transferType=0:(void 0===e&&(0,g.each)(radioBtns.receiveOptions.els,(function(){(0,p.hasClass)(this,"on")&&(e=this)})),void 0!==e&&(cur.paymentsOptions.transferType=(0,g.intval)((0,p.attr)(e,"data-type")))),U.checkAmount((0,p.val)("transfer_amount"),!1,!0)},updateCardFee(e){if(!cur.uiTransferCard||"request"===cur.paymentsOptions.boxTab)return;const t=(0,g.intval)((0,p.val)("transfer_amount")),s=U.getTransferLimit("minAmount"),a=(0,p.ge)("payments_money_transfer_to_card"),n=cur.uiTransferCard.val(),r=cur.paymentsOptions.cardsFee[n],d=0===cur.paymentsOptions.transferType,_=parseInt(n)===F||cur.paymentsOptions.forceType===B||cur.paymentsOptions.forceType===x,l=parseInt(n)!==F&&!cur.paymentsOptions.receiverVkpay||0===cur.paymentsOptions.forceType;let u=(0,A.getLang)("payments_transfer_without_fee"),c=(0,A.getLang)("payments_money_transfer_btn"),m=_?"payments_money_transfer_to_vkpay":"payments_money_transfer_to_card",y=l,f=0;if((0,p.toggleClass)(a,"disabled",_),(0,p.toggleClass)("payments_money_transfer_to_vkpay","disabled",l),0===parseInt(n))d&&(u=cur.paymentsOptions.mastercardPromoEnabled?(0,A.getLang)("payments_transfer_method_without_fee_for_mastercard"):(0,A.getLang)("payments_money_transfer_commission_undefined"));else if(parseInt(n)===F)y=!0;else if(d&&r&&(r.percent||r.vkPay&&r.vkPay.percent)){const e=r.free_amount_rest||0,s=r.free_amount_min||0;if(!e||t>e||s&&t<s){let s=t;t>e&&(s=t-e);const a=r.percent||0,n=r.min||0,d=r.add||0;f=s*a,f<n?f=n:f+=d,f=+(Math.round(f+"e+3")+"e-3"),f=+(Math.round(f+"e+2")+"e-2"),u=(0,A.langNumeric)(f,cur.paymentsOptions.cardsFeeStr,!0)}if(r.vkPay){const e=t+f,s=r.vkPay.percent||0,a=r.vkPay.min||0,n=r.vkPay.add||0;let d=e*s;d<a?d=a:d+=n,f=+(Math.round(f+d+"e+2")+"e-2"),d=+(Math.round(d+"e+2")+"e-2"),u=(0,A.langNumeric)(f,cur.paymentsOptions.cardsFeeStr,!0),u+=(0,A.langNumeric)(d,cur.paymentsOptions.cardsFeeVkPayStr,!0)}}!m||e&&!y||(0,p.ge)(m).classList.contains("on")||(0,p.ge)(m).click(),t>=s&&!(0,p.hasClass)("payments_money_transfer_amount_wrap","money_error")&&((0,p.val)("payments_money_transfer_notice",u),0===parseInt(n)&&d||(c=(0,A.langNumeric)(+(Math.round(t+f+"e+2")+"e-2"),cur.paymentsOptions.buttonAmountStr,!0)));const E=document.querySelector("#payments_money_transfer_send");D.FlatButton.setLabel(E,c)},isVKPayFillUpEnabled:()=>1==cur.paymentsOptions.vkpayFillUpEnabled,isVKPayTransfer:()=>parseInt(cur.paymentsOptions.transferType)===x,getBindCards:()=>cur.paymentsOptions.cards.filter((e=>{const t=parseInt(e[0]);return 0!==t&&t!==F})),hideFillUpCardSelection(){(0,p.hide)("payments_money_transfer_fill_up_cards")},showFillUpCardSelection(){(0,p.show)("payments_money_transfer_fill_up_cards")},isFillUpCardSelectionVisible:()=>(0,p.isVisible)("payments_money_transfer_fill_up_cards")}},584427:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{PaymentsBox:()=>PaymentsBox});var _icons_desktop__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(963251),_shared_evbus__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(338329),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(575753),_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(898848),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(866467),_shared_lib_site__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(105330),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(636576),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(576854),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(246429),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(237625),_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(754866),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(972332),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(458840),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(270959),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(342879),_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(683234),_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(560377),_web_lib_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(449299),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(593159),_web_payments_app_order_box__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(664822),_shared_apps_MiniAppsService_utils_getCurrentApp__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(670053);class PaymentsBox{static initHandlers(){(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/ps_promo_banner_click",(e=>{(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments_ps_promo_banner_event","","votes_buypage","relocate"),PaymentsBox.getVotesAmounts(!1,"spasibo",e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/save_phone_prefix_click",(e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByTag1)("input",e.payload.target.parentNode),0,0)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/save_phone_input",(e=>{13===e.payload.event.keyCode&&PaymentsBox.saveSmsPhone()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/get_votes_amounts",(e=>{PaymentsBox.getVotesAmounts(!1,e.payload.dataAttrs.name,e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/phone_code_input",(e=>{13===e.payload.event.keyCode&&PaymentsBox.smsSendCode()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_confirm_on_enter",(e=>{13===e.payload.event.keyCode&&PaymentsBox.showConfirm()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_confirm",(()=>{PaymentsBox.showConfirm()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_types",(()=>{PaymentsBox.showTypes()})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_terminal_tt",(e=>{PaymentsBox.paymentsShowTerminalTT(e.payload.target,e.payload.dataAttrs.name)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_phone_form",(()=>{PaymentsBox.showPhoneForm(2)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_phone_form_1",(()=>{PaymentsBox.showPhoneForm(1)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/show_all_prices",(e=>{PaymentsBox.showAllPrices(e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/change_option",(e=>{const{index:t,name:s}=e.payload.dataAttrs;PaymentsBox.onChangeOption(e.payload.target,t,s)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/focus_votes",(()=>{PaymentsBox.onChangeOption((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("last","payments_getvotes_amounts"),4,"payments_getvotes_amounts")})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/update_pay_amount",(e=>{PaymentsBox.updatePayAmount(e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/make_checkbox",(e=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(e.payload.target)})),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_0__.tq)().setInteractiveHandler("PaymentsBox/toggle_email",(e=>{PaymentsBox.toggleEmail(e.payload.target)}))}static initialize(e){PaymentsBox.initHandlers(),window.curNotifier&&curNotifier.idle_manager&&curNotifier.idle_manager.started&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.isArray)(cur.onUnidle)||(cur.onUnidle=[]),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_2__.isArray)(cur.onIdle)||(cur.onIdle=[]),cur.onUnidle.push((()=>{cur.getVotesDoneHide=!0})),cur.onIdle.push((()=>{cur.getVotesDoneHide=!1})));let t={bodyStyle:"padding: 0;",hideButtons:!0};if(cur.paymentsWideBox){let e={width:cur.checkoutEnabled?800:780,height:390};cur.checkoutEnabled||(e.title=!1),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(t,e)}else t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(t,{width:480});if(e.setOptions((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(t,{onClean:()=>{let t="sms"===cur.votesType&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress");cur.smsChkStatInt&&clearInterval(cur.smsChkStatInt);for(let e in cur.paymentsWaitingCache)cur.paymentsWaitingCache[e][2]&&clearInterval(cur.paymentsWaitingCache[e][2]);cur.smsAmountsInt&&clearTimeout(cur.smsAmountsInt),cur.isPaymentsAppOrder&&(cur.isPaymentComplete||cur.isPaymentAttemted)?e.onDone?e.onDone():(e.hide(),_web_payments_app_order_box__WEBPACK_IMPORTED_MODULE_18__.AppOrderBox.processOrder(1,e)):cur.isPaymentsAppOrder&&!cur.paymentsCheckOrderCnt&&cur.paymentsOrderBillPeriod&&cur.onSubscriptionCancel?cur.onSubscriptionCancel():cur.isPaymentsAppOrder&&!cur.paymentsCheckOrderCnt&&cur.onAppOrderCancel?cur.onAppOrderCancel():cur.paymentsTryCompleteOrder&&(cur.isPaymentComplete||cur.isPaymentAttemted)&&e.onDone&&e.onDone(),PaymentsBox.removeCheckOffersEvent(),window.removeEventListener("message",PaymentsBox.frameMessage,!1),window.removeEventListener("message",PaymentsBox.handlePaymentCompleteMessage,!1),t&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.showDoneBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_get_votes_box_close_notice"),{out:6e3})}})),(cur.fromInstantPay||cur.paymentsAuthPayment)&&(e.onDone=!1),cur.votesBox=e,cur.destroy.push((()=>{for(;boxQueue.count();)boxQueue.hideLast(!1)})),cur.checkoutEnabled)if(cur.paymentsWideBox){PaymentsBox.showProgress(""),PaymentsBox.submitDmrCheckout(cur.paymentsPreferVotes,!0);let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_wide_box_close_btn");e&&(e.onclick=cur.votesBox.hide)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_cont"),window.radioBtns.payments_getvotes_amounts={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")))},PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm);else cur.votesTypeInit&&(PaymentsBox.getVotesAmounts(!1,cur.votesTypeInit),cur.votesTypeInit=!1)}static initPhoneCountry(e,t){cur.countries=e,cur.defCountry=t,cur.uiPhoneCountry=new Dropdown((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("phone_country"),cur.countries,{selectedItems:t,big:!0,autocomplete:!0,multiselect:!1,onChange:e=>{let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("phone"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_phone_prefix"),a=cur.uiPhoneCountry.val_full()[3];if(0===e||"0"===e||""===e||!1===e||void 0===e){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(s);if(a==e)return;for(let t=0,s=cur.countries.length;t<s;++t)if(cur.countries[t][3]==e)return cur.uiPhoneCountry.val(cur.countries[t]);return cur.uiPhoneCountry.val(cur.defCountry,!0)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(s,a),setTimeout(_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus.pbind(t),0)}}),cur.destroy.push(cur.uiPhoneCountry.destroy.bind(cur.uiPhoneCountry))}static initPhoneNumber(e){e&&["input","keydown","keyup","mousedown","mouseup","select","contextmenu","drop"].forEach((function(t){e.addEventListener(t,(e=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domClosestByTag)("input",e.target);t&&(t.value=t.value.replace(/\D/g,""))}))}))}static validateEmail(e){return e.length<64&&e.match(/^.{1,40}@.{1,40}$/)&&e.match(/^([a-z0-9_\-]{0,40}\.){0,10}[a-z0-9_\-*]{1,40}@(([a-z0-9][a-z0-9_\-]{0,40})?[a-z0-9]\.){1,6}[a-z]{2,7}$/i)}static getEmail(){let e=!1;if(cur.paymentsEmailCheckbox)if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(cur.paymentsEmailCheckbox)){if(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(cur.paymentsEmailInput)),!e)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)(cur.paymentsEmailInput),""}else e="false";return e}static toggleEmail(e){"INPUT"===e.tagName&&(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(e)),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(e))||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.checkbox)(e),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(e)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(cur.paymentsEmailInput))}static unbind(e,t,s,a){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit"))return;const n=cur.paymentsPreferVotes;if(!s){const s="card"==e?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_unbind_card_confirm"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_revoke_token_confirm");return void(cur.confirmBox=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)({title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_action_confirmation"),bodyStyle:"padding: 20px; line-height: 160%;"},s,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_unbind_card_btn"),(()=>{PaymentsBox.unbind(e,t,!0)}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_cancel")))}const r={act:"a_del_instant_method",type:e,prefer_votes:a?-1:n,hash:t};cur.isPaymentsAppOrder&&cur.paymentsOrderAppId&&(r.aid=cur.paymentsOrderAppId),ajax.post("al_payments.php",r,{onDone:PaymentsBox.getVotesAmountsOnDone,onFail:function(e){return PaymentsBox.showBoxError(e),!0},showProgress:()=>{cur.confirmBox?cur.confirmBox.showProgress():(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit")},hideProgress:()=>{cur.confirmBox?cur.confirmBox.hide():(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit")}})}static instantPay(){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit"))return;const e=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();if(cur.isPaymentAttemted=!0,cur.paymentsAuthPayment)return void e.hide();let t,s,a;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")&&(cur.votesAmountsVal=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.radioval)("payments_getvotes_amounts")),void 0===cur.votesAmountsData[cur.votesAmountsVal]){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num")?parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num").value,10):0;if(!(e>0))return;cur._otherVotes=e,t=cur._otherAmount,s=cur._otherAmount,a=cur.votesAmountCustomTimeHash}else t=cur.votesAmountsData[cur.votesAmountsVal][2],s=cur.votesAmountsData[cur.votesAmountsVal][3],a=cur.votesAmountsData[cur.votesAmountsVal][4];let n={act:"a_getvotes_charge",type:cur.votesType,instant_pay:1,amount:t,order_amount:s,hash:a};cur.statSessionId&&(n.stat_session_id=cur.statSessionId),cur.isPaymentsAppOrder&&cur.paymentsOrderId&&(n.order_id=cur.paymentsOrderId,n.order_app_id=cur.paymentsOrderAppId,n.order_bill_period=cur.paymentsOrderBillPeriod,n.order_hash=cur.paymentsOrderHash),PaymentsBox.disablePaymentTypesRows(),ajax.post("al_payments.php",n,{onDone:(e,t,s,a)=>{PaymentsBox.setCurMidas(a),cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((()=>{PaymentsBox.checkStatus(cur.votesType,e)}),2e3),PaymentsBox.showProgress&&PaymentsBox.showProgress()},onFail:e=>(PaymentsBox.showBoxError(e),!0),showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton.pbind("payments_getvotes_submit"),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton.pbind("payments_getvotes_submit")})}static showAllPrices(e){return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")),((e,t)=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(t)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e),!1}static paymentsShowTerminalTT(e,t){let s="";cur.paymentsTooltips[t]&&(s+=cur.paymentsTooltips[t]),s&&(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(e,{text:s,dir:"auto",slide:15,className:"payments_terminal_tt",shift:[-3,3],hasover:1})}static updatePayAmount(o){let v=o.value.replace(/[^0-9]/g,"");const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.intval)(parseInt(v,10));v=i<1e4?i:parseInt(i.toString().substr(0,4),10),o.value!==v.toString()&&(o.value=v);let amount=0;if(cur.votesAmountsData.calcPayAmount){-1==cur.votesAmountsData.calcPayAmount.indexOf("return")&&(cur.votesAmountsData.calcPayAmount="return "+cur.votesAmountsData.calcPayAmount);const calcFunc="(function(votes){"+cur.votesAmountsData.calcPayAmount+";})("+v+")";try{amount=eval(calcFunc)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,calcFunc)}amount=amount?Math.ceil(100*amount)/100:0,amount=parseInt(amount,10)==amount?amount.toFixed(0):amount.toFixed(2),cur._otherAmount=amount,cur._otherVotes=v}const isBonusVotesDiscount=!!cur.votesAmountsData.calcBonusVotesForDiscount,isPriceDiscount=!!cur.votesAmountsData.calOriginalAmountForDiscount;let bonusElement=null;if(bonusElement=isBonusVotesDiscount?document.getElementById("personal_discount_bonus"):isPriceDiscount?document.getElementById("personal_discount_original_amount"):document.getElementById("payments_other_votes_bonus"),bonusElement&&(cur.votesAmountsData.bonusesTable||cur.votesAmountsData.calcBonusVotes||isBonusVotesDiscount||isPriceDiscount)){let bonus=0;if(cur.votesAmountsData.calcBonusVotes||isBonusVotesDiscount||isPriceDiscount){const calcFunc="(function(votes){"+(cur.votesAmountsData.calcBonusVotes||cur.votesAmountsData.calcBonusVotesForDiscount||cur.votesAmountsData.calOriginalAmountForDiscount)+";})("+v+")";try{bonus=eval(calcFunc)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,calcFunc)}}else for(let e in cur.votesAmountsData.bonusesTable)if(v>=e){const t=Math.floor(v*cur.votesAmountsData.bonusesTable[e]/e);t>bonus&&(bonus=t)}if(bonus)if(isBonusVotesDiscount)bonusElement.innerHTML=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("apps_personal_discount_amount_gift_calc",bonus),bonusElement.style.display="block";else if(isPriceDiscount){let e="";e=cur.votesAmountsData.currency_str?bonus>0?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(bonus,cur.votesAmountsData.currency_str):"":bonus>0?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_votes_cost_in_rubles",bonus):"",bonusElement.innerHTML=e,bonusElement.style.display="inline-block"}else bonusElement.innerHTML=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_bonus_votes",bonus),bonusElement.style.display="inline-block";else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(bonusElement)}if(cur.votesAmountsData.currency_str?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_amount").innerHTML=amount>0?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(amount,cur.votesAmountsData.currency_str):"":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_amount").innerHTML=amount>0?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_votes_cost_in_rubles",amount):"",isPriceDiscount){const e=document.getElementById("votes_amount");e&&e.classList.add("payments_opt_gift")}}static onChangeOption(e,t,s){let a;if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.radiobtn)(e,t,s),"payments_getvotes_amounts"===s){const e=cur.votesAmountsData[t];if(e){cur.votesAmountsVal=t,a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_get_votes_for_X").replace("{amount}",e[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("votes_num",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("votes_amount","");const s=document.getElementById("personal_discount_original_amount");s&&(s.style.display="none"),cur.paymentsEmailCheckbox&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(cur.paymentsEmailCheckbox)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)(cur.paymentsEmailInput)}else a=cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("votes_num");cur.checkoutEnabled?PaymentsBox.setButtons(a,PaymentsBox.showConfirm):PaymentsBox.setButtons(a,cur.votesAmountIsInstant||e&&e.length>=5?PaymentsBox.instantPay:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes)}}static setConfirmButtons(){if("card"!=cur.votesType&&cur.psList[cur.votesType]){const e=cur.paymentsWideBox?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_back_to_ps_list"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_go_ps_list");let t=!cur.psList[cur.votesType].in_menu;cur.paymentsInstantPayType==cur.votesType?t?PaymentsBox.setButtons((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_pay_order_btn"),PaymentsBox.instantPay,e,PaymentsBox.showPaySystemsList):PaymentsBox.setButtons((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_pay_order_btn"),PaymentsBox.instantPay):t?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,e,PaymentsBox.showPaySystemsList):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm)}else cur.checkoutEnabled?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes)}static popupWrite(e){return!(e.document.innerHTML==cur._popup_text||!cur._popup_text)&&(e.document.write(cur._popup_text),e.document.close(),e.blur(),e.focus(),cur._popup_callback&&cur._popup_callback(),!0)}static show3DsFrame(e,t){if(cur.threeds_submitted)return!0;cur.threeds_submitted=!0;let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("cards_iframe");a||(a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("iframe",{id:"card_iframe",name:"card_iframe"},{border:0,height:"435px",width:s.parentNode.offsetWidth+"px",overflowX:"hidden",overflowY:"hidden"}),a.frameBorder=0,s.innerHTML="",s.appendChild(a));let n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("form",{target:"card_iframe",method:"POST",action:e});for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("input",{type:"hidden",name:e,value:t[e]}));s.appendChild(n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress"),n.submit()}static submitDmrCheckout(e,t=!1){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress")&&!t)return;(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");const s=cur.psList.dmr_checkout;let a=!1;const n=(e*s.vote_cost).toFixed(2);if(!e||e<=0?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_web_no_sum"):s.min_amount&&e<s.min_amount?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_min_amount_limit_votes").replace("%s",s.min_amount):s.max_amount&&e>s.max_amount?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_max_amount_limit_votes").replace("%s",s.max_amount):void 0!==s.rest_amount_day&&e>s.rest_amount_day?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_rest_amount_day_votes").replace("%s",s.rest_amount_day):void 0!==s.rest_amount_week&&e>s.rest_amount_week&&(a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_rest_amount_week_votes").replace("%s",s.rest_amount_week)),a)return PaymentsBox.showBoxError(a),!1;const r=PaymentsBox.getEmail();if(""===r)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),!1;if(r&&"false"!==r&&!PaymentsBox.validateEmail(r))return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)(cur.paymentsEmailInput),PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_error_invalid_email")),!1;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container","payments_threeds_checkout_frame");let d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container"),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("iframe",{id:"card_iframe",name:"card_iframe"},{border:0,height:cur.isMidas?"560px":"435px",width:d.parentNode.offsetWidth+"px",overflowX:"hidden",overflowY:"hidden",display:"block",borderRadius:"0 0 4px 4px"});_.frameBorder=0,d.innerHTML="",d.style.height=_.style.height,d.appendChild(_),window.addEventListener("message",PaymentsBox.frameMessage,!1);let l=cur.votesType;!l&&cur.votesTypeInit&&(l=cur.votesTypeInit);const u={act:"a_getvotes_charge",type:"dmr_checkout",hash:cur.paymentsHash,amount:n,stat_session_id:cur.statSessionId,votes:e};l&&(u.pay_method=l),cur.paymentsAuthPayment&&(u.only_auth=1),r&&(u.email=r),cur.votesAmountsData.appoveCode&&(u.approve_code=cur.votesAmountsData.appoveCode),cur.isPaymentsAppOrder&&cur.paymentsOrderId&&(u.order_id=cur.paymentsOrderId,u.order_app_id=cur.paymentsOrderAppId,u.order_bill_period=cur.paymentsOrderBillPeriod,u.order_hash=cur.paymentsOrderHash),cur.votesAmountsData.purchaseDescr&&(u.purchase_descr=cur.votesAmountsData.purchaseDescr),PaymentsBox.trackingProtectionEnabled((function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr_checkout","iframe_track_protection_enabled")}),(function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr_checkout","iframe_track_protection_disabled")})),ajax.post("al_payments.php",u,{onDone:function(t,a,r,d){if(PaymentsBox.setCurMidas(d),!t)return;if(-2==t){const t=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_money_amount_rub",Math.floor(n));return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_money_for_votes",e).replace("{money}",t)),cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),cur.votesAmountsData.confirm_hash=r,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("confcode",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),PaymentsBox.enablePaymentTypesRows(),void PaymentsBox.approveGetCode()}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")&&PaymentsBox.showVotesAmounts(),!cur.paymentsWideBox){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_submit");PaymentsBox.setButtons(e.innerHTML,PaymentsBox.showConfirm,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_back"),PaymentsBox.showVotesAmounts)}cur._popup_text=a,cur._popup_callback=!1,cur._popup_callback=function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap","payments_getvotes_buttons","payments_box_progress","payments_box_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container").scrollTop=0};let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("card_iframe");if(_.contentWindow.document.open("text/html","replace"),_.contentWindow.document.write(a),_.contentWindow.document.close(),cur._popup_callback(),cur.isMidas){let e=_.closest(".popup_box_container");e&&(e.style.width="520px",e.style.minWidth="520px",e.style.minHeight="560px",e.style.height=null);let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container");if(t.style.width="520px",t.style.minHeight="560px",t.style.height=null,_.style.width="520px",_.style.minWidth="520px",_.style.minHeight="560px",_.style.height=null,document.body.attributes.scheme&&"vkcom_dark"==document.body.attributes.scheme.value&&e&&(e.querySelector(".box_title_wrap").style.backgroundColor="#19191a",e.querySelector(".box_body").style.backgroundColor="#19191a"),cur.isHideButtonBackAndText){let t=e.querySelector(".payments_box_summary");t&&(t.style.display="none")}}cur.smsChkData=t,cur.isPaymentComplete=cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus("dmr_checkout",t),s.use_iframe&&(cur.isPaymentCanceled||cur.isPaymentFailed)?(clearInterval(cur.smsChkStatInt),PaymentsBox.showVotesAmounts(),cur.isPaymentFailed?PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_landing_cancelled")):PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled")),window.removeEventListener("message",PaymentsBox.frameMessage,!1)):cur.isPaymentComplete&&"dmr_checkout"!=s.name&&PaymentsBox.showTypes()}),2e3)},onFail:e=>((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||PaymentsBox.setConfirmButtons(),PaymentsBox.showBoxError(e),!0),frame:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile})}static submitCard(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress"))return;(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");const t=cur.psList.card;let s=!1;const a=(e*t.vote_cost).toFixed(2);if(!e||e<=0?s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_web_no_sum"):t.min_amount&&e<t.min_amount?s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_min_amount_limit_votes").replace("%s",t.min_amount):t.max_amount&&e>t.max_amount?s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_max_amount_limit_votes").replace("%s",t.max_amount):null!=t.rest_amount_day&&e>t.rest_amount_day?s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_rest_amount_day_votes").replace("%s",t.rest_amount_day):null!=t.rest_amount_week&&e>t.rest_amount_week&&(s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_rest_amount_week_votes").replace("%s",t.rest_amount_week)),s)return PaymentsBox.showBoxError(s),!1;const n=PaymentsBox.getEmail();if(""===n)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),!1;if(n&&"false"!==n&&!PaymentsBox.validateEmail(n))return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)(cur.paymentsEmailInput),PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_error_invalid_email")),!1;if(cur.votesAmountsData.needApprove){const t=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_money_amount_rub",Math.floor(a));return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",cur.votesAmountsData.needApprove),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_money_for_votes",e).replace("{money}",t)),cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("confcode",""),delete cur.votesAmountsData.needApprove,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),void PaymentsBox.approveGetCode()}let r;if(PaymentsBox.disablePaymentTypesRows(),t.use_iframe){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("iframe",{id:"card_iframe",name:"card_iframe"},{border:0,height:"435px",width:e.parentNode.offsetWidth+"px",overflowX:"hidden",overflowY:"hidden"});t.frameBorder=0,e.innerHTML="",e.appendChild(t),window.addEventListener("message",PaymentsBox.frameMessage,!1)}else{const e=`scrollbars=1, resizable=1, menubar=1, left=${0}, top=${0}, toolbar=1, status=1`;r=window.open("","_blank",e),cur._popup_text=PaymentsBox.popupHtml((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_cards_redirect"),"",""),PaymentsBox.popupWrite(r)}const d={act:"a_getvotes_charge",type:"card",hash:cur.paymentsHash,amount:a,stat_session_id:cur.statSessionId};cur.paymentsAuthPayment&&(d.only_auth=1),n&&(d.email=n),cur.votesAmountsData.appoveCode&&(d.approve_code=cur.votesAmountsData.appoveCode),cur.isPaymentsAppOrder&&cur.paymentsOrderId&&(d.order_id=cur.paymentsOrderId,d.order_app_id=cur.paymentsOrderAppId,d.order_bill_period=cur.paymentsOrderBillPeriod,d.order_hash=cur.paymentsOrderHash),PaymentsBox.trackingProtectionEnabled((function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_track_protection_enabled")}),(function(){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_track_protection_disabled")})),ajax.post("al_payments.php",d,{onDone:function(s,n,d,_){if(PaymentsBox.setCurMidas(_),s){if(-2==s){t.use_iframe||r.close();const s=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_money_amount_rub",Math.floor(a));return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_money_for_votes",e).replace("{money}",s)),cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),cur.votesAmountsData.confirm_hash=d,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("confcode",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),PaymentsBox.enablePaymentTypesRows(),void PaymentsBox.approveGetCode()}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")&&PaymentsBox.showVotesAmounts(),t.use_iframe||((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),PaymentsBox.showProgress()),cur._popup_text=n,cur._popup_callback=!1,t.use_iframe){cur._popup_callback=function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap","payments_getvotes_buttons","payments_box_progress","payments_box_error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container").scrollTop=0};let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("card_iframe");e.contentWindow.document.open("text/html","replace"),e.contentWindow.document.write(n),e.contentWindow.document.close(),cur._popup_callback()}else r.document.open("text/html","replace"),r.document.write(n),r.document.close(),r.blur(),r.focus();cur.smsChkData=s,cur.isPaymentComplete=cur.isPaymentCanceled=cur.isPaymentFailed=!1,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus("card",s),!t.use_iframe&&r.closed?setTimeout((function(){cur.isPaymentComplete||(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled"),"info_msg"),PaymentsBox.setConfirmButtons())}),500):t.use_iframe&&(cur.isPaymentCanceled||cur.isPaymentFailed)?(clearInterval(cur.smsChkStatInt),PaymentsBox.showVotesAmounts(),cur.isPaymentFailed?PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_landing_cancelled")):PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled")),window.removeEventListener("message",PaymentsBox.frameMessage,!1)):cur.isPaymentComplete&&"alfabank"!=t.name&&"dmr"!=t.name&&PaymentsBox.showTypes()}),2e3)}},onFail:function(e){return t.use_iframe||r.close(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||PaymentsBox.setConfirmButtons(),PaymentsBox.showBoxError(e),!0},frame:_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile})}static trackingProtectionEnabled(e,t){let s=new XMLHttpRequest;s.open("GET","https://top-fwz1.mail.ru/counter2?id=1",!0),s.onreadystatechange=function(){200!==s.status?e():t(),s.onreadystatechange=null},s.send()}static submitPaymentSystem(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress"))return;const t=cur.votesType,s=cur.psList[t];let a=!1,n=0,r=0,d=0,_=0;if(!s.simple_redirect){if(!e)return;n=(e*s.vote_cost).toFixed(2),r=(e*s.vote_cost/cur.usdRate).toFixed(2),d=Math.floor(n),_=100*(n-d),!e||e<=0?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_web_no_sum"):s.min_amount&&e<s.min_amount?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_min_amount_limit_votes").replace("%s",s.min_amount):s.max_amount&&e>s.max_amount?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_max_amount_limit_votes").replace("%s",s.max_amount):null!=s.rest_amount_day&&e>s.rest_amount_day?a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_rest_amount_day_votes").replace("%s",s.rest_amount_day):null!=s.rest_amount_week&&e>s.rest_amount_week&&(a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_rest_amount_week_votes").replace("%s",s.rest_amount_week))}if(a)return PaymentsBox.showBoxError(a),!1;const l=PaymentsBox.getEmail();if(""===l)return;if(l&&"false"!==l&&!PaymentsBox.validateEmail(l))return void PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_error_invalid_email"));if(PaymentsBox.showProgress(),PaymentsBox.disablePaymentTypesRows(),"mailmoney_vkpay"===t){const e={act:"a_getvotes_charge",type:t,hash:cur.paymentsHash,amount:n,random_auth:0,stat_session_id:cur.statSessionId};ajax.post("al_payments.php",e,{onDone:(e,t,s,a)=>{PaymentsBox.setCurMidas(a);const n=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)(),r={noLocChange:1,skipBoxesHide:1,noClickHide:1};cur.isPaymentsAppOrder?(0,_shared_apps_MiniAppsService_utils_getCurrentApp__WEBPACK_IMPORTED_MODULE_19__.getCurrentApp)().openAppInLayer(e,!1,!0,r):(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_11__.showWiki)({w:e},!1,!1,r),n._hide(!1,!0),cur.onExternalAppDone=e=>{n._show(),e.status||(PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled"),"info_msg"),PaymentsBox.setConfirmButtons(),clearInterval(cur.smsChkStatInt)),cur.onExternalAppDone=null,window.WkView&&WkView.hide(!1,!0)},cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus(cur.votesType,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.data,null,n)}),2e3)},onFail:e=>(PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),!0)})}else{if(cur.votesAmountsData.oauth_url&&(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_remember_wallet")||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("payments_remember_wallet"))){const e=cur.votesAmountsData.oauth_params;let a="";for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){a+=`<input type="hidden" autocomplete="off" name="${t}" value="${e[t]}"/>`}let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("paymentSystemsForm");r.action=cur.votesAmountsData.oauth_url,r.method="post",r.innerHTML=a;const d=cur.votesAmountsData.popup_params||{},_="_blank",u=d.width||700,c=d.height||600,p=`scrollbars=1, resizable=1, menubar=0, left=${Math.floor(window.screen.width/2)-u/2}, top=${Math.floor(window.screen.height/2)-c/2}, width=${u}, height=${c}`,m=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payment_redirect").replace("%s",s.title),y=`<form action="${r.action}" method="${r.method}" id="popup_payment_form" accept-charset="UTF-8">${r.innerHTML}</form>`;cur._popup_text=PaymentsBox.popupHtml(m,y,"document.getElementById('popup_payment_form').submit()"),cur._popup_callback=!1,window.addEventListener("message",PaymentsBox.handlePaymentCompleteMessage,!1);let g=window.open("",_,p);cur.smsChkStatCnt=0,cur.oauthState=0;let f=0;return cur.smsChkStatInt=setInterval((function(){if(2==cur.oauthState)PaymentsBox.checkStatus(cur.votesType,cur.smsChkData);else if(0==cur.oauthState&&(f=cur.isPaymentComplete&&cur.paymentCompleteParams&&cur.paymentCompleteParams.code?cur.paymentCompleteParams.code:0,f)){cur.oauthState=1;let e={act:"a_getvotes_charge",type:t,oauth_code:f,hash:cur.paymentsHash,amount:n,stat_session_id:cur.statSessionId};return cur.paymentsAuthPayment&&(e.only_auth=1),l&&(e.email=l),void ajax.post("al_payments.php",e,{onDone:(e,t,s,a)=>{PaymentsBox.setCurMidas(a),cur.oauthState=2,cur.smsChkData=e},onFail:e=>(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),!0)})}(g.closed&&!cur.isPaymentComplete||cur.isPaymentComplete&&!f)&&(clearInterval(cur.smsChkStatInt),cur.isPaymentComplete?PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_sms_money_fail")):PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled"),"info_msg"),PaymentsBox.setConfirmButtons())}),2e3),void PaymentsBox.popupWrite(g)}if(cur.votesAmountsData.provider&&-1!==["dmr","paypal","yandexmoney","api_provider"].indexOf(cur.votesAmountsData.provider)){const e=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payment_redirect").replace("%s",s.title);let a,r={act:"a_getvotes_charge",type:t,hash:cur.paymentsHash,amount:n,random_auth:0,stat_session_id:cur.statSessionId};if(l&&(r.email=l),"paypal"===cur.votesAmountsData.provider||"yandexmoney"===cur.votesAmountsData.provider){let e;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_remember_wallet")?(r.remember_wallet=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)("payments_remember_wallet")||cur.forceRebind,cur.forceRebind&&(cur.forceRebind=!1)):r.remember_wallet=1,r.remember_wallet){const t=cur.votesAmountsData.popup_params||{},s=t.width||700,a=t.height||600;e=`scrollbars=1, resizable=1, menubar=0, left=${Math.floor(window.screen.width/2)-s/2}, top=${Math.floor(window.screen.height/2)-a/2}, width=${s}, height=${a}`}else{e=`scrollbars=1, resizable=1, menubar=1, left=${0}, top=${0}, toolbar=1, status=1`}a=r.remember_wallet?window.open("","",e):window.open("","_blank",e);const t=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payment_redirect").replace("%s",s.title);cur._popup_text=PaymentsBox.popupHtml(t,"",""),PaymentsBox.popupWrite(a)}ajax.post("al_payments.php",r,{onDone:function(t,s,n,r){if(PaymentsBox.setCurMidas(r),!t)return;let d="api_provider"!==cur.votesAmountsData.provider;cur.canOpenPopup=d;let _=!d;PaymentsBox.checkStatusCallback=t=>{if("paypal"===cur.votesAmountsData.provider||"yandexmoney"===cur.votesAmountsData.provider){if(a&&!a.closed&&!_){_=!0;let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("paymentSystemsForm");s.action=t.action,s.method="get";let n="";for(let e in t.params)if(Object.prototype.hasOwnProperty.call(t.params,e)){n+=`<input type="hidden" autocomplete="off" name="${e}" value="${t.params[e]}"/>`}s.innerHTML=n;let r=`<form action="${s.action}" method="${s.method}" id="popup_payment_form" accept-charset="UTF-8">${s.innerHTML}</form>`;cur._popup_text=PaymentsBox.popupHtml(e,r,"document.getElementById('popup_payment_form').submit()"),PaymentsBox.popupWrite(a)}(a.closed&&!cur.isPaymentComplete||cur.isPaymentComplete)&&(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError(cur.isPaymentComplete?(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_sms_money_fail"):(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled")),PaymentsBox.setConfirmButtons())}else cur._popup||(cur._popup=window.open("","_blank"))},cur.smsChkData=t,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((()=>{PaymentsBox.checkStatus(cur.votesType,t)}),2e3)},onFail:function(e){return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||PaymentsBox.setConfirmButtons(),PaymentsBox.showBoxError(e),!0}})}else{if(!cur.isAdsPayment){const t={act:"a_getvotes_invoice",type:cur.votesType,amount:n,votes:e,invoice_hash:cur.votesAmountsData.invoice_hash,stat_session_id:cur.statSessionId};ajax.post("al_payments.php",t)}let a=s.gate_params,u="",c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("paymentSystemsForm"),p=(new Date).getTime();for(let t in a)if(Object.prototype.hasOwnProperty.call(a,t)){let s=a[t];s=s.replace("{amount_votes}",e),s=s.replace("{amount_rub}",n),s=s.replace("{amount_usd}",r),s=s.replace("{amount_rub_int}",d),s=s.replace("{amount_rub_frac}",_),s=s.replace("{time}",p),u+=`<input type="hidden" autocomplete="off" name="${t}" value="${s}"/>`}let m=s.gate_url;m=m.replace("{time}",p),m=m.replace("{amount_votes}",e),m=m.replace("{amount_rub}",n),m=m.replace("{amount_usd}",r),m=m.replace("{amount_rub_int}",d),m=m.replace("{amount_rub_frac}",_),c.action=m,c.method=s.gate_method,c.innerHTML=u;const y="_blank",g=`scrollbars=1, resizable=1, menubar=1, left=${0}, top=${0}, toolbar=1, status=1`;let f=!1;try{const a=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payment_redirect").replace("%s",s.title),d=`<form action="${c.action}" method="${c.method}" id="popup_payment_form" accept-charset="${s.gate_charset}">${c.innerHTML}</form>`;cur._popup_text=PaymentsBox.popupHtml(a,d,`Payments.submitPopupForm("${t}", "${e}", "${n}", "${r}")`),cur._popup_callback=!1,f=window.open("",y,g),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments","","votes",t,"start"),cur.smsChkData=!1,cur.isPaymentComplete=!1,cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval((function(){PaymentsBox.checkStatus(cur.votesType,!1),f.closed&&!cur.isPaymentComplete&&(clearInterval(cur.smsChkStatInt),PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled"),"info_msg"),s.simple_redirect?PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes):PaymentsBox.setConfirmButtons())}),2e3),PaymentsBox.popupWrite(f)}catch(e){c.submit()}l&&ajax.post("al_payments.php",{act:"a_set_receipt_email",email:l,hash:cur.paymentsHash},{onFail:e=>!0})}}}static approveSendCode(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value;if(!e.length)return void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_error");let t=0;for(let s=0;s<e.length;s++)t+=parseInt(e[s]);if(t%=10,t!=cur.votesAmountsData.approveCodeChk)return PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_invalid_code")),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode");cur.votesAmountsData.appoveCode=e,PaymentsBox.showConfirm()}static approveGetCode(e){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");let t={act:"a_getvotes_approve_code",hash:cur.votesAmountsData.confirm_hash};return e&&(t.resend=1),ajax.post("al_payments.php",t,{onDone:function(t,s){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),1==t?PaymentsBox.showBoxError(s):e||(cur.votesAmountsData.approveCodeChk=s,PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm"),PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.approveSendCode,cur.paymentsChangeType,cur.checkoutEnabled?PaymentsBox.showVotesAmounts:PaymentsBox.showTypes))},onFail:function(e){return PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),!0}}),!1}static smsSendPin(){if(null==cur.votesAmountsVal)return!1;const e=cur.votesAmountsData[cur.votesAmountsVal][3],t=cur.votesAmountsData[cur.votesAmountsVal][2];if(4!=e&&8!=t&&(2!=e||5!=t))return!1;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value;s.length&&((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit"),ajax.post("al_payments.php",{act:"a_getvotes_validate",code:s,oid:cur.votesAmountsData[cur.votesAmountsVal][3],qid:cur.smsChkData.qid,hash:cur.smsChkData.hash},{onDone:function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),PaymentsBox.showProgress(),cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval(PaymentsBox.checkStatus.pbind("sms",cur.smsChkData),2e3)},onFail:function(e){return PaymentsBox.showBoxError(e),!0}}))}static smsSendCode(){if("card"===cur.votesType)return!1;if(null!=cur.votesAmountsVal){const e=cur.votesAmountsData[cur.votesAmountsVal][3],t=cur.votesAmountsData[cur.votesAmountsVal][2];if(4==e||8==t||2==e&&5==t)return PaymentsBox.smsSendPin()}const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value;e.length?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit"),ajax.post("al_payments.php",{act:"a_getvotes_validate",pid:cur.votesAmountsVal,code:e,hash:cur.votesAmountsData[cur.votesAmountsVal].hash},{onDone:function(e){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),e&&3==cur.votesAmountsData[cur.votesAmountsVal][2]?PaymentsBox.getVotesCharge(!1,!0):e&&PaymentsBox.getVotesCharge()},onFail:function(e){return PaymentsBox.showBoxError(e),!0}})):(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode")}static smsGetCode(e){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");let t={act:"a_getvotes_validate",hash:cur.votesAmountsData[cur.votesAmountsVal].hash,pid:cur.votesAmountsVal};e&&(t.resend=1),ajax.post("al_payments.php",t,{onDone:function(e,t){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),2==e?(PaymentsBox.showBoxError(t,"ok_msg"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("confcode")):e&&3==cur.votesAmountsData[cur.votesAmountsVal][2]?PaymentsBox.getVotesCharge(!1,!0):e?PaymentsBox.getVotesCharge():(PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("confcode"),cur.paymentsWideBox?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.smsSendCode,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_change_phone_number"),PaymentsBox.showPhoneForm):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.smsSendCode,cur.paymentsChangeType,PaymentsBox.showTypes))},onFail:function(e){return PaymentsBox.showBoxError(e),PaymentsBox.setConfirmButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.elfocus)("confcode"),!0}})}static confirmPinCode(){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").value);if(!e.length)return void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("confcode");let t={act:"a_getvotes_confirm_pin",hash:cur.updateTnxHash,ps:cur.votesType,qid:cur.smsChkData.qid,pin:e};PaymentsBox.showProgress(),ajax.post("al_payments.php",t,{onDone:function(){cur.smsChkStatInt=setInterval((()=>{PaymentsBox.checkStatus(cur.votesType,cur.smsChkData)}),2e3)},onFail:function(e){PaymentsBox.refreshBox(),PaymentsBox.showBoxError(e)}})}static checkPinKeyPress(e){if((e=e||window.event).ctrlKey||e.altKey||e.metaKey)return;let t=null;return null===e.which&&e.keyCode>=32?t=String.fromCharCode(e.keyCode):0!==e.which&&0!==e.charCode&&e.which>=32&&(t=String.fromCharCode(e.which)),null!==t?!(t<"0"||t>"9")&&void 0:void 0}static fillBDay(){let params={act:"a_getvotes_fill_bday"};ajax.post("al_payments.php",params,{onDone:function(js){if(js)try{eval(js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,js)}}})}static showOffer(e){let t={act:"a_getvotes_offer",offer_id:e,offer_aid:cur.paymentsOfferApp||0,app_currency:cur.offersAppCurrency||0};const s=(0,_shared_apps_MiniAppsService_utils_getCurrentApp__WEBPACK_IMPORTED_MODULE_19__.getCurrentApp)();s?.options&&(t.aid=s.options.aid),cur.paymentsOfferPreview&&(t.offer_view=cur.paymentsOfferPreview),ajax.post("al_payments.php",t,{onDone:PaymentsBox.offerOnLoad,onFail:e=>(e&&(PaymentsBox.showBoxError(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap")),!0)})}static showNextOffers(e){let t={act:"a_getvotes_amounts",type:"offers",offset:cur.offersOffset,app_currency:cur.offersAppCurrency,hash:cur.paymentsHash};const s=(0,_shared_apps_MiniAppsService_utils_getCurrentApp__WEBPACK_IMPORTED_MODULE_19__.getCurrentApp)();s?.options&&(t.isAppOrder=cur.paymentsOfferApp?1:0,t.aid=s.options.aid),ajax.post("al_payments.php",t,{onDone:function(t,s){s&&(t||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(e),cur.offersOffset+=20,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_offers_wrap").innerHTML+=s,PaymentsBox.checkOffers())},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)(e),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)(e)})}static showConfirm(){cur.votesAmountsVal=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.radioval)("payments_getvotes_amounts"):0;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num")?parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num").value,10):0;if(void 0===cur.votesAmountsVal)return;cur.votesAmountsVal&&null==cur.votesAmountsData[cur.votesAmountsVal]&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("votes_num")&&!e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.notaBene)("votes_num");let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_spasibo_rules_accept");if(t&&!(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isChecked)(t)){let e={text:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_spasibo_rules_not_accepted"),dir:"auto",className:"payments_terminal_tt",hasover:1};return cur.paymentsWideBox&&(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.extend)(e,{shift:[-30,10]})),void(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_13__.showTooltip)(t,e)}if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().changed=!0,"sms"===cur.votesType){cur.isResetCheckedMaxSmsVotesValue&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_msg").innerHTML=cur.votesAmountsData.confirm_msg_again,cur.isResetCheckedMaxSmsVotesValue=!1);const t=cur.votesAmountsData.confirm_type;if(2==t&&null!=cur.votesAmountsData.checked_max_sms_votes_val&&(cur.votesAmountsVal=cur.votesAmountsData.checked_max_sms_votes_val,cur.votesAmountsData.checked_max_sms_votes_val=0,cur.isResetCheckedMaxSmsVotesValue=!0),null==cur.votesAmountsData[cur.votesAmountsVal]&&e){if(!t)return void PaymentsBox.getVotesCharge(e,!0);cur.votesAmountsData[-1]=[e,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_money_amount_rub",cur._otherAmount),cur.votesAmountsData[0][2],0],cur.votesAmountsVal=-1}void 0===cur.votesAmountsData[cur.votesAmountsVal]&&(cur.votesAmountsVal=0);const s=cur.votesAmountsData[cur.votesAmountsVal][0],a=cur.votesAmountsData[cur.votesAmountsVal][1],n=cur.votesAmountsData[cur.votesAmountsVal][2],r=cur.votesAmountsData[cur.votesAmountsVal][3],d=cur.votesAmountsData[cur.votesAmountsVal][6];if(0==n){cur.smsChkData={oid:r,qid:0,hash:cur.votesAmountsData.check_hash};let e=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_to_get_send_sms",s);cur.paymentsWideBox||(e+=`<br/>${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_service_cost")}`);const t=cur.votesAmountsData[cur.votesAmountsVal];if(e=e.replace("{number}",cur.votesAmountsData[cur.votesAmountsVal][4]),e=e.replace("{text}",`<nobr>${cur.votesAmountsData[cur.votesAmountsVal][5]}${vk.id}</nobr>`),e=e.replace("{amount}",cur.votesAmountsData[cur.votesAmountsVal][1]),t.invoice_hash&&cur.statSessionId){PaymentsBox.showWaiting("");const a={act:"a_getvotes_invoice",type:cur.votesType,oid:r,votes:s,invoice_hash:t.invoice_hash,stat_session_id:cur.statSessionId};ajax.post("al_payments.php",a,{onDone:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_msg").innerHTML=e},onFail:function(e){return clearInterval(cur.smsChkStatInt),PaymentsBox.needContinue=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.showVotesAmounts():PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(e),!0}})}else PaymentsBox.showWaiting(e)}else if(5==n||6==n||8==n)PaymentsBox.getVotesCharge();else if(7==n){PaymentsBox.getVotesCharge(),cur._popup_text=PaymentsBox.popupHtml((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_cards_redirect"),"",""),cur._popup_callback=!1,cur._popup_href=!1;const e="/payments?act=go_gate&type=sms",t=Math.floor(window.screen.width/2)-350,s=Math.floor(window.screen.height/2)-300;(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.debugLog)(e),cur._popup=window.open(e,"_blank",`scrollbars=1, resizable=1, menubar=0, left=${t}, top=${s}, width=700, height=600`)}else if(1!=n&&4!=n&&1!=t)PaymentsBox.getVotesCharge(!1,!0);else{if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",d),3==r&&(PaymentsBox.checkStatusCallback=function(e){cur.isResetCheckedMaxSmsVotesValue=!1,cur.checkedMaxVotes=e,PaymentsBox.getVotesAmounts(!0)}),2==t&&s<=cur.votesAmountsData.confirm_max_votes){if(cur.paymentsWideBox)return void PaymentsBox.getVotesCharge();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_confcode_wrap"),PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm"),PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.getVotesCharge,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_back"),PaymentsBox.showVotesAmounts)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap"),PaymentsBox.smsGetCode();cur.votesAmountsData.resend_msg&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_sms_resend",cur.votesAmountsData.resend_msg),cur.votesAmountsData.confirm_wait_comment&&cur.votesAmountsData.confirm_wait_comment[r]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_comm",cur.votesAmountsData.confirm_wait_comment[r]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm_comm_wrap")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_comm").innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_confirm_comm_wrap"))}}else{let t;t=cur.votesAmountsData[cur.votesAmountsVal]?cur.votesAmountsData[cur.votesAmountsVal][0]:e,cur.checkoutEnabled?PaymentsBox.submitDmrCheckout(t):"card"===cur.votesType?PaymentsBox.submitCard(t):PaymentsBox.submitPaymentSystem(t)}}static offerOnLoad(html,js){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_offers_list");let offerView=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_offer_view");if(offerView){offerView.innerHTML=html,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(offerView);try{eval(js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,js)}}}static showWaiting(e){const t=cur.votesAmountsData[cur.votesAmountsVal]?cur.votesAmountsData[cur.votesAmountsVal][3]:0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_msg").innerHTML=e,t&&cur.votesAmountsData.confirm_wait_comment&&cur.votesAmountsData.confirm_wait_comment[t]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_comm").innerHTML=cur.votesAmountsData.confirm_wait_comment[t],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting_comm")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_comm").innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_waiting_comm")),PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons"),cur.paymentsWideBox&&cur.votesAmountsData[cur.votesAmountsVal]&&cur.votesAmountsData[cur.votesAmountsVal][7]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_amount").innerHTML=cur.votesAmountsData[cur.votesAmountsVal][6],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting_phone").innerHTML=cur.votesAmountsData[cur.votesAmountsVal][7],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting_mo")):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_waiting_mo"),delete cur.paymentsWaitingCache[cur.votesType],cur.smsChkStatInt&&clearInterval(cur.smsChkStatInt),cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval(PaymentsBox.checkStatus.pbind(cur.votesType,cur.smsChkData),2e3)}static showPhoneForm(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_msg","payments_getvotes_phone").innerHTML=t||(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_get_votes_input_phone"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("phone").value="",PaymentsBox.refreshBox(),t&&cur.paymentsWideBox?PaymentsBox.setButtons((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_save_phone"),PaymentsBox.saveSmsPhone):PaymentsBox.setButtons((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_save_phone"),PaymentsBox.saveSmsPhone,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_back"),2==e?PaymentsBox.getVotesAmounts:e?PaymentsBox.showVotesAmounts:PaymentsBox.showTypes),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_phone");const s=cur.uiPhoneCountry.container;if("spasibo"===cur.votesType)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_phone_prefix","+79");else{const e=cur.uiPhoneCountry.selectedItems();if(e.length>0)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_phone_prefix",e[0][3]);else for(let e=0,t=cur.countries.length;e<t;++e)cur.countries[e][0]==cur.defCountry&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_phone_prefix",cur.countries[e][3]);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(s)}return cur.paymentsBoxClass=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box").className,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("payments_box","payments_phone_form"),!1}static showPaySystemsList(){return PaymentsBox.refreshBox(),cur.paymentsWideBox&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_ps_list_title_header").innerText),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_ps","payments_votes_vkpay_promo_banner"),cur.votesType=!1,PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes),!1}static showVotesAmounts(){return PaymentsBox.refreshBox(),cur.checkoutEnabled?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm):"card"!==cur.votesType&&cur.psList[cur.votesType]&&!cur.psList[cur.votesType].in_menu?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_go_ps_list"),PaymentsBox.showPaySystemsList):PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_cont","payments_getvotes_wrap","payments_getvotes_buttons"),cur.paymentsWideBox&&cur.paymentsOrderNotice&&((0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_15__.showMsg)("payments_box_error",cur.paymentsOrderNotice,"info_msg",null),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_error")),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_6__.updateAriaElements)(),delete cur.votesAmountsData.appoveCode,!1}static showTypes(){if(cur.paymentsWideBox)return PaymentsBox.showVotesAmounts(),!1;if(PaymentsBox.refreshBox(),cur.votesAmountsVal=void 0,cur.votesAmountsData=[],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_method","payments_votes_vkpay_promo_banner"),cur.paymentBoxTitle){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().setOptions({title:cur.paymentBoxTitle})}return!1}static setButtons(e,t,s,a){if(!cur.paymentsWideBox||e){if(e){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_submit");s&&(s.innerHTML=e,s.onclick=t,s.dataset.taskClick="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(s,"payments_getvotes_buttons"))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons");if(cur.paymentsWideBox){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_back");e&&(e.innerHTML="",s&&e.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ce)("div",{className:"button",innerHTML:s,onclick:a,"data-task-click":""})))}else{let e=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();e&&(cur.paymentBoxTitle||(cur.paymentBoxTitle=e.getOptions().title),s?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("box_title",e.titleWrap).innerHTML=`<div class="back"><span class="back__icon">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_20__.getIcon24BrowserBack)().icon}</span>${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_box_title_back")}</div>`,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("back",e.titleWrap).onclick=a,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("back",e.titleWrap).dataset.taskClick=""):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("box_title",e.titleWrap).innerHTML=cur.paymentBoxTitle)}}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons")}static showBoxError(e,t){if("object"==typeof e&&(e=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_error_occured")),e&&cur.paymentsWideBox&&cur.checkoutEnabled){let t=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.MessageBox({title:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_error"),hideButtons:!0}),s=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();s&&s.hide(),t.content(e).show()}else{if(e){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box_error");s&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(s,""),(0,_web_lib_ui_util__WEBPACK_IMPORTED_MODULE_15__.showMsg)(s,e,t||"error"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(s))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress","payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_wrap"),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),PaymentsBox.hideRowProgress(),PaymentsBox.enablePaymentTypesRows()}}static showProgress(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_progress_msg","string"==typeof e?e:(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_waiting_payment_complete")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_error","payments_getvotes_wrap","payments_getvotes_buttons"),cur.paymentsWideBox&&e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_progress_link"):e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress_link"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_progress")}static hideRowProgress(){["payments_getvotes_ps",cur.paymentsWideBox?"payments_box_menu":"payments_getvotes_method"].forEach((e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(e)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_active_row",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e)).forEach((t=>{"payments_box_menu"!==e?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(t,"payments_getvotes_active_row"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(t,"payments_progress")}))}))}static refreshBox(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_box_progress","payments_box_error","payments_getvotes_method","payments_getvotes_cont","payments_getvotes_phone","payments_getvotes_confirm","payments_getvotes_waiting","payments_getvotes_other","payments_getvotes_terminals","payments_getvotes_ps","payments_getvotes_foreign_cards_warning","payments_iframe_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_wrap"),cur.smsChkStatInt&&!cur.paymentsWideBox&&clearInterval(cur.smsChkStatInt),cur.paymentsBoxClass&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box").className=cur.paymentsBoxClass,cur.paymentsBoxClass=""),cur.votesType&&"card"!==cur.votesType||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_foreign_cards_warning"),PaymentsBox.enablePaymentTypesRows()}static saveSmsPhone(){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("phone")),t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_phone_prefix")||{})||"");e&&(cur.paymentsWaitingCache.sms&&(clearInterval(cur.paymentsWaitingCache.sms[2]),delete cur.paymentsWaitingCache.sms),cur.newSmsPhone=t+e,PaymentsBox.getVotesAmounts())}static startFormMeasure(){cur.formMeasureTime=Date.now(),vk.dev&&(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.debugLog)(cur.formMeasureTime)}static finishFormMeasure(e){if(cur.formMeasureTime){const t=Date.now()-cur.formMeasureTime;vk.dev&&(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.debugLog)(t),delete cur.formMeasureTime,(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments_frame_load_time",t,e)}}static frameMessage(e){if(!e.origin.match(/^https?:\/\/([a-zA-Z0-9\-\.]+\.)?paymentgate\.ru$/)&&!e.origin.match(/^https?:\/\/([a-zA-Z0-9\-\.]+\.)?money\.mail\.ru$/)&&!e.origin.match(/^https?:\/\/co\.vkpay\.io$/))return!1;let t={};if(e.data){switch(typeof e.data){case"object":t=e.data;break;case"string":"{"===e.data.substr(0,1)&&(t=(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_16__.parseJSON)(e.data))}if("billing"!==t.type)return!1}if("pageLoad"===t.action||"formLoad"===t.action)cur.paymentsIgnoreResize=!1;else if("paySuccess"===t.action||"closeWindow"==t.action&&"ok"==t.action_params.status)cur.paymentsIgnoreResize=!0,cur.checkoutEnabled&&(PaymentsBox.showProgress(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_iframe_container"));else if("submit"===e.data||"3dsPage"===t.action)setTimeout(PaymentsBox.frameHeight.pbind(600,!0),200),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame");else if("3dsFinish"===t.action)PaymentsBox.frameHeight(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame");else if("resizeFrame"===t.action)if(t.action_params.height<10&&cur.paymentsIgnoreResize)cur.paymentsIgnoreResize=!1;else{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container");e&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(e,"payments_threeds_checkout_frame")&&setTimeout(PaymentsBox.frameHeight.pbind(t.action_params.height),200)}else"putPixel"===t.action&&"page_load"===t.action_params.alias?(PaymentsBox.finishFormMeasure("dmr"),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_loaded")):"session_fail"===t.action?(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_5__.statlogsValueEvent)("payments",0,"votes","dmr","iframe_session_fail"):("payError"===t.action||"closeWindow"==t.action&&["error","cancel"].includes(t.action_params.status))&&cur.checkoutEnabled?PaymentsBox.checkoutDecline(t.action_params):"typePaymentMethod"===t.action&&cur.checkoutEnabled&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container","payments_threeds_checkout_frame"),t.action_params&&t.action_params.system&&PaymentsBox.checkoutPayMethodChanged(t.action_params.system))}static frameHeight(e,t){let s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("card_iframe");s&&(e?(cur.prevFrameHeight=s.style.height,s.style.height=e+"px"):(s.style.height=cur.prevFrameHeight,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)("payments_iframe_container",cur.checkoutEnabled?"payments_threeds_checkout_frame":"payments_threeds_frame")));let a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_iframe_container");a&&(cur.paymentsWideBox&&!cur.checkoutEnabled||t||(a.style.height=(e||cur.prevFrameHeight)+(cur.checkoutEnabled?0:10)+"px"),a.scrollTop=0)}static paymentCanceled(e){e?cur.isPaymentFailed=!0:cur.isPaymentCanceled=!0,PaymentsBox.frameHeight()}static checkoutDecline(e){let t=e||{};t.act="checkout_decline",t.qid=cur.smsChkData.qid,t.hash=cur.smsChkData.declineHash,ajax.post("payments",t,{onDone:function(e){return PaymentsBox.stopCheckAndShowError(e),!0},onFail:function(e){return PaymentsBox.stopCheckAndShowError(e),!0}})}static checkoutPayMethodChanged(e){e&&ajax.post("payments",{act:"checkout_ps_choose",qid:cur.smsChkData.qid,pay_method:e})}static stopCheckAndShowError(e){clearInterval(cur.smsChkStatInt),PaymentsBox.needContinue=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.showVotesAmounts():cur.checkoutEnabled?PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm):PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(e)}static complete(e,t){cur.paymentCompleteParams=t,cur.isPaymentComplete=!0}static checkStatus(e,t,s,a){if("sms"===e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress")&&!cur.paymentsWideBox&&7!=cur.votesAmountsData[cur.votesAmountsVal][2])if(15==cur.smsChkStatCnt)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box_progress_msg").innerHTML=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_waiting_payment_complete_still");else if(cur.smsChkStatCnt>30){return clearInterval(cur.smsChkStatInt),cur.isPaymentAttemted=!0,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().hide(),void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.showFastBox)((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_internet_getting_votes"),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_get_votes_delay"))}let n={act:"a_getvotes_check",type:e,votes_purchase:cur.isPaymentsAppOrder||cur.paymentsWideBox||cur.paymentsInstantPayType?0:1};t&&(t.oid||t.qid)?(n.oid=t.oid,n.qid=t.qid,n.hash=t.hash):n.hash=cur.psList[e].check_hash,0==cur.smsChkStatCnt&&(n.start=1),cur.statSessionId&&(n.stat_session_id=cur.statSessionId),t.test&&(n.test=1);let r=a||(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)();ajax.post("al_payments.php",n,{onDone:function(s,a,n){if("sms"===e&&cur._popup&&cur._popup.closed)return clearInterval(cur.smsChkStatInt),cur.smsChkStatCnt=0,PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_payment_cancelled"),"info_msg"),void PaymentsBox.setConfirmButtons();if(s){if(1==s){if(window.cur.paymentSuccess=!0,"mailmoney_vkpay"===e&&WkView&&(r._show(),cur.onExternalAppDone=null,WkView.hide(!1,!0)),cur.isPaymentAttemted=!0,PaymentsBox.needContinue&&(cur.needContinue=1,PaymentsBox.needContinue=0),cur.paymentsHideLastBoxOnly)boxQueue.hideLast(!1),delete cur.paymentsHideLastBoxOnly;else for(;boxQueue.count();)boxQueue.hideLast(!1);if(a&&!cur.isPaymentsAppOrder&&(!cur.paymentsTryCompleteOrder||!r.onDone)){let e=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_12__.MessageBox({width:400,hideButtons:!0,bodyStyle:"padding: 0; border-radius: 8px;"});e.content(a),e.show()}n&&(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_16__.updateMoney)(n)}else if(2==s||10==s)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_iframe_container")?PaymentsBox.showVotesAmounts():PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(a);else if(3==s){let s="sms"===e;cur.votesAmountsData[cur.votesAmountsVal]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",cur.votesAmountsData[cur.votesAmountsVal][0]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",cur.votesAmountsData[cur.votesAmountsVal][1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",s?cur.votesAmountsData[cur.votesAmountsVal][6]:cur.votesAmountsData[cur.votesAmountsVal][1])):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_num",cur._otherVotes),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_amount",cur._otherAmount+" "+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(cur._otherAmount,cur.votesAmountsData.currency_price_str)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_box_votes_money",cur._otherAmount+" "+(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.langNumeric)(cur._otherAmount,cur.votesAmountsData.currency_price_str))),s||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_get_votes_ps_enter_code")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_confirm_amount")),cur.votesAmountsData.confirm_wait_comment&&cur.votesAmountsData.confirm_wait_comment[t.oid]?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_comm").innerHTML=cur.votesAmountsData.confirm_wait_comment[t.oid],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_confirm_comm_wrap")):s&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_confirm_comm").innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_confirm_comm_wrap")),"spasibo"===e&&(cur.updateTnxHash=a),PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_box_confcode_wrap","payments_getvotes_confirm"),s&&a&&PaymentsBox.showBoxError(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("confcode").onkeypress=s?"":PaymentsBox.checkPinKeyPress,PaymentsBox.setButtons(cur.payments_get_votes,s?PaymentsBox.smsSendCode:PaymentsBox.confirmPinCode,cur.paymentsChangeType,PaymentsBox.showTypes)}else{if(4==s){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")&&!cur.paymentsWaitingCache.sms){let e=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_to_get_send_sms",cur.votesAmountsData[cur.votesAmountsVal][0]);cur.paymentsWideBox||(e+=`<br/>${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_service_cost")}`),e=e.replace("{number}",a.service_number),e=e.replace("{text}",`<nobr>${a.message_text}</nobr>`),e=e.replace("{amount}",cur.votesAmountsData[cur.votesAmountsVal][1]),PaymentsBox.showWaiting(e)}return}if(5==s)PaymentsBox.refreshBox(),PaymentsBox.showConfirm();else if(6==s)delete cur.votesAmountsData.oauth_url,delete cur.paymentsInstantPayType,PaymentsBox.showVotesAmounts(),PaymentsBox.showBoxError((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_instant_pay_amount_limit_error")),PaymentsBox.setConfirmButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_remember_wallet",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("payments_getvotes_confirm_descr","payments_getvotes_cont"));else{if(7==s)return void(cur._popup&&!cur._popup_href&&(cur._popup_href=a,cur._popup.location.href=a));if(8==s)return void PaymentsBox.checkStatusCallback(a);if(9==s)return void PaymentsBox.show3DsFrame(a,n)}}clearInterval(cur.smsChkStatInt),cur.smsChkStatCnt=0}},onFail:function(e){return PaymentsBox.stopCheckAndShowError(e),!0}}),cur.smsChkStatCnt++}static checkStatusCallback(e){}static getVotesCharge(e,t){if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.isButtonLocked)("payments_getvotes_submit")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress"))return;if(!((e=parseInt(e,10))||null!=cur.votesAmountsVal&&cur.votesAmountsData[cur.votesAmountsVal]))return;let s={act:"a_getvotes_charge",type:cur.votesType,hash:cur.paymentsHash,stat_session_id:cur.statSessionId};const a=PaymentsBox.getEmail();""!==a&&(a&&(s.email=a),t?(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit"):PaymentsBox.showProgress(),e?(s.pid=-1,s.votes=e):(s.pid=cur.votesAmountsVal,-1==cur.votesAmountsVal&&(s.votes=cur.votesAmountsData[cur.votesAmountsVal][0])),cur.isResetCheckedMaxSmsVotesValue&&(s.pay_by_repay_status=1),PaymentsBox.disablePaymentTypesRows(),ajax.post("al_payments.php",s,{onDone:(s,a,n,r)=>{PaymentsBox.setCurMidas(r),PaymentsBox.votesChargeOnDone(s,e,t)},onFail:e=>((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_box_progress")&&PaymentsBox.setButtons(cur.payments_get_votes,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_confirm")?PaymentsBox.getVotesCharge:PaymentsBox.showConfirm,cur.paymentsChangeType,PaymentsBox.showTypes),PaymentsBox.showBoxError(e),!0)}))}static votesChargeOnDone(e,t,s){if(e)if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),-1==e)PaymentsBox.getVotesAmounts(!0);else if(e.qid)if(cur.smsChkData=e,s){const e=(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_for_get_n_votes",t||cur.votesAmountsData[cur.votesAmountsVal][0]);let s=cur.votesAmountsData.confirm_wait_msg.replace("{amount}",e);if(s+=t?`<br/>${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_service_cost_rubles",cur._otherAmount)}`:`<br/>${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_service_cost").replace("{amount}",cur.votesAmountsData[cur.votesAmountsVal][1])}`,cur.paymentsWideBox){s+=`<br><br/><a onclick="return PaymentsBox.showPhoneForm(1);">${(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_change_phone_number")}</a>`}PaymentsBox.showWaiting(s)}else cur.smsChkStatCnt=0,cur.smsChkStatInt=setInterval(PaymentsBox.checkStatus.pbind(cur.votesType,e),2e3)}static getVotesAmounts(e,t,s){if(null!=t&&cur.paymentsWideBox){if(cur.votesType==t&&cur.votesTypeInit!=t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_cont")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_terminals")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_ps")))return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_waiting")?cur.paymentsWaitingCache[cur.votesType]=[(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting").innerHTML,cur.smsChkStatInt]:cur.smsChkStatInt&&!cur.paymentsWaitingCache[t]&&clearInterval(cur.smsChkStatInt),cur.votesType=t}else null!=t&&(cur.votesType=t);if(!cur.votesType)return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_foreign_cards_warning");if(cur.paymentsWideBox&&!s&&(s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("payments_method_"+cur.votesType,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_box_menu")))),cur.paymentsWideBox&&cur.paymentsTypesSum&&cur.paymentsTypesSum[t]){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_summary_bill");e?e.innerHTML=cur.paymentsTypesSum[t]:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_order_sum",cur.paymentsTypesSum[t]),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_17__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_tt"),((e,t)=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.re)(t)}))}let a="term"===cur.votesType||"ps"===cur.votesType;if(a){PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_method");let e="";if("term"===cur.votesType?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_terminals"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_votes_vkpay_promo_banner"),e="payments_terminals_title_header"):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_ps"),e="payments_ps_list_title_header"),cur.paymentsWideBox&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(e).innerText),PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes),!cur.paymentsWideBox)return}const n=["payments_getvotes_ps",cur.paymentsWideBox?"payments_box_menu":"payments_getvotes_method"];for(let t=0;t<n.length;t++){let r=n[t];if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)(r)||cur.paymentsWideBox&&!s||"payments_box_menu"===r&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_ps")&&s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(s.parentNode,"payments_getvotes_ps_list"))continue;let d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)(r),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_active_row",d);if(!e&&_.length&&!cur.paymentsWideBox)return;_.forEach((e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(e,"payments_getvotes_active_row"),cur.paymentsWideBox&&!a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.removeClass)(e,"payments_progress")}))}if(s&&(!cur.paymentsWideBox||"payments_box_menu"!==s.parentNode.id||a||e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(s,"payments_progress"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.addClass)(s,"payments_getvotes_active_row")),cur.paymentsWideBox&&cur.paymentsWaitingCache[t])return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_title").innerHTML=cur.paymentsWaitingCache[t][0],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_waiting").innerHTML=cur.paymentsWaitingCache[t][1],PaymentsBox.refreshBox(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_waiting","payments_getvotes_title"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_buttons"),void PaymentsBox.hideRowProgress();if(a)return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.isVisible)("payments_getvotes_buttons")&&!cur.paymentsWideBox&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.lockButton)("payments_getvotes_submit");let r={act:"a_getvotes_amounts",type:cur.votesType,prefer_votes:cur.paymentsPreferVotes,hash:cur.paymentsHash};if(cur.statSessionId&&(r.stat_session_id=cur.statSessionId),cur.isPaymentsAppOrder&&cur.paymentsOrderAppId&&(r.aid=cur.paymentsOrderAppId,cur.paymentsOrderBillPeriod&&(r.bill_period=cur.paymentsOrderBillPeriod),cur.paymentsOrderDiscount&&(r.discount=cur.paymentsOrderDiscount)),"sms"===r.type)cur.checkedMaxVotes&&(r.checked_max_votes=cur.checkedMaxVotes,cur.checkedMaxVotes=0),cur.newSmsPhone&&(r.phone=cur.newSmsPhone,cur.newSmsPhone=!1),cur.isCorpPhone&&(r.corp=cur.isCorpPhone,cur.isCorpPhone=!1);else if("offers"===r.type){const e=(0,_shared_apps_MiniAppsService_utils_getCurrentApp__WEBPACK_IMPORTED_MODULE_19__.getCurrentApp)();if(e?.options&&(r.isAppOrder=cur.paymentsOfferApp?1:0,r.aid=e.options.aid,r.orderBox=cur.isPaymentsAppOrder?1:0),cur.paymentsPreload)return PaymentsBox.getVotesAmountsOnDone.apply(this,cur.paymentsPreload),cur.paymentsPreload=!1,void(cur.paymentsOfferPreload&&(PaymentsBox.offerOnLoad.apply(this,cur.paymentsOfferPreload),cur.paymentsOfferPreload=!1,cur.paymentsOneOffer=!0))}else if("spasibo"===r.type)cur.newSmsPhone&&(r.phone=cur.newSmsPhone,cur.newSmsPhone=!1),cur.needContinue&&(r.continue=1,cur.needContinue=0);else if(cur.psList[r.type]&&cur.psList[r.type].simple_redirect)return PaymentsBox.hideRowProgress(),void PaymentsBox.submitPaymentSystem();ajax.post("al_payments.php",r,{onDone:PaymentsBox.getVotesAmountsOnDone,onFail:e=>(PaymentsBox.showBoxError(e),!0)})}static getVotesAmountsOnDone(result,html,data,js,title){if(PaymentsBox.hideRowProgress(),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_14__.unlockButton)("payments_getvotes_submit"),cur.paymentsWideBox&&(title&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_title",title),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_title")),data&&data.menu_money)){let e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_summary_bill");e?e.innerHTML=data.menu_money:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(`payments_method_${cur.votesType}_descr`,data.menu_money)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_votes_vkpay_promo_banner"),-1==result)return void PaymentsBox.showPhoneForm();if(-2==result)return void PaymentsBox.showPhoneForm(!1,html);if(-3==result){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_method_opt","payments_box_menu");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("payments_getvotes_active_row","payments_box_menu"));for(let t=0;t<e.length;t++){let s=e[t];if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hasClass)(s,"payments_getvotes_active_row")){s.onclick();break}}return}if(!result)return PaymentsBox.showProgress(""),void(cur.smsAmountsInt=setTimeout((()=>{PaymentsBox.getVotesAmounts(!0)}),1e3));if(!html)return;let other;if(2==result?(other=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_other"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)(other,html)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_cont",html),cur.votesAmountsData=data,(cur.fromInstantPay&&2==cur.votesAmountsData.confirm_type||2!=cur.votesAmountsData.confirm_type||!cur.votesAmountsData.checked_max_sms_votes_val)&&PaymentsBox.showVotesAmounts(),cur.votesType&&"card"!==cur.votesType?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_foreign_cards_warning"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_getvotes_foreign_cards_warning"),cur.paymentsPreload&&"offers"===cur.votesType?PaymentsBox.setButtons(!1):"offers"===cur.votesType?PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes):cur.paymentsPreload&&PaymentsBox.setButtons(cur.payments_get_votes,PaymentsBox.showConfirm),window.radioBtns.payments_getvotes_amounts={els:Array.prototype.slice.apply((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("radiobtn",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_getvotes_amounts")))},data.confirm_msg&&data.confirm_type&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.val)("payments_getvotes_confirm_msg",data.confirm_msg),2==result&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_getvotes_wrap"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)(other)),js)try{eval(js)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_8__.logEvalError)(e,js)}cur.instantNeedCVV&&(PaymentsBox.showConfirm(),cur.instantNeedCVV=!1),cur.paymentsEmailInput=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_receipt_email"),cur.paymentsEmailCheckbox=!!cur.paymentsEmailInput&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass1)("_checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.domPN)(cur.paymentsEmailInput))}static popupHtml(e,t,s){return`<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">\n<head>\n    <meta http-equiv="content-type" content="text/html; charset=windows-1251" />\n    <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n    <style>\n        body {font-family:tahoma,verdana,arial,sans-serif,Lucida Sans; font-size:11px;}\n        .text {position:relative; top:40%; text-align:center; line-height:24px;}\n        .text img {margin-bottom:8px;}\n        .text_container {position:absolute; top:0; left:0; right:0; bottom:0; line-height:150%; height: 100%;}\n    </style>\n    <script type="text/javascript">\n      if (!window.vk) window.vk = {loginscheme: '${vk.loginscheme}', ip_h: '${vk.ip_h}', __domain: '${(0,_shared_lib_site__WEBPACK_IMPORTED_MODULE_4__.getHostName)()}'};\n    <\/script>\n    <script type="text/javascript" src="${window.stManager.getCompiledPath(window.jsc("web/payments_legacy.js"))}"><\/script>\n</head>\n<body>\n${t}\n<div id="wait_text_container" class="text_container">\n    <div class="text">\n        <img src="/images/progress.gif" /><br/>${e}\n    </div>\n</div>\n<script type="text/javascript">\n  var st = setTimeout(function() {try {${s}; clearTimeout(st)} catch(e) {}}, 100)\n<\/script>\n</body>\n</html>`}static viewOffer(e){this.setButtons(e,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("start_offer").submit(),PaymentsBox.setButtons((0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("payments_back_to_offers_list"),PaymentsBox.backToOffersList,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_cancel"),PaymentsBox.backToOffersList)}),(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_cancel"),PaymentsBox.backToOffersList)}static backToOffersList(){if(cur.paymentsOneOffer)return(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().hide();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.hide)("payments_offer_view"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.show)("payments_offers_list"),cur.votesTypeInit||!1===cur.votesTypeInit?PaymentsBox.setButtons(!1):PaymentsBox.setButtons(!1,!1,cur.paymentsChangeType,PaymentsBox.showTypes)}static initializeOfferChecker(e,t,s,a){cur.offersOffset=e,cur.offersAppCurrency=t,PaymentsBox.checkOffersList=[],PaymentsBox.checkOffersDo=()=>{if(s)return;const e=PaymentsBox.checkOffersList.join(",");PaymentsBox.checkOffersList=[],ajax.post("al_payments.php",{act:"a_offers_stat",offers:e,hash:a}),PaymentsBox.checkOffersTO=!1},PaymentsBox.checkOffers(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("box_layer_wrap"),"scroll",PaymentsBox.checkOffers)}static removeCheckOffersEvent(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_10__.removeEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("box_layer_wrap"),"scroll",PaymentsBox.checkOffers)}static checkOffers(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_offer",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("payments_offers_wrap")),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.ge)("box_layer_wrap").scrollTop,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)("box_layer_wrap")[1];e.forEach((e=>{const a=e,n=a.offsetTop;n+30<t+s&&n+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.getSize)(a)[1]-20>t&&!a.getAttribute("checked")&&(a.setAttribute("checked",1),PaymentsBox.checkOffersList.push(a.id.substr(15)),PaymentsBox.checkOffersTO||(PaymentsBox.checkOffersTO=setTimeout(PaymentsBox.checkOffersDo,1e3)))}))}static offersRemoveButtons(){cur.votesTypeInit?PaymentsBox.setButtons(!1):PaymentsBox.setButtons(cur.paymentsChangeType,PaymentsBox.showTypes,(0,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_close"),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_7__.curBox)().hide)}static disablePaymentTypesRows(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_method_opt");if(e&&e.length>0)for(let t=0;t<e.length;t++){let s=e[t];s.classList.contains("payments_getvotes_active_row")?s.classList.add("payments_getvotes_noevents_row"):s.classList.add("payments_getvotes_disabled_row","payments_getvotes_noevents_row")}}static enablePaymentTypesRows(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_9__.geByClass)("payments_getvotes_method_opt");if(e&&e.length>0)for(let t=0;t<e.length;t++)e[t].classList.remove("payments_getvotes_disabled_row","payments_getvotes_noevents_row")}static handlePaymentCompleteMessage(e){e.origin==window.origin&&e.data.type&&"paymentCompleteMessage"===e.data.type&&window.PaymentsBox.complete(e.data.newUrl,e.data.params)}static setCurMidas(e){"object"==typeof e&&"isMidas"in e&&("cur"in window||(window.cur={}),window.cur.isMidas=Boolean(e.isMidas))}}},880789:(e,t,s)=>{"use strict";s.d(t,{initSettingsAddressBox:()=>c});var a=s(754866),n=s(593159),r=s(972332),d=s(342879),_=s(683234),l=s(866467),u=s(952661);function c(e,t){e.setOptions({title:(0,l.getLang)("settings_addrbox_title")});const s=document.querySelector("#settdbx_addr"),c=document.querySelector("#settdbx_addr_tt_place");s.onfocus=function(){-2===cur.addrChecked&&(0,d.showTooltip)(c,{text:(0,l.getLang)("settings_addrbox_hint"),dir:"left",slideX:15,className:"settings_pwd_tt",shift:[-12,-15,0],onCreate:function(){(0,r.removeEvent)(c,"mouseout")}})},s.onblur=function(){c.tt&&c.tt.hide()},(0,a.elfocus)(s),setTimeout(a.elfocus.pbind(s),100),(0,a.setStyle)(s,{width:230-(0,a.ge)("settdbx_base").offsetWidth-8}),(0,n.extend)(cur,{settDomainCheckAddress:function(e){clearTimeout(cur.addressCheckTO),cur.lastAddress!==(0,a.val)("settdbx_addr")&&(cur.addressCheckTO=setTimeout(cur.settDomainDoCheckAddress,e||0))},settDomainDoCheckAddress:function(){let e=document.querySelector("#settdbx_submit"),t=document.querySelector("#settdbx_advices");cur.lastAddress=(0,a.val)("settdbx_addr"),ajax.post("al_settings.php",{act:"a_check_address",name:cur.lastAddress,from:"box"},{onDone:function(s){cur.addrChecked=1,u.FlatButton.setLabel(e,s),u.FlatButton.setDisabled(e,!1),(0,a.val)(t,"")},onFail:function(n){let r=(n=n.split("<*>"))[1],d=n[2];return n=n[0],d?(cur.addrChecked=-2,s.onfocus()):(cur.addrChecked=-1,s.onblur()),u.FlatButton.setLabel(e,n),u.FlatButton.setDisabled(e,!0),(0,a.val)(t,r),!0}})},settDomainAdvisedAddress:function(e){(0,a.val)("settdbx_addr",e),cur.settDomainCheckAddress()},settDomainAddressSubmit:function(e){if(1!==cur.addrChecked)return void(0,_.notaBene)("settings_addr");let s=(0,a.val)("settdbx_addr"),n={act:"a_change_address",hash:t,name:s};u.FlatButton.lock(e),window.ajax.post("al_settings.php",n,{onDone:function(e){nav.go(s,!1,{params:{from:"address_box"}})},showProgress:()=>u.FlatButton.lock(e),hideProgress:()=>u.FlatButton.unlock(e)})}})}},443291:(e,t,s)=>{"use strict";s.d(t,{showNextPaymentsHistory:()=>d});var a=s(683234),n=s(575753),r=s(754866);const d=(e,t)=>{if((0,a.isButtonLocked)(e))return;let s,d;return(0,a.lockButton)(e),t||(t="votes"),void 0===cur.historyOffset[t]&&(cur.historyOffset[t]=5),"transfer"===t?(s={act:"a_transfer_history"},d=(0,r.ge)("settings_transfer_history")):"subscriptions"===t?(s={act:"a_payments_subsciptions"},d=(0,r.ge)("settings_payments_subscriptions")):"games"===t?(s={act:"a_payments_games"},d=(0,r.ge)("settings_payments_games")):"goods_orders"===t?(s={act:"a_payments_goods_orders"},d=(0,r.ge)("settings_payments_goods_orders")):(s={act:"a_votes_history"},d=(0,r.ge)("settings_votes_history")),s.offset=d.rows.length,"subscriptions"===t&&(s.extra_items_count=cur.historyExtraItemsSubscriptions),ajax.post("al_settings.php",s,{onDone:function(s,_,l){const u=d.tBodies[0];if(s){if((0,a.unlockButton)(e),n.browser.msie){const e=(0,r.se)("<table>"+s+"</table>");Array.from((0,r.geByTag)("tr",e)).forEach((e=>{1===e.nodeType&&u.appendChild(e)}))}else u.insertAdjacentHTML("beforeEnd",s);"subscriptions"===t&&l&&(cur.historyExtraItemsSubscriptions=l)}s&&!_||((0,r.addClass)(u.lastChild,"settings_votes_history_last"),(0,r.hide)(e))}}),!1}},428374:(e,t,s)=>{"use strict";s.d(t,{InlineDropdown:()=>c});var a=s(754866),n=s(575753),r=s(604723),d=s(972332),_=s(600222),l=s(898848),u=s(593159);function c(e,t){if(this.constructor!==c)throw new Error("InlineDropdown was called without 'new' operator");if(!(e=(0,a.ge)(e)))return;if(!e.nodeType)throw new Error("First argument not a DOM element");if((0,a.hasClass)(e,"idd_wrap"))return;if(this._opts=t||{},this._items=t.items?(0,u.clone)(t.items):JSON.parse(e.getAttribute("data-items")),!this._items)throw new Error("No items provided");this._title=t.keepTitle?t.title||e.innerHTML:"",this._selectable=!t.keepTitle||t.keepSelected,this._disableCancelClickEvent=!!t.disableCancelClickEvent&&!!t.disableCancelClickEvent;const{icon:s}=(0,_.getIcon12Dropdown)();this._iddEl=(0,a.se)(`<div class="idd_wrap" id="${e.id}">\n    <div class="idd_selected_value" tabindex="0" role="button">\n      ${e.innerHTML}\n    </div>\n    ${t.withArrow?`<div class="idd_chevron">${s}</div>`:""}\n    <input type="hidden" id="${e.id}_input" name="${e.getAttribute("name")||e.id}" />\n  </div>`);let n=this;if((0,l.each)(e.className.split(" "),(function(e,t){(0,a.addClass)(n._iddEl,t)})),(0,l.each)(e.attributes,(function(e,t){0==t.name.indexOf("data-")&&n._iddEl.setAttribute(t.name,t.value)})),e.parentNode.replaceChild(this._iddEl,e),this._els={valueEl:(0,a.geByClass1)("idd_selected_value",this._iddEl),itemsContentEl:(0,a.geByClass1)("idd_items_content",this._iddEl),hiddenInputEl:(0,a.geByTag1)("input",this._iddEl)},this._opts.autoShow){let e=!1;const t=function(){e=!0,clearTimeout(n._autoShowTimeout),n._autoShowTimeout=setTimeout((function(){e&&n._onClick()}),100)},s=function(){clearTimeout(n._autoShowTimeout),e=!1};(0,d.addEvent)(this._iddEl,"mouseenter",t),(0,d.addEvent)(this._iddEl,"mouseleave",s),(0,d.addEvent)(this._iddEl,"keydown",(e=>"Enter"===e.key&&e.target.getAttribute("class").includes("idd_selected_value")?t():null))}else(0,d.addEvent)(this._iddEl,"click",this._onClick.bind(this)),(0,d.addEvent)(this._iddEl,"keydown",(e=>"Enter"===e.key&&e.target.getAttribute("class").includes("idd_selected_value")?this._onClick.call(this):null));this._rebuildDropdown();let r=!1;void 0!==t.selected?r=t.selected:e.hasAttribute("data-value")&&(r=e.getAttribute("data-value")),!1!==r&&this.select(r,!0)}c.IDD_HEADER_CORRECTION_LEFT=-10,c.IDD_HEADER_CORRECTION_TOP=-8,c.prototype.updateItems=function(e){this._items=(0,u.clone)(e),this._rebuildDropdown()},c.prototype._rebuildDropdown=function(){let e=this._opts.withIcon?"idd_with_icon":"",t=this._opts.idPrefix?this._opts.idPrefix:"",s=this._opts.idItemPrefix?this._opts.idItemPrefix:"",r=this,u=this._opts.ariaLabel||"";const{icon:p}=(0,_.getIcon12Dropdown)();let m=`<div class="idd_header_wrap ${e}">\n    <div class="idd_header" id="${t}${this._items[0][0]}"></div>\n      ${this._opts.withArrow?`<div class="idd_chevron">${p}</div>`:""}\n    </div>`,y=`<div class="idd_items_wrap"><div class="idd_items_content" role="list" aria-label="${u}">`;(0,l.each)(this._items,(function(t,a){y+="separator"===a?'<div class="idd_separator"></div>':function(t,a){a=a||"";let n=r._opts.sublists&&r._opts.sublists[t[0]]?"idd_sublist":"";return`<div class="idd_item ${a} ${e} ${n}" id="${s}idd_item_${t[0]}" data-testid="${s+"idd_item_"+t[0]}" data-id="${t[0]}" tabindex="0" role="button">\n      ${r._opts.withIcon?'<div class="idd_item_icon" id="'+t[0]+'"></div>':""}\n      <div class="idd_item_name">${r._opts.html?r._opts.html(t):t[1]}</div>\n    </div>`}(a)})),y+="</div></div>",this._els.popupItems=(0,a.se)(y),this._els.popupHeader=(0,a.se)(m),(0,d.addEvent)(this._els.popupItems,"click",(function(e){let t=e.target;if("a"!=t.tagName.toLowerCase()){for(;t&&!(0,a.hasClass)(t,"idd_item");)t=t.parentNode;if(t){const s=t.getAttribute("data-id");if(r._opts.customClickHandler?.(Number(s)))return void(0,d.cancelEvent)(e);r.select(s)?r._hide():r._hoverItem(t)}(0,d.cancelEvent)(e)}else setTimeout((function(){r._hide()}))})),(0,l.each)((0,a.geByClass)("idd_item",this._els.popupItems),(function(e,t){(0,d.addEvent)(t,"mouseenter",(function(e){c._preventMouseHover||r._hoverItem(e.currentTarget)})),(0,d.addEvent)(t,"mouseleave",(function(e){c._preventMouseHover||r._unhoverItem(e.currentTarget,e)}))})),(0,d.addEvent)(this._els.popupItems,"mouseenter",function(){(0,d.addEvent)(this._els.popupItems,n.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this)),(0,d.addEvent)(this._els.popupItems,"mouseleave",function(){(0,d.removeEvent)(this._els.popupItems,n.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this))},c.prototype._onClick=function(e){if((0,a.isVisible)(this._els.popupEl))return void this._hide();c._currIDD&&c._currIDD._hide(),c._currIDD=this,window.tooltips&&tooltips.hideAll();let t=this;let s=this._els.popupEl=(0,a.se)('<div class="idd_popup"></div>');this._opts.alignLeft&&(0,a.addClass)(s,"idd_align_left"),this._opts.popupClass&&(0,a.addClass)(s,this._opts.popupClass),this.openToUp=1==this._opts.forceDir||"up"==this._opts.forceDir||-1!=this._opts.forceDir&&"down"!=this._opts.forceDir&&(0,a.getXY)(t._iddEl)[1]-((window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0))+200>window.innerHeight,this.openToUp?(s.appendChild(this._els.popupItems),s.appendChild(this._els.popupHeader),(0,a.addClass)(s,"idd_popup_up")):(s.appendChild(this._els.popupHeader),s.appendChild(this._els.popupItems));let n=(0,a.geByClass1)("idd_header",this._els.popupHeader);this._opts.keepTitle?n.innerHTML=this._title:n.innerHTML=this._selected?this._selected[1]:"",s.id="idd_"+this._iddEl.id,this._iddEl.appendChild(s);let r=(0,a.getSize)(s),_=(0,a.getSize)(this._els.valueEl),l=0;this.openToUp&&(l=-(0,a.getSize)(this._els.popupItems)[1]);let u={marginTop:(this._opts.headerTop||c.IDD_HEADER_CORRECTION_TOP)-_[1]+l,width:r[0]+8,opacity:1};this._opts.alignLeft?u[vk.rtl?"marginRight":"marginLeft"]=_[0]-c.IDD_HEADER_CORRECTION_LEFT:u.marginLeft=(this._opts.headerLeft||c.IDD_HEADER_CORRECTION_LEFT)-(this._opts.withIcon?20:0),(0,a.setStyle)(s,u),this._unhoverItem(),this._highlightItem(),this._initOutEvent(),this._initKeypressEvent(),this._opts.onShow&&this._opts.onShow(this.ddEl),this._disableCancelClickEvent||(0,d.cancelEvent)(e)},c.prototype._hide=function(){(0,a.re)(this._els.popupEl),this._els.popupEl=null,(0,a.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredItem=null,this._deinitEvents(),this._hideSubmenu(),clearTimeout(this._hideSubmenuTimeout),this._opts.onHide&&this._opts.onHide()},c.prototype._highlightItem=function(e){if(!this._selectable)return;if(!this._els.popupEl)return;if(void 0===e){if(!this._selected)return;e=this._selected[0]}let t=(0,a.geByClass1)("idd_hl",this._els.popupEl);t&&(0,a.removeClass)(t,"idd_hl");let s=(0,a.ge)("idd_item_"+e);(0,a.addClass)(s,"idd_hl");let n=this;(0,l.each)((0,a.geByClass)("idd_item",this._els.popupItems),(function(e,t){if(t==s)return n._els.popupItems.scrollTop=(e+1)*(0,a.getSize)(t)[1]-(0,a.getSize)(n._els.popupItems)[1]/2,!1}))},c.prototype._onWheel=function(e){let t=(0,a.getSize)((0,a.geByClass1)("idd_items_content",this._els.popupItems))[1],s=(0,a.getSize)(this._els.popupItems)[1];t!=s&&(0==this._els.popupItems.scrollTop&&e.deltaY<0||this._els.popupItems.scrollTop==t-s&&e.deltaY>0)&&(0,d.cancelEvent)(e)},c.prototype._onKeyDown=function(e){switch(e.keyCode){case 9:case 38:case 40:case 13:case 27:this._onKey(e.keyCode,e)}},c.prototype._onKeyPress=function(e){this._onKey(e.which,e)},c.prototype._hideSubmenu=function(){(0,a.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent"),(0,a.re)(this._els.currCascade),delete this._currSubmenuItem,this._hoveredItem&&this._showSubmenu(this._hoveredItem)},c.prototype._showSubmenu=function(e){if(clearTimeout(this._hideSubmenuTimeout),!e)return;let t=this,s=e.getAttribute("data-id");if(this._opts.sublists&&this._opts.sublists[s]){if((0,a.addClass)(e,"idd_hover_sublist_parent"),this._currSubmenuItem==e)return void clearTimeout(this._submenuHideTimeout);let n=this._opts.sublists[s],_='<div class="idd_popup"><div class="idd_items_wrap"><div class="idd_items_content">',u=n.withIcon?"idd_with_icon":"";function p(e,t){return'<div class="idd_item '+(t=t||"")+" "+u+'" id="idd_item_'+e[0]+'" data-id="'+e[0]+'" role="button" tabindex="0">'+(n.withIcon?'<div class="idd_item_icon" id="'+e[0]+'"></div>':"")+'<div class="idd_item_name">'+(n.html?n.html(e):e[1])+"</div></div>"}(0,l.each)(n.items,(function(e,t){_+=p(t)})),_+="</div></div></div>",this._els.currCascade=(0,a.se)(_),this._iddEl.appendChild(this._els.currCascade);{let m=(0,a.getSize)(this._els.popupEl),y=(0,a.getSize)(e),g=(0,a.getSize)(this._els.currCascade),f=0,E=e;for(;null!=(E=E.previousSibling);)f++;let A=m[0]+(this._opts.headerLeft||c.IDD_HEADER_CORRECTION_LEFT)-1;(0,a.setStyle)(this._els.currCascade,{marginLeft:A-3,marginTop:y[1]*f+6-(this.openToUp?m[1]:0),"z-index":200,width:g[0]+30}),setTimeout((function(){(0,r.cssAnim)(t._els.currCascade,{marginLeft:A,opacity:1},{duration:140})}),10)}(0,l.each)((0,a.geByClass)("idd_item",this._els.currCascade),(function(e,s){(0,d.addEvent)(s,"mouseenter",(function(e){t._isInSubmenu=!0,c._preventMouseHover||t._hoverItem(e.currentTarget,null,!0)})),(0,d.addEvent)(s,"mouseleave",(function(e){t._isInSubmenu=!1,c._preventMouseHover||t._unhoverItem()}))})),(0,d.addEvent)(this._els.currCascade,"click",(function(e){let s=e.target;if("a"!=s.tagName.toLowerCase()){for(;s&&!(0,a.hasClass)(s,"idd_item");)s=s.parentNode;if(s){let e=!0,r=s.getAttribute("data-id"),d=(0,a.geByClass1)("idd_item_name",s).innerHTML;n.onSelect?e=n.onSelect(r,d):t._opts.onSelect&&(e=t._opts.onSelect(r,d)),e&&t._hide()}(0,d.cancelEvent)(e)}else setTimeout((function(){t._hide()}))})),this._currSubmenuItem=e}},c.prototype._hoverItem=function(e,t,s){let n=this;if(this._unhoverItem(),(0,a.addClass)(e,"idd_hover"),this._hoveredItem=e,t&&e){let t=e.getAttribute("id"),s=this;(0,l.each)((0,a.geByClass)("idd_item"),(function(n,r){if(r.getAttribute("id")==t)return s._els.popupItems.scrollTop=(0,a.getSize)(e)[1]*(n+1)-(0,a.getSize)(s._els.popupItems)[1]/2,clearTimeout(c._preventMouseHover),c._preventMouseHover=setTimeout((function(){c._preventMouseHover=null}),100),!1}))}if(clearTimeout(this._hideSubmenuTimeout),s)(0,a.addClass)(this._currSubmenuItem,"idd_hover_sublist_parent");else{let t=this._currSubmenuItem==e;this._currSubmenuItem&&!t&&(this._hideSubmenuTimeout=setTimeout((function(){n._hideSubmenu()}),200)),this._currSubmenuItem||this._showSubmenu(e),(0,a.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent")}},c.prototype._unhoverItem=function(e,t){this._hoveredItem&&(0,a.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredParentItem&&(0,a.removeClass)(this._hoveredParentItem,"idd_hover"),clearTimeout(c._preventMouseHover)},c.prototype._onKey=function(e,t){if(38==e||40==e){let s=this,n=this._hoveredItem||(0,a.geByClass1)("idd_hl",this._els.popupItems)||(0,a.geByClass1)("idd_item",this._els.popupItems);return n=38==e?n.previousSibling:n.nextSibling,s._hoverItem(n,!0),(0,d.cancelEvent)(t),!1}if(9==e){let e=this,s=(0,a.geByClass1)("idd_items_content",this._els.popupItems),n=t.target;return n=t.target.getAttribute("class").includes("idd_item")?t.shiftKey?n.previousSibling:n.nextSibling:t.shiftKey?s.lastChild:s.firstChild,e._hoverItem(n,!0),!1}13==e?this._hoveredItem&&this.select(this._hoveredItem.getAttribute("data-id"))&&this._hide():27==e?this._hide():this._quickSearch(e)},c.prototype._quickSearch=function(e){let t=this;if(void 0!==e){let s=String.fromCharCode(e).toLowerCase();if(!s)return;setTimeout((function(){t._currSearchStr=""}),600),this._currSearchStr=this._currSearchStr||"",this._currQuickSearchIndex=this._currQuickSearchIndex||0,1==this._currSearchStr.length&&this._currSearchStr[0]==s||(this._currSearchStr+=s)}let s=this._items;for(let t=this._currQuickSearchIndex;t<s.length;t++){let n=s[t][1].toLowerCase();if(1==this._currSearchStr.length&&this._currSearchStr==n[0]||this._currSearchStr.length>1&&n.indexOf(this._currSearchStr)>=0){this._currQuickSearchIndex=t+1,this._hoverItem((0,a.ge)("idd_item_"+s[t][0]),!0),t==s.length-1&&(this._currQuickSearchIndex=0);break}t==s.length-1&&(this._currQuickSearchIndex=0,e&&this._quickSearch())}},c.prototype._deinitEvents=function(){(0,d.removeEvent)(window,"click",c._window_onOuterClick),(0,d.removeEvent)(window,"keypress",c._window_onKeyPress),(0,d.removeEvent)(window,"keydown",c._window_onKeyDown)},c.prototype._initKeypressEvent=function(){(0,d.addEvent)(window,"keypress",c._window_onKeyPress=this._onKeyPress.bind(this)),(0,d.addEvent)(window,"keydown",c._window_onKeyDown=this._onKeyDown.bind(this))},c.prototype._onOuterClick=function(e){let t=e.target,s=!0;for(;t&&t!=document;){if((0,a.hasClass)(t,"idd_popup")){s=!1;break}t=t.parentNode}s&&this._hide()},c.prototype._initOutEvent=function(){let e=this;setTimeout((function(){(0,d.addEvent)(window,"click",c._window_onOuterClick=e._onOuterClick.bind(e))})),this._opts.autoHide>0&&((0,d.addEvent)(this._iddEl,"mouseleave",(function(){clearTimeout(e._leaveTimeout),e._leaveTimeout=setTimeout((function(){e._isInSubmenu||e._hide()}),e._opts.autoHide)})),(0,d.addEvent)(this._iddEl,"mouseenter",(function(){clearTimeout(e._leaveTimeout)})))},c.prototype.deinit=function(){this._deinitEvents()},c.prototype.setItems=function(e){this._items=(0,u.clone)(e),this.select(e[0][0],!0),this._rebuildDropdown()},c.prototype.getElement=function(){return this._iddEl},c.prototype.getSelected=function(){return this._selected},c.prototype.select=function(e,t){if(this._opts.sublists&&this._opts.sublists[e])return;let s=!1;if((0,l.each)(this._items,(function(t,a){if(a[0]==e)return s=a,!1})),!1===s)throw new Error("No item found for selection");this._selected=s,this._opts.keepTitle||(this._els.valueEl.innerHTML=s[1]),(0,a.val)(this._els.hiddenInputEl,e);let n=!0;if(!t&&this._opts.onSelect)try{n=!this._opts.onSelect(s[0],s)}catch(e){console.error(e)}return n},c.prototype.val=function(e,t){return void 0!==e?this.select(e,t):this.getSelected()?this.getSelected()[0]:""}},437266:(e,t,s)=>{"use strict";s.d(t,{PLAYLIST_URL_REGEXP:()=>a.PLAYLIST_URL_REGEXP,getPlaylistId:()=>a.getPlaylistId,getVideoPageUrl:()=>a.getVideoPageUrl,logPlaylistEvent:()=>a.logPlaylistEvent,logVideoClick:()=>a.logVideoClick});var a=s(369488)},369488:(e,t,s)=>{"use strict";s.d(t,{PLAYLIST_URL_REGEXP:()=>n.PLAYLIST_URL_REGEXP,getPlaylistId:()=>n.getPlaylistId,getVideoPageUrl:()=>n.getVideoPageUrl,logPlaylistEvent:()=>a.logPlaylistEvent,logVideoClick:()=>a.logVideoClick});var a=s(712234),n=s(131462)},712234:(e,t,s)=>{"use strict";s.d(t,{logPlaylistEvent:()=>c,logVideoClick:()=>u});var a=s(538522),n=s(540462),r=s(314309),d=s(317216),_=s(231450);const l=(e,t,s,a)=>{(a=(0,_.getTrackCode)("search_track_code")||a)&&r.searchStatsCollector.logEvent({action:e,type:t,track_code:s||a})},u=(e,t)=>{var s,a,n;s=d.EventItemType.VIDEO,a=e?.track_code,n=t?.searchTrackCode,l(d.SearchClickActionMap.TAP,s,a,n)},c=e=>{const t=(0,a.joinRawId)({itemId:e.id,ownerId:e.owner_id});if(u({},{playlistId:t}),(0,n.partConfigEnabled)("video_playlist_click_events")){const t=e.owner_id===window.vk.id;r.videoPlaylistClickStatsCollector.logEvent({event_type:d.VideoPlaylistEventTypes.PLAY_ALL_PLAYLIST_COVER,album_id:e.id,owner_id:e.owner_id},t?"video_my_playlist":"video_group_playlist")}}},131462:(e,t,s)=>{"use strict";s.d(t,{PLAYLIST_URL_REGEXP:()=>n,getPlaylistId:()=>r,getVideoPageUrl:()=>d});var a=s(873900);const n=/\/?playlist\/(-?\d+_-?\d+)\/?/,r=()=>{const{strLoc:e="",objLoc:t={}}=window.nav,{pl:s,playlist:a}=t;return e.match(n)?.[1]??s??a??null},d=({playlistId:e,videoId:t,ownerId:s},n)=>{const r=n?"/":"",d=`video${(0,a.getIdentityRawId)({id:t,ownerId:s})}`,_=(e=>e?window.cur.isVideoStandalone?`${(e=>e?`playlist/${e}`:"")(e)}/`:`?pl=${e}`:"")(e);return window.cur.isVideoStandalone?`${r}${_}${d}`:`${r}${d}${_}`}},270262:(e,t,s)=>{"use strict";s.d(t,{AdBlockDetector:()=>d,getAdblockState:()=>_});var a=s(540462),n=s(210909),r=s(558137);class d{get hasResult(){return void 0!==this.reason}async detect(e=!1){return this.hasResult&&!e||(this.reason=await(0,n.isAdblockDetected)(),this.detected=!!this.reason),this.detected}}const _=(0,r.makeSharedState)("adblock_protection/detector",(()=>{const e=new d;return e.detect(),e}),{version:1});((0,a.partConfigEnabled)("post_adblock_protection_promo")||(0,a.partConfigEnabled)("tgb_adblock_protection"))&&_()},525815:(e,t,s)=>{"use strict";s.d(t,{lifecycle:()=>l});var a=s(558137),n=s(32489),r=s(303790);const d=e=>({create:e.createEvent("create/app"),updateConfig:e.createEvent("create/app"),remount:e.createEvent("remount/app"),close:e.createEvent("close/app"),unmount:e.createEvent("unmount/app")}),_=e=>{const t=e.createStore([]),s=t.map((e=>e[0]??null)),a=e.createStore({startTime:void 0});return{stack:t,currentAppId:s,apps:e.createStore(new Map),bridges:e.createStore(new Map),performance:a}},l=(0,a.makeSharedState)("MiniAppsSDKLifecycle",(()=>{const e=(0,n.createDomain)("MiniAppsSDK_lifecycle"),t=e.createEvent("resetLifecycleEvent");return{resetLifecycleHandlersEvent:t,beforeStart:(0,r.generateLifecycleHooks)("beforeStart",e,t),afterStart:(0,r.generateLifecycleHooks)("afterStart",e,t),afterMount:(0,r.generateLifecycleHooks)("afterMount",e,t),afterInit:(0,r.generateLifecycleHooks)("afterInit",e,t),afterUnmount:(0,r.generateLifecycleHooks)("afterUnmount",e,t),beforeClose:(0,r.generateLifecycleHooks)("beforeClose",e,t),intents:d(e),miniApp:_(e)}}),{version:1})()},303790:(e,t,s)=>{"use strict";s.d(t,{generateLifecycleHooks:()=>d});var a=s(32489),n=s(506856);const r=({handlers:e,data:t})=>{e.forEach((e=>{e(t)}))};const d=(e,t,s)=>{const d=t.createEvent(`add/${e}`),_=t.createEvent(`remove/${e}`),l=t.createEvent(`fire/${e}`),u=t.createEvent(`complete/${e}`),c=t.createStore(new Set,{name:e}),p=t.createEffect(r),m=t.createEffect((e=>t=>{throw(0,n.error)(`MiniAppsSDK/lifecycle/handler/${e}`,t.params,t.error),new Error(`MiniAppsSDK/lifecycle/handler/${e}: ${t.error.message}`)})(e)),y=t.createEffect({name:`add/${e}`,handler:({handlers:e,handler:t})=>{e.add(t)}}),g=t.createEffect({name:`add/${e}`,handler:({handlers:e,handler:t})=>{e.delete(t)}});c.reset(s),(0,a.sample)({clock:d,source:c,fn:(e,t)=>({handlers:e,handler:t}),target:y}),(0,a.sample)({clock:_,source:c,fn:(e,t)=>({handlers:e,handler:t}),target:g}),(0,a.sample)({clock:l,source:c,fn:(e,t)=>({handlers:e,data:t}),target:p}),(0,a.sample)({clock:p.done,fn:({params:e})=>e.data,target:u}),(0,a.sample)({clock:p.fail,target:m});const f=function(e,t){return s=>(e(s),()=>{t(s)})}(d,_);return{add:f,remove:_,fire:l,complete:u}}},670053:(e,t,s)=>{"use strict";s.d(t,{getCurrentApp:()=>r});var a=s(525815),n=s(540462);function r(){if(!(0,n.partConfigEnabled)("mini_apps_replace_cur_app_with_get_current_app"))return window.cur.app;const e=a.lifecycle.miniApp.apps.getState(),[t]=a.lifecycle.miniApp.stack.getState();return e.get(t)?.app??null}},63057:(e,t,s)=>{"use strict";s.d(t,{AudioHlsNode:()=>m});var a=s(994506),n=s(434810),r=s(201659),d=s(262022),_=s(39816),l=s(166583),u=s(43866),c=s(469004),p=s(540462);class m{get isFullyLoaded(){return this.fullyLoaded}get error(){return this.audioElement.error||null}get played(){return this.audioElement.played}get src(){return this.url}get hls(){return this.hlsInstance||null}get duration(){return isFinite(this.audioElement.duration)?this.audioElement.duration:0}get readyState(){return this.audioElement.readyState}get currentTime(){return this.audioElement.currentTime}set currentTime(e){this.audioElement.currentTime=e}get volume(){return this.audioElement.volume}set volume(e){this.audioElement.volume=e}set playbackRate(e){this.audioElement.playbackRate=e}get currentProgress(){return isNaN(this.audioElement.duration)?0:Math.max(0,Math.min(1,this.audioElement.currentTime/this.audioElement.duration))}get currentBuffered(){return this.audioElement.buffered.length?Math.min(1,this.audioElement.buffered.end(0)/this.audioElement.duration):0}play(){return(0,u.wrapAudioPlay)(this.audioElement).catch((e=>{switch(e.code){case e.NOT_SUPPORTED_ERR:case e.ABORT_ERR:break;default:throw e}}))}pause(){this.audioElement.pause()}addEventListeners(e){this.audioElement.addEventListener("pause",(()=>e.onPause())),this.audioElement.addEventListener("play",(()=>e.onPlay())),this.audioElement.addEventListener("progress",(()=>{if(e.onBufferUpdate(),!this.hlsInstance){const e=this.audioElement.buffered;e.length&&Math.abs(e.end(e.length-1)-this.audioElement.duration)<1&&(this.fullyLoaded=!0)}})),this.audioElement.addEventListener("timeupdate",(()=>{e.onProgressUpdate&&e.onProgressUpdate()})),this.audioElement.addEventListener("ended",(()=>{e.onEnd&&e.onEnd()})),this.onFail=e.onFail||(()=>{}),this.audioElement.addEventListener("error",(()=>{this.onFail()})),this.audioElement.addEventListener("canplay",(()=>{e.onCanPlay&&e.onCanPlay()})),this.audioElement.addEventListener("durationchange",(()=>{e.onDurationChange&&e.onDurationChange()}))}static isHlsUrl(e){const t=(0,n.audioUnmaskSource)(e).includes(".m3u8");if(!(0,a.isAudioPWAFeature)())return t;const s=(0,d.checkIsDownloadedUrl)(e);return t||s}setUrl(e){if(this.url=e,m.isHlsUrl(this.url)&&!m.shouldUseNativeHls()&&"function"==typeof window.MediaSource)return this.initHls(this.url).catch((()=>this.onFail()));this.hlsInstance&&this.hlsInstance.destroy();const t=this.audioElement.firstElementChild;return t.src=this.url,m.isHlsUrl(this.url)?t.type="application/vnd.apple.mpegurl":(0,p.partConfigEnabled)("music_clear_media_type")&&t.removeAttribute("type"),this.audioElement.load(),Promise.resolve()}static shouldUseNativeHls(){const[e]=window.browser.version.split("."),t=parseInt(e);return window.browser.safari||window.browser.msie_edge&&t>11&&t<78}initHls(e){return m.loadHls().then((({default:t})=>new Promise((s=>{let a=!1;const n=!!c.ls.get("_audio_hls_debug");this.hlsInstance&&this.hlsInstance.destroy();const d=new t({debug:n,maxBufferHole:3,nudgeOffset:.5,nudgeMaxRetry:5,maxFragLookUpTolerance:.2});d.on(t.Events.BUFFER_EOS,(()=>this.fullyLoaded=!0)),d.on(t.Events.ERROR,((e,s)=>{(n||s.fatal)&&console.log("audio hls error",e,s),s.details===t.ErrorDetails.BUFFER_STALLED_ERROR&&(a=!0,d.stopLoad(),d.startLoad()),s.fatal&&this.onFail({type:s.type,details:s.details,url:s.frag&&s.frag.url||s.context&&s.context.url,code:s.networkDetails?s.networkDetails.status:0})})),d.on(t.Events.FRAG_BUFFERED,((e,t)=>{const s=(0,r.getCurrentAudio)(),n={owner_id:s.ownerId,audio_id:s.id,fragment_id:t.frag.sn.toString(),fragment_duration:Math.ceil(1e3*t.frag.duration).toString(),time_to_first_byte:Math.ceil(t.stats.loading.first-t.stats.loading.start).toString(),time_to_first_frame:Math.ceil(t.stats.loading.end-t.stats.loading.start).toString(),buffering_time:Math.ceil(t.stats.buffering.end-t.stats.buffering.start).toString(),http_request_host:new URL(t.frag.baseurl).host};a&&(a=!1,this.audioNetworkStatCollector.logEvent({...n,event_type:_.AudioNetworkType.FRAGMENT_STALLED},l.default.getConnectionType(),l.default.getConnectionEffectiveType())),this.audioNetworkStatCollector.logEvent({...n,event_type:_.AudioNetworkType.FRAGMENT_LOADED},l.default.getConnectionType(),l.default.getConnectionEffectiveType())})),d.loadSource(e),d.attachMedia(this.audioElement),this.hlsInstance=d,s()}))))}static loadHls(){return Promise.all([s.e(45458),s.e("langs/web/hls")]).then(s.bind(s,164945))}constructor(e,t){this.fullyLoaded=!1,this.url="",this.audioElement=new Audio,this.audioElement.appendChild(document.createElement("source")),this.audioElement.crossOrigin="anonymous",this.audioElement.preload="auto",this.volume=e.volume,this.addEventListeners(e),t&&this.setUrl(t).then((()=>{this.audioElement.load()}));const s=new _.NetworkStatCollector;this.audioNetworkStatCollector=new _.AudioNetworkStatCollector(s)}}},706278:(e,t,s)=>{"use strict";s.d(t,{AudioMediaSession:()=>u});var a=s(392358),n=s(423015),r=s(251458),d=s(8520),_=s(636576),l=s(628459);class u{init(){this.mediaSession&&(this.player.subscribe(a.AudioPlayerEventType.PLAY,this.handlePlay),this.player.subscribe(a.AudioPlayerEventType.PLAYLIST_CHANGED,this.handlePlaylistChange))}async updateMediaSessionControls(){const{mediaSession:e}=this;if(e)if(this.player.ads?.isActive)e.setActionHandler("play",this.play),e.setActionHandler("pause",this.pause),e.setActionHandler("seekbackward",null),e.setActionHandler("seekforward",null),e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null);else{e.setActionHandler("play",this.play),e.setActionHandler("pause",this.pause);const t=this.player.getCurrentAudio();if(this.player.isPlaying()?(e.setActionHandler("seekbackward",this.seekBackward),e.setActionHandler("seekforward",this.seekForward)):(e.setActionHandler("seekbackward",null),e.setActionHandler("seekforward",null)),t&&!(0,r.isPodcast)(t))try{const[t,s]=await this.getPrevAndNextAudio();t?e.setActionHandler("previoustrack",this.previousTrack):e.setActionHandler("previoustrack",null),s?e.setActionHandler("nexttrack",this.nextTrack):e.setActionHandler("nexttrack",null)}catch(t){e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null)}else e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null)}}getPrevAndNextAudio(){return Promise.all([this.player.getPrevAudio().catch((()=>null)),this.player.getNextAudio().catch((()=>null))])}constructor(e,t){this.handlePlay=()=>{const{mediaSession:e}=this;if(!e)return;const t=this.player.getCurrentAudio(),s=(0,n.audioTupleToAudioObject)(t);if(!s)return;const a=(0,d.decodeHTMLEntities)(s.title+(s.subTitle?` (${s.subTitle})`:"")).replace(/<[^>]*>?/gm,""),r=(0,d.decodeHTMLEntities)(s.performer||"").replace(/<[^>]*>?/gm,""),_=this.player.getCurrentPlaylist(),u=_?(0,d.decodeHTMLEntities)(_.getTitle&&_.getTitle()||"").replace(/<[^>]*>?/gm,""):"",c=s.coverUrl_p||s.coverUrl_l,p=c?[{sizes:"160x160",src:c}]:[];this.updateMediaSessionControls(),(0,l.updateMediaSessionMetadata)({title:a,artist:r,album:u,artwork:p},e)},this.handlePlaylistChange=()=>{this.player&&!this.player.getCurrentAudio()&&(0,l.clear)()},this.play=()=>{this.player.play(),(0,_.statlogsValueEvent)("global_media_controls","audio_player","play")},this.pause=()=>{this.player.pause(),(0,_.statlogsValueEvent)("global_media_controls","audio_player","pause")},this.previousTrack=()=>{this.player.prev(),(0,_.statlogsValueEvent)("global_media_controls","audio_player","previous_track")},this.nextTrack=()=>{this.player.next(),(0,_.statlogsValueEvent)("global_media_controls","audio_player","next_track")},this.seekBackward=()=>{const e=(0,n.audioTupleToAudioObject)(this.player.getCurrentAudio()),t=e?.duration||0,s=(this.player.getCurrentProgress()||0)*t,a=Math.max(0,(s-10)/t);a>0?this.player.seek(a):this.player.prev(),(0,_.statlogsValueEvent)("global_media_controls","audio_player","seek_backward")},this.seekForward=()=>{const e=(0,n.audioTupleToAudioObject)(this.player.getCurrentAudio()),t=e?.duration||0,s=(this.player.getCurrentProgress()||0)*t,a=Math.min(1,(s+10)/t);a<1?this.player.seek(a):this.player.next(),(0,_.statlogsValueEvent)("global_media_controls","audio_player","seek_forward")},this.player=e,this.mediaSession=t??l.DEFAULT_MEDIA_SESSION}}},392358:(e,t,s)=>{"use strict";var a;s.d(t,{AudioPlayerEventType:()=>a,events:()=>n}),function(e){e.CURRENT_CHANGED="curr",e.PLAY="start",e.PLAY_REQUESTED="request_play",e.IMPL_PLAY="impl_play",e.PAUSE="pause",e.STOP="stop",e.UPDATE="update",e.LOADED="loaded",e.ENDED="ended",e.FAILED="failed",e.BUFFERED="buffered",e.PROGRESS="progress",e.VOLUME="volume",e.PLAYLIST_CHANGED="plchange",e.PLAYLIST_CLEAR_REQUESTED="playlist_clear_requested",e.PLAYLIST_CLEARED="playlist_cleared",e.ADDED="added",e.REMOVED="removed",e.FREQ_UPDATE="freq",e.SEEK="seek",e.PLAY_NEXT="play_next",e.AD_READY="ad_ready",e.AD_DEINITED="ad_deinit",e.AD_STARTED="ad_started",e.AD_COMPLETED="ad_completed",e.PLAYER_IS_AD_CHANGED="player_is_ad_changed",e.PLAYER_IS_PLAYING_CHANGED="player_is_playing_changed",e.START_LOADING="start_load",e.CAN_PLAY="actual_start",e.SELECT="select",e.DESELECT="deselect",e.EMPTY_PLAYLIST="empty_playlist",e.NOT_FOUND_PLAYLIST="not_found_playlist",e.INIT="init",e.REQUEST_EXPANDED="request_expanded",e.PLAYLIST_START_LOADING="playlist_start_loading",e.MUSIC_AUDIOS_ADD="music_audios_add",e.MUSIC_AUDIOS_DELETE="music_audios_delete",e.MUSIC_PLAYLISTS_ADD="music_playlists_add",e.MUSIC_OWNERS_FOLLOW="music_owners_follow",e.MUSIC_OWNERS_UNFOLLOW="music_owners_unfollow",e.CURATOR_FOLLOW="curator_follow",e.CURATOR_UNFOLLOW="curator_unfollow",e.RADIOSTATION_FOLLOW="radiostation_follow",e.RADIOSTATION_UNFOLLOW="radiostation_unfollow",e.CURRENT_RADIOSTATION_FOLLOW_STATUS_UPDATE="current_radiostation_update",e.CURRENT_AUDIO_DISLIKE_STATUS_UPDATE="current_audio_dislike_status_update",e.AUDIO_RESTORE_BY_DISLIKE_ACTION="audio_restore_by_dislike_action",e.AUDIO_DELETE_BY_DISLIKE_ACTION="audio_delete_by_dislike_action",e.PLACEHOLDER_REMOVE="placeholder_remove",e.PLAY_TRACK_FROM_AUTOPLAY="play_track_from_autoplay",e.CLEAN_AUTOPLAY_QUEUE="clean_autoplay_queue",e.PLAY_PREVIEW="play_preview",e.STOP_PREVIEW="stop_preview",e.END_PREVIEW="end_preview",e.PROGRESS_PREVIEW="progress_preview",e.PREVIEW_BUFFERED="preview_buffered",e.PLAY_SNIPPET="play_snippet",e.STOP_SNIPPET="stop_snippet",e.PROGRESS_SNIPPET="progress_snippet",e.SNIPPET_BUFFERED="snippet_buffered",e.SNIPPET_PLAYER_STATE_CHANGED="snippet_player_state_changed",e.SNIPPET_PLAYER_FAIL="snippet_player_fail",e.SNIPPET_PLAYER_PLAY_NEXT_SNIPPET="snippet_player_play_next_snippet",e.SNIPPET_PLAYER_PLAY_PREV_SNIPPET="snippet_player_play_prev_snippet",e.SNIPPET_PLAYER_SNIPPET_PLAYING_END="snippet_player_snippet_playing_end",e.SNIPPET_PLAYER_CHANGE_SOURCE="snippet_player_change_source",e.SNIPPET_PLAYER_PAUSED_BY_INCOMING_CALL="snippet_player_paused_by_incoming_call",e.SNIPPET_PLAYER_PAUSED_BY_VISIBILITY="snippet_player_paused_by_visibility",e.NAVIGATE_TO_SECTION="navigate_to_section"}(a||(a={}));const n=a},679937:(e,t,s)=>{"use strict";s.d(t,{AudioMixPlaylist:()=>g,PLAYLIST_CONTEXT_VKMIX:()=>p,PLAYLIST_TYPE_VKMIX:()=>c});var a=s(434518),n=s(763812),r=s(346127),d=s(488150),_=s(702130),l=s(955141),u=s(540462);const c="vkmix",p="vkmix:vk_mix";var m=(0,n._)("_items"),y=(0,n._)("_isSessionLaunched");class g extends _.AudioList{get isSessionLaunched(){return(0,a._)(this,y)[y]}get infinite(){return!0}get isEmpty(){return!1}get items(){return(0,a._)(this,m)[m]}get length(){return this.items.length}audioAt(e){return this.items.at(e)}async fetchAt(e,{range:t=0}={}){const s=this.ensureAbsIndex(e),a=this.audioAt(s),n=s+t+1-this.length;if(a&&n<=0)return a;const[r]=await this.fetchNext(n);if(!r)throw new Error("fetchNext have not return audios");return r}async fetchNext(e=1){const t=(0,u.partConfigEnabled)("audio_recom_playlists_starts_with_last_played_audio_web"),{id:s,isSessionLaunched:a}=this,n=(await this.service.fetchNextFx({id:s,count:e,isSessionLaunched:a,isSessionFeatureEnabled:t})).map((e=>function(e){return{mediaMetadata:{},...(0,r.mapAPIAudioToMusicAudioData)(d.AudioType.MusicTrack,e),apiAudio:e}}(e)));return this.items.push(...n),n}launchSession(){if(0===this.length)throw new Error("Music mix session cannot be launched if there are no tracks in the mix");(0,a._)(this,y)[y]=!0}breakSession(){this.items.length=0,(0,a._)(this,y)[y]=!1}constructor({id:e,title:t,items:s=[],context:n}){super(),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),(0,a._)(this,y)[y]=!1,this.fetchable=null,this.service=(0,l.createAudioVkMixPlaylistService)(),(0,a._)(this,m)[m]=[...s],this.type=c,this.title=t,this.id=e,this.context=n}}},955141:(e,t,s)=>{"use strict";s.d(t,{createAudioVkMixPlaylistService:()=>r});var a=s(32489),n=s(241024);function r(){const e=(0,a.createDomain)("audio/playlist/vkmix"),{$lists:t,fetchNextFx:s}=(0,n.createAudioVkMixService)(e);return{$lists:t,$loading:s.pending,fetchNextFx:s}}},82467:(e,t,s)=>{"use strict";s.d(t,{AudioMixPlaylist:()=>a.AudioMixPlaylist,PLAYLIST_CONTEXT_VKMIX:()=>a.PLAYLIST_CONTEXT_VKMIX,PLAYLIST_TYPE_VKMIX:()=>a.PLAYLIST_TYPE_VKMIX});var a=s(679937)},972623:(e,t,s)=>{"use strict";s.d(t,{AudioStats:()=>z,SUBTYPE_OFF:()=>V,SUBTYPE_ON:()=>W,SUBTYPE_PLAYLIST:()=>j,SUBTYPE_UPLOAD:()=>N,TYPE_ADDED:()=>m,TYPE_BROADCASTING:()=>C,TYPE_REMOVED:()=>y,TYPE_SHARE_AUDIO:()=>E,TYPE_SHOW_ALBUM:()=>f});var a=s(7240),n=s(740342),r=s(636576),d=s(418562),_=s(469004),l=s(346723),u=s(314309),c=s(540462),p=s(317216);const m="added",y="removed",g="recommendation_removed",f="show_album",E="share_audio",A="start",P="stop",b="volume",I="rewind",T="play_further",C="broadcast",O="curator",M="default",S="next_track",D="prev_track",k="auto",L="interruption",R="continue_from_pause",B="new",x="close_app",F="queue",U="pause",N="upload",W="on",V="off",K="follow",H="unfollow",j="playlist",$="session_end",G={[A]:1,[P]:2,[b]:3,[I]:4,[T]:5,[m]:6,[y]:7,[g]:8,[f]:9,[E]:10,[C]:11,[O]:12,[p.RADIO_STATION_EVENT_ITEM]:13},q={[M]:1,[S]:2,[D]:3,[k]:4,[L]:5,[R]:6,[B]:7,[x]:8,[F]:9,[U]:10,[N]:11,[W]:12,[V]:13,[K]:14,[H]:15},Y="audio_unique_unauth_id";class z{listenOnBeforeUnload(){window.addEvent(window,"beforeunload",this.onPageClose)}stopListenOnBeforeUnload(){window.removeEvent(window,"beforeunload",this.onPageClose)}logEvent(e){return this.actionStatCollector.logEvent(e)}canOperate(){return null!==this.playerAdapter&&!(this.playerAdapter.isPodcast()||this.playerAdapter.isExternalStream()||this.playerAdapter.isAdPlaying()||this.playerAdapter.isMarusiaTrack())}getCurrentAudioParams(){if(!this.playerAdapter)return{};const e=this.currentAudioId||this.playerAdapter.getAudioId();if(e){const[t,s]=e.split("_");return{ownerId:t,audioId:s,trackCode:this.currentAudioTrackCode||this.playerAdapter.getAudioTrackCode()}}return{}}getEnvParams(){if(this.playerAdapter)return{state:this.playerAdapter.getState(),context:this.playerAdapter.getContext(),ref:window.cur&&window.vk.widget?String(window.cur.widgetReferrer||"").substring(0,20):""}}getListenedTime(){return this.playerAdapter&&Math.round(this.playerAdapter.getListenedTime())||0}getPlaySubtype(){if(!this.playerAdapter)return"";if(this.playerAdapter.isAutoPlayed())return k;const e=this.playerAdapter.getSequence();if(e)return e>0?S:D;const t=this.pausedAudioId,s=this.playerAdapter.getAudioId();return t&&s===t?R:B}onRadioOn(e){(0,c.partConfigEnabled)("audioRadioActionStatCollectorEnabled")?this.actionStatCollector.logEvent({type:p.RADIO_STATION_EVENT_ITEM,[p.RADIO_STATION_EVENT_ITEM]:{event_type:W,radio_station_id:e.id,track_code:e.trackCode}}):this.sendAudioEvent({type:p.RADIO_STATION_EVENT_ITEM,subtype:W,playlistId:e.id,trackCode:e.trackCode})}onRadioOff(e){(0,c.partConfigEnabled)("audioRadioActionStatCollectorEnabled")?this.actionStatCollector.logEvent({type:p.RADIO_STATION_EVENT_ITEM,[p.RADIO_STATION_EVENT_ITEM]:{event_type:V,radio_station_id:e.id,duration:this.getListenedTime(),track_code:e.trackCode}}):this.sendAudioEvent({type:p.RADIO_STATION_EVENT_ITEM,subtype:V,playlistId:e.id,listened:this.getListenedTime(),trackCode:e.trackCode})}onTrackSwitch(e,t){if(!e||!this.playerAdapter)return;let s=B;const a=this.playerAdapter.getSequence(),[n,r]=e.fullId.split("_");this.playerAdapter.isAutoPlayed()?s=k:a&&(s=a>0?S:D),this.sendCurrentAudioEvent({type:P,subtype:s,position:this.currentPosition,listened:this.currentListened,trackCode:e.trackCode,playlistId:t,ownerId:Number(n),audioId:Number(r)}),this.wasEnded=!0,this.collectListenedData(e),this.collectListenedDataSwitch();const d=this.listenedData;this.listenedData=null,this.sendListenedData(d)}onPageClose(){this.playerAdapter&&this.playerAdapter.isPlaying()&&(this.sendCurrentAudioEvent({type:P,subtype:x}),this.sendListenedData())}collectListenedDataSwitch(){if(this.listenedData){if(this.listenedData.end_stream_reason===$||!this.playerAdapter)return;const e=this.playerAdapter.isAutoPlayed(),t=this.getListenedTime(),s=this.playerAdapter.getSequence();let a=null;s&&!e?a=s>0?"next_btn":"prev":this.playlistChanged&&(a="playlist_change"),!a&&e&&(a="playlist_next"),this.listenedData.end_stream_reason=a||"new",t&&(this.listenedData.listened=t)}}collectListenedData(e=null){const t=e||this.currentAudio;if(!this.canOperate()||!t||!this.playerAdapter)return null;const s=t.fullId,a=t.trackCode||this.playerAdapter.getAudioTrackCode(),n=this.getListenedTime(),r=t.urlHash;if(r||console.log("no url hash"),!n||!r)return null;let d={audio_id:s,listened:n,context:this.playerAdapter.getContext(),hash:r};return window.cur&&window.vk.widget&&(d.ref=window.cur.widgetReferrer||""),this.playerAdapter.hasSearchParams()&&(d.search_params=JSON.stringify(this.playerAdapter.getSearchParams())),this.playerAdapter.hasPlaylist()&&(this.playerAdapter.isRealPlaylist()&&(d.playlist_id=this.playerAdapter.getPlaylistId()),this.playerAdapter.isShuffledPlaylist()&&(d.shuffled=1)),a&&(d.track_code=a),this.playerAdapter.isRepeatCurrentAudio()?d.repeat="one":this.playerAdapter.isRepeatAll()&&(d.repeat="all"),this.playerAdapter.isAutoPlayed()&&(d.auto=1),this.playerAdapter.hasPrevAudio()&&(d.prev_audio_id=this.playerAdapter.getPrevAudioId()),this.playerAdapter.hasPrevPlaylist()&&this.playerAdapter.isRealPrevPlaylist()&&(d.prev_playlist_id=this.playerAdapter.getPrevPlaylistId()),this.playerAdapter.isPlaying()||(d.end_stream_reason="stop_btn"),d.state=document.hidden?"background":"app",this.listenedData=d,this.sendListenedDataDelayed(1e4,d),d}sendListenedData(e=null){null!==this.sendTimeout&&clearTimeout(this.sendTimeout);const t=e||this.listenedData;this.listenedData=null,t&&t.listened&&this.playerAdapter&&(this.uniqueUserId&&(t.unique_id=this.uniqueUserId),this.playerAdapter.sendListenedData(t))}sendListenedDataDelayed(e=0,t=null){null!==this.sendTimeout&&clearTimeout(this.sendTimeout),this.sendTimeout=setTimeout((()=>this.sendListenedData(t)),e)}serializeEvent(e){const t=[G[e.type],q[e.subtype],1];return e.audioId?t.push(e.ownerId+"_"+e.audioId):t.push(0),e.trackCode?t.push(e.trackCode):t.push(0),e.state?t.push(e.state):t.push(a.UNKNOWN_STATE),e.ref?t.push(e.ref):t.push(""),e.context?t.push(e.context):t.push("other"),e.volume||0===e.volume?t.push(e.volume):t.push(this.playerAdapter&&this.playerAdapter.getVolume()),e.position||0===e.position?t.push(e.position):t.push(this.playerAdapter&&this.playerAdapter.getProgressInSeconds()),e.shuffle?t.push(e.shuffle?1:0):t.push(0),e.repeat?t.push(e.repeat):t.push(0),e.listened?t.push(Math.max(e.listened,0)):t.push(0),e.playlistId?t.push(e.playlistId):t.push(""),e.targetOwnerId?t.push(e.targetOwnerId):t.push(0),this.uniqueUserId?t.push(this.uniqueUserId):t.push(""),e.positionTo?t.push(e.positionTo):t.push(null),t}sendEvent(e){this.debug&&(console.log("[audio stats event]",e.type,e.subtype,e),window._statForTest||(window._statForTest=[]),window._statForTest.push(e)),(0,r.statlogsValueEvent)("audio_sts",...this.serializeEvent(e))}sendCurrentAudioEvent(e){if(!this.playerAdapter)return;const t=this.playerAdapter.isRepeatCurrentAudio()?1:this.playerAdapter.isRepeatAll()?2:0;this.sendEvent({shuffle:this.playerAdapter.isShuffledPlaylist(),repeat:t,volume:this.playerAdapter.getVolume(),position:this.playerAdapter.getProgressInSeconds(),listened:this.getListenedTime(),playlistId:this.playerAdapter.getPlaylistId(),...this.getEnvParams(),...this.getCurrentAudioParams(),...e})}sendAudioEvent(e){const t={...e,...this.getEnvParams()};!window.vk.id&&this.uniqueUserId&&(t.uniqueUnauthId=this.uniqueUserId),this.sendEvent(t)}destroy(){this.playerAdapter.events.off("play",this.handlePlay).off("pause",this.handlePause).off("stop",this.handlePause).off("progress",this.handleProgress).off("volume",this.handleVolume).off("seekLegacy",this.handleSeek).off("playlistChanged",this.handlePlaylistChanged).off("ended",this.handleEnded).off("playNext",this.handlePlayNext).off("adCompleted",this.handleAdCompleted),this.stopListenOnBeforeUnload(),this.listenedData=null,null!==this.sendTimeout&&clearTimeout(this.sendTimeout)}constructor(e){if(this.handlePlay=()=>{if(!this.playerAdapter)return;if(this.playerAdapter.isRadio()&&!this.playerAdapter.isMarusiaTrack())return void this.onRadioOn(this.playerAdapter.getAudio());if(this.playerAdapter.isMarusiaTrack())return void l.marusiaAudioStats.onPlay(this.playerAdapter);if(!this.canOperate())return;const e=this.playerAdapter.getAudio();if(!e)return;const t=e.fullId,s=this.currentAudioId===t||!this.currentAudioId,a=this.currentAudioId!==this.pausedAudioId;let n=this.playerAdapter.getListenedTime();!s&&a&&this.onTrackSwitch(this.currentAudio,this.currentPlaylistId),this.playedTime=Date.now(),this.currentAudioId=t,this.currentAudio=e,this.currentAudioTrackCode=this.playerAdapter.getAudioTrackCode(),this.currentPlaylistId=this.playerAdapter.getPlaylistId(),this.wasEnded||this.playerAdapter.hasPrevAudio()&&(!this.pausedAudioId||this.playerAdapter.isAutoPlayed())?(this.currentPosition=0,n=0):this.currentPosition=this.playerAdapter.getProgressInSeconds(),this.currentListened=n,this.sendCurrentAudioEvent({type:A,subtype:this.getPlaySubtype(),position:this.currentPosition,listened:n}),this.pausedAudioId=null,this.playlistChanged=!1,this.wasEnded=!1,this.listenOnBeforeUnload()},this.handlePause=()=>{if(!this.playerAdapter)return;if(this.playerAdapter.isRadio()&&!this.playerAdapter.isMarusiaTrack())return void this.onRadioOff(this.playerAdapter.getAudio());if(this.playerAdapter.isMarusiaTrack())return void l.marusiaAudioStats.onPause(this.playerAdapter);const e=this.playerAdapter.getAudioId();if(!this.canOperate()||!e)return;const t=this.collectListenedData();this.sendListenedDataDelayed(1e3,t),setTimeout((()=>{if(this.currentAudio&&e!==this.currentAudio.fullId)return;if(Date.now()-this.playedTime<150)return;if(!this.playerAdapter)return;this.pausedAudioId=e;const t=this.playerAdapter.getPausedBy();this.sendCurrentAudioEvent({type:P,subtype:t?t===F?F:L:U})}),100),this.stopListenOnBeforeUnload()},this.handleProgress=()=>{this.playerAdapter&&(this.playerAdapter.getProgress()<.01||!this.playerAdapter.isPlaying()||(this.currentPosition=this.playerAdapter.getProgressInSeconds(),this.currentListened=this.playerAdapter.getListenedTime(),!this.pausedAudioId&&Date.now()-this.playedTime>150&&this.collectListenedData(),this.adsCompleted&&(this.sendCurrentAudioEvent({type:A,subtype:this.getPlaySubtype(),position:this.currentPosition}),this.adsCompleted=!1)))},this.handleVolume=(0,n.debounce)((()=>{this.canOperate()&&this.sendCurrentAudioEvent({type:b,subtype:M})}),300),this.handleSeek=()=>{if(!this.canOperate()||!this.playerAdapter)return;const e={position:this.currentPosition,positionTo:this.playerAdapter.getProgressInSeconds()};e.position!==e.positionTo&&this.sendCurrentAudioEvent({type:I,subtype:M,...e})},this.handlePlaylistChanged=()=>{this.canOperate()&&(this.playlistChanged=!0)},this.handleEnded=()=>{this.listenedData&&this.playerAdapter.isLastTrack()&&(this.listenedData.end_stream_reason=$),this.wasEnded=!0,this.playerAdapter.isRepeatCurrentAudio()?(this.sendCurrentAudioEvent({type:P,subtype:k}),this.collectListenedData(),this.sendListenedData()):this.sendListenedDataDelayed(150)},this.handlePlayNext=({audioFullId:e})=>{if(!this.canOperate()||!e)return;const[t,s]=e.split("_");this.sendAudioEvent({type:T,subtype:M,ownerId:Number(t),audioId:Number(s)})},this.handleAdCompleted=()=>{this.adsCompleted=!0},this.handleBroadcastStatusToggled=({status:e,targetOwnerId:t})=>{this.sendCurrentAudioEvent({type:C,subtype:e?W:V,targetOwnerId:t.toString()})},this.playerAdapter=e,this.listenedData=null,this.sendTimeout=null,this.currentAudioId=null,this.currentAudio=null,this.currentAudioTrackCode=null,this.pausedAudioId=null,this.playlistChanged=!1,this.currentPosition=0,this.currentListened=0,this.playedTime=0,this.adsCompleted=!1,this.wasEnded=!1,window.vk.id)this.uniqueUserId=null;else{const e=_.ls.get(Y);e?this.uniqueUserId=e:(this.uniqueUserId=(0,d.default)(),_.ls.set(Y,this.uniqueUserId))}this.debug=e.isDebug(),this.playerAdapter.events.on("play",this.handlePlay).on("pause",this.handlePause).on("stop",this.handlePause).on("progress",this.handleProgress).on("volume",this.handleVolume).on("seekLegacy",this.handleSeek).on("playlistChanged",this.handlePlaylistChanged).on("ended",this.handleEnded).on("playNext",this.handlePlayNext).on("adCompleted",this.handleAdCompleted).on("broadcastStatusToggled",this.handleBroadcastStatusToggled),this.onPageClose=this.onPageClose.bind(this),this.productionStatCollector=new u.ProductionStatCollector,this.actionStatCollector=new u.ActionStatCollector(this.productionStatCollector)}}},315283:(e,t,s)=>{"use strict";s.d(t,{AudioStatsPlayerAdapter:()=>_,FULL_SCREEN_STATE:()=>d,UNKNOWN_STATE:()=>r});var a=s(392358),n=s(426389);const r=0,d=2;class _{destory(){this.unlistenPlayer()}get events(){return this.emitter.listenable}getPausedBy(){return null}getState(){return document.hidden?1:3}getProgress(){return this.player.playerGetProgress()}getProgressInSeconds(){return this.player.getProgressInSeconds()}getVolume(){return this.player.getVolume()}getAudioId(){return this.player.getAudioId()}getAudio(){return this.player.getAudio()}getAudioTrackCode(){return this.player.getAudioTrackCode()}getPrevAudioId(){return this.player.getPrevAudioId()}getPrevPlaylistId(){return this.player.getPrevPlaylistId()}getPlaylistId(){return this.player.getPlaylistId()}getContext(){return this.player.getContext()}getSequence(){return this.player.getSequence()}getType(){return this.player.getType()}getListenedTime(){return isNaN(this.player.getListenedTime())?0:Math.round(this.player.getListenedTime())}getSearchParams(){return this.player.getSearchParams()}isPlaying(){return this.player.isPlaying()}isPaused(){return this.player.isPaused()}isAutoPlayed(){return this.player.isAutoPlayed()}isRepeatCurrentAudio(){return this.player.isRepeatCurrentAudio()}isRepeatAll(){return this.player.isRepeatAll()}isShuffledPlaylist(){return this.player.isShuffledPlaylist()}isRealPlaylist(){return this.player.isRealPlaylist()}isRealPrevPlaylist(){return this.player.isRealPrevPlaylist()}isPodcast(){return this.player.isPodcast()}isExternalStream(){return this.player.isExternalStream()}isRadio(){return this.player.isRadio()}isMarusiaTrack(){return this.player.isMarusiaTrack()}isAdPlaying(){return this.player.ads.isActive}isLastTrack(){return this.player.isLastTrack()}getTrackPosition(){return this.player.getTrackPosition()}hasPrevAudio(){return this.player.hasPrevAudio()}hasPrevPlaylist(){return this.player.hasPrevPlaylist()}hasPlaylist(){return this.player.hasPlaylist()}hasSearchParams(){return this.player.hasSearchParams()}isDebug(){return!1}sendListenedData(e){return this.player.sendListenedData(e)}getPlaylistQueue(){return null}getCurrentAudio(){return this.player.getCurrentAudioData()}getPlayingAudio(){return this.isPlaying()||this.isPaused()?this.getCurrentAudio():null}listenPlayer(){this.player.subscribe(a.AudioPlayerEventType.PLAY,this.handlePlayerPlay),this.player.subscribe(a.AudioPlayerEventType.PAUSE,this.handlePlayerPause),this.player.subscribe(a.AudioPlayerEventType.STOP,this.handlePlayerStop),this.player.subscribe(a.AudioPlayerEventType.PROGRESS,this.handlePlayerProgress),this.player.subscribe(a.AudioPlayerEventType.VOLUME,this.handlePlayerVolume),this.player.subscribe(a.AudioPlayerEventType.SEEK,this.handlePlayerSeekLegacy),this.player.subscribe(a.AudioPlayerEventType.PLAYLIST_CHANGED,this.handlePlayerPlaylistChanged),this.player.subscribe(a.AudioPlayerEventType.ENDED,this.handlePlayerEnded),this.player.subscribe(a.AudioPlayerEventType.PLAY_NEXT,this.handlePlayerPlayNext),this.player.subscribe(a.AudioPlayerEventType.AD_COMPLETED,this.handlePlayerAdCompleted);const e=this.player.nextEvents;e?.on&&(e.on("playAudio",this.handlePlayerPlayMarked),e.on("pauseAudio",this.handlePlayerPauseMarked),e.on("stopAudio",this.handlePlayerStopMarked),e.on("playAdv",this.handlePlayerPlayAdv),e.on("pauseAdv",this.handlePlayerPauseAdv),e.on("stopAdv",this.handlePlayerStopAdv),e.on("seek",this.handlePlayerSeek),e.on("stateRestore",this.handlePlayerStateRestore),e.on("broadcastStatusToggled",this.handlePlayerBroadcastStatusToggled))}unlistenPlayer(){this.player.unsubscribe(a.AudioPlayerEventType.PLAY,this.handlePlayerPlay),this.player.unsubscribe(a.AudioPlayerEventType.PAUSE,this.handlePlayerPause),this.player.unsubscribe(a.AudioPlayerEventType.STOP,this.handlePlayerStop),this.player.unsubscribe(a.AudioPlayerEventType.PROGRESS,this.handlePlayerProgress),this.player.unsubscribe(a.AudioPlayerEventType.VOLUME,this.handlePlayerVolume),this.player.unsubscribe(a.AudioPlayerEventType.SEEK,this.handlePlayerSeekLegacy),this.player.unsubscribe(a.AudioPlayerEventType.PLAYLIST_CHANGED,this.handlePlayerPlaylistChanged),this.player.unsubscribe(a.AudioPlayerEventType.ENDED,this.handlePlayerEnded),this.player.unsubscribe(a.AudioPlayerEventType.PLAY_NEXT,this.handlePlayerPlayNext),this.player.unsubscribe(a.AudioPlayerEventType.AD_COMPLETED,this.handlePlayerAdCompleted);const e=this.player.nextEvents;e?.off&&(e.off("playAudio",this.handlePlayerPlayMarked),e.off("pauseAudio",this.handlePlayerPauseMarked),e.off("stopAudio",this.handlePlayerStopMarked),e.off("playAdv",this.handlePlayerPlayAdv),e.off("pauseAdv",this.handlePlayerPauseAdv),e.off("stopAdv",this.handlePlayerStopAdv),e.off("seek",this.handlePlayerSeek),e.off("stateRestore",this.handlePlayerStateRestore))}constructor(e,t){this.emitterFactory=t,this.emitter=this.emitterFactory.create(),this.handlePlayerPlay=()=>{this.emitter.emit("play")},this.handlePlayerPlayMarked=e=>{const{audio:t,reason:s,progressTime:a}=e;m(t),function(e){if(!l.includes(e))throw new Error(`Invalid play reason: ${e}`)}(s),y(a),this.emitter.emit("playAudio",{audio:t,reason:s,progressTime:a})},this.handlePlayerPause=()=>{this.emitter.emit("pause")},this.handlePlayerPauseMarked=e=>{const{audio:t,reason:s,progressTime:a}=e;m(t),function(e){if(!u.includes(e))throw new Error(`Invalid pause reason: ${e}`)}(s),y(a),this.emitter.emit("pauseAudio",{audio:t,reason:s,progressTime:a})},this.handlePlayerStop=()=>{this.emitter.emit("stop")},this.handlePlayerStopMarked=e=>{const{audio:t,reason:s,progressTime:a}=e;m(t),function(e){if(!c.includes(e))throw new Error(`Invalid stop reason: ${e}`)}(s),y(a),this.emitter.emit("stopAudio",{audio:t,reason:s,progressTime:a})},this.handlePlayerProgress=()=>{this.emitter.emit("progress")},this.handlePlayerVolume=()=>{this.emitter.emit("volume")},this.handlePlayerSeekLegacy=()=>{this.emitter.emit("seekLegacy")},this.handlePlayerSeek=e=>{const{audio:t,reason:s,progressTime:a,fromTime:n}=e;m(t),function(e){if(!p.includes(e))throw new Error(`Invalid seek reason: ${e}`)}(s),y(a),y(n),this.emitter.emit("seek",{audio:t,reason:s,progressTime:a,fromTime:n})},this.handlePlayerPlaylistChanged=()=>{this.emitter.emit("playlistChanged")},this.handlePlayerEnded=()=>{this.emitter.emit("ended")},this.handlePlayerPlayNext=(e,t)=>{this.emitter.emit("playNext",{currentAudio:e,audioFullId:t})},this.handlePlayerAdCompleted=()=>{this.emitter.emit("adCompleted")},this.handlePlayerPlayAdv=e=>{this.emitter.emit("playAdv",e)},this.handlePlayerPauseAdv=e=>{this.emitter.emit("pauseAdv",e)},this.handlePlayerStopAdv=e=>{this.emitter.emit("stopAdv",e)},this.handlePlayerStateRestore=e=>{const{audio:t,progressTime:s}=e;t&&m(t),y(s),this.emitter.emit("stateRestore",{audio:t,progressTime:s})},this.handlePlayerBroadcastStatusToggled=e=>{this.emitter.emit("broadcastStatusToggled",e)},this.player=e,this.listenPlayer()}}const l=Object.values(n.AudioPlayerPlayAudioEventReason),u=Object.values(n.AudioPlayerPauseAudioEventReason),c=Object.values(n.AudioPlayerStopAudioEventReason),p=Object.values(n.AudioPlayerSeekEventReason);function m(e){if(!e||"object"!=typeof e)throw new Error(`Invalid TrackedAudioData: ${e}`);if(!Number.isFinite(e.id))throw new Error(`Invalid TrackedAudioData (id is not finite): ${e.id}`);if(!Number.isFinite(e.ownerId))throw new Error(`Invalid TrackedAudioData (ownerId is not finite): ${e.ownerId}`);if("string"!=typeof e.trackCode)throw new Error("Invalid TrackedAudioData (trackCode is not string): "+typeof e.trackCode)}function y(e){if("number"!=typeof e)throw new Error(`Value is not number (given: ${typeof e})`)}},7240:(e,t,s)=>{"use strict";s.d(t,{AudioStatsPlayerAdapter:()=>a.AudioStatsPlayerAdapter,FULL_SCREEN_STATE:()=>a.FULL_SCREEN_STATE,UNKNOWN_STATE:()=>a.UNKNOWN_STATE});var a=s(315283)},956648:(e,t,s)=>{"use strict";s.d(t,{AudioTaskManager:()=>r,TaskName:()=>a});var a,n=s(762701);!function(e){e.URL="url",e.PLAYBACK_RATE="playback_rate",e.DELAY="delay",e.SEEK="seek",e.PAUSE="pause",e.PLAY="play",e.VOL_SET="vol_set",e.VOL_UP="vol_up",e.VOL_DOWN="vol_down"}(a||(a={}));class r{newTask(e,t){let s,a;const n=new Promise(((e,t)=>{s=e,a=t}));return this.tasks.push({name:e,fn:()=>t().then(s).catch(a),id:`${e}_${this.taskIDCounter++}`}),this.doTasks(),n}clearAllTasks(){this.taskAbort=this.taskInProgress,this.taskInProgress=null,this.tasks=[]}clearTask(e){this.tasks=this.tasks||[],this.tasks=this.tasks.filter((t=>t.name!==e))}doTasks(){if(this.taskInProgress)return;const e=this.tasks.shift();e&&(this.taskInProgress=e.id,this.ensureImplReady().then((()=>e.fn())).then((()=>{this.taskAbort!==e.id?(this.taskInProgress=null,this.doTasks()):this.taskAbort=null})))}ensureImplReady(){return new Promise((e=>this.impl.onReady(e)))}delay(e){return this.newTask("delay",(()=>new Promise((t=>(0,n.setWorkerTimeout)(t,e)))))}setUrl(e){return this.newTask("url",(()=>new Promise((t=>this.impl.setUrl(e,t)))))}seekImmediate(e){this.impl.seek(e)}seek(e){return this.clearTask("seek"),this.newTask("seek",(()=>new Promise((t=>{this.seekImmediate(e),t()}))))}pause(){return this.newTask("pause",(()=>new Promise((e=>{this.impl.pause(),e()}))))}play(){return window.browser.safari&&this.impl.play(),this.newTask("play",(()=>new Promise(((e,t)=>{this.impl.play().then(e).catch(t)}))))}setVolume(e,t,s=null){if(t){const t=e?"vol_up":"vol_down";return this.newTask(t,(()=>new Promise((t=>this.impl.fadeVolume(e,s,(()=>t()))))))}return this.newTask("vol_set",(()=>new Promise((t=>{this.impl.setVolume(e),t()}))))}updatePlaybackRate(e){return this.newTask("playback_rate",(()=>new Promise((t=>{this.impl.setPlaybackRate(e),t()}))))}constructor(e){this.impl=e,this.taskIDCounter=1,this.tasks=[],this.taskInProgress=null,this.taskAbort=null}}},653192:(e,t,s)=>{"use strict";s.d(t,{AutoplayQueue:()=>u});var a=s(8520),n=s(867366),r=s(392358),d=s(519290),_=s(18058),l=s(730640);class u{get list(){return this._list}get length(){return this._list.length}get enabled(){return this.service.$enabled.getState()}hasSource(e){const t=(0,l.clearObject)({...e,offset:void 0});return this.sources.some((e=>(0,a.isEqual)(t,(0,l.clearObject)({...e,offset:void 0}))))}setSource(e){this.hasSource(e)||(this.sources=[(0,l.clearObject)(e)],this.nextFrom=null,this._list=[],this.hasMore=!0,this.fetchNextAudios())}async fetchNextAudios(){try{const e=this.nextFrom??this.sources[0];if(!e)return[];const t=await this.fetchService.getAutoplayAudioIdsBySource(e);if(!t)return[];const{next_from:s,audios:a}=t;if(this.nextFrom=s,this.hasSource(s)||this.sources.push(s),!a||!a.length)return this.hasMore=!1,[];const r=a.map((e=>e.audio_raw_id)).join(","),_=await this.fetchService.reloadAudios(r),l=this.getCurrentQueueAudioIds(),u=_.map(((e,t)=>(e[n.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]=a[t]?.access_key||"",e[n.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]=a[t]?.track_code||"",e[n.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="autoplay",e))).filter((e=>!l.some((t=>t.includes((0,d.getAudioFullId)(e))))));return this._list.push(...u),u}catch(e){console.log(e)}}async getNextAudios(e=0){const t=Math.min(e+10,this._list.length);if(e>this._list.length-1){const t=await this.fetchNextAudios();return t&&t.length>0?this.getNextAudios(e):[]}return this._list.slice(e,t)}getAudioById(e){return this._list.find((t=>e.includes((0,d.getAudioFullId)(t))))}indexOf(e){const t=(0,d.getAudioFullId)(e);return this._list.findIndex((e=>(0,d.getAudioFullId)(e)===t))}spliceHead(e){return this._list.splice(0,e+1)}clean(){this._list=[],this.sources=[],this.nextFrom=null,this.hasMore=!1,this.eventBus.emit(r.AudioPlayerEventType.CLEAN_AUTOPLAY_QUEUE)}constructor(e,t,s){this._list=[],this.sources=[],this.nextFrom=null,this.service=(0,_.ensureAutoplayService)(),this.hasMore=!0,this.fetchService=e,this.getCurrentQueueAudioIds=s,this.eventBus=t,this.service.init()}}},726680:(e,t,s)=>{"use strict";s.d(t,{EventBus:()=>a});class a{subscribe(e,t){return Array.isArray(e)&&e.forEach((e=>this.subscribe(e,t))),this.subscriptions[e]||(this.subscriptions[e]=[]),this.subscriptions[e].push(t),{unsubscribe:()=>this.unsubscribe(e,t)}}unsubscribe(e,t){if(this.subscriptions[e]){const s=this.subscriptions[e].indexOf(t);s>=0&&this.subscriptions[e].splice(s,1)}}emit(e,...t){this.precheck&&!this.precheck(e,...t)||(this.onAnyCallBack&&setTimeout((()=>this.onAnyCallBack(e,...t))),this.subscriptions[e]&&this.subscriptions[e].forEach((e=>setTimeout((()=>e(...t))))))}constructor(){this.subscriptions={}}}},269808:(e,t,s)=>{"use strict";var a,n;s.d(t,{PlaylistSourceType:()=>a,PlaylistType:()=>n,isAutoplayEnabledForPlaylist:()=>d}),function(e){e.CATALOG="catalog",e.MESSAGE="im",e.FEED="feed",e.WALL="wall",e.ALBUM="album",e.CURATOR="curator",e.PLAYLIST="playlist",e.VKMIX="vkmix",e.PODCAST="podcast"}(a||(a={})),function(e){e.TYPE_CURRENT="current",e.TYPE_PLAYLIST="playlist",e.TYPE_MY="my",e.TYPE_ALBUM="album",e.TYPE_TEMP="temp",e.TYPE_RECOM="recoms",e.TYPE_SEARCH="search",e.TYPE_LIVE="live",e.TYPE_WALL="wall",e.TYPE_RECENT="recent",e.TYPE_RADIO="radio",e.TYPE_ARTICLE_TTS="article_tts",e.TYPE_VKMIX="vkmix"}(n||(n={}));const r=["radio","article_tts"],d=e=>!r.includes(e.getType())},673269:(e,t,s)=>{"use strict";s.d(t,{PlaylistQueue:()=>B});var a=s(8520),n=s(540462),r=s(898848),d=s(667545),_=s(867366),l=s(423015),u=s(653192),c=s(392358),p=s(269808),m=s(223009),y=s(590733),g=s(213236),f=s(105330),E=s(519290),A=s(482310),P=s(137590),b=s(768035);const{AUDIO_ITEM_INDEX_OWNER_ID:I,AUDIO_ITEM_INDEX_TRACK_CODE:T,AUDIO_ITEM_INDEX_ID:C,AUDIO_QUEUE_MAX_AUDIOS_COUNT:O,AUDIO_ITEM_INDEX_URL:M,AUDIO_ITEM_INDEX_TITLE:S,AUDIO_ITEM_INDEX_PERFORMER:D,AUDIO_ITEM_INDEX_EXTRA:k,AUDIO_ITEM_ACCESS_KEY:L,AUDIO_ITEM_INDEX_CONTEXT:R}=_.AUDIO_PLAYER_ENUMS;class B{get isAutoplayEnabled(){return this._autoplayQueue?.enabled??!1}get list(){return this._list}get shuffled(){return this._shuffled}get eventBus(){return this._eventBus}get source(){return this._source}get autoplayQueue(){return this.isAutoplaySupported?this._autoplayQueue:null}setSortedQueue(e,t){Array.isArray(e)&&(this._shuffled=!1,this._list=[],this.originalList=[],this.addToList(e),t&&this.setSource(t))}async setSortedQueueByPlaylist(e){return this.clean(),this.addPlaylist(e)}setSource(e){this._source=e}setAutoplaySourceFromPlaylist(e){if(!this.isAutoplaySupported)return;const t=(0,m.getPlaylistRawSource)(e),s=(0,g.getAutoplayPlaylistSource)(t);this.setAutoplaySource(s)}setAutoplaySource(e){this._autoplayQueue?.setSource({...e,offset:0})}getAudioIds(e){return"string"==typeof e?e.split("_"):"object"!=typeof e||Array.isArray(e)?[e[I],e[C]]:[e.ownerId,e.id]}compareAudiosIds(e,t){return!(!Array.isArray(e)||e.length<2||!t)&&(e[0]==t[I]&&e[1]==t[C])}fetchAudios(e){let t=e;return Array.isArray(t)&&(t=t.join(",")),this.fetchService.reloadAudios(t)}findAndFetchEmptyAudiosFrom(e){const t=[],s=[],a=this._list;let n=e+O;n=n<a.length?n:a.length-1;for(let r=e;r<=n;r++){const e=a[r];if(this.isEmptyAudio(e)&&e){const a=`${e[I]}_${e[C]}_${e[L]}`;t.push(a),s.push(r)}}return t.length<1?Promise.resolve({counter:0,successful:!0}):this.fetchAudios(t).then((e=>{if(e){let n=this.syncAndRemoveUnmatchedAudios(t,e,a);return this.truncateArray(s,n),s.forEach(((t,s)=>{if(e[s]){const n=(0,A.getAudioExtra)(e[s]);if(n){const r=(0,A.getAudioExtra)(a[t]);if(r){const t=(0,P.mergeAudioExtra)(r,n);t&&(e[s][k]=t)}else e[s][k]=a[t][k]}else e[s][k]=a[t][k];e[s][T]=a[t][T],a[t]=e[s]}})),{counter:n,successful:!0}}return{counter:0,successful:!1}})).catch((()=>({counter:0,successful:!1})))}truncateArray(e,t){return e.length=Math.max(e.length-t,0),e}syncAndRemoveUnmatchedAudios(e,t,s){if(e.length===t.length)return 0;let a=0;const n=t.map((e=>e[C]));return e.forEach((e=>{const t=Number(e.split("_")[1]);if(!n.includes(t)){const[t,n]=e.split("_"),r=s.find((e=>Number(e[C])===Number(n)&&Number(e[I])===Number(t)));r&&(a++,this.removeAudio(r))}})),a}getAudio(e){if(!e)return Promise.resolve(null);let t=null,s=null;const a=this.getAudioIds(e);return this._list.find(((e,n)=>!!this.compareAudiosIds(a,e)&&(s=n,t=e,!0))),t&&null!==s?this.isEmptyAudio(t)?this.findAndFetchEmptyAudiosFrom(s).then((({successful:e})=>e&&null!==s?Promise.resolve(this._list[s]):Promise.resolve(null))).catch((()=>Promise.resolve(null))):Promise.resolve(t):Promise.resolve(null)}async getFirstAudio(e){const t=await this.getAudioAt(0);return t&&e&&(0,l.audioTupleToAudioObject)(t).isClaimed?this.getNextAudio(t,{repeat:!1,ignoreClaimed:e}):t}async getLastAudio(e){const t=this.length-1;if(t<0)return null;const s=await this.getAudioAt(t);return s&&e&&(0,l.audioTupleToAudioObject)(s).isClaimed?this.getPrevAudio(s,{repeat:!1,ignoreClaimed:e}):s}async getPrevAudio(e,t={}){const{ignoreClaimed:s}=t,a=this.indexOfAudio(e);if(a<0)return null;const n=a-1;if(n<0)return t.repeat?this.getLastAudio(s):null;const r=await this.getAudioAt(n);return r&&s&&(0,l.audioTupleToAudioObject)(r).isClaimed?this.getPrevAudio(r,t):r}async getNextAudio(e,t={}){const{autoplayQueue:s}=this,{ignoreClaimed:a}=t,n=this.indexOfAudio(e);if(n<0)return null;const r=n+1;if(r>=this.length){if(t.repeat)return this.getFirstAudio(a);if(s?.enabled){const e=s.list;if(e.length>0)return e[0]}return null}const d=await this.getAudioAt(r);return d&&a&&(0,l.audioTupleToAudioObject)(d).isClaimed?this.getNextAudio(d,t):d}indexOfAudio(e){if(!e)return-1;let t=this.getAudioIds(e);return this._list?this._list.findIndex((e=>this.compareAudiosIds(t,e))):-1}getAudioAt(e){return!Array.isArray(this._list)||this._list.length<=e?Promise.resolve(null):e<0?this.findAndFetchEmptyAudiosFrom(0).then((()=>this._list[0])):this.findAndFetchEmptyAudiosFrom(e).then((()=>this._list[e]))}async getPrevAndNextAudios(e){if(!e)return[null,null];let t=null,s=null;const a=this._list.findIndex((t=>t[T]===e[T]));let n=a-1,r=a+1;if(n>=0&&(t=this._list[n]),r<this._list.length&&(s=this._list[r]),t&&this.isEmptyAudio(t)||s&&this.isEmptyAudio(s))try{await this.findAndFetchEmptyAudiosFrom(n>0?n:a)}catch(e){}return[t,s]}getAudios(e,t){return Number.isInteger(e)&&Number.isInteger(t)?(e<0&&(e=0),e>this._list.length?Promise.resolve(null):(t-e>O&&(t=e+O),t>this._list.length&&(t=this._list.length),this.findAndFetchEmptyAudiosFrom(e).then((({counter:s})=>this._list.slice(e,t+1-s))))):Promise.resolve(null)}removeAudio(e){let t=this.indexOfAudio(e);return t>=0?(this._list.splice(t,1),t):-1}addToList(e,t,s){const a=this._list;let n=e;void 0!==t||s?n.forEach((e=>{const t=this.indexOfAudio(e);t>=0&&a.splice(t,1)})):n=n.filter((e=>-1===this.indexOfAudio(e))),n.forEach((e=>{null===e[k]&&(e[k]="[]"),e[S]=(0,r.clean)((0,r.replaceEntities)(e[S]).replace(/(<em>|<\/em>)/g,"")),e[D]=(0,r.clean)((0,r.replaceEntities)(e[D]).replace(/(<em>|<\/em>)/g,""))})),void 0===t?(this.shuffled&&this.originalList.push(...n),a.push(...n)):(this.shuffled&&this.originalList.push(...n),a.splice(t,0,...n))}addAudio(e,t){this.isArrayOfAudioTuples(e)?this.addToList(e,t):e?.length&&this.addToList([e],t)}isArrayOfAudioTuples(e){return Array.isArray(e)&&Array.isArray(e[0])}addEmptyAudios(e){const t=e.map((e=>{const{audio_raw_id:t,access_key:s,track_code:a}=e,{ownerId:n,id:r}=(0,b.parseRawId)(t),d=[];return d[I]=n,d[C]=r,d[L]=s,d[T]=a,d}));this.addToList(t,void 0,!0)}async addNoConsecutivePlaylist(e,t){const s=(0,m.getPlaylistRawSource)(e),a=(0,y.getPlaylistSource)(s),n=(0,g.getAutoplayPlaylistSource)(s,(0,E.getAudioFullId)(t));return"autoplay"===t[R]||this._autoplayQueue?.hasSource(n)||(this.setSource(a),this.setAutoplaySource(n),this._list=[],this.addToList([t])),!0}async addPlaylist(e){if(this.isAutoplayEnabledForPlaylist=(0,p.isAutoplayEnabledForPlaylist)(e),!this.isAutoplayEnabledForPlaylist){this.clean();const t=e.getAudiosList();return this.addToList(t),this._autoplayQueue?.clean(),!0}const{isAutoplaySupported:t}=this,s=(0,m.getPlaylistRawSource)(e),n=(0,y.getPlaylistSource)(s);if((0,a.isEqual)(n,this._source)){if(t&&this.length){const e=(0,g.getAutoplayPlaylistSource)(s);this.setAutoplaySource(e)}return!0}if(this.setSource(n),n.source===p.PlaylistSourceType.VKMIX){this.clean();const t=e.getAudiosList();return this.addToList(t),this._autoplayQueue?.clean(),!0}if(e.isLive()||e?.isLoadable())return this._autoplayQueue?.clean(),!0;if(t){const t=(0,g.getAutoplayPlaylistSource)(s);if(!this._source)return!1;try{const{audioIds:s}=await this.fetchService.getAudioIdsBySource(n);if(!Array.isArray(s)||0===s.length){const t=e.getAudiosList();return this.addToList(t),!0}return this.addEmptyAudios(s),this.setAutoplaySource(t),!0}catch{return!1}}try{const t=await e.getAudioIds();if(!Array.isArray(t)||0===t.length){const t=e.getAudiosList();return this.addToList(t),!0}return this.addEmptyAudios(t),!0}catch{return!1}}moveAudio(e,t){let s=this._list.splice(e,1);e<t&&(t-=1),this._list.splice(t,0,s[0])}clean(){this._list=[],this.originalList=[],this._shuffled=!1,this._source=null}moveAudioAtFirstPosition(e){let t=this.indexOfAudio(e);-1!==t?(this._list.splice(t,1),this._list.unshift(e)):this._list.unshift(e)}removeSortedList(){this.originalList&&(this._list=[].concat(this.originalList)),this._shuffled=!1}get length(){return this.list.length}isEmpty(){return!this.length}shuffle(e,t){if(!(e&&this.shuffled||!e&&!this.shuffled)){if(e){const[e]=this._list;this.originalList=[...this._list],this._list=function(e){let t=e.length;for(;t>0;){const s=Math.floor(Math.random()*t);t--;const a=e[t];e[t]=e[s],e[s]=a}return e}([...this._list]),!t&&e&&this.moveAudioAtFirstPosition(e),this._shuffled=!0}else this._list=[...this.originalList],this._shuffled=!1;return!0}}resetShuffle(){this.shuffle(!1)}constructor(e,t){if(this._autoplayQueue=null,this.isAutoplaySupported=(0,n.partConfigEnabled)("autoplay_web")&&!(0,f.isMvk)(),this.isEmptyAudio=e=>!(e&&(e[M]||(0,d.isClaimedAudio)(e))),B.instance)return B.instance;if(this.fetchService=e,this._list=[],this.originalList=[],this._source=null,this._shuffled=!1,this._eventBus=t,this.isAutoplaySupported){const s=new u.AutoplayQueue(e,t,(()=>this._list.map(E.getAudioFullId)));this._autoplayQueue=s,this.isAutoplayEnabledForPlaylist=!0,this._eventBus.subscribe(c.AudioPlayerEventType.PLAY_TRACK_FROM_AUTOPLAY,(e=>{const t=s.indexOf(e);if(t>=0){const e=s.spliceHead(t);this.addToList(e)}}))}B.instance=this}}},233297:(e,t,s)=>{"use strict";s.d(t,{SpecialProjectController:()=>_});var a,n=s(119864),r=s(445798);let d;!function(e){e.Opened="opened",e.Closed="closed"}(a||(a={}));class _{static get(){if(!d)throw new Error("SpecialProjectController must be initialized.");return d}static init(e,t){if(!e)throw new Error("SpecialProjectController must be initialized with showModal.");return d||(d=new _(e,t),d)}showModal(e,t){this.showCurrentModal&&this.showCurrentModal(t,this.tryToSendCloseReason(e))}constructor(e,t){this.audioApi=t,this.projects={},this.statCollector=null,this.wasProjectShown=e=>!!this.projects[e],this.tryModal=async(e,t)=>{if(!this.wasProjectShown(e))try{const s=await this.getSpecialProject(e);this.showModal(e,s),this.statCollector?.open(+e,t)}catch(e){}finally{this.projects[e]="opened"}},this.tryToSendCloseReason=e=>t=>{"closed"!==this.projects[e]&&(this.consumeSpecialProject(e,t),this.statCollector?.close(),this.projects[e]="closed")},this.getSpecialProject=async e=>{const t=await this.audioApi.getSpecialProject({special_project_id:e});return(0,r.mapSpecialProjectData)(t)},this.consumeSpecialProject=(e,t)=>this.audioApi.consumeSpecialProject({special_project_id:e,reason:t}),this.statCollector=new n.SpecialProjectStatCollector,this.showCurrentModal=e}}},119864:(e,t,s)=>{"use strict";s.d(t,{SpecialProjectStatCollector:()=>r});var a=s(317216),n=s(314309);class r{open(e,t){if(this.openedModal)throw new Error("Modal must be closed before opening");this.openedModal={id:e,trackCode:t,startView:this.productCollector.getCurrentTime()}}close(){const{openedModal:e}=this;if(!e)throw new Error("Modal must be open before closing");this.sendView(e),this.openedModal=null}sendView(e){const t={end_view:this.productCollector.getCurrentTime(),start_view:e.startView,type:a.ViewProductionStatEventTypes.TYPE_CATALOG_SPECIAL_PROJECT_ITEM},s={type:a.EventItemType.AUDIO_SPECIAL_PROGECT_MODAL,id:e.id,track_code:e.trackCode};this.viewCollector.logEvent(t,s)}constructor(){this.openedModal=null,this.productCollector=new n.ProductionStatCollector,this.viewCollector=new n.ViewStatCollector(this.productCollector)}}},514871:(e,t,s)=>{"use strict";s.d(t,{SpecialProjectHeader:()=>u});var a=s(474848),n=s(296540),r=s(612196),d=s(8520),_=s(551009);const l=e=>{const[t]=e.filter((e=>!!e&&!!e.url)).map((e=>e.url));return t},u=(0,n.memo)((({style:e,image:t=[],className:s,backgroundImage:n=[]})=>{const u=l(n),c=l(t);return(0,a.jsx)("div",{className:(0,d.classNames)(_.default.root,s,{[_.default.singleImage]:"image"===e}),style:{backgroundImage:`url(${"avatar"===e?u:c})`},children:"avatar"===e&&(0,a.jsx)(r.Avatar,{noBorder:!0,src:c,size:72})})}))},445798:(e,t,s)=>{"use strict";s.d(t,{mapSpecialProjectData:()=>a});const a=e=>({...e,backgroundImage:e.background_image})},423769:(e,t,s)=>{"use strict";function a(e){const t=e?.options;if(!t)return[];const s=[];for(const e of t)switch(e.type){case"copy":{const{name:t,copyText:a}=e;if(!t||!a)break;const n=()=>{navigator.clipboard.writeText(a)};s.push({type:"action",label:t,action:n});break}case"default":{const{name:t,clickLink:a}=e;if(!t)break;if(a){s.push({type:"link",label:t,href:a});break}break}}return s}s.d(t,{makeChoicesFromAdman:()=>a})},255818:(e,t,s)=>{"use strict";s.d(t,{makeAudioAdFromAdman:()=>n});var a=s(423769);function n(e){return{id:e.banner_id,choices:(0,a.makeChoicesFromAdman)(e.adChoices)}}},216577:(e,t,s)=>{"use strict";function a(e){return new Promise(((t,s)=>{window.ajax.post("al_audio.php",{act:"get_lyrics",aid:e.audio_id},{onDone:t,onFail:e=>(s(e),!0)})}))}s.d(t,{getLyrics:()=>a})},867366:(e,t,s)=>{"use strict";var a,n;s.d(t,{AUDIO_PLAYER_ENUMS:()=>r,AudioPlaylistContext:()=>d,EAudioFlagBit:()=>n,EAudioTupleIndex:()=>a}),function(e){e[e.ID=0]="ID",e[e.OWNER_ID=1]="OWNER_ID",e[e.URL=2]="URL",e[e.TITLE=3]="TITLE",e[e.PERFORMER=4]="PERFORMER",e[e.DURATION=5]="DURATION",e[e.ALBUM_ID=6]="ALBUM_ID",e[e.AUTHOR_LINK=8]="AUTHOR_LINK",e[e.LYRICS=9]="LYRICS",e[e.FLAGS=10]="FLAGS",e[e.CONTEXT=11]="CONTEXT",e[e.EXTRA=12]="EXTRA",e[e.HASHES=13]="HASHES",e[e.COVER_URL=14]="COVER_URL",e[e.ADS=15]="ADS",e[e.SUBTITLE=16]="SUBTITLE",e[e.MAIN_ARTISTS=17]="MAIN_ARTISTS",e[e.FEAT_ARTISTS=18]="FEAT_ARTISTS",e[e.ALBUM=19]="ALBUM",e[e.TRACK_CODE=20]="TRACK_CODE",e[e.RESTRICTION=21]="RESTRICTION",e[e.ALBUM_PART=22]="ALBUM_PART",e[e.IS_NEW_STATS=23]="IS_NEW_STATS",e[e.ACCESS_KEY=24]="ACCESS_KEY",e[e.CHART_INFO=25]="CHART_INFO",e[e.TRACK_PAGE_ID=26]="TRACK_PAGE_ID",e[e.IS_ORIGINAL_SOUND=27]="IS_ORIGINAL_SOUND",e[e.ADMIN_URL=28]="ADMIN_URL",e[e.UMA_QUERY_URL=29]="UMA_QUERY_URL"}(a||(a={})),function(e){e[e.HAS_LYRICS=1]="HAS_LYRICS",e[e.CAN_ADD=2]="CAN_ADD",e[e.CLAIMED=4]="CLAIMED",e[e.QUEUE=8]="QUEUE",e[e.HQ=16]="HQ",e[e.LONG_PERFORMER=32]="LONG_PERFORMER",e[e.UMA=128]="UMA",e[e.REPLACEABLE=512]="REPLACEABLE",e[e.EXPLICIT=1024]="EXPLICIT",e[e.SHOW_INFO=8192]="SHOW_INFO"}(n||(n={}));const r={AUDIO_ITEM_INDEX_ID:0,AUDIO_ITEM_INDEX_OWNER_ID:1,AUDIO_ITEM_INDEX_URL:2,AUDIO_ITEM_INDEX_TITLE:3,AUDIO_ITEM_INDEX_PERFORMER:4,AUDIO_ITEM_INDEX_DURATION:5,AUDIO_ITEM_INDEX_ALBUM_ID:6,AUDIO_ITEM_INDEX_AUTHOR_LINK:8,AUDIO_ITEM_INDEX_LYRICS:9,AUDIO_ITEM_INDEX_FLAGS:10,AUDIO_ITEM_INDEX_CONTEXT:11,AUDIO_ITEM_INDEX_EXTRA:12,AUDIO_ITEM_INDEX_HASHES:13,AUDIO_ITEM_INDEX_COVER_URL:14,AUDIO_ITEM_INDEX_ADS:15,AUDIO_ITEM_INDEX_SUBTITLE:16,AUDIO_ITEM_INDEX_MAIN_ARTISTS:17,AUDIO_ITEM_INDEX_FEAT_ARTISTS:18,AUDIO_ITEM_INDEX_ALBUM:19,AUDIO_ITEM_INDEX_TRACK_CODE:20,AUDIO_ITEM_INDEX_RESTRICTION:21,AUDIO_ITEM_INDEX_ALBUM_PART:22,AUDIO_ITEM_ACCESS_KEY:24,AUDIO_ITEM_CHART_INFO_INDEX:25,AUDIO_ITEM_INDEX_TRACK_PAGE_ID:26,AUDIO_ITEM_INDEX_IS_ORIGINAL_SOUND:27,AUDIO_ITEM_INDEX_ADMIN_URL:28,AUDIO_ITEM_INDEX_UMA_QUERY_URL:29,AUDIO_ITEM_HAS_LYRICS_BIT:1,AUDIO_ITEM_CAN_ADD_BIT:2,AUDIO_ITEM_CLAIMED_BIT:4,AUDIO_ITEM_QUEUE_BIT:8,AUDIO_ITEM_HQ_BIT:16,AUDIO_ITEM_LONG_PERFORMER_BIT:32,AUDIO_ITEM_UMA_BIT:128,AUDIO_ITEM_REPLACEABLE:512,AUDIO_ITEM_EXPLICIT_BIT:1024,AUDIO_ITEM_SHOW_INFO_BIT:8192,AUDIO_ENOUGH_LOCAL_SEARCH_RESULTS:500,AUDIO_RECOMS_TYPE_LISTENED:"recoms6",AUDIO_PLAYING_CLS:"audio_row__playing",AUDIO_CURRENT_CLS:"audio_row__current",AUDIO_DURATION_CLS:"audio_row__duration",AUDIO_LAYER_HEIGHT:550,AUDIO_LAYER_MIN_WIDTH:400,AUDIO_LAYER_MAX_WIDTH:1e3,AUDIO_HQ_LABEL_CLS:"audio_hq_label_show",AUDIO_MAX_AUDIOS_IN_SNIPPET:5,AUDIO_ROW_COVER_SIZE:40,AUDIO_ROW_PLAY_SIZE:24,AUDIO_ROW_ACTION_ROW_ITEM:'<button class="audio_row__more_action audio_row__more_action_%0% _audio_row__more_action_%0% %3%">%2%</button>',AUDIO_QUEUE_MAX_AUDIOS_COUNT:35,LOG_LS_KEY:"audiolog",ONBOARDING_ARTISTS_LS_KEY:"artists_onboarding",AUDIO_RECOMS_ONBOARDING_NEED_SKIP_LS_KEY:"audio_recoms_onboarding_need_skip"};var d;!function(e){e.USER_WALL="user_wall",e.GROUP_WALL="group_wall",e.WALL="wall",e.FEED="feed"}(d||(d={}))},766194:(e,t,s)=>{"use strict";s.d(t,{setAudioLastListRefCookie:()=>u,setAudioLastListRefCookieDebounced:()=>c});var a=s(8520),n=s(873900),r=s(396858),d=s(540462);const _="remixaudio_last_list_ref",l=1/24/60;function u({ref:e,list:t,index:s}){if(!(0,d.partConfigEnabled)("audio_player_stats_ref_web"))return;const u={list_id:(0,n.getIdentityRawId)(t),ref:e};(0,a.isNumber)(s)&&(u.index=s);const c=JSON.stringify(u);(0,r.setCookie)(_,c,l)}const c=(0,a.debounce)(u,50)},18058:(e,t,s)=>{"use strict";s.d(t,{ensureAutoplayService:()=>_});var a=s(32489),n=s(978746),r=s(540462);let d;function _(){return d||(d=function(){const e=(0,a.createDomain)("audio/autoplay"),t=(0,n.ensureAccountInfoService)(),{$accountInfo:s,setInfoFx:d}=t,_=(0,r.partConfigEnabled)("autoplay_web_toggle"),l=e.createStore(_),u=e.createStore(!1),c=e.createEffect((e=>d({query:{name:"audio_autoplay",value:e}})));return{$toggleSupported:l,$enabled:u,setEnabledFx:c,init:function(){l.on(s,((e,{audio_autoplay:t})=>_&&void 0!==t)),(0,a.sample)({source:{accountInfo:s,toggleSupported:l},fn:({accountInfo:e,toggleSupported:t})=>!t||(e.audio_autoplay??!1),target:u}),t.initEvent()}}}()),d}},262022:(e,t,s)=>{"use strict";s.d(t,{checkIsDownloadedUrl:()=>n});var a=s(434810);function n(e){return(0,a.audioUnmaskSource)(e).includes("blob:http")}},730640:(e,t,s)=>{"use strict";s.d(t,{clearObject:()=>r});var a=s(596034),n=s(269592);function r(e){return(0,a.default)(e,n.default)}},310619:(e,t,s)=>{"use strict";s.d(t,{decodeHTML:()=>r});var a=s(8520);const n={"amp;":"&","#38;":"&","lt;":"<","#60;":"<","gt;":">","#62;":">","apos;":"'","#39;":"'","quot;":'"',"#34;":'"',"copy;":"©"};function r(e){return(0,a.decodeHTMLEntities)(e,n)}},482310:(e,t,s)=>{"use strict";s.d(t,{getAudioExtra:()=>r});var a=s(898848),n=s(867366);function r(e){if(!e)return null;let t;if((0,a.isObject)(e)){t=e.extra}else{t=e[n.EAudioTupleIndex.EXTRA]}if((0,a.isObject)(t))return t;try{return JSON.parse(t||"{}")}catch(e){return null}}},519290:(e,t,s)=>{"use strict";s.d(t,{getAudioFullId:()=>n});var a=s(867366);const n=e=>e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]},213236:(e,t,s)=>{"use strict";s.d(t,{getAutoplayPlaylistSource:()=>a});const a=(e,t="")=>{const{entity_id:s,...a}=e;return{...a,audio_id:t}}},201659:(e,t,s)=>{"use strict";s.d(t,{getCurrentAudio:()=>r});var a=s(423015),n=s(105330);function r(){const e={id:0,ownerId:0};try{return(0,n.isMvk)()?window.audio.getCurrent()||e:(0,a.audioTupleToAudioObject)(window.getAudioPlayer().getCurrentAudio())||e}catch(t){return e}}},223009:(e,t,s)=>{"use strict";s.d(t,{getPlaylistRawSource:()=>n});var a=s(269808);const n=e=>{const t=e.getContext(),s=e.getBlockId(),n=e.getFullId();if(s)return{source:a.PlaylistSourceType.CATALOG,section_id:s,entity_id:s,playlist_id:n};if(e.getType()===a.PlaylistSourceType.CURATOR)return{source:a.PlaylistSourceType.CURATOR,section_id:s,entity_id:s,playlist_id:n};const{sourceType:r,id:d}=(e=>{if(e){const[t,s]=e.split(":");return{sourceType:t,id:s}}return{sourceType:"",id:""}})(t);if(r.includes("wall"))return{source:a.PlaylistSourceType.WALL,entity_id:d,owner_id:d};switch(r){case a.PlaylistSourceType.CATALOG:return{source:a.PlaylistSourceType.CATALOG,section_id:d,entity_id:d,playlist_id:n,block_id:s};case a.PlaylistSourceType.MESSAGE:return{source:a.PlaylistSourceType.MESSAGE,entity_id:`_${d}`};case a.PlaylistSourceType.FEED:return{source:a.PlaylistSourceType.FEED,entity_id:d,owner_id:d};case a.PlaylistSourceType.ALBUM:return{source:a.PlaylistSourceType.ALBUM,entity_id:d};case a.PlaylistSourceType.VKMIX:return{source:a.PlaylistSourceType.VKMIX,entity_id:d};default:return{source:a.PlaylistSourceType.PLAYLIST,entity_id:n,playlist_id:n}}}},590733:(e,t,s)=>{"use strict";s.d(t,{getPlaylistSource:()=>n});var a=s(269808);const n=e=>{let t;return t=e.source===a.PlaylistSourceType.CATALOG&&!1===e.block_id?{source:a.PlaylistSourceType.PLAYLIST,entity_id:e.playlist_id}:{source:e.source||"",entity_id:e.entity_id||""},t}},947779:(e,t,s)=>{"use strict";s.d(t,{getSpecialProjectId:()=>n});var a=s(482310);function n(e){const t=(0,a.getAudioExtra)(e);return t?.specialProjectId??null}},219095:(e,t,s)=>{"use strict";s.d(t,{isArticleTts:()=>n});var a=s(482310);function n(e){const t=(0,a.getAudioExtra)(e);return!!t&&!!t.articleTts}},994506:(e,t,s)=>{"use strict";s.d(t,{isAudioPWAFeature:()=>n});var a=s(540462);function n(){return(0,a.partConfigEnabled)("mvk_music_pwa")}},667545:(e,t,s)=>{"use strict";s.d(t,{isClaimedAudio:()=>r});var a=s(423015),n=s(867366);function r(e){return!!e&&!!((e=(0,a.audioTupleToAudioObject)(e)).flags&n.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CLAIMED_BIT)}},690027:(e,t,s)=>{"use strict";s.d(t,{isExternalStream:()=>n});var a=s(482310);function n(e){const t=(0,a.getAudioExtra)(e);return!!t&&!!t.externalStream}},388952:(e,t,s)=>{"use strict";s.d(t,{isMarusiaTale:()=>n});var a=s(482310);function n(e){const t=(0,a.getAudioExtra)(e);return!!t&&!!t.marusiaTale}},103293:(e,t,s)=>{"use strict";s.d(t,{isMarusiaTrack:()=>n});var a=s(482310);function n(e){const t=(0,a.getAudioExtra)(e);return!!t&&!!t.voiceAssistant}},22021:(e,t,s)=>{"use strict";s.d(t,{isRadio:()=>n});var a=s(482310);function n(e){const t=(0,a.getAudioExtra)(e);return!!t&&!!t.radio}},137590:(e,t,s)=>{"use strict";function a(e,t){return e&&t?{...e,...t}:null}s.d(t,{mergeAudioExtra:()=>a})},315621:(e,t,s)=>{"use strict";s.d(t,{mergeAudioTupleWithoutContext:()=>n});var a=s(867366);function n(e,t){const s=[...e];return Object.assign(s,t),s[a.EAudioTupleIndex.CONTEXT]=e[a.EAudioTupleIndex.CONTEXT],s}},303354:(e,t,s)=>{"use strict";s.d(t,{AudioLyricsProvider:()=>c});var a=s(825127),n=s(203763),r=s(216577),d=s(660617),_=s(423015),l=s(474201),u=s(174736);class c{get(e){return this.lyrics.get(e)||{status:u.EAudioLyricsStatus.Pending}}listen(e,t){return this.eventEmitter.on(e,t),()=>{this.eventEmitter.off(e,t)}}setLoading(e){const t={status:u.EAudioLyricsStatus.Loading};this.lyrics.set(e,t),this.eventEmitter.emit(e,t)}setLoaded(e,t){const s={status:u.EAudioLyricsStatus.Loaded,data:t};this.lyrics.set(e,s),this.eventEmitter.emit(e,s)}setError(e,t){const s={status:u.EAudioLyricsStatus.Error,errorMessage:t};this.lyrics.set(e,s),this.eventEmitter.emit(e,s)}constructor(){this.lyrics=new Map,this.eventEmitter=new a.default,this.fetch=(0,n.dedupeAsyncCallback)((async e=>{const t=(0,_.audioTupleToAudioObject)(e),{fullId:s,hasLyrics:a}=t;try{const e=this.lyrics.get(s);if(e&&e.status===u.EAudioLyricsStatus.Loaded)return e.data||null;if(!a)return this.setLoaded(s,null),null;this.setLoading(s);const t=await(0,r.getLyrics)({audio_id:s}),n=(0,l.mapLyricsResponse)(t);return this.setLoaded(s,n),n}catch(e){throw this.setError(s,e.message||"unknown"),e}}),(e=>(0,d.getAudioTupleFullId)(e)))}}},474201:(e,t,s)=>{"use strict";s.d(t,{mapLyricsResponse:()=>n});var a=s(310619);function n(e){if(Array.isArray(e))return null;const{credits:t,lyrics:s}=e;if(!s)return null;const{text:n,timestamps:r,ugc:d}=s||{},_={};return r&&(_.karaoke=function(e){return e.map((e=>{const{line:t,...s}=e;return t?{...s,text:(0,a.decodeHTML)(t)}:s}))}(r)),n&&(_.static=n.map((e=>({text:(0,a.decodeHTML)(e)})))),d&&(_.ugc=d.map((e=>({text:(0,a.decodeHTML)(e)})))),_.karaoke?.length||_.static?.length||_.ugc?.length?{lines:_,credits:t&&(0,a.decodeHTML)(t)}:null}},174736:(e,t,s)=>{"use strict";var a;s.d(t,{EAudioLyricsStatus:()=>a}),function(e){e[e.Pending=0]="Pending",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error"}(a||(a={}))},423015:(e,t,s)=>{"use strict";s.d(t,{audioTupleToAudioObject:()=>u});var a=s(898848),n=s(867366),r=s(349581),d=s(660617),_=s(22021);const l=Symbol("audioObjectSymbol");function u(e){if(!e)return null;if("string"==typeof e)return{id:e};if(!Array.isArray(e))return e.__audioObject!==l&&console.warn("audioTupleToAudioObject get audio object that not marked as audioObjectSymbol",{audio:e}),e;const t=e[n.EAudioTupleIndex.FLAGS],s=(e[n.EAudioTupleIndex.HASHES]||"").split("/"),u=(e[n.EAudioTupleIndex.COVER_URL]||"").split(/(,(?!\d))/g).filter((e=>","!==e));return u.length<2&&(0,_.isRadio)(e)&&u.push(e[n.EAudioTupleIndex.COVER_URL],e[n.EAudioTupleIndex.COVER_URL]),{id:(0,a.intval)(e[n.EAudioTupleIndex.ID]),owner_id:(0,a.intval)(e[n.EAudioTupleIndex.OWNER_ID]),ownerId:(0,a.intval)(e[n.EAudioTupleIndex.OWNER_ID]),fullId:(0,d.getAudioTupleFullId)(e),title:e[n.EAudioTupleIndex.TITLE]||"",subTitle:e[n.EAudioTupleIndex.SUBTITLE],performer:(0,r.getAudioPerformers)(e,!1),mainArtists:e[n.EAudioTupleIndex.MAIN_ARTISTS],featArtists:e[n.EAudioTupleIndex.FEAT_ARTISTS],authorLink:e[n.EAudioTupleIndex.AUTHOR_LINK],duration:(0,a.intval)(e[n.EAudioTupleIndex.DURATION]),lyrics:e[n.EAudioTupleIndex.LYRICS],url:e[n.EAudioTupleIndex.URL],context:e[n.EAudioTupleIndex.CONTEXT],extra:e[n.EAudioTupleIndex.EXTRA],accessKey:e[n.EAudioTupleIndex.ACCESS_KEY],addHash:s[0]||"",editHash:s[1]||"",actionHash:s[2]||"",deleteHash:s[3]||"",replaceHash:s[4]||"",urlHash:s[5]||"",restoreHash:s[6]||"",canEdit:!!s[1],canDelete:s[3]===e[n.EAudioTupleIndex.ACCESS_KEY]?window.vk.id===e[n.EAudioTupleIndex.OWNER_ID]:Boolean(s[3]),flags:t,isOriginalSound:e[n.EAudioTupleIndex.IS_ORIGINAL_SOUND],hasLyrics:!!(t&n.EAudioFlagBit.HAS_LYRICS),isLongPerformer:!!(t&n.EAudioFlagBit.LONG_PERFORMER),isClaimed:!!(t&n.EAudioFlagBit.CLAIMED),isFromQueue:!!(t&n.EAudioFlagBit.QUEUE),isExplicit:!!(t&n.EAudioFlagBit.EXPLICIT),isUMA:!!(t&n.EAudioFlagBit.UMA),isReplaceable:!!(t&n.EAudioFlagBit.REPLACEABLE),canAdd:!!(t&n.EAudioFlagBit.CAN_ADD),showInfo:!!(t&n.EAudioFlagBit.SHOW_INFO),coverUrl_s:u[1],coverUrl_p:u[1],coverUrl_l:u[0],hasTrackPage:!!e[n.EAudioTupleIndex.TRACK_PAGE_ID],trackPageId:e[n.EAudioTupleIndex.TRACK_PAGE_ID],ads:e[n.EAudioTupleIndex.ADS],album:e[n.EAudioTupleIndex.ALBUM],albumId:(0,a.intval)(e[n.EAudioTupleIndex.ALBUM_ID]),albumPart:(0,a.intval)(e[n.EAudioTupleIndex.ALBUM_PART]),trackCode:e[n.EAudioTupleIndex.TRACK_CODE],restrictionStatus:e[n.EAudioTupleIndex.RESTRICTION],chartInfo:e[n.EAudioTupleIndex.CHART_INFO],adminUrl:e[n.EAudioTupleIndex.ADMIN_URL]||"",umaQueryUrl:e[n.EAudioTupleIndex.UMA_QUERY_URL]||"",__audioObject:l}}},660617:(e,t,s)=>{"use strict";s.d(t,{getAudioTupleFullId:()=>n});var a=s(867366);function n(e){return`${e[a.EAudioTupleIndex.OWNER_ID]}_${e[a.EAudioTupleIndex.ID]}`}},213921:(e,t,s)=>{"use strict";s.d(t,{toSnippetAudioData:()=>a.toSnippetAudioData,toTrackedAudioData:()=>a.toTrackedAudioData});var a=s(338536);s(289286)},338536:(e,t,s)=>{"use strict";s.d(t,{toSnippetAudioData:()=>_,toTrackedAudioData:()=>d});var a=s(488150),n=s(423015),r=s(482310);function d(e){if(!e||"object"!=typeof e)return;const t=Array.isArray(e)?(0,n.audioTupleToAudioObject)(e):e;return t?function(e){const t=e.extra??"{}",s="string"==typeof t?JSON.parse(t):t,n={id:e.id,ownerId:e.ownerId,accessKey:e.accessKey};let d={...n,identity:n,title:e.title,author:{raw:e.performer,main:[],feat:[]},url:e.url,duration:e.duration,isExplicit:e.isExplicit,trackCode:e.trackCode??"",artwork:[]};if(s.podcast)return{...d,type:a.AudioType.PodcastEpisode,podcastId:d.ownerId};if(s.radio)return{...d,type:a.AudioType.Radio};return{...d,type:a.AudioType.MusicTrack,hasLyrics:e.hasLyrics??!1,disliked:(0,r.getAudioExtra)(e)?.dislike??!1}}(t):void 0}function _(e){if(e&&"object"==typeof e)return{...e,identity:e.identity,title:e.title,artwork:[...e.artwork],id:e.identity.id,ownerId:e.identity.ownerId,author:e.authors,hasLyrics:e.hasLyrics,trackCode:e.context.trackCode??"",disliked:!1}}},289286:(e,t,s)=>{"use strict";s(139612),s(867366)},582218:(e,t,s)=>{"use strict";s.d(t,{QueueListener:()=>a});class a{constructor(e){this.queueHandler=e}}},797251:(e,t,s)=>{"use strict";s.d(t,{mapAudioTupleToMusicAudioIdentity:()=>a.mapAudioTupleToMusicAudioIdentity});var a=s(960518)},960518:(e,t,s)=>{"use strict";s.d(t,{mapAudioTupleToMusicAudioIdentity:()=>a.mapAudioTupleToMusicAudioIdentity});var a=s(220436)},220436:(e,t,s)=>{"use strict";s.d(t,{mapAudioTupleToMusicAudioIdentity:()=>r});var a=s(867366),n=s(70148);function r(e){return new n.OwnedIdentity({id:e[a.EAudioTupleIndex.ID],ownerId:e[a.EAudioTupleIndex.OWNER_ID],accessKey:e[a.EAudioTupleIndex.ACCESS_KEY]})}},943223:(e,t,s)=>{"use strict";s.d(t,{mapAudioTupleToMusicAudioIdentity:()=>a.mapAudioTupleToMusicAudioIdentity});var a=s(797251)},227997:(e,t,s)=>{"use strict";s.d(t,{mapPlaylistToMusicMixIdentity:()=>a.mapPlaylistToMusicMixIdentity,mapPlaylistToMusicPlaylistIdentity:()=>a.mapPlaylistToMusicPlaylistIdentity});var a=s(874903)},874903:(e,t,s)=>{"use strict";s.d(t,{mapPlaylistToMusicMixIdentity:()=>a.mapPlaylistToMusicMixIdentity,mapPlaylistToMusicPlaylistIdentity:()=>a.mapPlaylistToMusicPlaylistIdentity});var a=s(998082)},998082:(e,t,s)=>{"use strict";s.d(t,{mapPlaylistToMusicMixIdentity:()=>a.mapPlaylistToMusicMixIdentity,mapPlaylistToMusicPlaylistIdentity:()=>n.mapPlaylistToMusicPlaylistIdentity});var a=s(736722),n=s(764144)},736722:(e,t,s)=>{"use strict";s.d(t,{mapPlaylistToMusicMixIdentity:()=>n});var a=s(843161);function n(e){const t=e.getPlaylistId();if(!t)throw new Error("There is no identity in the music mix");return new a.SingleIdentity({id:t})}},764144:(e,t,s)=>{"use strict";s.d(t,{mapPlaylistToMusicPlaylistIdentity:()=>r});var a=s(35215),n=s(70148);function r(e){const t=e.getPlaylistId(),s=e.getOwnerId?.();if(!t||!s)throw new Error("There is no identity in the music playlist");const r=parseInt(t),d=parseInt(s);if(!(0,a.isNumber)(r)||!(0,a.isNumber)(d))throw new Error("There is no identity in the music playlist");return new n.OwnedIdentity({id:r,ownerId:d})}},280494:(e,t,s)=>{"use strict";s.d(t,{mapAudioTupleToMusicAudioIdentity:()=>a.mapAudioTupleToMusicAudioIdentity,mapPlaylistToMusicMixIdentity:()=>n.mapPlaylistToMusicMixIdentity,mapPlaylistToMusicPlaylistIdentity:()=>n.mapPlaylistToMusicPlaylistIdentity});var a=s(943223),n=s(227997)},880804:(e,t,s)=>{"use strict";var a,n,r,d;s.d(t,{AudioPlayerPauseAudioEventReason:()=>n,AudioPlayerPlayAudioEventReason:()=>a,AudioPlayerSeekEventReason:()=>d,AudioPlayerStopAudioEventReason:()=>r}),function(e){e.PlayButton="PLAY_BUTTON",e.NextButton="NEXT_BUTTON",e.PrevButton="PREV_BUTTON",e.NextMediaSession="NEXT_MEDIA_SESSION",e.PrevMediaSession="PREV_MEDIA_SESSION",e.MixAndPlayButton="MIX_AND_PLAY_BUTTON",e.ListButton="LIST_BUTTON",e.AudioButton="AUDIO_BUTTON",e.QueueContinuation="QUEUE_CONTINUATION",e.QueueContinuationAfterError="QUEUE_CONTINUATION_AFTER_ERROR",e.Autoplay="AUTOPLAY",e.Repeat="REPEAT",e.Voice="VOICE",e.NextVoice="NEXT_VOICE",e.PrevVoice="PREV_VOICE",e.ChannelAutoResume="CHANNEL_AUTO_RESUME",e.Unknown="UNKNOWN"}(a||(a={})),function(e){e.PauseButton="PAUSE_BUTTON",e.MediaSession="MEDIA_SESSION",e.ChannelAutoPause="CHANNEL_AUTO_PAUSE",e.Voice="VOICE",e.Paywall="PAYWALL",e.Unknown="UNKNOWN"}(n||(n={})),function(e){e.NextButton="NEXT_BUTTON",e.PrevButton="PREV_BUTTON",e.QueueContinuation="QUEUE_CONTINUATION",e.Adv="ADV",e.Repeat="REPEAT",e.ChangeQueue="CHANGE_QUEUE",e.Clear="CLEAR",e.Error="ERROR",e.Unknown="UNKNOWN"}(r||(r={})),function(e){e.SliderForward="SLIDER_FORWARD",e.SliderBack="SLIDER_BACK",e.TapForward="TAP_FORWARD",e.TapBack="TAP_BACK",e.DoubleTapForward="DOUBLE_TAP_FORWARD",e.DoubleTapBack="DOUBLE_TAP_BACK",e.Unknown="UNKNOWN"}(d||(d={}))},294718:(e,t,s)=>{"use strict";s.d(t,{createAudioPlayerEventEmitter:()=>n});var a=s(26530);function n(e){return e.resolve(a.EmitterFactory).create()}},198994:(e,t,s)=>{"use strict";s.d(t,{getStopReasonForPlayReason:()=>n});var a=s(880804);function n(e){switch(e){case a.AudioPlayerPlayAudioEventReason.QueueContinuation:return a.AudioPlayerStopAudioEventReason.QueueContinuation;case a.AudioPlayerPlayAudioEventReason.QueueContinuationAfterError:return a.AudioPlayerStopAudioEventReason.Error;case a.AudioPlayerPlayAudioEventReason.NextButton:case a.AudioPlayerPlayAudioEventReason.NextMediaSession:case a.AudioPlayerPlayAudioEventReason.NextVoice:return a.AudioPlayerStopAudioEventReason.NextButton;case a.AudioPlayerPlayAudioEventReason.PrevButton:case a.AudioPlayerPlayAudioEventReason.PrevMediaSession:case a.AudioPlayerPlayAudioEventReason.PrevVoice:return a.AudioPlayerStopAudioEventReason.PrevButton;case a.AudioPlayerPlayAudioEventReason.MixAndPlayButton:case a.AudioPlayerPlayAudioEventReason.ListButton:case a.AudioPlayerPlayAudioEventReason.AudioButton:case a.AudioPlayerPlayAudioEventReason.Voice:return a.AudioPlayerStopAudioEventReason.ChangeQueue;case a.AudioPlayerPlayAudioEventReason.Repeat:return a.AudioPlayerStopAudioEventReason.Repeat;case a.AudioPlayerPlayAudioEventReason.Unknown:return a.AudioPlayerStopAudioEventReason.Unknown;default:return}}},913735:(e,t,s)=>{"use strict";s.d(t,{createAudioPlayerEventEmitter:()=>a.createAudioPlayerEventEmitter,getStopReasonForPlayReason:()=>n.getStopReasonForPlayReason});var a=s(294718),n=s(198994)},426389:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerPauseAudioEventReason:()=>a.AudioPlayerPauseAudioEventReason,AudioPlayerPlayAudioEventReason:()=>a.AudioPlayerPlayAudioEventReason,AudioPlayerSeekEventReason:()=>a.AudioPlayerSeekEventReason,AudioPlayerStopAudioEventReason:()=>a.AudioPlayerStopAudioEventReason,createAudioPlayerEventEmitter:()=>n.createAudioPlayerEventEmitter,getStopReasonForPlayReason:()=>n.getStopReasonForPlayReason});var a=s(880804),n=s(913735)},771979:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerStatsListener:()=>k});var a=s(434518),n=s(763812),r=s(488150),d=s(694132),_=s(107885),l=s(985890),u=s(851636),c=(0,n._)("_stats"),p=(0,n._)("_handlePlayAudio"),m=(0,n._)("_handlePlayAdv"),y=(0,n._)("_handlePauseAudio"),g=(0,n._)("_handlePauseAdv"),f=(0,n._)("_handleStopAudio"),E=(0,n._)("_handleStopAdv"),A=(0,n._)("_handleSeek"),P=(0,n._)("_handleStateRestore"),b=(0,n._)("_handlePageClose"),I=(0,n._)("_makeAdvEventData"),T=(0,n._)("_makeAudioEventData"),C=(0,n._)("_makeEventData"),O=(0,n._)("_canOperate"),M=(0,n._)("_getPlayedTime"),S=(0,n._)("_handleRadioHeartbeat"),D=(0,n._)("_radioHeartbeat");class k{destroy(){window.removeEventListener("beforeunload",(0,a._)(this,b)[b]),this.playerAdapter.events.off("playAudio",(0,a._)(this,p)[p]).off("pauseAudio",(0,a._)(this,y)[y]).off("stopAudio",(0,a._)(this,f)[f]).off("playAdv",(0,a._)(this,m)[m]).off("pauseAdv",(0,a._)(this,g)[g]).off("stopAdv",(0,a._)(this,E)[E]).off("seek",(0,a._)(this,A)[A]).off("stateRestore",(0,a._)(this,P)[P])}constructor(e){Object.defineProperty(this,I,{value:L}),Object.defineProperty(this,T,{value:R}),Object.defineProperty(this,C,{value:B}),Object.defineProperty(this,O,{value:x}),Object.defineProperty(this,M,{value:F}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,S,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:void 0}),this.playerAdapter=e,(0,a._)(this,c)[c]=new _.AudioPlayerStatsCollector(new d.AudioNavScreenProvider),(0,a._)(this,p)[p]=({reason:e,audio:t,progressTime:s})=>{if(!(0,a._)(this,O)[O]())return;const n=(0,a._)(this,T)[T](t,s);(0,a._)(this,c)[c].play((0,l.mapPlayReasonToSubtype)(e),n),t.type===r.AudioType.Radio&&(0,a._)(this,D)[D].start(t)},(0,a._)(this,m)[m]=({reason:e,advId:t,progressTime:s})=>{if(!(0,a._)(this,O)[O]())return;const n=(0,a._)(this,I)[I](t,s);(0,a._)(this,c)[c].play((0,l.mapPlayReasonToSubtype)(e),n)},(0,a._)(this,y)[y]=({reason:e,audio:t,progressTime:s})=>{if(!(0,a._)(this,O)[O]())return;const n=(0,a._)(this,T)[T](t,s);(0,a._)(this,c)[c].pause((0,l.mapPauseReasonToSubtype)(e),n),t.type===r.AudioType.Radio&&(0,a._)(this,D)[D].stop(t)},(0,a._)(this,g)[g]=({reason:e,advId:t,progressTime:s})=>{if(!(0,a._)(this,O)[O]())return;const n=(0,a._)(this,I)[I](t,s);(0,a._)(this,c)[c].pause((0,l.mapPauseReasonToSubtype)(e),n)},(0,a._)(this,f)[f]=({reason:e,audio:t,progressTime:s})=>{if(!(0,a._)(this,O)[O]())return;const n=(0,a._)(this,T)[T](t,s);(0,a._)(this,c)[c].end((0,l.mapStopReasonToSubtype)(e),n),t.type===r.AudioType.Radio&&(0,a._)(this,D)[D].stop(t)},(0,a._)(this,E)[E]=({reason:e,advId:t,progressTime:s})=>{if(!(0,a._)(this,O)[O]())return;const n=(0,a._)(this,I)[I](t,s);(0,a._)(this,c)[c].end((0,l.mapStopReasonToSubtype)(e),n)},(0,a._)(this,A)[A]=({reason:e,audio:t,progressTime:s,fromTime:n})=>{if(!(0,a._)(this,O)[O]())return;const r=(0,a._)(this,T)[T](t,n);(0,a._)(this,c)[c].pause((0,l.mapSeekPauseReasonToSubtype)(e),r);const d=(0,a._)(this,T)[T](t,s);(0,a._)(this,c)[c].play((0,l.mapSeekPlayReasonToSubtype)(e),d)},(0,a._)(this,P)[P]=({audio:e,progressTime:t})=>{if(!e||!(0,a._)(this,O)[O]())return;const s=(0,a._)(this,T)[T](e,t);(0,a._)(this,c)[c].pause(_.PauseEventSubtype.StateRestore,s),(0,a._)(this,D)[D].clear()},(0,a._)(this,b)[b]=()=>{const e=this.playerAdapter.getPlayingAudio();if(!e||!(0,a._)(this,O)[O]())return;const t=(0,a._)(this,T)[T](e,(0,a._)(this,M)[M]());(0,a._)(this,c)[c].end(_.StopEventSubtype.Close,t),(0,a._)(this,D)[D].clear()},(0,a._)(this,S)[S]=e=>{const t=(0,a._)(this,T)[T](e,(0,a._)(this,M)[M]());(0,a._)(this,c)[c].play(_.PlayEventSubtype.Heartbeat,t)},(0,a._)(this,D)[D]=new u.AudioHeartbeatTimer({ms:1e4,onBeat:(0,a._)(this,S)[S]}),this.playerAdapter=e,window.addEventListener("beforeunload",(0,a._)(this,b)[b]),this.playerAdapter.events.on("playAudio",(0,a._)(this,p)[p]).on("pauseAudio",(0,a._)(this,y)[y]).on("stopAudio",(0,a._)(this,f)[f]).on("playAdv",(0,a._)(this,m)[m]).on("pauseAdv",(0,a._)(this,g)[g]).on("stopAdv",(0,a._)(this,E)[E]).on("seek",(0,a._)(this,A)[A]).on("stateRestore",(0,a._)(this,P)[P])}}function L(e,t){const s=(0,_.makeAdvListeningData)(e),n=Math.round(t/1e3);return{...(0,a._)(this,C)[C](),timeline:n,trackCode:"",...s}}function R(e,t){const s=(0,l.mapAudioDataToListeningData)(e),n=Math.round(t/1e3);return{...(0,a._)(this,C)[C](),trackCode:e.trackCode,timeline:n,...s}}function B(){return{shuffle:Boolean(this.playerAdapter.isShuffledPlaylist()),repeatMode:this.playerAdapter.isRepeatCurrentAudio()?_.RepeatMode.One:this.playerAdapter.isRepeatAll()?_.RepeatMode.All:_.RepeatMode.Off,volume:this.playerAdapter.getVolume(),speed:100,streamingType:_.StreamingType.Online,playerInitId:null,layer:!0,autorecoms:!0}}function x(){return!this.playerAdapter.isMarusiaTrack()}function F(){return 1e3*Math.round(this.playerAdapter.getListenedTime())||0}},818212:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerStatsCollector:()=>A});var a=s(434518),n=s(763812),r=s(314309),d=s(540462),_=s(975106),l=s(847154),u=s(674234);const c=["audio","podcast"];var p=(0,n._)("_eventTimelines"),m=(0,n._)("_actionCollector"),y=(0,n._)("_audioNavScreenProvider"),g=(0,n._)("_log"),f=(0,n._)("_debug"),E=(0,n._)("_getNavScreen");class A{play(e,t){(0,a._)(this,g)[g]({category:_.EventCategory.Play,type:_.PlayEventType.Start,subtype:e},t)}pause(e,t){(0,a._)(this,g)[g]({category:_.EventCategory.Stop,type:_.StopEventType.Pause,subtype:e},t)}end(e,t){(0,a._)(this,g)[g]({category:_.EventCategory.Stop,type:_.StopEventType.End,subtype:e},t)}constructor(e){Object.defineProperty(this,g,{value:P}),Object.defineProperty(this,f,{get:b,set:void 0}),Object.defineProperty(this,E,{value:I}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),(0,a._)(this,p)[p]=new Map,(0,a._)(this,m)[m]=new r.ActionStatCollector(new r.ProductionStatCollector),(0,a._)(this,y)[y]=e}}function P(e,t){const s=(0,a._)(this,E)[E](),n=(0,u.getEventDataKey)(t),r=(0,l.makeEventItem)(e,t,(0,a._)(this,p)[p].get(n)??0,s);if((0,a._)(this,m)[m].logEvent({type:_.EVENT_ITEM_TYPE,[_.EVENT_ITEM_TYPE]:r},{screen:s.screen}),(0,a._)(this,f)[f]){const e=r.event.type,t=r.event[e];console.log([["event_category",e],["event_type",t.type],["event_subtype",t.subtype],["screen",s.screen]].map((([e,t])=>`${e}: ${t}`)).join("\n"),r)}e.category===_.EventCategory.Stop&&e.type===_.StopEventType.End?(0,a._)(this,p)[p].delete(n):(0,a._)(this,p)[p].set(n,t.timeline)}function b(){return(0,d.partConfigEnabled)("audio_player_stats_debug")}function I(){let e=window.cur.module,t=null;return c.includes(e)?((0,d.partConfigEnabled)("audio_player_stats_extra_screens")&&(e=(0,a._)(this,y)[y].screen??e),t=(0,a._)(this,y)[y].catalogSectionId):(0,a._)(this,y)[y].clearPage(),{screen:e,catalogSectionId:t}}},761372:(e,t,s)=>{"use strict";var a,n,r,d,_,l,u,c;s.d(t,{ListeningType:()=>a,MusicContentType:()=>n,PauseEventSubtype:()=>u,PlayEventSubtype:()=>l,PodcastContentType:()=>r,RepeatMode:()=>d,StopEventSubtype:()=>c,StreamingType:()=>_}),function(e){e.Music="type_audio_audio_listening_item",e.Podcast="type_audio_podcast_listening_item",e.Book="type_audio_book_listening_item",e.Adv="type_audio_adv_listening_item",e.Radio="type_audio_radio_listening_item"}(a||(a={})),function(e){e.Track="music_track",e.Snippet="music_snippet"}(n||(n={})),function(e){e.Episode="podcast_episode",e.Trailer="podcast_trailer"}(r||(r={})),function(e){e.Off="off",e.One="one",e.All="all"}(d||(d={})),function(e){e.Online="online",e.OnlineCache="online_cache"}(_||(_={})),function(e){e.PlayButton="play_btn",e.NextButton="next_btn",e.PrevButton="prev_btn",e.NextMediaSession="next_by_system",e.PrevMediaSession="prev_by_system",e.MixAndPlayButton="mix_and_play_btn",e.FastplayListButton="fastplay_list_btn",e.FastplayAudioButton="fastplay_audio_btn",e.QueueContinuation="autoplay",e.QueueContinuationAfterError="autoplay_error",e.Autoplay="autoplay",e.Repeat="repeat",e.Voice="voice",e.NextVoice="next_voice",e.PrevVoice="prev_voice",e.PullSliderForward="pull_slider_forward",e.PullSliderBack="pull_slider_back",e.SeekTapForward="seek_tap_forward",e.SeekTapBack="seek_tap_back",e.NextDoubleTap="next_double_tap",e.PrevDoubleTap="prev_double_tap",e.ChannelAutoResume="session_terminated_autostart",e.Heartbeat="heartbeat",e.Unknown="unhandled_on_client"}(l||(l={})),function(e){e.PauseButton="pause_btn",e.MediaSession="pause_by_system",e.ChannelAutoPause="session_terminated",e.PullSliderForward="pull_slider_forward",e.PullSliderBack="pull_slider_back",e.SeekTapForward="seek_tap_forward",e.SeekTapBack="seek_tap_back",e.NextDoubleTap="next_double_tap",e.PrevDoubleTap="prev_double_tap",e.Voice="voice",e.Paywall="paywall_pause",e.StateRestore="client_restore",e.Error="error",e.Unknown="unhandled_on_client"}(u||(u={})),function(e){e.NextButton="next",e.PrevButton="prev",e.Autoplay="autoplay",e.Adv="adv",e.Repeat="repeat",e.ChangeSource="change_source",e.Close="close",e.Error="error",e.Unknown="unhandled_on_client"}(c||(c={}))},805711:(e,t,s)=>{"use strict";s.d(t,{makeAdvListeningData:()=>a.makeAdvListeningData});var a=s(69095)},69095:(e,t,s)=>{"use strict";s.d(t,{makeAdvListeningData:()=>n});var a=s(761372);function n(e){return{listeningType:a.ListeningType.Adv,contentType:"audio_adv",advId:e}}},107885:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerStatsCollector:()=>a.AudioPlayerStatsCollector,ListeningType:()=>n.ListeningType,MusicContentType:()=>n.MusicContentType,PauseEventSubtype:()=>n.PauseEventSubtype,PlayEventSubtype:()=>n.PlayEventSubtype,PodcastContentType:()=>n.PodcastContentType,RepeatMode:()=>n.RepeatMode,StopEventSubtype:()=>n.StopEventSubtype,StreamingType:()=>n.StreamingType,makeAdvListeningData:()=>r.makeAdvListeningData});var a=s(818212),n=s(761372),r=s(805711)},975106:(e,t,s)=>{"use strict";s.d(t,{AppState:()=>y,AudioEventLayer:()=>c,Autorecoms:()=>m,EVENT_ITEM_TYPE:()=>d,EventCategory:()=>_,PLAYER_INIT_ID:()=>r,PlayEventType:()=>l,Shuffle:()=>p,StopEventType:()=>u});var a=s(418562),n=s(553608);const r=(()=>{const e="AUDIO_PLAYER_INIT_ID",t=(0,n.getSessionStorage)();let s=t.getItem(e);return s||(s=(0,a.default)(),t.setItem(e,s)),s})(),d="type_audio_listening_item";var _,l,u,c,p,m,y;!function(e){e.Play="play",e.Stop="stop"}(_||(_={})),function(e){e.Start="start"}(l||(l={})),function(e){e.Pause="pause",e.End="end"}(u||(u={})),function(e){e.Not="not",e.Layer="layer"}(c||(c={})),function(e){e.Off="off",e.On="on"}(p||(p={})),function(e){e.Off="off",e.On="on"}(m||(m={})),function(e){e.Active="active",e.Inactive="inactive"}(y||(y={}))},674234:(e,t,s)=>{"use strict";s.d(t,{getEventDataKey:()=>n});var a=s(761372);function n(e){return`${function(e){switch(e.listeningType){case a.ListeningType.Music:{const{contentType:t,audioId:s,ownerId:a}=e;return`${t}/${a}_${s}`}case a.ListeningType.Adv:{const{contentType:t,advId:s}=e;return`${t}/${s}`}case a.ListeningType.Podcast:{const{contentType:t,podcastId:s,ownerId:a,episodeId:n}=e;return`${t}/${a}_${s}_${n}`}case a.ListeningType.Book:{const{contentType:t,bookId:s,chapterId:a}=e;return`${t}/${s}${a?"_":""}${a}`}case a.ListeningType.Radio:{const{contentType:t,radioId:s}=e;return`${t}/${s}`}}}(e)}/${e.trackCode}`}},847154:(e,t,s)=>{"use strict";s.d(t,{getClientServerTime:()=>a.getClientServerTime,getClientTime:()=>a.getClientTime,makeEventItem:()=>a.makeEventItem});s(982727);var a=s(187847)},187847:(e,t,s)=>{"use strict";s.d(t,{getClientServerTime:()=>l,getClientTime:()=>_,makeEventItem:()=>d});var a=s(540462),n=s(975106),r=s(982727);function d(e,t,s,a){const d=_(),u=function({category:e,type:t,subtype:s}){const a={type:e};return{[e]:{type:t,subtype:s},...a}}(e),{catalogSectionId:c}=a;return{event:u,client_time:d,client_server_time:l(d),layer:t.layer?n.AudioEventLayer.Layer:n.AudioEventLayer.Not,autorecoms:t.autorecoms?n.Autorecoms.On:n.Autorecoms.Off,track_code:t.trackCode,timeline:t.timeline,timeline_from:s,player_init_id:n.PLAYER_INIT_ID,volume:t.volume,speed:t.speed,shuffle:t.shuffle?n.Shuffle.On:n.Shuffle.Off,app_state:document.hidden?n.AppState.Inactive:n.AppState.Active,streaming_type:t.streamingType,repeat_mode:t.repeatMode,...c?{nav_info:{section_id:c}}:void 0,...(0,r.mapListeningData)(t)}}function _(){return Math.floor(Date.now()/1e3)}function l(e=_()){return e-(Number.isFinite(window.vk?.dt)?window.vk.dt:(0,a.calculateTimeOffsets)())}},982727:(e,t,s)=>{"use strict";s.d(t,{mapListeningData:()=>n});var a=s(761372);function n(e){switch(e.listeningType){case a.ListeningType.Music:return function({listeningType:e,...t}){return{listening_type:e,[e]:{audio_id:t.audioId,audio_owner_id:t.ownerId,content_type:t.contentType}}}(e);case a.ListeningType.Podcast:return function({listeningType:e,...t}){return{listening_type:e,[e]:{podcast_id:t.podcastId,podcast_owner_id:t.ownerId,episode_id:t.episodeId,podcast_authors_ids:t.authorIds,content_type:t.contentType}}}(e);case a.ListeningType.Book:return function({listeningType:e,...t}){return{listening_type:e,[e]:{book_id:t.bookId,chapter_id:t.chapterId,content_type:"audiobook_chapter"}}}(e);case a.ListeningType.Radio:return function({listeningType:e,...t}){return{listening_type:e,[e]:{radio_id:t.radioId,content_type:"radio"}}}(e);case a.ListeningType.Adv:return function({listeningType:e,...t}){return{listening_type:e,[e]:{adv_id:t.advId,content_type:"audio_adv"}}}(e)}}},123965:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerMediascopeListener:()=>a.AudioPlayerMediascopeListener,AudioPlayerMyTrackerListener:()=>n.AudioPlayerMyTrackerListener,AudioPlayerStatsListener:()=>r.AudioPlayerStatsListener});var a=s(888090),n=s(405188),r=s(771979)},851636:(e,t,s)=>{"use strict";s.d(t,{AudioHeartbeatTimer:()=>y});var a=s(434518),n=s(763812),r=s(478455),d=s(86909),_=(0,n._)("_ms"),l=(0,n._)("_onBeat"),u=(0,n._)("_clearIntervalFn"),c=(0,n._)("_currentAudio"),p=(0,n._)("_clearInterval"),m=(0,n._)("_isActive");class y{start(e){if((0,a._)(this,m)[m])throw new Error("HeartbeatTimer is already started");const t=(0,a._)(this,l)[l];(0,a._)(this,p)[p](),(0,a._)(this,c)[c]=e,(0,a._)(this,u)[u]=(0,d.setStableInterval)((()=>{t(e)}),(0,a._)(this,_)[_],{name:"AudioHeartbeatTimer"})}stop(e){if(!(0,a._)(this,m)[m])throw new Error("HeartbeatTimer is not started");const t=(0,a._)(this,c)[c]&&(0,r.getAudioFullId)((0,a._)(this,c)[c]);if((0,r.getAudioFullId)(e)!==t)throw new Error("Trying to pause another audio");(0,a._)(this,p)[p](),(0,a._)(this,c)[c]=null}clear(){(0,a._)(this,p)[p](),(0,a._)(this,c)[c]=null}constructor(e){Object.defineProperty(this,p,{value:g}),Object.defineProperty(this,m,{get:f,set:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),(0,a._)(this,u)[u]=null,(0,a._)(this,c)[c]=null,(0,a._)(this,_)[_]=e.ms,(0,a._)(this,l)[l]=e.onBeat}}function g(){(0,a._)(this,u)[u]&&((0,a._)(this,u)[u](),(0,a._)(this,u)[u]=null)}function f(){return!!(0,a._)(this,u)[u]}},985890:(e,t,s)=>{"use strict";s.d(t,{mapAudioDataToListeningData:()=>a.mapAudioDataToListeningData,mapPauseReasonToSubtype:()=>n.mapPauseReasonToSubtype,mapPlayReasonToSubtype:()=>n.mapPlayReasonToSubtype,mapSeekPauseReasonToSubtype:()=>n.mapSeekPauseReasonToSubtype,mapSeekPlayReasonToSubtype:()=>n.mapSeekPlayReasonToSubtype,mapStopReasonToSubtype:()=>n.mapStopReasonToSubtype});var a=s(936112),n=s(530887)},936112:(e,t,s)=>{"use strict";s.d(t,{mapAudioDataToListeningData:()=>_});var a=s(488150),n=s(107885);const r={[a.AudioType.MusicTrack]:n.MusicContentType.Track,[a.AudioType.MusicSnippet]:n.MusicContentType.Snippet},d={[a.AudioType.PodcastTrailer]:n.PodcastContentType.Trailer,[a.AudioType.PodcastEpisode]:n.PodcastContentType.Episode};function _(e){const{id:t,ownerId:s,type:_}=e;switch(_){case a.AudioType.MusicTrack:case a.AudioType.MusicSnippet:return{listeningType:n.ListeningType.Music,contentType:r[_],audioId:t,ownerId:s};case a.AudioType.PodcastEpisode:case a.AudioType.PodcastTrailer:return{listeningType:n.ListeningType.Podcast,contentType:d[_],episodeId:t,ownerId:s,podcastId:e.podcastId};case a.AudioType.Radio:return{listeningType:n.ListeningType.Radio,contentType:"radio",radioId:t}}}},530887:(e,t,s)=>{"use strict";s.d(t,{mapPauseReasonToSubtype:()=>p,mapPlayReasonToSubtype:()=>c,mapSeekPauseReasonToSubtype:()=>y,mapSeekPlayReasonToSubtype:()=>g,mapStopReasonToSubtype:()=>m});var a=s(426389),n=s(107885);const r={[a.AudioPlayerPlayAudioEventReason.PlayButton]:n.PlayEventSubtype.PlayButton,[a.AudioPlayerPlayAudioEventReason.NextButton]:n.PlayEventSubtype.NextButton,[a.AudioPlayerPlayAudioEventReason.PrevButton]:n.PlayEventSubtype.PrevButton,[a.AudioPlayerPlayAudioEventReason.NextMediaSession]:n.PlayEventSubtype.NextMediaSession,[a.AudioPlayerPlayAudioEventReason.PrevMediaSession]:n.PlayEventSubtype.PrevMediaSession,[a.AudioPlayerPlayAudioEventReason.MixAndPlayButton]:n.PlayEventSubtype.MixAndPlayButton,[a.AudioPlayerPlayAudioEventReason.ListButton]:n.PlayEventSubtype.FastplayListButton,[a.AudioPlayerPlayAudioEventReason.AudioButton]:n.PlayEventSubtype.FastplayAudioButton,[a.AudioPlayerPlayAudioEventReason.QueueContinuation]:n.PlayEventSubtype.QueueContinuation,[a.AudioPlayerPlayAudioEventReason.QueueContinuationAfterError]:n.PlayEventSubtype.QueueContinuationAfterError,[a.AudioPlayerPlayAudioEventReason.Autoplay]:n.PlayEventSubtype.Autoplay,[a.AudioPlayerPlayAudioEventReason.Repeat]:n.PlayEventSubtype.Repeat,[a.AudioPlayerPlayAudioEventReason.Voice]:n.PlayEventSubtype.Voice,[a.AudioPlayerPlayAudioEventReason.NextVoice]:n.PlayEventSubtype.NextVoice,[a.AudioPlayerPlayAudioEventReason.PrevVoice]:n.PlayEventSubtype.PrevVoice,[a.AudioPlayerPlayAudioEventReason.ChannelAutoResume]:n.PlayEventSubtype.ChannelAutoResume,[a.AudioPlayerPlayAudioEventReason.Unknown]:n.PlayEventSubtype.Unknown},d={[a.AudioPlayerPauseAudioEventReason.PauseButton]:n.PauseEventSubtype.PauseButton,[a.AudioPlayerPauseAudioEventReason.MediaSession]:n.PauseEventSubtype.MediaSession,[a.AudioPlayerPauseAudioEventReason.ChannelAutoPause]:n.PauseEventSubtype.ChannelAutoPause,[a.AudioPlayerPauseAudioEventReason.Voice]:n.PauseEventSubtype.Voice,[a.AudioPlayerPauseAudioEventReason.Paywall]:n.PauseEventSubtype.Paywall,[a.AudioPlayerPauseAudioEventReason.Unknown]:n.PauseEventSubtype.Unknown},_={[a.AudioPlayerStopAudioEventReason.NextButton]:n.StopEventSubtype.NextButton,[a.AudioPlayerStopAudioEventReason.PrevButton]:n.StopEventSubtype.PrevButton,[a.AudioPlayerStopAudioEventReason.QueueContinuation]:n.StopEventSubtype.Autoplay,[a.AudioPlayerStopAudioEventReason.Adv]:n.StopEventSubtype.Adv,[a.AudioPlayerStopAudioEventReason.Repeat]:n.StopEventSubtype.Repeat,[a.AudioPlayerStopAudioEventReason.ChangeQueue]:n.StopEventSubtype.ChangeSource,[a.AudioPlayerStopAudioEventReason.Clear]:n.StopEventSubtype.Close,[a.AudioPlayerStopAudioEventReason.Error]:n.StopEventSubtype.Error,[a.AudioPlayerStopAudioEventReason.Unknown]:n.StopEventSubtype.Unknown},l={[a.AudioPlayerSeekEventReason.SliderForward]:n.PauseEventSubtype.PullSliderForward,[a.AudioPlayerSeekEventReason.SliderBack]:n.PauseEventSubtype.PullSliderBack,[a.AudioPlayerSeekEventReason.TapForward]:n.PauseEventSubtype.SeekTapForward,[a.AudioPlayerSeekEventReason.TapBack]:n.PauseEventSubtype.SeekTapBack,[a.AudioPlayerSeekEventReason.DoubleTapForward]:n.PauseEventSubtype.NextDoubleTap,[a.AudioPlayerSeekEventReason.DoubleTapBack]:n.PauseEventSubtype.PrevDoubleTap,[a.AudioPlayerSeekEventReason.Unknown]:n.PauseEventSubtype.Unknown},u={[a.AudioPlayerSeekEventReason.SliderForward]:n.PlayEventSubtype.PullSliderForward,[a.AudioPlayerSeekEventReason.SliderBack]:n.PlayEventSubtype.PullSliderBack,[a.AudioPlayerSeekEventReason.TapForward]:n.PlayEventSubtype.SeekTapForward,[a.AudioPlayerSeekEventReason.TapBack]:n.PlayEventSubtype.SeekTapBack,[a.AudioPlayerSeekEventReason.DoubleTapForward]:n.PlayEventSubtype.NextDoubleTap,[a.AudioPlayerSeekEventReason.DoubleTapBack]:n.PlayEventSubtype.PrevDoubleTap,[a.AudioPlayerSeekEventReason.Unknown]:n.PlayEventSubtype.Unknown};function c(e){return r[e??a.AudioPlayerPlayAudioEventReason.Unknown]}function p(e){return d[e??a.AudioPlayerPauseAudioEventReason.Unknown]}function m(e){return _[e??a.AudioPlayerStopAudioEventReason.Unknown]}function y(e){return l[e??a.AudioPlayerPauseAudioEventReason.Unknown]}function g(e){return u[e??a.AudioPlayerPauseAudioEventReason.Unknown]}},599653:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerMediascopeListener:()=>p});var a=s(434518),n=s(763812),r=(0,n._)("_player"),d=(0,n._)("_counter"),_=(0,n._)("_handlePlayAudio"),l=(0,n._)("_handlePauseAudio"),u=(0,n._)("_handleStopAudio"),c=(0,n._)("_canOperate");class p{destroy(){(0,a._)(this,r)[r].events.off("playAudio",(0,a._)(this,_)[_]).off("pauseAudio",(0,a._)(this,l)[l]).off("stopAudio",(0,a._)(this,u)[u])}constructor(e,t){Object.defineProperty(this,c,{value:m}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,a._)(this,_)[_]=()=>{(0,a._)(this,c)[c]()&&(0,a._)(this,d)[d].start()},(0,a._)(this,l)[l]=()=>{(0,a._)(this,c)[c]()&&(0,a._)(this,d)[d].stop()},(0,a._)(this,u)[u]=()=>{(0,a._)(this,c)[c]()&&(0,a._)(this,d)[d].stop()},(0,a._)(this,r)[r]=e,(0,a._)(this,d)[d]=t.ensureActivityCounter({type:"service",events:{start:{code:"632121"},stop:{code:"652121"},heartbeat:{code:"642121",msInterval:3e4}}}),(0,a._)(this,r)[r].events.on("playAudio",(0,a._)(this,_)[_]).on("pauseAudio",(0,a._)(this,l)[l]).on("stopAudio",(0,a._)(this,u)[u])}}function m(){return!(0,a._)(this,r)[r].isMarusiaTrack()}},888090:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerMediascopeListener:()=>a.AudioPlayerMediascopeListener});var a=s(599653)},164374:(e,t,s)=>{"use strict";s.d(t,{AudioListenedDAUCounter:()=>y});var a=s(434518),n=s(763812);var r=(0,n._)("_onReach"),d=(0,n._)("_startedAt"),_=(0,n._)("_timeout"),l=(0,n._)("_listenedTime"),u=(0,n._)("_reached"),c=(0,n._)("_reach"),p=(0,n._)("_clear"),m=(0,n._)("_clearTimeout");class y{start(){(0,a._)(this,u)[u]||this.started||((0,a._)(this,d)[d]=Date.now(),(0,a._)(this,_)[_]=setTimeout((()=>{(0,a._)(this,c)[c](),(0,a._)(this,_)[_]=null}),3e4-(0,a._)(this,l)[l]))}pause(){this.started&&((0,a._)(this,m)[m](),(0,a._)(this,l)[l]+=Date.now()-(0,a._)(this,d)[d],(0,a._)(this,l)[l]>=3e4&&(0,a._)(this,c)[c]())}reset(){this.pause(),(0,a._)(this,p)[p]()}get started(){return null!==(0,a._)(this,_)[_]}constructor(e){Object.defineProperty(this,c,{value:g}),Object.defineProperty(this,p,{value:f}),Object.defineProperty(this,m,{value:E}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,a._)(this,d)[d]=-1,(0,a._)(this,_)[_]=null,(0,a._)(this,l)[l]=0,(0,a._)(this,u)[u]=!1,(0,a._)(this,r)[r]=e}}function g(){(0,a._)(this,u)[u]=!0,(0,a._)(this,r)[r]()}function f(){(0,a._)(this,m)[m](),(0,a._)(this,d)[d]=-1,(0,a._)(this,l)[l]=0,(0,a._)(this,u)[u]=!1}function E(){const e=(0,a._)(this,_)[_];e&&(clearTimeout(e),(0,a._)(this,_)[_]=null)}},977e3:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerActivityCounter:()=>A});var a=s(434518),n=s(763812),r=s(478455),d=s(540462),_=s(261793),l=s(164374),u=(0,n._)("_type"),c=(0,n._)("_timespent"),p=(0,n._)("_dau"),m=(0,n._)("_listenedCounter"),y=(0,n._)("_currentAudio"),g=(0,n._)("_debug"),f=(0,n._)("_logDebug"),E=(0,n._)("_isCurrentAudio");class A{get isActiveTimespent(){return(0,a._)(this,c)[c].isActiveTimespent}start(e){(0,a._)(this,E)[E](e)||((0,a._)(this,y)[y]=e,(0,a._)(this,m)[m].reset()),(0,a._)(this,f)[f](`start ${(0,r.getAudioFullId)(e.identity)}`),(0,a._)(this,m)[m].start(),(0,a._)(this,c)[c].startTimespent()}pause(e){(0,a._)(this,E)[E](e)&&(0,a._)(this,m)[m].pause(),(0,a._)(this,c)[c].stopTimespent(),(0,a._)(this,f)[f](`pause ${(0,r.getAudioFullId)(e.identity)}`)}stop(e){(0,a._)(this,E)[E](e)&&(0,a._)(this,m)[m].reset(),(0,a._)(this,c)[c].stopTimespent(),(0,a._)(this,f)[f](`stop ${(0,r.getAudioFullId)(e.identity)}`)}constructor({myTracker:e,type:t,strict:s}){Object.defineProperty(this,g,{get:P,set:void 0}),Object.defineProperty(this,f,{value:b}),Object.defineProperty(this,E,{value:I}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),(0,a._)(this,m)[m]=new l.AudioListenedDAUCounter((()=>{(0,a._)(this,p)[p].increment(),(0,a._)(this,f)[f]("increment")})),(0,a._)(this,y)[y]=null,(0,a._)(this,u)[u]=t,(0,a._)(this,c)[c]=T(e,_.TIMESPENT_ACTIVITY_MAP[t],s),(0,a._)(this,p)[p]=T(e,_.DAU_ACTIVITY_MAP[t],s)}}function P(){return(0,d.partConfigEnabled)("audio_player_stats_debug")}function b(e){(0,a._)(this,g)[g]&&console.log(`[AudioPlayerActivityCounter][${(0,a._)(this,u)[u]}] ${e}`)}function I(e){const t=(0,a._)(this,y)[y];return!!t&&(0,r.getAudioFullId)(e.identity)===(0,r.getAudioFullId)(t.identity)}function T(e,t,s){return e.ensureActivityCounter({activityId:t,timespentType:"service",strict:s})}},660857:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerMyTrackerListener:()=>g});var a=s(434518),n=s(763812),r=s(261793),d=s(977e3),_=(0,n._)("_player"),l=(0,n._)("_counters"),u=(0,n._)("_handlePlayAudio"),c=(0,n._)("_handlePauseAudio"),p=(0,n._)("_handleStopAudio"),m=(0,n._)("_getCounter"),y=(0,n._)("_canOperate");class g{destroy(){(0,a._)(this,_)[_].events.off("playAudio",(0,a._)(this,u)[u]).off("pauseAudio",(0,a._)(this,c)[c]).off("stopAudio",(0,a._)(this,p)[p])}constructor(e,t){Object.defineProperty(this,m,{value:f}),Object.defineProperty(this,y,{value:E}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),(0,a._)(this,u)[u]=e=>{if(!(0,a._)(this,y)[y]())return;const{audio:t}=e;(0,a._)(this,m)[m](t.type).start(t)},(0,a._)(this,c)[c]=e=>{if(!(0,a._)(this,y)[y]())return;const{audio:t}=e;(0,a._)(this,m)[m](t.type).pause(t)},(0,a._)(this,p)[p]=e=>{if(!(0,a._)(this,y)[y]())return;const{audio:t}=e;(0,a._)(this,m)[m](t.type).stop(t)},(0,a._)(this,_)[_]=e,(0,a._)(this,l)[l]=function(e){const t=t=>new d.AudioPlayerActivityCounter({myTracker:e,type:t,strict:!1});return{[r.AudioPlayerActivityCounterType.Music]:t(r.AudioPlayerActivityCounterType.Music),[r.AudioPlayerActivityCounterType.MusicSnippets]:t(r.AudioPlayerActivityCounterType.MusicSnippets),[r.AudioPlayerActivityCounterType.Podcasts]:t(r.AudioPlayerActivityCounterType.Podcasts),[r.AudioPlayerActivityCounterType.Audiobooks]:t(r.AudioPlayerActivityCounterType.Audiobooks),[r.AudioPlayerActivityCounterType.Radio]:t(r.AudioPlayerActivityCounterType.Radio)}}(t),(0,a._)(this,_)[_].events.on("playAudio",(0,a._)(this,u)[u]).on("pauseAudio",(0,a._)(this,c)[c]).on("stopAudio",(0,a._)(this,p)[p])}}function f(e){const t=r.AUDIO_TYPE_ACTIVITY_TYPE_MAP[e];return(0,a._)(this,l)[l][t]}function E(){return!(0,a._)(this,_)[_].isMarusiaTrack()}},261793:(e,t,s)=>{"use strict";s.d(t,{AUDIO_TYPE_ACTIVITY_TYPE_MAP:()=>d,AudioPlayerActivityCounterType:()=>a,DAU_ACTIVITY_MAP:()=>l,TIMESPENT_ACTIVITY_MAP:()=>_});var a,n=s(571355),r=s(488150);!function(e){e.Music="music",e.MusicSnippets="music_snippets",e.Podcasts="podcasts",e.Audiobooks="audiobooks",e.Radio="radio"}(a||(a={}));const d={[r.AudioType.MusicTrack]:"music",[r.AudioType.MusicSnippet]:"music_snippets",[r.AudioType.PodcastEpisode]:"podcasts",[r.AudioType.PodcastTrailer]:"podcasts",[r.AudioType.Radio]:"radio"},_={music:n.MyTrackerActivityId.MusicListen,music_snippets:n.MyTrackerActivityId.MusicSnippetsListen,podcasts:n.MyTrackerActivityId.PodcastsListen,audiobooks:n.MyTrackerActivityId.AudiobooksListen,radio:n.MyTrackerActivityId.RadioListen},l={music:n.MyTrackerActivityId.MusicTrackListenedDAU,music_snippets:n.MyTrackerActivityId.MusicSnippetListenedDAU,podcasts:n.MyTrackerActivityId.PodcastEpisodeListenedDAU,audiobooks:n.MyTrackerActivityId.AudiobookListenedDAU,radio:n.MyTrackerActivityId.RadiostationListenedDAU}},405188:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerMyTrackerListener:()=>a.AudioPlayerMyTrackerListener});var a=s(660857)},220347:(e,t,s)=>{"use strict";function a(e){const t={};return e&&e.length&&e.filter((e=>!!e)).map((e=>e.queues&&e.queues[0])).forEach((e=>t[e.type]=e)),t}s.d(t,{unpackQueues:()=>a})},43899:(e,t,s)=>{"use strict";s.d(t,{renderAvatarToString:()=>l});var a=s(474848),n=s(440961),r=s(751268),d=s(575753),_=s(106605);function l(e,t,s,l="",u,c,p,m,y,g){let f;u&&(f="online"),d.mobPlatforms[u]&&(f="online-mobile");const E=null!==s&&s?"a":"span",A=document.createElement(E);void 0!==c&&A.setAttribute("onclick",c),g&&A.classList.add("nft_avatar_wrap"),l&&(Array.isArray(l)?A.classList.add(...l):A.classList.add(l)),s&&(A.href=s),n.render((0,a.jsxs)(r.RichAvatar,{className:_.default.root,alt:y,src:e,size:t,nft:g,children:[p&&(0,a.jsx)(r.RichAvatar.Outline,{"data-outline-id":m,appearance:"accent"}),f&&(0,a.jsx)(r.RichAvatar.BadgeWithPreset,{preset:f})]}),A);const P=A.outerHTML;return n.unmountComponentAtNode(A),P}},175819:(e,t,s)=>{"use strict";s.d(t,{OUR_DOMAINS:()=>d,RE_DOMAIN_PATTERN:()=>l,TOP_DOMAINS:()=>n,VK_DOMAIN:()=>_});var a=s(105330);const n=[..."aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","),..."бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","),..."qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map((e=>"xn--"+e))],r=a.VK_HOST_REGEX_GROUP_UNSAFE.source,d=new RegExp(`^([a-zA-Z0-9\\.\\_\\-]+\\.)?(${r}|vk\\.cc)$`),_=new RegExp(`^(?:https?:\\/\\/)?(?:${a.VK_SITES_REGEX_SOURCE_UNSAFE})?\\/([a-zA-Z0-9\\._]+)\\??$`),l="((?:[a-z0-9_]*[a-z0-9])?(?:(?:\\.[a-z](?:[a-z0-9_]+[a-z0-9])?)*\\.[a-z][a-z0-9_]{2,40}[a-z0-9])?)"},470403:(e,t,s)=>{"use strict";s.d(t,{EMAIL:()=>n});var a=s(828758);const n=new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@("+a.RE_URL_DOMAIN_NAME+a.RE_URL_DOMAIN_TOP+"))","ig")},846145:(e,t,s)=>{"use strict";s.d(t,{FREE_MENTION:()=>r,FREE_MENTION_LINK:()=>d,MENTION:()=>n});var a=s(105330);const n=/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,r=/\[([^\$\[\]]+?)\|([^\]]+?)\]/g,d=new RegExp(`\\[((?:https?:\\/\\/)?(?:(?:m\\.|dev\\.)?(?:${a.VK_HOST_REGEX_GROUP_UNSAFE.source}|vk\\.me))(?!\\/\\/)(?!\\/doc[\\d\\-])(?!\\/page[\\d\\-])(?!\\/away[\\.\\?])(?:\\/[-\\._~:\\/?#\\[\\]@!\\$&'\\(\\)\\*\\+,;=%.\\w]*)*)\\|([^\\]\\n\\t]*)\\]`)},828758:(e,t,s)=>{"use strict";s.d(t,{RE_URL_DOMAIN_NAME:()=>n,RE_URL_DOMAIN_TOP:()=>r,RE_URL_PATTERN:()=>d});const a="\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј",n="((?:["+a+"\\—\\-\\_]+\\.){1,5})",r="([A-Za-zа-яА-Я\\-\\d]{2,22})",d="(https?:\\/\\/)?"+("("+n+r+"(?:\\:(\\d{2,5}))?)")+("(([\\/?#])(?:\\&|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯*]+|"+("(?:\\(|\\[)["+a+"\\d&#%;,]+(?:\\)|\\])")+"){0,200})?")},701563:(e,t,s)=>{"use strict";s.d(t,{logDonutEvent:()=>d});var a=s(93642),n=s(317216),r=s(261910);function d(e,t){const{type:s,type_property:d,params:_}=(0,r.parseJSON)(e);d===n.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM?a.donutStats.logEventAction({event_type:_.event_type,source:_.source,owner_id:_.owner_id}):t&&s===n.ProductionStatEventTypes.TYPE_NAVGO&&function(e,{params:t,typeProperty:s}){if(s===n.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM){const e=t.owner_id,s=t.track_code;if(!t||"number"!=typeof e||"string"!=typeof s)return;a.donutStats.logEventDescriptionClick({ownerId:e,trackCode:s})}}(0,{typeProperty:d,params:_})}},93642:(e,t,s)=>{"use strict";s.d(t,{donutStats:()=>_});var a=s(314309),n=s(317216),r=s(301374);class d{logEventAction(e){return this.actionStatCollector.logEvent(d.createDonutActionStatEvent(e))}logEventActionView(e){return this.logEventAction({...e,event_type:r.DonutActionEventType.PAYMENT_FORM})}logEventDescriptionClick(e){this.navStatCollector.logEvent({...d.createNavStatEventBase(),...d.createDescriptionClickStatEvent(e)})}static createDonutActionStatEvent(e){return{type:n.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM,[n.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM]:e}}static createNavStatEventBase(){return{screen:"wall",subtype:n.NavigationProductionStatEventTypes.GO}}static createDescriptionClickStatEvent(e){return{item:d.processClickParamsToEventItem(e),type:n.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM,[n.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM]:{}}}static processClickParamsToEventItem(e){return{type:n.EventItemType.BROWSER,owner_id:e.ownerId,track_code:e.trackCode}}constructor(){this.productionStatCollector=new a.ProductionStatCollector,this.actionStatCollector=new a.ActionStatCollector(this.productionStatCollector),this.navStatCollector=new a.NavigationStatCollector(this.productionStatCollector)}}const _=new d},650353:(e,t,s)=>{"use strict";s.d(t,{convertAttachesToPhpMedia:()=>y,convertKludgesToAttaches:()=>m,isEventForMarusia:()=>E,isOnboardingFindFriendsLink:()=>f,isPinnedSortId:()=>g});var a=s(898848),n=s(312641),r=s(105330),d=s(89473),_=s(182622);function l(e,t=[]){const[s,a]=e.split("_");return[s,a,t]}function u(e,t,s=0,a=0){if(a>50)return[[],e.length];const n=[];let r="";for(;s<e.length;){const d=e[s];if("id"===d)r=t[s];else if(","===d&&r)n.push(l(r)),r="";else if("("===d){const[d,_]=u(e,t,s+1,a+1);s=_,n.push(l(r,d)),r=""}else if(")"===d)return""!==r&&n.push(l(r)),[n,s];s++}return r&&n.push(l(r)),[n,s]}let c={};function p(e){if(c[e])return c[e];const t=e?e.length:0,s=[],a=[];let n="";for(let r=0;r<t;r++){const t=e[r],d=t.charCodeAt(0);d>=48&&d<=57||"_"===t||"-"===t?n+=t:"("!==t&&")"!==t&&":"!==t&&","!==t||(""!==n&&(a.push(n),s.push("id"),n=""),a.push(t),s.push(t))}n.length>0&&(a.push(n),s.push("id"));const[r]=u(s,a);return Object.keys(c).length>300&&(c={}),c[e]=r,r}function m(e,t){const s=[];e.fwd_count?s.push({type:"mail",id:-t,object:{fwd_count:e.fwd_count}}):e.fwd&&s.push({type:"mail",id:-t,object:{fwd_count:p(e.fwd).length}});for(let t=1;e[`attach${t}_type`];++t)switch(e[`attach${t}_type`]){case"call":s.push({type:e[`attach${t}_type`],id:e[`attach${t}`],initiatorId:(0,a.intval)(e[`attach${t}_call_initiator_id`]),state:e[`attach${t}_call_state`],duration:(0,a.intval)(e[`attach${t}_call_duration`]),receiverId:(0,a.intval)(e[`attach${t}_call_receiver_id`])});break;case"doc":if("audiomsg"===e[`attach${t}_kind`]){const a=e.attachments?JSON.parse(e.attachments)[0]:{};s.push({type:e[`attach${t}_type`],kind:"audio_message",id:e[`attach${t}`],audio_message:a.audio_message});break}default:s.push({type:e[`attach${t}_type`],id:e[`attach${t}`],kind:e[`attach${t}_kind`],productId:e[`attach${t}_product_id`]})}return e.geo&&s.push({type:"geo",id:e.geo}),s}function y(e){return e.map((e=>{const t="audiomsg"===e[2]?"audio_message":e[2];return`${e[0]}:${e[1]}:${t}`})).join(",")}function g(e){return e>0&&(e|n.PINNED_CONVERSATION_BIT_MASK)===n.PINNED_CONVERSATION_BIT_MASK}function f(e){return new RegExp(`(^(https?:\\/\\/)?([a-z0-9_\\-.]+\\.)?${r.VK_SITE_REGEX_SOURCE_UNSAFE})?\\/onboarding_find_friends`).test(decodeURIComponent(e))}function E(e){return e.type===d.ADD_MESSAGE&&(0,_.isMarusiaPeer)(e.peerId)}},979805:(e,t,s)=>{"use strict";s.d(t,{getMessageFromTuple:()=>d,hasUserMentions:()=>_});var a=s(12473),n=s(650353),r=s(810068);const d=([e,t,s,d,_,l,u,c,p,m])=>{const y=Object.assign({},l||{},u||{});return Array.isArray(y.marked_users)&&(y.marked_users=y.marked_users.filter((e=>Object.values(a.MARKED_TYPE).includes(e[0])))),{messageId:e,flags:t,peerId:s,date:d,attaches:(0,n.convertKludgesToAttaches)(y,e),subject:y.title||"",text:_,kludges:y,randomId:c,userId:r.Ranges.isChatOrChannelPeer(s)?Number(y.from)||0:s,update_time:m,chat_local_id:p}};function _(e,t){return!!e.kludges&&(e.kludges.marked_users||[]).some((e=>{if(e[0]!==a.MARKED_TYPE.MENTIONS)return!1;switch(e[1]){case"all":return!0;case"online":return e[2].includes(t);default:return e[1].includes(t)}}))}},89473:(e,t,s)=>{"use strict";s.d(t,{ADD_MESSAGE:()=>c,CHANGE_PEER:()=>U,CHANGE_TAB:()=>N,CONVERSATION_UPDATED:()=>A,CONVO_MAJOR_ID_CHANGED:()=>X,CONVO_MINOR_ID_CHANGED:()=>Q,DELETE_DIALOG:()=>K,EDIT_MESSAGE:()=>H,FAILED_MESSAGE:()=>W,FLAG_AUDIO_MESSAGE_LISTENED:()=>re,FLAG_DELETED:()=>se,FLAG_DELETE_BY_TTL:()=>de,FLAG_HAS_REACTIONS:()=>_e,FLAG_HAS_REPLY:()=>ne,FLAG_IMPORTANT:()=>ie,FLAG_OUTBOUND:()=>te,FLAG_SPAM:()=>oe,FLAG_STEALTH:()=>ae,FOLDER_AD_TAG:()=>pe,FOLDER_HAS_BANNER:()=>ce,FOLDER_IMPORTANT:()=>ue,INVALIDATE_MESSAGE:()=>$,KEYBOARD_CALLBACK_RECEIVED:()=>O,MAIL_CHAT_FLAG_DISABLE_STICKERS_POPUP_AUTOPLAY:()=>le,MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED:()=>he,MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED:()=>ve,MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED:()=>Ae,MAIL_CHAT_UPDATE_TYPE_BUSINESS_NOTIFY_DATA_CHANGED:()=>Ie,MAIL_CHAT_UPDATE_TYPE_CALL_IN_PROGRESS_CHANGED:()=>Te,MAIL_CHAT_UPDATE_TYPE_CONTACT_CONVERTED:()=>be,MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED:()=>me,MAIL_CHAT_UPDATE_TYPE_IS_NEW_CHANGED:()=>Ce,MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED:()=>we,MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED:()=>Pe,MAIL_CHAT_UPDATE_TYPE_PINNED:()=>ye,MAIL_CHAT_UPDATE_TYPE_USER_JOINED:()=>ge,MAIL_CHAT_UPDATE_TYPE_USER_KICKED:()=>Ee,MAIL_CHAT_UPDATE_TYPE_USER_LEFT:()=>fe,MESSAGE_REQUEST_STATUS_ACCEPTED:()=>Oe,MESSAGE_REQUEST_STATUS_NEW:()=>Se,MESSAGE_REQUEST_STATUS_REJECTED:()=>Me,MUTEX:()=>F,NOTIFY_SETTINGS_CHANGED:()=>C,PEER_PROFILE_TAGS_CHANGED_EVENT:()=>Z,PEER_TAGS_CHANGED_EVENT:()=>J,REACTION_CREATE_OR_EDIT_EVENT:()=>ee,READ_INBOUND:()=>p,READ_INBOUND_BY_CMID:()=>y,READ_OUTBOUND:()=>m,READ_OUTBOUND_BY_CMID:()=>f,RECONNECTED:()=>Y,RECONNECTING:()=>q,RECORDING_AUDIO:()=>b,REFRESH_LP_KEY:()=>R,REPLACE_DIRECTORIES:()=>D,REPLACE_FLAGS:()=>l,REPLACE_MESSAGE:()=>j,RESEND:()=>V,RESET_DIRECTORIES:()=>S,RESET_FLAGS:()=>u,RESET_PEER:()=>x,RESYNC:()=>L,SET_DIRECTORIES:()=>k,SET_FLAGS:()=>_,TRANSITION:()=>B,TYPING:()=>P,UNREAD_COUNT:()=>T,UNREAD_REACTIONS:()=>g,WAITING_FOR_RECONNECT:()=>G,constructEvent:()=>r,mutexEvent:()=>xe,readInboundByCmidEvent:()=>Re,readInboundEvent:()=>De,resetDirectoriesEvent:()=>ke,resyncEvent:()=>Be,setDirectoriesEvent:()=>Le});var a=s(979805),n=s(898848);function r(e){switch(e[0]){case 0:return function([,e]){return{type:d,localId:e}}(e);case 1:return function([,e,t,s]){return{type:l,messageId:e,mask:t,peerId:s}}(e);case 2:return function([,e,t,s]){return{type:_,messageId:e,flags:t,peerId:s}}(e);case 3:return function([,e,t,s]){return{type:u,messageId:e,flags:t,peerId:s}}(e);case 4:return function([,e,t,s,n,r,d,_,l,u,p,m]){return{type:c,...(0,a.getMessageFromTuple)([Number(e),Number(t),Number(n),Number(r),d,_,l,u,p,m]),minorSortId:s}}(e);case 5:return function([,e,t,s,n,r,d,_,l,u,c]){return{type:H,...(0,a.getMessageFromTuple)([Number(e),Number(t),Number(s),Number(n),r,d,_,l,u,c])}}(e);case 6:return De(e);case 7:return function([,e,t,s]){return{type:m,peerId:e,upToId:t,unread:s}}(e);case 10:return ke(e);case 11:return function([,e,t]){return{type:D,peerId:e,mask:t}}(e);case 12:return Le(e);case 13:return function([,e,t,s]){return{type:K,peerId:e,localId:t,leaveChat:s}}(e);case 18:return function([,e,t,s,n,r,d,_,l,u,c]){return{type:j,...(0,a.getMessageFromTuple)([Number(e),Number(t),Number(s),Number(n),r,d,_,l,u,c])}}(e);case 19:return function([,e]){return{type:$,messageId:e}}(e);case 20:return function([,e,t]){return{type:X,peerId:e,majorId:t}}(e);case 21:return function([,e,t]){return{type:Q,peerId:e,minorId:t}}(e);case 23:return function([,e,t]){return{type:J,peerId:e,peerTagsMask:t}}(e);case 51:return function([,e,t]){return{type:E,chatId:e,self:t}}(e);case 52:return function([,e,t,s]){return{type:A,peerId:t,updateType:e,updateArg:s}}(e);case 63:return function([,e,t,s,a]){return{type:P,peerId:e,userIds:t,totalCount:s,ts:a}}(e);case 64:return function([,e,t,s,a]){return{type:b,peerId:e,userIds:t,totalCount:s,ts:a}}(e);case 70:return function([,e,t]){return{type:I,userId:e,callId:t}}(e);case 80:return function([,e,t,s,a,n,r,d,_,l]){return{type:T,count:e,countNotMuted:t,showOnlyNotMuted:s,businessNotifyUnread:a,headerTotalUnread:n,headerNotMutedUnread:r,archiveUnreadCount:d,archiveUnreadUnmutedCount:_,archiveMentionsCount:l}}(e);case 114:return function([,e]){const{peer_id:t,sound:s,disabled_until:a}=e||{};return{type:C,peerId:t,sound:s,disabledUntil:a}}(e);case 115:return function([,e]){return{type:z,payload:e}}(e);case 119:return function([,e]){const{event_id:t,owner_id:s,peer_id:a,action:n}=e;return{type:O,event_id:t,owner_id:s,peer_id:a,action:n}}(e);case 120:return function([]){return{type:Z}}(e);case 601:return function([,e,...t]){const s=[],a=1===e?t.splice(2,1).pop():void 0,[n,r,d,..._]=t;for(let e=0;e<d;e++){const e=_.shift(),[t,a,,...n]=_.splice(0,e);s.push({reaction_id:t,count:a,...n?{user_ids:n}:void 0})}return{type:ee,subtype:e,peerId:n,cmid:r,reactionsCount:d,reactionCounters:s,...a?{reactionId:a}:void 0}}(e);case 602:return function([,e,t,...s]){return{type:g,peerId:e,totalCount:t,cmids:s}}(e);case 10006:return Re(e);case 10007:return function([,e,t,s]){return{type:f,peerId:e,upToCmid:t,unread:s}}(e);case-1:return Be();case-2:return function([,e,t]){return{type:R,key:e,url:t}}(e);case-3:return function([,e]){return{type:G,timeout:e}}(e);case-4:return{type:q};case-5:return{type:Y};default:return function(e){return{type:M,params:e}}(e)}}const d="event_delete",_="event_set_flags",l="event_replace_flags",u="event_reset_flags",c="event_add_message",p="event_read_inbound",m="event_read_outbound",y="event_read_inbound_by_cmid",g="event_unread_reactions",f="event_read_outbound_by_cmid",E="event_chat_changed",A="event_chat_updated",P="event_typing",b="event_recoding_audio",I="event_video_call",T="event_unread_count",C="event_notify_settings_changed",O="event_keyboard_callback_received",M="event_empty",S="event_reset_directories",D="event_replace_directories",k="event_set_directories",L="event_resync",R="event_refresh_lp_key",B="transition_event",x="reset_peer",F="mutex",U="change_peer",N="event_change_tab",W="event_failed_message",V="event_resend",K="event_delete_dialog",H="event_edit_message",j="event_replace_message",$="event_invalidate_event",G="event_waiting_for_reconnect",q="event_reconnecting",Y="event_reconnected",z="incoming_call",X="event_convo_major_id_changed",Q="event_convo_minor_id_changed",J="peer_tags_changed",Z="peer_profile_tags_changed",ee="reaction_create_or_edit",te=2,ie=8,oe=64,se=128,ae=65536,ne=1<<21,re=4096,de=1<<22,_e=1<<24,le=549755813888,ue=1,ce=8,pe=32768,he=3,me=4,ye=5,ge=6,fe=7,Ee=8,ve=9,Ae=10,we=11,Pe=12,be=13,Ie=14,Te=19,Ce=22,Oe=1,Me=2,Se=3;function De([,e,t,s]){return{type:p,peerId:e,upToId:t,unread:s}}function ke([,e,t,s=!1]){return{type:S,peerId:e,mask:t,local:s}}function Le([,e,t,s=!1]){return{type:k,peerId:e,mask:t,local:s}}function Re([,e,t,s]){return{type:y,peerId:e,upToCmid:t,unread:s}}function Be(){return{type:L}}function xe([,e,t,s,a,r]){return{type:F,free:!!(0,n.intval)(e)||(0,n.intval)(a)===window.vk.id,resource:t,peerId:(0,n.intval)(s),who:(0,n.intval)(a),name:r}}},12473:(e,t,s)=>{"use strict";var a,n;s.d(t,{AttachmentType:()=>n,MARKED_TYPE:()=>a}),function(e){e[e.MENTIONS=1]="MENTIONS",e[e.CASPER=2]="CASPER"}(a||(a={})),function(e){e.REPLY="reply",e.DOCUMENT="doc",e.MAIL="mail",e.CALL="call",e.STICKER="sticker",e.UGC_STICKER="ugc_sticker"}(n||(n={}))},725669:(e,t,s)=>{"use strict";s.d(t,{asyncComponent:()=>r});var a=s(296540),n=s(8520);function r(e,t){return(0,a.lazy)((()=>(0,n.asyncImportLoader)(e,3).then((e=>({default:t(e)})))))}},695847:(e,t,s)=>{"use strict";function a(e){return navigator.clipboard?function(e){return navigator.clipboard.writeText(e)}(e):(n(e),Promise.resolve())}function n(e){const t=document.createElement("input"),s=document.activeElement;t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),s.focus()}s.d(t,{_copyWithFakeElement:()=>n,copyToClipboard:()=>a})},353557:(e,t,s)=>{"use strict";function a(e,t){let s;e=Math.max(e,0);const a=Math.floor(e%60);s=a<10?"0"+a:a;const n=(e=Math.floor(e/60))%60;return s=n+":"+s,((e=Math.floor(e/60))>0||t)&&(n<10&&(s="0"+s),s=e+":"+s),s}s.d(t,{formatTime:()=>a})},203763:(e,t,s)=>{"use strict";s.d(t,{dedupeAsyncCallback:()=>n});var a=s(8520);function n(e,t=((...e)=>e)){const s=new Map;return(...n)=>{const r=t(...n);for(const[e,t]of s.entries())if((0,a.isEqual)(r,e))return t;const d=e(...n);return s.set(r,d),d.finally((()=>{s.delete(r)})),d}}},194025:(e,t,s)=>{"use strict";s.d(t,{NarrativeAnalyticEventType:()=>a,NarrativeAnalyticNavScreen:()=>n,sendNarrativeAnalytic:()=>_});var a,n,r=s(636576),d=s(540462);function _(e,t,s="other"){const a=t?.title||void 0,n=t?.customCover?0:t?.coverStoryId||0,_=t?.id||0,l=t?.ownerId||0;let u=t?.storyIds;u?.length||(u=t?.stories?.map((e=>e.id)));const c={event_type:e,nav_screen:s,narrative_owner_id:l,narrative_id:_,narrative_title:a,story_ids:u?.length?u:void 0,cover_story_id:n};(0,r.statlogsValueEvent)("narrative_product_analytic",c),(0,d.partConfigEnabled)("narratives_web_analytic_debug")&&console.log("-- narrative analytic",c)}!function(e){e.clickToAddToNarrative="click_to_add_to_narrative",e.addStoryToNarrative="add_story_to_narrative",e.openNarrativeList="open_narrative_list",e.close="close",e.changeSort="change_sort",e.publishNarrative="publish_narrative",e.createNarrative="create_narrative",e.deleteNarrative="delete_narrative",e.clickToEditNarrative="click_to_edit_narrative",e.editNarrative="edit_narrative",e.addToBookmarks="add_to_bookmarks",e.shareNarrative="share_narrative",e.seeMore="see_more",e.addToNarrativeFromActionSheet="add_to_narrative_from_action_sheet"}(a||(a={})),function(e){e.storyArchive="story_archive",e.storyViewer="story_viewer",e.profile="profile",e.feedBlock="narratives_feed_block",e.club="club",e.other="other"}(n||(n={}))},261910:(e,t,s)=>{"use strict";s.d(t,{parseJSON:()=>n});var a=s(298077);function n(e){try{return JSON.parse(e)}catch(t){const s={environment:"parseJsonError",breadcrumb:{message:"Uncaught json parse error",data:{json:e},category:"custom"}};return(0,a.logError)(t,s),{}}}},680960:(e,t,s)=>{"use strict";s.d(t,{logQuestionError:()=>a});const a=(0,s(339328).createSentryLogger)({debugPrefix:"[Questions Sentry Logger]"})},961209:(e,t,s)=>{"use strict";s.d(t,{QuestionsStatCollector:()=>l});var a=s(314309),n=s(317216),r=s(540462),d=s(148230),_=s(419222);class l{logClickEvent(e,t={}){const s={type:n.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM,[n.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM]:{type:e,screen:t.navScreen||window.cur.module||""}};t.questionReceiverId&&(s[n.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_receiver_id=t.questionReceiverId),t.questionAuthorId&&(s[n.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_author_id=t.questionAuthorId),t.questionText&&(s[n.ClickProductionStatEventTypes.TYPE_QUESTION_ITEM].question_text=t.questionText);const a={type:n.EventItemType.QUESTION,id:t.questionId||0};(0,r.partConfigEnabled)("profile_questions_analytic_debug")&&console.log(`--${e}`,s,a),this.clickStatCollector.logEvent(s,a)}logOpeningEvent(e,t,s){let a;switch(t){case _.QuestionsBoxRef.STORY:a=s===d.QuestionAnalyticBoxName.askQuestion?d.QuestionAnalyticEventType.openAskQuestionFromStory:d.QuestionAnalyticEventType.openMyQuestionsFromStory;break;case _.QuestionsBoxRef.SNIPPET:a=s===d.QuestionAnalyticBoxName.askQuestion?d.QuestionAnalyticEventType.openAskQuestionFromSnippet:d.QuestionAnalyticEventType.openMyQuestionsFromSnippet;break;default:a=s===d.QuestionAnalyticBoxName.askQuestion?d.QuestionAnalyticEventType.openAskQuestionFromUrl:d.QuestionAnalyticEventType.openMyQuestionsFromUrl}const n={questionReceiverId:e};s===d.QuestionAnalyticBoxName.askQuestion&&(n.questionAuthorId=window.vk.id),this.logClickEvent(a,n)}constructor(){this.productionStatCollector=new a.ProductionStatCollector,this.clickStatCollector=new a.ClickStatCollector(this.productionStatCollector)}}},508611:(e,t,s)=>{"use strict";s.d(t,{logQuestionsClickEvent:()=>n,logQuestionsOpeningEvent:()=>r});const a=new(s(961209).QuestionsStatCollector);function n(e,t={}){a.logClickEvent(e,t)}function r(e,t,s){a.logOpeningEvent(e,t,s)}},148230:(e,t,s)=>{"use strict";var a,n;s.d(t,{QuestionAnalyticBoxName:()=>n,QuestionAnalyticEventType:()=>a}),function(e){e.clickToQuestion="click_to_question",e.reply="reply",e.replyAgain="reply_again",e.sharing="sharing",e.shareToStory="share_to_story",e.shareToWall="share_to_wall",e.shareToGroup="share_to_group",e.shareToIm="share_to_im",e.copyLink="copy_link",e.openStory="open_story",e.callFriends="call_friends",e.openSettings="open_settings",e.openProfile="open_profile",e.block="block",e.unblock="unblock",e.deleteAllQuestions="delete_all_questions",e.delete="delete",e.cancelDelete="cancel_delete",e.cancelDeleteAllAuthorQuestions="cancel_delete_all_author_questions",e.cancelDeleteAllAnonymousQuestions="cancel_delete_all_anonymous_questions",e.next="next",e.close="close",e.clickToSend="click_to_send",e.sendQuestion="send_question",e.cancelSendQuestion="cancel_send_question",e.cancelWriteAnswer="cancel_write_answer",e.closeMyQuestions="close_my_questions",e.openMyQuestionsFromUrl="open_my_questions_from_url",e.openAskQuestionFromUrl="open_ask_question_from_url",e.openMyQuestionsFromSnippet="open_my_questions_from_snippet",e.openAskQuestionFromSnippet="open_ask_question_from_snippet",e.openMyQuestionsFromStory="open_my_questions_from_story",e.openAskQuestionFromStory="open_ask_question_from_story"}(a||(a={})),function(e){e[e.askQuestion=0]="askQuestion",e[e.myQuestions=1]="myQuestions"}(n||(n={}))},444024:(e,t,s)=>{"use strict";s.d(t,{parseReactWikiLinks:()=>p});var a=s(474848),n=s(296540),r=s(279734),d=s(34231);const _={target:"_self",withVKUILink:!1,withNewRegex:!1,wrapAwayIfExternal:!1},l=new RegExp(`\\[?(${/(?:http(s)?:\/\/)/.source}?${/[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=.]+/.source})${/(?:\|([\wёЁА-я ]{1,}))/.source}?\\]?`),u=new RegExp(`(${l.source}|${/\[(id|public|club|event)-?[\d]{1,}\|[\wёЁА-я ]{1,}\]/.source})`,"gi"),c=/^(http(s)?:\/\/)?vk.(com|ru)/gi;function p(e,t=_){const{target:s=_.target,withVKUILink:l=_.withVKUILink}=t,p=e.match(t.withNewRegex?u:/\[(.*?)\]/g),m=p?p.map((e=>e.replace(/\[|(.*?)\]/g,"$1"))):[];if(!p||!m.length)return(0,a.jsx)(n.Fragment,{children:e});const y=l?r.Link:"a",g=m.map(((e,n)=>{const[r,_]=e.split("|");let l=t.hrefMap?.[r]||(c.test(r)?r.replace(c,""):r);const u=t.onClickMap?.[r];return t.wrapAwayIfExternal&&(l=(0,d.wrapAwayIfExternal)(l)),(0,a.jsx)(y,{href:l,target:s,onClick:u,children:_||r},n)})),f=[];return p.forEach(((t,s)=>{const a=e.indexOf(t);f.push(e.substr(0,a)),f.push(g[s]),e=e.slice(a+t.length)})),f.push(e),(0,a.jsx)(n.Fragment,{children:f})}},598129:(e,t,s)=>{"use strict";function a(e,t){let s,a=t.timeout,n=t.onLoad,r=t.onError,d=document.createElement("script");if(d.addEventListener("load",_),d.addEventListener("readystatechange",_),d.addEventListener("error",l),t.attributes)for(const[e,s]of Object.entries(t.attributes))null==s||("boolean"==typeof s?d.toggleAttribute(e,s):d.setAttribute(e,s));function _(){d.readyState&&"loaded"!==d.readyState&&"complete"!==d.readyState||(u(),n&&n())}function l(){u(),r&&r()}function u(){clearTimeout(s),d.removeEventListener("load",_),d.removeEventListener("readystatechange",_),d.removeEventListener("error",l)}return d.src=e,document.head.appendChild(d),a&&(s=setTimeout(l,a)),{destroy:function(){u()}}}s.d(t,{loadScript:()=>a})},346723:(e,t,s)=>{"use strict";s.d(t,{marusiaAudioStats:()=>l});var a=s(540462),n=s(482310),r=s(793722),d=s(121246);class _{startLoop(){this.stopLoop(),this.sendIsPlayingInterval=setInterval(this.sendTrackPlaying.bind(this),_.SEND_IS_PLAYING_INTERVAL),this.currentTrackStartPlayTimeMs=this.getCurrentTime()}getCurrentTime(){return(new Date).getTime()}stopLoop(){this.sendIsPlayingInterval&&(clearInterval(this.sendIsPlayingInterval),this.sendIsPlayingInterval=null),this.currentTrackStartPlayTimeMs=null}sendTrackPlaying(){if(!this.playerAdapter)return void this.stopLoop();if(!this.playerAdapter.isMarusiaTrack())return void this.stopLoop();const e=this.playerAdapter.getAudio();e?(this.sendDeviceStatEvent(d.PlayerDeviceStatEventType.TRACK_PLAYING,d.ActivationSource.playback,e),this.sendPlayerStatusEvent("PLAY",e)):this.stopLoop()}sendPlayerStatusEvent(e,t){if(!this.playerAdapter||!this.currentTrackStartPlayTimeMs)return;const s=(0,n.getAudioExtra)(t)?.voiceAssistant;if(!s)return;const a=s.source?.url??t.url,r=s.source?.skill_name??_.GLOBAL,d={meta:{source:s.source,title:t.title,url:a},url:a,volume:this.playerAdapter.getVolume(),repeat:this.playerAdapter.isRepeatCurrentAudio(),state:e,updated:(new Date).getTime()/1e3,position:this.playerAdapter.getTrackPosition(),elapsed:this.playerAdapter.getProgressInSeconds(),duration:t.duration,created:this.currentTrackStartPlayTimeMs,skill:r,random:this.playerAdapter.isShuffledPlaylist()};this.api.sendPlayerStatus(r,d)}sendDeviceStatEvent(e,t,s){if(!s||!this.playerAdapter)return;const a=(0,n.getAudioExtra)(s)?.voiceAssistant;if(!a)return;const r={type:e,phrase_id:a.source?.phrase_id??"",timestamp:Math.round((new Date).getTime()/1e3),data:{track_id:a.track_id??"",position:this.playerAdapter.getProgress(),duration:this.playerAdapter.getAudio().duration,activated_by:t,source_type:a.source?.type??"",flags:a.flags??"",playback_duration:this.playerAdapter.getListenedTime(),audio_type:a.source?.media_type??""}};this.api.sendDeviceStat([r])}getActivatedBy(e,t){switch(e){case d.PlayerDeviceStatEventType.TRACK_STOP:return d.ActivationSource.os_system;case d.PlayerDeviceStatEventType.TRACK_START:case d.PlayerDeviceStatEventType.TRACK_RESUME:if(t.isAutoPlayed())return d.ActivationSource.playback;return t.getSequence()?d.ActivationSource.playback:d.ActivationSource.app_ui;default:return d.ActivationSource.os_system}}onPlay(e){if(!(0,a.partConfigEnabled)("marusia_web_music_stats"))return;this.playerAdapter=e;const t=this.playerAdapter.getAudio();if(!t)return;const s=t.fullId,n=this.currentAudioId===s;this.currentAudioId=s,!n&&this.currentAudio&&this.onEnded(e,this.currentAudio),this.currentAudio=t;const r=n?d.PlayerDeviceStatEventType.TRACK_RESUME:d.PlayerDeviceStatEventType.TRACK_START,_=e.isAutoPlayed()?d.ActivationSource.playback:d.ActivationSource.app_ui;this.sendDeviceStatEvent(r,_,t),this.sendPlayerStatusEvent("PLAY",t),this.startLoop()}onPause(e){if(!(0,a.partConfigEnabled)("marusia_web_music_stats"))return;this.playerAdapter=e;const t=this.playerAdapter.getAudio();t&&(this.sendDeviceStatEvent(d.PlayerDeviceStatEventType.TRACK_PAUSE,d.ActivationSource.os_system,t),this.sendPlayerStatusEvent("PAUSE",t),this.stopLoop())}onEnded(e,t){(0,a.partConfigEnabled)("marusia_web_music_stats")&&(this.playerAdapter=e,t&&(this.sendDeviceStatEvent(d.PlayerDeviceStatEventType.TRACK_STOP,d.ActivationSource.os_system,t),this.sendPlayerStatusEvent("STOP",t),this.stopLoop()))}constructor(){this.api=new r.MarusiaSharedApi,this.sendIsPlayingInterval=null,this.playerAdapter=null,this.currentTrackStartPlayTimeMs=null,this.currentAudioId=null,this.currentAudio=null}}_.SEND_IS_PLAYING_INTERVAL=15e3,_.GLOBAL="__global__";const l=new _},793722:(e,t,s)=>{"use strict";s.d(t,{MarusiaSharedApi:()=>u});var a=s(957994),n=s(812527),r=s(40147),d=s(461742),_=s(474284);const l="https://vc.go.mail.ru";class u{generateDeviceId(){return(0,r.generateDeviceId)("vk_web",this.debug)}processBackendCommands(e,t){const s={phrase_id:e,command_ids:JSON.stringify(t)};return(0,a.api)("marusia.processCommands",s)}getSuggests(e){const t={has_unread_messages:Number(e)};return(0,a.api)("marusia.getSuggests",t)}getWebStatic(){return(0,a.api)("marusia.getWebStatic",{})}getWebSession(e){const t={device_id:e};return(0,a.api)("marusia.getWebSession",t)}revokeWebSession(e){const t={device_id:e};return(0,a.api)("marusia.revokeWebSession",t)}getLastMessageCommands(){return(0,a.api)("marusia.getLastMessageCommands",{})}sendStartSessionEvent(){return(0,a.api)("marusia.sendStartSessionEvent",{})}getOnboarding(){return(0,a.api)("marusia.getOnboarding",{})}async isBackendCommand(e){const t=(await this.getInitConfig()).marusiaBackendCommands?.commands;return!t||t.some((t=>"media"===e.type?"vk"===e.meta?.source?.type&&(e.type===t.type&&e.media_type===t.media_type):("playlist"!==e.type||"vk"===e.tracks[0]?.meta?.source?.type)&&e.type===t.type))}getInitConfig(){return null===this.initConfigCache&&(this.initConfigCache=(0,a.api)("marusia.getInitConfig",{device_id:this.generateDeviceId(),tts_type:"mp3"})),this.initConfigCache}sendMessage(e,t,s){return(0,a.api)("messages.send",{peer_id:e,random_id:Math.round(2147483647*Math.random()),payload:JSON.stringify(s),message:t})}reloadAudios(e){return Promise.resolve([])}getApiHost(){return this.getInitConfig().then((e=>e.marusiaServerType?e.marusiaServerType:{server_url:l,skill:""}))}async makeRequest(e,t={},s={}){const a=await(0,n.getSession)(this),r=await this.getApiHost(),_=r.server_url,u=this.generateDeviceId(),c=(await this.getInitConfig()).maskedChatId,p={...t,dialog_mode:"vk_bot",session_id:a.session_id,device_id:u,chat_id:":vk:chat:"+c};_!==l&&(p.skillserver_type=r.skill);const m=new URLSearchParams(p).toString();let y=!0,g=null;try{g=await fetch(`${_}/${e}?${m}`,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.session_secret}`},...s}),400===g.status&&(y=!1,g=null)}catch{}if(!y)return await(0,n.revokeSession)(this),this.makeRequest(e,t,s);if(!g)throw new Error(d.MarusiaError.API_ERROR);return g.json()}async getPreparedCapabilities(){const e=(await this.getInitConfig()).capabilities.capabilities2;let t={};return e&&(t=e.reduce(((e,t)=>({...e,[t.capability]:t.enabled})),{})),t}async getDefaultOptions(e){const t=await this.getPreparedCapabilities();return{body:JSON.stringify({...e,capabilities2:{capabilities:t}})}}async addChunk(e,t,s=!1,a,n){const r={last:s?1:0,phrase_id:e,chunk_num:t},d={signal:n,body:a};return(await this.makeRequest("phrase/add",r,d)).result}async createAsrPhrase(e,t){const s={};e&&(s.player_data=e);const a=await this.getDefaultOptions(s);return t&&(a.signal=t),this.makeRequest("phrase/create",{no_kw:1},a)}async phraseCreateText(e,t,s){const a={text:e,refuse_tts:1},n=t??{};s&&(n.player_data=s);const r=await this.getDefaultOptions(n);return this.makeRequest("phrase/create/text",a,r)}async phraseCreateEvent(e,t,s){const a={event:e,refuse_tts:1},n=t??{};s&&(n.player_data=s);const r=await this.getDefaultOptions(n);return this.makeRequest("phrase/create/event",a,r)}async getPhraseResult(e){const t={phrase_id:e,capabilities2:JSON.stringify({capabilities:await this.getPreparedCapabilities()})};return this.makeRequest("phrase/result",t,{method:"GET"})}async upgradeToken(e){const t={app_id:_.MARUSIA_APP_ID},s={body:JSON.stringify({phrase_info:e.phrase_info})};return this.makeRequest("account/vk/upgrade_token",t,s)}sendDeviceStat(e){const t={body:JSON.stringify({events:e})};return this.makeRequest("device/stat",{},t)}sendPlayerStatus(e,t){const s={as_global:1,skill_id:e},a={body:JSON.stringify(t)};return this.makeRequest("player/status",s,a)}skillList(e){const t={category:e,size:10,page:0,use_all_platforms:0};return this.makeRequest("skill_list",t,{method:"GET"})}skillListCategories(){return this.makeRequest("skill_list/categories",{add_featured:1,use_all_platforms:0},{method:"GET"})}constructor(e){this.debug=!1,this.initConfigCache=null,this.debug=!!e}}},474284:(e,t,s)=>{"use strict";s.d(t,{MARUSIA_APP_ID:()=>a});const a=6463690},40147:(e,t,s)=>{"use strict";s.d(t,{generateDeviceId:()=>d});var a=s(8520),n=s(75745);const r="marusia-device-id";function d(e,t){let s=a.localStorage.getItem(r);if(!s){s=`:${t?"d":"c"}:${"chat"}:${e}:${(0,n.uuid)(32)}`,a.localStorage.setItem(r,s)}return s}},812527:(e,t,s)=>{"use strict";let a;s.d(t,{getSession:()=>r,revokeSession:()=>_});let n=3;async function r(e){if(!a){const t=e.generateDeviceId();a=e.getWebSession(t)}try{return await a}catch(t){if(console.error("get session error",t),n<3)return n+=1,d(),r(e);throw new Error("get session error")}}function d(){a=void 0}function _(e){return d(),e.revokeWebSession(e.generateDeviceId())}},461742:(e,t,s)=>{"use strict";var a,n;s.d(t,{CommunicationType:()=>a,MarusiaError:()=>n}),function(e){e.kws="kws",e.listen_command="listen_command",e.button="button",e.text="text",e.suggest="suggest",e.skill="skill",e.widget="widget",e.other="other"}(a||(a={})),function(e){e.HIDDEN="HIDDEN",e.BACKEND_COMMAND_TIMEOUT="BACKEND_COMMAND_TIMEOUT",e.USER_INTERRUPT="USER_INTERRUPT",e.ATTACH_LOAD_TIMEOUT="ATTACHES_LOAD_TIMEOUT",e.API_ERROR="API_ERROR"}(n||(n={}))},794070:(e,t,s)=>{"use strict";var a;s.d(t,{MarusiaMediaType:()=>a}),function(e){e[e.music=1]="music",e[e.radio=2]="radio",e[e.noise=3]="noise",e[e.tale=4]="tale",e[e.podcast=5]="podcast",e[e.books=6]="books",e[e.video=8]="video"}(a||(a={}))},121246:(e,t,s)=>{"use strict";var a,n;s.d(t,{ActivationSource:()=>n,PlayerDeviceStatEventType:()=>a}),function(e){e.TRACK_START="player.track_start",e.TRACK_STOP="player.track_stop",e.TRACK_RESUME="player.track_resume",e.TRACK_PAUSE="player.track_pause",e.TRACK_PLAYING="player.track_playing"}(a||(a={})),function(e){e.playback="playback",e.backend_new_media="backend_new_media",e.backend_controls="backend_controls",e.os_ui="os_ui",e.os_system="os_system",e.app_ui="app_ui",e.playback_limit="playback_limit"}(n||(n={}))},75745:(e,t,s)=>{"use strict";s.d(t,{MARUSIA_PEER_ID:()=>a,disableMarusiaTextInput:()=>_,enableMarusiaTextInput:()=>l,getSuggestContentForApi:()=>c,isPayloadForCommand:()=>r,isSuggestCommand:()=>d,parseBase64JSON:()=>u,replaceSpecialPhrases:()=>p,uuid:()=>n});s(794070),s(89473);const a=-194070336;function n(e=32){return[...Array(e).keys()].reduce((e=>`${e}${Math.floor(16*Math.random()).toString(16)}`),"")}function r(e,t){if(!e.voice_assistant)return!1;const s=e.voice_assistant;return!(s.phrase_id!==t.phraseId||(a=s.command_ids,n=t.commandIds,a.length!==n.length||!a.every((e=>n.includes(e)))));var a,n}function d(e){return["text_suggest","event_suggest","url_suggest"].includes(e.type)}function _(e){e.contentEditable="false",e.classList.add("im-chat-input--text_disabled")}function l(e){e.contentEditable="true",e.classList.remove("im-chat-input--text_disabled")}function u(e){let t=null;if(e)try{t=JSON.parse(atob(e))}catch(e){console.error("Failed to parse JSON")}return t}function c(e){let t="";return"event_suggest"===e.type&&(t=e.text),"text_suggest"===e.type&&(t=e.payload),p(t)}function p(e){return e.replace("#DISLIKE#","👎🏻").replace("#LIKE#","👍🏻")}},683852:(e,t,s)=>{"use strict";s.d(t,{areResourcesBlocked:()=>n});var a=s(952492);async function n(){const e=new AbortController;try{await Promise.all(a.URLS.map((t=>fetch(t,{method:"HEAD",mode:"no-cors",signal:e.signal}))))}catch{return e.abort(),!0}return!1}},210909:(e,t,s)=>{"use strict";s.d(t,{isAdblockDetected:()=>p});var a=s(540462),n=s(636576),r=s(170022),d=s(433367),_=s(952492),l=s(683852),u=s(636111);const c={RESOURCE:"resource",ADVERT:"advert",BOTH:"both"};async function p(){const[e,t]=await Promise.all([(0,l.areResourcesBlocked)(),(0,u.isAdvertBlocked)()]);return e&&t?c.BOTH:e?c.RESOURCE:!!t&&c.ADVERT}(0,a.partConfigEnabled)("unique_adblock_users")&&requestIdleCallback((async()=>{const e=new d.CooldownManager(window.vk?.id,r.METRICS_SCOPE.ADBLOCK_STATS,_.DEFAULT_ADBLOCK_STATS_COOLDOWN_MS);if(!e.isMetricOnCoolDown()){const t=await p();(0,n.statlogsValueEvent)(_.ADBLOCK_CONFIG_KEY,window.vk.id,window.vk.statsMeta.platform,Boolean(t).toString(),t||void 0,window.cur.module||void 0),e.updateMetricTimestamp()}}),{timeout:5e3})},170022:(e,t,s)=>{"use strict";var a;s.d(t,{METRICS_SCOPE:()=>a}),function(e){e.USER_INFO_STATS="USER_INFO_STATS",e.PERFORMANCE_STATS="PERFORMANCE_STATS",e.ADBLOCK_STATS="ADBLOCK_STATS",e.MODULE_NAVIGATION_STATS="MODULE_NAVIGATION_STATS",e.BROWSER_CERTIFICATE_SUPPORT="CERT_STATS",e.WASM_SUPPORT="WASM_STATS"}(a||(a={}))},433367:(e,t,s)=>{"use strict";s.d(t,{CooldownManager:()=>n});var a=s(553608);class n{getMetricsState(){const e=a.vkLocalStorage.getItem(this.storageName);return e?JSON.parse(e):{timestamps:{}}}getMetricName(e){if("number"==typeof this.cooldown)return e??"default";if(!e)throw new Error("The metric name is required for a complex cooldown configuration.");return e}getMetricTTL(e){return"number"==typeof this.cooldown?this.cooldown:this.cooldown[e]}checkMetricCooldown(e,t){return(!this.options.invalidationReasons?.dateChange||new Date(t).toDateString()===(new Date).toDateString())&&t+this.getMetricTTL(e)>Date.now()}isMetricOnCoolDown(e){const t=this.getMetricName(e),s=this.getMetricsState().timestamps[t]??0;return this.scheduleCleanOutdatedMetrics(),this.checkMetricCooldown(t,s)}updateMetricTimestamp(e){const t=this.getMetricName(e),s=this.getMetricsState();s.timestamps[t]=Date.now(),a.vkLocalStorage.setItem(this.storageName,JSON.stringify(s)),this.scheduleCleanOutdatedMetrics()}cleanOutdatedMetrics(){const e=this.getMetricsState(),t={...e};Object.entries(e.timestamps).forEach((([e,s])=>{this.checkMetricCooldown(e,s)||delete t.timestamps[e]})),a.vkLocalStorage.setItem(this.storageName,JSON.stringify(t))}scheduleCleanOutdatedMetrics(){this.options.cleanOutdatedMetrics&&!this.isOutdatedMetricsCleanScheduled&&(this.isOutdatedMetricsCleanScheduled=!0,requestIdleCallback((()=>{this.isOutdatedMetricsCleanScheduled=!1,this.cleanOutdatedMetrics()}),{timeout:5e3}))}constructor(e,t,s,a={}){this.id=e,this.scope=t,this.cooldown=s,this.options=a,this.isOutdatedMetricsCleanScheduled=!1,this.storageName=`@METRICS_${e||"GUEST"}_${t}`}}},530888:(e,t,s)=>{"use strict";s.d(t,{STORY_TECH_STATS_STORAGE_NAME:()=>a,StoryErrorType:()=>d,StoryEventType:()=>_,StoryEventTypeDebugTypes:()=>l,StoryTypeNext:()=>r,StoryTypeOpen:()=>n});const a="story_tech_stats_storage";var n,r,d,_;!function(e){e.OPEN_STORY_BY_CLICK="OPEN_STORY_BY_CLICK",e.NEXT_OPEN_STORY="NEXT_OPEN_STORY",e.UNKNOWN="UNKNOWN"}(n||(n={})),function(e){e.NEXT_STORY="NEXT_STORY",e.PREV_STORY="PREV_STORY",e.RESET_STORY="RESET_STORY",e.NEXT_CONTAINER_STORY="NEXT_CONTAINER_STORY",e.PREV_CONTAINER_STORY="PREV_CONTAINER_STORY"}(r||(r={})),function(e){e.DOWNLOAD="download",e.UPLOAD="upload"}(d||(d={})),function(e){e.STORY_FEED_BLOCK_START_LOADING="story_feed_block_start_loading",e.STORY_FEED_BLOCK_CHUNK_LOADED="story_feed_block_chunk_loaded",e.STORY_FEED_BLOCK_DATA_LOADED="story_feed_block_data_loaded",e.STORY_FEED_BLOCK_DATA_LOADED_BEFORE_FEED_RENDERED="story_feed_block_data_loaded_before_feed_rendered",e.STORY_FEED_BLOCK_DATA_LOADED_AFTER_FEED_RENDERED="story_feed_block_data_loaded_after_feed_rendered",e.STORY_FEED_BLOCK_LOADING="story_feed_block_loading",e.FEED_RENDERED="feed_rendered",e.STORY_FEED_BLOCK_RENDERED="story_feed_block_rendered",e.STORY_FEED_BLOCK_RENDERED_WITHOUT_FEED="story_feed_block_rendered_without_feed",e.STORY_OPENING_START="story_opening_start",e.STORY_OPENED="story_opened",e.STORY_VIEWER_CLOSED="story_viewer_closed",e.STORY_CLOSED="story_closed",e.SHOW_VIEWER_LOADER="show_viewer_loader",e.HIDE_VIEWER_LOADER="hide_viewer_loader",e.DOWNLOAD="download",e.DOWNLOAD_START="download_start",e.UPLOAD_START="upload_start",e.UPLOAD="upload",e.VIDEO_STALL="video_stall",e.PLAYING_VIDEO_ERROR="playing_video_error"}(_||(_={}));const l=new Set(["story_feed_block_start_loading","story_opening_start","show_viewer_loader","download_start","upload_start","story_viewer_closed","story_closed"])},364038:(e,t,s)=>{"use strict";s.d(t,{AudioNetworkStatCollector:()=>n});var a=s(595649);class n{logEvent(e,t,s){const n={network_type:t,network_effective_type:s,type:a.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM,[a.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM]:e};this.networkStatCollector.logEvent(n)}constructor(e){this.networkStatCollector=e}}},39816:(e,t,s)=>{"use strict";s.d(t,{AudioNetworkStatCollector:()=>n.AudioNetworkStatCollector,AudioNetworkType:()=>r.AudioNetworkType,NetworkStatCollector:()=>a.NetworkStatCollector});var a=s(613946),n=s(364038),r=s(595649)},613946:(e,t,s)=>{"use strict";s.d(t,{NetworkStatCollector:()=>r});var a=s(298077),n=s(101272);class r{logEvent(e){e.type&&e[e.type]?(0,n.saveNetworkStats)(e):(0,a.logError)(new Error("NetworkStatCollector: invalid event."))}}new r},595649:(e,t,s)=>{"use strict";var a,n;s.d(t,{AudioNetworkType:()=>n,NetworkStatEventTypes:()=>a}),function(e){e.TYPE_NETWORK_AUDIO_ITEM="type_network_audio_item",e.TYPE_MODULE_NAVIGATION_STATS_ITEM="type_module_navigation_stats_item"}(a||(a={})),function(e){e.FRAGMENT_LOADED="fragment_loaded",e.FRAGMENT_STALLED="fragment_stalled"}(n||(n={}))},851727:(e,t,s)=>{"use strict";s.d(t,{TooltipStatCollector:()=>d});var a=s(317216),n=s(314309);const r="unknown";class d{logEvent(e,t,s){const n={action:e,hint_id:t,duration:s||0},r={...this.productionStatCollector.getBaseEvent(this.getScreen(this.getModule())),type:a.ActionProductionStatEventTypes.TYPE_UI_HINT_ITEM,[a.ActionProductionStatEventTypes.TYPE_UI_HINT_ITEM]:n};this.actionStatCollector.logEvent(r,{force:!0})}getModule(){return window.cur?.module??r}getScreen(e=r){return window.cur?.screen?window.cur.screen===r?e:window.cur.screen:e}constructor(){this.productionStatCollector=new n.ProductionStatCollector,this.actionStatCollector=new n.ActionStatCollector(this.productionStatCollector)}}},301374:(e,t,s)=>{"use strict";var a,n;s.d(t,{DonutActionEventType:()=>a}),function(e){e.PAYMENT_FORM="payment_form",e.PAYMENT_FORM_CLICK_OFFER="payment_form_click_offer",e.PAYMENT_FORM_CLICK_PAY="payment_form_click_pay",e.PAYMENT_FORM_CLICK_CLOSE="payment_form_click_close"}(a||(a={})),function(e){e.PAYMENT_START="payment_start",e.DATA_ACCESS="data_access",e.RESULT_PAYMENT_SUCCESS_OK="result_payment_success_ok",e.RESULT_PAYMENT_SUCCESS_WAITING="result_payment_success_waiting",e.RESULT_PAYMENT_SUCCESS_WAITING_TIMEOUT="result_payment_success_waiting_timeout",e.RESULT_RESUB_SUCCESS_WAITING_OK="result_resub_success_waiting_ok",e.RESULT_PAYMENT_UNAVAILABLE="result_payment_unavailable",e.RESULT_PAYMENT_CANCEL="result_payment_cancel",e.RESULT_ERROR="result_error",e.RESULT_CHANGE_ERROR="result_change_error",e.RESULT_CHANGE_SUCCESS_OK="result_change_success_ok",e.RESULT_CHANGE_SUCCESS_WAITING_TIMEOUT="result_change_success_waiting_timeout",e.UNKNOWN="donut_payment_screen_unknown"}(n||(n={}))},854950:(e,t,s)=>{"use strict";s.d(t,{getImageMinWidth:()=>a});const a=e=>Math.ceil(e*Math.max(window.devicePixelRatio,1))},131393:(e,t,s)=>{"use strict";s.d(t,{banUser:()=>p,deleteFromAuthor:()=>l,deleteQuestion:()=>d,getQuestion:()=>n,getQuestions:()=>r,getUsers:()=>c,reportQuestion:()=>y,restoreAuthorQuestions:()=>u,restoreQuestion:()=>_,unbanUser:()=>m});var a=s(957994);function n(e){return(0,a.api)("questions.getById",{owner_id:window.vk.id,question_id:e,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function r(e="",t=15){return(0,a.api)("questions.get",{owner_id:window.vk.id,start_from:e,limit:t,extended:1,fields:"photo_50,photo_100,first_name_gen,last_name_gen,domain"})}function d(e){return(0,a.api)("questions.delete",{owner_id:window.vk.id,question_id:e})}function _(e){return(0,a.api)("questions.restore",{owner_id:window.vk.id,question_id:e})}function l(e){return(0,a.api)("questions.deleteFromAuthor",{owner_id:window.vk.id,question_id:e})}function u(e){return(0,a.api)("questions.restoreFromAuthor",{owner_id:window.vk.id,question_id:e})}function c(e){return(0,a.api)("users.get",{user_ids:e.join(","),fields:"photo_50,photo_100,can_ask_anonymous,can_ask_question,first_name_nom,first_name_dat,first_name_gen,last_name_gen,sex"})}function p(e){return(0,a.api)("questions.authorBan",{owner_id:window.vk.id,question_id:e})}function m(e){return(0,a.api)("questions.authorUnBan",{owner_id:window.vk.id,question_id:e})}function y(e){return(0,a.api)("reports.add",{type:"profile_story_question",owner_id:window.vk.id,item_id:e})}},419222:(e,t,s)=>{"use strict";var a;s.d(t,{QuestionsBoxRef:()=>a}),function(e){e.SNIPPET="snippet",e.URL="url",e.STORY="story"}(a||(a={}))},353679:(e,t,s)=>{"use strict";s.d(t,{DEFAULT_CACHE:()=>l,ORDER_ERRORS:()=>c,ORDER_ITEM_ERRORS:()=>p,SAMPLE_RECIPIENT_ID:()=>u,STICKER_ANIMATION:()=>_,STICKER_IMAGE:()=>d,STICKER_PACK_ICON:()=>n,STICKER_PACK_THUMB:()=>r});var a=s(612831);const n={square_png:{id:"square.png",width:104,height:104},square_15x_png:{id:"square_1.5x.png",width:156,height:156},square_2x_png:{id:"square_2x.png",width:208,height:208},square_3x_png:{id:"square_3x.png",width:312,height:312},square_4x_png:{id:"square_4x.png",width:416,height:416}},r={"102_png":{id:"102.png",width:102,height:102,theme:a.Theme.LIGHT},"51_png":{id:"51.png",width:51,height:51,theme:a.Theme.LIGHT},"68_png":{id:"68.png",width:68,height:68,theme:a.Theme.LIGHT},"34_png":{id:"34.png",width:34,height:34,theme:a.Theme.LIGHT},"60_png":{id:"60.png",width:60,height:60,theme:a.Theme.LIGHT},"30_png":{id:"30.png",width:30,height:30,theme:a.Theme.LIGHT},"102b_png":{id:"102b.png",width:102,height:102,theme:a.Theme.DARK},"51b_png":{id:"51b.png",width:51,height:51,theme:a.Theme.DARK},"68b_png":{id:"68b.png",width:68,height:68,theme:a.Theme.DARK},"34b_png":{id:"34b.png",width:34,height:34,theme:a.Theme.DARK},"60b_png":{id:"60b.png",width:60,height:60,theme:a.Theme.DARK},"30b_png":{id:"30b.png",width:30,height:30,theme:a.Theme.DARK},"44_png":{id:"44.png",width:44,height:44},"22_png":{id:"22.png",width:22,height:22}},d={"64_png":{id:"64.png",width:64,height:64,theme:a.Theme.LIGHT},"128_png":{id:"128.png",width:128,height:128,theme:a.Theme.LIGHT},"256_png":{id:"256.png",width:256,height:256,theme:a.Theme.LIGHT},"352_png":{id:"352.png",width:352,height:352,theme:a.Theme.LIGHT},"512_png":{id:"512.png",width:512,height:512,theme:a.Theme.LIGHT},"64b_png":{id:"64b.png",width:64,height:64,theme:a.Theme.DARK},"128b_png":{id:"128b.png",width:128,height:128,theme:a.Theme.DARK},"256b_png":{id:"256b.png",width:256,height:256,theme:a.Theme.DARK},"352b_png":{id:"352b.png",width:352,height:352,theme:a.Theme.DARK},"512b_png":{id:"512b.png",width:512,height:512,theme:a.Theme.DARK}},_={[a.Theme.LIGHT]:"animation.json",[a.Theme.DARK]:"animation.b.json"},l={products:(0,a.createProductsMap)([]),productIdsQueue:new Set,productsPromise:void 0,productPromises:new Map,stickers:new Map},u=-1;var c,p;!function(e){e.NOT_SIGNED_IN="not_signed_in",e.NO_VALID_ITEMS="no_valid_items"}(c||(c={})),function(e){e.DUPLICATE_PRODUCT="duplicate_product"}(p||(p={}))},612831:(e,t,s)=>{"use strict";var a;s.d(t,{ProductsByType:()=>m,Theme:()=>a,UserProductStateKey:()=>_,createProductsMap:()=>d,imageSizeCache:()=>r,imageSizesIndex:()=>n,isBasePack:()=>l,isPackProduct:()=>c,isStyleProduct:()=>u}),function(e){e.LIGHT="light",e.DARK="dark",e.DEFAULT="light"}(a||(a={}));const n=Symbol(),r=Symbol(),d=e=>new Map(e);var _;!function(e){e.IsNew="is_new"}(_||(_={}));const l=e=>void 0!==e.sticker_ids,u=e=>void 0!==e.base_id,c=e=>l(e)&&!u(e);var p;!function(e){e.Pack="pack",e.Style="style"}(p||(p={}));class m{add(e){e&&(c(e)?this.pack.add(e):u(e)&&this.style.add(e))}getPack(){return this.pack.values().next().value}getStyles(){return Array.from(this.style.values())}getCount(){return this.pack.size+this.style.size}constructor(e=[]){this.pack=new Set,this.style=new Set,e.forEach((e=>this.add(e)))}}},847771:(e,t,s)=>{"use strict";s.d(t,{getStickerAnimationUrl:()=>c,getStickerImageUrl:()=>u,getStickerPackIconUrl:()=>p,isSampleOrderItem:()=>m,logStickersError:()=>y});var a=s(612831),n=s(353679),r=s(298077);const d=(e,t,s,n=a.Theme.DEFAULT)=>{const r=window.devicePixelRatio,d=[t*=r,s*=r,n].toString();let _=e[a.imageSizeCache];if(_&&_.has(d)){const e=_.get(d);if(e)return e}_||(_=new Map,e[a.imageSizeCache]=_);const l=(e=>{let t=e[a.imageSizesIndex];return t||(t=Object.values(e).sort(((e,t)=>e.width-t.width||e.height-t.height)),e[a.imageSizesIndex]=t),t})(e).filter((e=>!e.theme||e.theme===n)),u=l.find((e=>e.width>=t&&e.height>=s))||l[l.length-1];return _.set(d,u),u},_=(e,t,s=a.Theme.DEFAULT)=>d(n.STICKER_IMAGE,e,t,s),l=(e,t)=>e.image.base_url+"/"+t.id+(e.image.version?`?${e.image.version}`:"");function u(e,t,s,n=a.Theme.DEFAULT){if(e.render?.images){const{images:a}=e.render;let r;a.sort(((e,t)=>e.width-t.width||e.height-t.height));for(const e of a)if(e.width>=t&&e.height>=s){if(e.theme===n)return e.url;r=e}if(r)return r.url}return l(e,_(t,s,n))}const c=(e,t=a.Theme.DEFAULT)=>e.animation?e.animation.base_url+"/"+n.STICKER_ANIMATION[t]+(e.animation.version?`?${e.animation.version}`:""):"",p=(e,t,s,r=a.Theme.DEFAULT)=>((e,t)=>e.icon.base_url+"/"+t.id+(e.thumb.version?`?${e.thumb.version}`:""))(e,((e,t,s=a.Theme.DEFAULT)=>d(n.STICKER_PACK_ICON,e,t,s))(t,s,r)),m=e=>e.recipient_id===n.SAMPLE_RECIPIENT_ID,y=e=>{(0,r.logError)(new Error(`Stickers: ${e}`),{environment:"stickers"})}},224194:(e,t,s)=>{"use strict";s.d(t,{isPopUpStickersEnabled:()=>d,isPopUpStickersEnabledInVkCom:()=>r});var a=s(105330),n=s(540462);const r=()=>(0,n.partConfigEnabled)("stickers.popup.vkcom"),d=()=>(0,a.isMvk)()?(0,n.partConfigEnabled)("stickers.popup.mvk"):r()},807978:(e,t,s)=>{"use strict";s.d(t,{DAY:()=>_,SECOND:()=>n,getShortPrintableTimeSpan:()=>p});var a=s(866467);const n=1e3,r=60*n,d=60*r,_=24*d,l=7*_,u=30*_,c=12*u;function p(e){return e>=c?(0,a.langNumeric)(Math.floor(e/c),(0,a.getLang)("global_short_years_fixed")):e>=u?(0,a.langNumeric)(Math.floor(e/u),(0,a.getLang)("global_short_months")):e>=l?(0,a.langNumeric)(Math.floor(e/l),(0,a.getLang)("global_short_weeks")):e>=_?(0,a.langNumeric)(Math.floor(e/_),(0,a.getLang)("global_short_days")):e>=d?(0,a.langNumeric)(Math.floor(e/d),(0,a.getLang)("global_short_hours")):e>=r?(0,a.langNumeric)(Math.floor(e/r),(0,a.getLang)("global_short_minutes")):e>=n?(0,a.langNumeric)(Math.floor(e/n),(0,a.getLang)("global_short_seconds")):""}},153659:(e,t,s)=>{"use strict";s.d(t,{TooltipsStat:()=>r});var a=s(317216);const n=new(s(851727).TooltipStatCollector);class r{handleShow(){this.showTime=new Date,this.skipShow?n.logEvent(a.ETooltipEventTypes.TOOLTIP_COULD_BE_SHOWN,this.tooltipId,0):n.logEvent(a.ETooltipEventTypes.TOOLTIP_SHOW,this.tooltipId,0)}handleHide(e=a.ETooltipEventTypes.TOOLTIP_HIDE_BY_INTERFACE_INTERACTION){let t=0;this.showTime&&(t=(new Date).getTime()-this.showTime.getTime()),n.logEvent(e,this.tooltipId,t)}static registryShow(e,t=!1){r.tootips[e]=new r(e,t),r.tootips[e].handleShow()}static registryHide(e,t=a.ETooltipEventTypes.TOOLTIP_HIDE_BY_INTERFACE_INTERACTION){(r.tootips[e]||new r(e,!1)).handleHide(t)}constructor(e,t){this.tooltipId=e,this.skipShow=t}}r.tootips={}},222062:(e,t,s)=>{"use strict";s.d(t,{checkOwnerIsNFT:()=>a});const a=e=>{if(e){if("is_nft"in e)return Boolean(e.is_nft);if("is_nft_photo"in e)return Boolean(e.is_nft_photo)}return!1}},339328:(e,t,s)=>{"use strict";s.d(t,{createSentryLogger:()=>d,isApiNetworkError:()=>r});var a=s(626287),n=s(298077);function r(e){return!(!e||"object"!=typeof e)&&e.type===a.APIErrorType.NETWORK_ERROR}const d=({debugPrefix:e="[Sentry Logger]",isConsoleEnabled:t=!1,environment:s,catchNetworkError:a})=>{function d(t,s){return`${e} `+(s?`${s}: ${t}`:t)}return function(_){const{error:l,additionalText:u,extra:c,environment:p}=_,m=p||s;if(t&&console.error(e,{error:l,additionalText:u||"Some error happened",extra:c,environment:m}),a&&r(l)&&a(_))return;const y=c?{environment:p,breadcrumb:{data:{extra:c}}}:{environment:m};if(l instanceof Error){const e=new Error(d(l.message,u));return e.name=l.name,e.stack=l.stack,void(0,n.logError)(e,y)}if("string"!=typeof l)return l instanceof Object?(y.breadcrumb?.data?y.breadcrumb.data.object=l:y.breadcrumb={...y.breadcrumb,data:{object:l}},void(0,n.logError)(new Error(d("Error as object",u)),y)):void(l||!u?(0,n.logError)(new Error(d("Unknown error")),y):(0,n.logError)(new Error(d(u)),y));(0,n.logError)(new Error(d(l,u)),y)}}},641495:(e,t,s)=>{"use strict";s.d(t,{getOwnerName:()=>a});const a=(e,t=!0,s)=>{let a="";return e&&("name"in e?a=e.name||"":!t&&"first_name"in e?a=s?e[`first_name_${s}`]||"":e.first_name||"":("first_name"in e||"last_name"in e)&&(a=s?`${e[`first_name_${s}`]} ${e[`last_name_${s}`]}`:`${e.first_name} ${e.last_name}`)),a}},172479:(e,t,s)=>{"use strict";s.d(t,{getOwnerUrl:()=>a});const a=(e,t="/",s="")=>e?"domain"in e&&"id"in e?`/artist/${e.domain||e.id||""}${s}`:"screen_name"in e&&e.screen_name?`${t}${e.screen_name}${s}`:"first_name"in e?`${t}id${e.id}${s}`:`${t}club${e.id}${s}`:""},841315:(e,t,s)=>{"use strict";s.d(t,{getVideoCopyLink:()=>c,getVideoUrl:()=>u});var a=s(538522),n=s(105330),r=s(826981),d=s(540462),_=s(671112),l=s(800361);const u=e=>{const{owner_id:t,id:s}=e;if(void 0===t)return(0,_.getVideoPrefix)("slash");if(void 0===s)return`${(0,_.getVideoPrefix)("doubleSlash")}@id${t}`;const n="short_video"===e.type?"clip":"video",r=(0,a.joinRawId)({ownerId:t,itemId:s}),u=e.access_key?`?list=${e.access_key}`:"";if(!(0,d.partConfigEnabled)("video_new_video_page")||!(0,d.partConfigEnabled)("video_linked_playlists_feature"))return"/"+n+r+u;const c=(0,l.isVideoStandalone)(),p=e.linked_to_playlist_marks&&e.linked_to_playlist_marks.at(0)?.playlist_id;if(c&&p&&"short_video"!==e.type)return`/playlist/${p}/${n+r}`;return"/"+n+r+u+(p?`${u?"&":"?"}pl=${p}`:"")},c=(e,t,s,a)=>{const _=new URL(u(e),"https://"+(0,n.getHostName)());return t&&_.searchParams.set("t",(0,r.toString)(t)),e.access_key?.startsWith("ln-")?_.searchParams.set("list",e.access_key):_.searchParams.delete("list"),s&&(0,d.partConfigEnabled)("video_player_ref_domain_embed")&&_.searchParams.set("ref_domain",a||window.cur?.mvOpts?.ref_domain||""),_.toString()}},945270:(e,t,s)=>{"use strict";s.d(t,{emailLinksReplacerReact:()=>r,replaceEmailLinks:()=>n});var a=s(470403);function n(e,t){return e.replace(a.EMAIL,t||function(e){return`<a href="mailto:${e}">${e}</a>`})}function r(e){return(t,s)=>e({key:t,url:s})}},148636:(e,t,s)=>{"use strict";s.d(t,{linksReplacer:()=>g,linksReplacerReact:()=>y,replaceHyperLinks:()=>p});var a=s(898848),n=s(105330),r=s(828758),d=s(175819),_=s(34231);function l(e){if(!e[0]||!e[6])return e;const t=e[0].length-1,s=e[6].length-1;return"."===e[0][t]&&"."===e[6][s]&&(e[0]=e[0].slice(0,t),e[6]=e[6].slice(0,s)),e}function u(e){return{full:e[0],protocol:e[1]||"http://",url:e[2],domain:e[4],query:e[6]||""}}function c(e){return e.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function p(e,t){const s=new RegExp(r.RE_URL_PATTERN,"ig"),a=d.TOP_DOMAINS.reduce(((e,t)=>Math.max(e,t.length)),0);let n,_=0,c=e;for(;null!==(n=s.exec(e));){n=l(n);const s=n[0].length,r=n.index+s,p=e[n.index-1],m=e[r-1];if("@"===e[r]&&(!n[0]||n[0]&&!n[0].toLowerCase().includes("http")))continue;const y=void 0!==p&&/([\w\$А-Яа-яёЁєЄҐґЇїІіЈј—\-\_@;.])/i.test(p),g=void 0!==m&&/([:;$])/i.test(m);if(!y&&!g){const e=u(n),l=e.domain.toLowerCase();if(l.length<=a&&d.TOP_DOMAINS.includes(l)){const a=t(e);c=c.slice(0,n.index+_)+a+c.slice(r+_),_+=a.length-s}}}return c}function m(e,t){try{e=decodeURIComponent(e)}catch(e){}return e.length>t&&(e=e.substr(0,t-2)+".."),e=c(e).replace(/\n/g," ")}function y(e){return(t,s,r=55)=>{const{url:l,protocol:u,query:p,full:y}=s,g=m(y,r),f=(0,a.replaceEntities)(l+p);if(d.OUR_DOMAINS.test(l)){const s=c(u+l+p),a=y.match(d.VK_DOMAIN);return e({key:t,href:s,mentionId:a?a[1]:"",text:g})}{const s=window.nav?.strLoc?.startsWith("video"),r=((0,n.isPWA)()||s?`https://${(0,n.getHostName)()}`:"")+(0,_.wrapAway)(u+f,!0),d=(0,a.clean)(u+l+p);return e({key:t,href:r,goAwayUrl:d,text:g})}}}function g(e,t=55){let{full:s}=e;const{url:r,protocol:_,query:l}=e;s=m(s,t);const u=(0,a.replaceEntities)(r+l);if(d.OUR_DOMAINS.test(r)){let e="";const t=s.match(d.VK_DOMAIN);if(t){const s=t[1];e=(0,n.isMvk)()?"":` mention_id="${s}" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"`}return`<a href="${c(_+r+l)}" target="_blank" rel="noopener"${e}>${s}</a>`}const p=window.nav?.strLoc?.startsWith("video"),y=`${(0,n.isPWA)()||p?`https://${(0,n.getHostName)()}/`:"/"}away.php?utf=1&to=${encodeURIComponent(_+u)}`,g=(0,a.clean)((_+r+l).replace(/'/g,"\\'"));return`<a href="${y}" target="_blank" rel="noopener" ${(0,n.isMvk)()?"":`onclick="return goAway('${g}', {}, event);"`}>${s}</a>`}},839348:(e,t,s)=>{"use strict";s.d(t,{mentionReplaceReact:()=>_,replaceMentions:()=>d});var a=s(846145),n=s(898848),r=s(105330);function d(e,t){return e.replace(a.MENTION,t||function(e,t,s,a,d){const _=(0,r.isMvk)()?"":` mention_id="${(0,n.clean)(t+s)}" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"`;return`<a href="/${t+s}" class="mem_link" mention="${(0,n.clean)(a||"")}"${_}>${d}</a>`})}function _(e){return(t,s,a,n,r,d)=>e({key:t,mentionId:a+n,mention:r,href:`/${a+n}`,text:d})}},638112:(e,t,s)=>{"use strict";s.d(t,{onVKVideoLogout:()=>n});async function a(e,t="al_video.php",s){const a=new URLSearchParams(e),n=await fetch(`${t}?${a}`,{method:"POST",...s});return await n.json()}const n=async(e,t,s,n,r={})=>{try{const{logout_hash:d}=await a({act:"get_hashes",app_id:t},s,r);if(!d)throw new Error("[VK AUTH]: get_hashes failed");const{success:_}=await a({act:"delete_session",hash:d},s,r);if(!_)throw new Error("[VK AUTH]: delete_session failed");n(e)}catch(e){throw new Error("[VK AUTH]: logout failed")}}},745005:(e,t,s)=>{"use strict";s.d(t,{MenuHelpHintTextTooltip:()=>d});var a=s(474848),n=s(296540),r=s(578392);const d=e=>{const[t,s]=(0,n.useState)(!1);return(0,n.useLayoutEffect)((()=>{const e=setTimeout((()=>s(!0)));return()=>{clearTimeout(e)}}),[]),(0,a.jsx)(r.TextTooltip,{shown:t,...e})}},926326:(e,t,s)=>{"use strict";s.d(t,{MenuHelpHintTooltip:()=>_});var a=s(474848),n=s(296540),r=s(753457),d=s(984745);const _=e=>{const{helpHint:t,onClose:s,..._}=e,[l,u]=(0,n.useState)(!1),c=(0,n.useCallback)((()=>{(0,d.ensureAccountHelpHintsService)().hideHelpHint({hintId:t.id,isOptimistic:!0}),s?.()}),[s]);return(0,n.useLayoutEffect)((()=>{const e=setTimeout((()=>u(!0)));return()=>{clearTimeout(e)}}),[]),(0,a.jsx)(r.OnboardingTooltip,{shown:l,header:t.title,text:t.description,onClose:c,..._})}},664634:(e,t,s)=>{"use strict";s.d(t,{MenuHelpHintTextTooltip:()=>n.MenuHelpHintTextTooltip,MenuHelpHintTooltip:()=>a.MenuHelpHintTooltip});var a=s(926326),n=s(745005)},506596:(e,t,s)=>{"use strict";s.d(t,{getAdditionalInfo:()=>l});var a=s(8520),n=s(856289),r=s(584683),d=s(866467),_=s(807978);const l=e=>{const{partner_text:t,date:s,type:l,release_date:u,genres:c,views:p=1}=e;if("music_video"===l&&c?.length&&u)return`${new Date(u*_.SECOND).getFullYear()} · ${c[0].name}`;if(t)return(0,a.decodeHTMLEntities)(t);const m=e=>(0,a.decodeHTMLEntities)((0,r.getFormattedViews)(e));return s?s>Date.now()/_.SECOND?(0,d.getLang)("video_postponed_publication"):(0,n.isLiveVideo)(e)?m(p):`${m(p)} · ${(0,a.decodeHTMLEntities)((0,n.getFormattedUpdatedTime)(s,!0))}`:m(p)}},817339:(e,t,s)=>{"use strict";s.d(t,{getFormattedPostponePublishDateTime:()=>l,getFormattedUpdatedTime:()=>d,getFormattedUpdatedTimeWithPrefix:()=>_});var a=s(898848),n=s(866467);const r=(e,[t,s],r)=>{return r?(0,n.langNumeric)((0,a.intval)(e),s):(d=(0,a.intval)(e),_=t,l=s,(0,a.isArray)(_)&&d<_.length?_[d]:(0,n.langNumeric)(d,l));var d,_,l},d=(e,t)=>{const s=Date.now()/1e3-e;if(s<5)return((e,t)=>t?(0,n.langNumeric)((0,a.intval)(e),(0,n.getLang)("video_added_less_than_a_minute_ago")):(0,n.getLang)("video_added_now","raw")[0])(s,t);if(s<60)return((e,t)=>t?(0,n.langNumeric)((0,a.intval)(e),(0,n.getLang)("video_added_less_than_a_minute_ago","raw")):(0,n.getLang)("video_added_less_than_a_minute_ago"))(s,t);if(s<3600){const e=[(0,n.getLang)("video_word_mins_ago","raw"),(0,n.getLang)("video_mins_ago","raw")];return r(s/60,e,t)}if(s<86400){const e=[(0,n.getLang)("video_word_hours_ago","raw"),(0,n.getLang)("video_hours_ago","raw")];return r(s/3600,e,t)}if(s<2592e3){const e=[(0,n.getLang)("video_word_days_ago","raw"),(0,n.getLang)("video_days_ago","raw")];return r(s/86400,e,t)}if(s<31536e3){const e=[(0,n.getLang)("video_word_months_ago","raw"),(0,n.getLang)("video_months_ago","raw")];return r(s/2592e3,e,t)}const d=[(0,n.getLang)("video_word_years_ago","raw"),(0,n.getLang)("video_years_ago","raw")];return r(s/31363200,d,t)},_=e=>(0,n.langStr)((0,n.getLang)("video_album_updated_time"),"updated_time_ago",d(e,!0)),l=e=>{const t=1e3*e,s=new Date,a=new Date(t);return(0,n.langDate)(t,s.getFullYear()===a.getFullYear()?(0,n.getLang)("video_postponed_publication_date","raw"):(0,n.getLang)("video_postponed_publication_full_date","raw"),0,(0,n.getLang)("months_sm_of"))}},584683:(e,t,s)=>{"use strict";s.d(t,{getFormattedViews:()=>r});var a=s(866467),n=s(856289);function r(e){return e>999?(0,n.getFormattedBigViewsToShortCase)(e):(0,a.getLang)("video_N_views_list",e||1,!0)}},839962:(e,t,s)=>{"use strict";s.d(t,{useOwner:()=>a.useOwner,useVideoInPlaylist:()=>n.useVideoInPlaylist});var a=s(796050),n=s(231867)},796050:(e,t,s)=>{"use strict";s.d(t,{useOwner:()=>r});var a=s(335797),n=s(468073);const r=(e,t,s)=>{const r=(0,a.useEntitiesStore)(t.$entitiesGroups,n.Ranges.convertOwnerIdToGroupId(e.owner_id)),d=(0,a.useEntitiesStore)(s.$entitiesUsers,e.owner_id);return n.Ranges.isGroupId(e.owner_id)&&r?r:n.Ranges.isUserId(e.owner_id)&&d?d:void 0}},231867:(e,t,s)=>{"use strict";s.d(t,{useVideoInPlaylist:()=>n});var a=s(293721);const n=(e,t,s)=>(0,a.useStoreMap)(e,(e=>!(!e||!e[t])&&Boolean(e[t][s])))},856289:(e,t,s)=>{"use strict";s.d(t,{BASE_LOCATION:()=>n.BASE_LOCATION,BOOKMARKS_URL:()=>T.BOOKMARKS_URL,MY_VIDEO_ALBUM_ID:()=>n.MY_VIDEO_ALBUM_ID,MenuHelpHintTextTooltip:()=>a.MenuHelpHintTextTooltip,MenuHelpHintTooltip:()=>a.MenuHelpHintTooltip,PLAYLIST_PAGE_BASE_PATH:()=>n.PLAYLIST_PAGE_BASE_PATH,PLAYLIST_PAGE_REGEXP:()=>n.PLAYLIST_PAGE_REGEXP,PLAYLIST_POPOVER_VERTICAL_OFFSET:()=>n.PLAYLIST_POPOVER_VERTICAL_OFFSET,PLAYLIST_POPOVER_WIDTH:()=>n.PLAYLIST_POPOVER_WIDTH,SECTION_MY_BOOKMARKS:()=>n.SECTION_MY_BOOKMARKS,SECTION_MY_LIKED:()=>n.SECTION_MY_LIKED,SNACKBAR_TIMEOUT:()=>n.SNACKBAR_TIMEOUT,UPLOADED_ALBUM_ID:()=>n.UPLOADED_ALBUM_ID,VIDEO_CLIP_IDENTITY_RAW_ID_REGEXP:()=>n.VIDEO_CLIP_IDENTITY_RAW_ID_REGEXP,VIDEO_COMMUNITY_COMMENTS_PATH:()=>n.VIDEO_COMMUNITY_COMMENTS_PATH,VIDEO_PAGE_PATHNAME_REGEXP:()=>n.VIDEO_PAGE_PATHNAME_REGEXP,canAddVideoToCommunityPlaylist:()=>T.canAddVideoToCommunityPlaylist,canCreateClipFromVideo:()=>T.canCreateClipFromVideo,createVideoBindingsService:()=>b.createVideoBindingsService,formatTextWithLinks:()=>T.formatTextWithLinks,get:()=>P.get,getAdditionalInfo:()=>r.getAdditionalInfo,getAllPlaylistURL:()=>T.getAllPlaylistURL,getFormattedBigLikesToShortCase:()=>C.getFormattedBigLikesToShortCase,getFormattedBigSubscribersToShortCase:()=>C.getFormattedBigSubscribersToShortCase,getFormattedBigViewsToShortCase:()=>C.getFormattedBigViewsToShortCase,getFormattedFullVideoViews:()=>C.getFormattedFullVideoViews,getFormattedPostponePublishDateTime:()=>d.getFormattedPostponePublishDateTime,getFormattedUpdatedTime:()=>d.getFormattedUpdatedTime,getFormattedUpdatedTimeWithPrefix:()=>d.getFormattedUpdatedTimeWithPrefix,getFormattedVideoDate:()=>C.getFormattedVideoDate,getFormattedViews:()=>_.getFormattedViews,getLiveStartURL:()=>T.getLiveStartURL,getMyVideosPage:()=>T.getMyVideosPage,getOwnerVideosPageBasePath:()=>T.getOwnerVideosPageBasePath,getOwnerVideosPageURL:()=>T.getOwnerVideosPageURL,getPlaylistURL:()=>T.getPlaylistURL,getThumbSrc:()=>T.getThumbSrc,getVideoPrefix:()=>T.getVideoPrefix,getWatchLaterPath:()=>T.getWatchLaterPath,isFakeVideoStandalone:()=>u.isFakeVideoStandalone,isLiveVideo:()=>T.isLiveVideo,isPrivacyLocked:()=>A.isPrivacyLocked,isStandaloneOrVideoPage:()=>p.isStandaloneOrVideoPage,isVideoPageOpen:()=>p.isVideoPageOpen,isVideoSection:()=>m.isVideoSection,isVideoStandalone:()=>c.isVideoStandalone,isVideoStandaloneOrSection:()=>m.isVideoStandaloneOrSection,mapArtistToVideoCardOwner:()=>y.mapArtistToVideoCardOwner,mapPlaylistToPlaylistCardItem:()=>g.mapPlaylistToPlaylistCardItem,mapRestrictions:()=>A.mapRestrictions,mapUserOrGroupToPlaylistCardOwner:()=>f.mapUserOrGroupToPlaylistCardOwner,mapUserOrGroupToVideoCardOwner:()=>E.mapUserOrGroupToVideoCardOwner,mapVideoToSimpleVideoCardItem:()=>A.mapVideoToSimpleVideoCardItem,mapVideoToVideoCardItem:()=>A.mapVideoToVideoCardItem,trackOneStatError:()=>I.trackOneStatError,useOwner:()=>l.useOwner,useVideoInPlaylist:()=>l.useVideoInPlaylist});var a=s(664634),n=s(666384),r=s(506596),d=s(817339),_=s(584683),l=s(839962),u=s(902642),c=s(800361),p=s(11387),m=s(536669),y=s(483673),g=s(707447),f=s(741444),E=s(361877),A=s(857551),P=s(191977),b=s(497206),I=s(859738),T=s(671112),C=s(891297)},922939:(e,t,s)=>{"use strict";s.d(t,{isPrivacyLocked:()=>a});const a=e=>!!e&&Boolean((e=>e.category&&!["all","any"].includes(e.category))(e)||e.excluded_category?.length||e.lists?.allowed?.length||e.lists?.excluded?.length||e.owners?.allowed?.length||e.owners?.excluded?.length)},11387:(e,t,s)=>{"use strict";s.d(t,{isStandaloneOrVideoPage:()=>l,isVideoPageOpen:()=>_});var a=s(666384),n=s(540462),r=s(856289),d=s(437266);const _=()=>!!(0,n.partConfigEnabled)("video_new_video_page")&&(a.VIDEO_PAGE_STARTS_WITH_PATH_REGEXP.test(window.nav.strLoc)||d.PLAYLIST_URL_REGEXP.test(window.nav.strLoc)),l=()=>(0,r.isVideoStandalone)()||_()&&(0,n.partConfigEnabled)("vkvideo_redirect_to_standalone")},557454:(e,t,s)=>{"use strict";s.d(t,{isUpcomingLiveVideo:()=>a});const a=({liveStatus:e,type:t})=>"live"===t&&"upcoming"===e},971517:(e,t,s)=>{"use strict";s.d(t,{isVideoExternal:()=>a});const a=e=>Boolean(e&&e.player&&(e.files?.external||"YouTube"===e.platform))},536669:(e,t,s)=>{"use strict";s.d(t,{isVideoSection:()=>r,isVideoStandaloneOrSection:()=>d});var a=s(800361),n=s(666384);const r=()=>window.nav.strLoc.startsWith(n.BASE_PATHNAME),d=()=>(0,a.isVideoStandalone)()||r()},483673:(e,t,s)=>{"use strict";s.d(t,{mapArtistToVideoCardOwner:()=>u,mapVideoToFeaturedArtists:()=>c});var a=s(641495),n=s(172479),r=s(8520);const d=[50,100,200],_=({photo:e})=>e?d.reduce(((t,s)=>(t[`photo_${s}`]=(0,r.getPhotoSize)(e,s)?.url,t)),{}):{},l=e=>({name:(0,a.getOwnerName)(e),href:(0,n.getOwnerUrl)(e)}),u=e=>{if("music_video"!==e.type||!e.main_artists)return null;const[t]=e.main_artists;return t?{name:(0,a.getOwnerName)(t),href:(0,n.getOwnerUrl)(t),..._(t)}:null},c=e=>e?.featured_artists?e.featured_artists.map(l):void 0},707447:(e,t,s)=>{"use strict";s.d(t,{mapPlaylistToPlaylistCardItem:()=>d});var a=s(671112),n=s(922939),r=s(817339);const d=e=>({id:e.id,href:(0,a.getPlaylistURL)(e.owner_id,e.id),title:e.title,count:e.count,thumbSrc:(0,a.getThumbSrc)(e),isPrivacyLocked:(0,n.isPrivacyLocked)(e.privacy),isThumbBlurred:Boolean(e.image_blur),additionalInfo:(0,r.getFormattedUpdatedTimeWithPrefix)(e.updated_time)})},741444:(e,t,s)=>{"use strict";s.d(t,{mapUserOrGroupToPlaylistCardOwner:()=>d});var a=s(33305),n=s(641495),r=s(172479);const d=(e,t)=>({name:(0,n.getOwnerName)(e),href:(0,r.getOwnerUrl)(e,t),is_nft:(0,a.isOwnerUser)(e)?e.is_nft:e.is_nft_photo,verified:Boolean(e.verified),has_unseen_stories:e.has_unseen_stories,photo_50:e.photo_50,photo_100:e.photo_100,photo_200:e.photo_200})},361877:(e,t,s)=>{"use strict";s.d(t,{mapUserOrGroupToVideoCardOwner:()=>d});var a=s(222062),n=s(641495),r=s(172479);const d=(e,t)=>e?{...e,name:(0,n.getOwnerName)(e),href:(0,r.getOwnerUrl)(e,t),verified:1===e.verified,is_nft:(0,a.checkOwnerIsNFT)(e)}:{name:"",href:""}},857551:(e,t,s)=>{"use strict";s.d(t,{isPrivacyLocked:()=>y,mapRestrictions:()=>f,mapVideoToSimpleVideoCardItem:()=>I,mapVideoToVideoCardItem:()=>b});var a=s(8520),n=s(866467),r=s(807978),d=s(841315),_=s(557454),l=s(483673),u=s(671112),c=s(506596),p=s(584683),m=s(817339);const y=e=>!!e&&((e=>"members"===e.category?"to_subscribers":"by_link"===e.category?"by_link":Boolean(e.category&&!["all","any"].includes(e.category)))(e)||Boolean(e.excluded_category?.length||e.lists?.allowed?.length||e.lists?.excluded?.length||e.owners?.allowed?.length||e.owners?.excluded?.length)),g=e=>{if(!e)return;return{delete_outline:"delete",hide_outline:"hide",recent_outline:"recent",info_outline:"info",lock_outline:"lock",picture_outline:"picture",live_clock_badge_outline:"liveClockBadge",do_not_disturb_outline:"doNotDisturb",users3_outline:"users3",cancle_circle_outline:"cancleCircle"}[e]},f=e=>{const t=e&&(e=>e&&(e.icon_name?.length||e.mute_info_link?.length)?1===e.blur?"blurred":e.mute_info_link&&e.mute_info_link.length>0?"muted":"hidden":null)(e);return t?{title:e.title,mode:t,iconType:g(e.icon_name)}:null},E=e=>{const t=e.title||"",s=e.subtitle||"";return"music_video"===e.type?`${t} ${s}`:t},A=e=>{const t=e.published_at;if(!t)return;const s=t*r.SECOND;return Date.now()>s?void 0:(0,n.langDate)(s,(0,n.getLang)("global_short_date_time","raw"),0,(0,n.getLang)("months_sm_of","raw"))};function P(e){const t={isUpcoming:(0,_.isUpcomingLiveVideo)({type:e.type,liveStatus:e.live_status}),isInteractive:Boolean(e.interactive_info),badgeText:e.platform};return t.isUpcoming?t.badgeText=(0,n.getLang)("global_video_soon"):t.isInteractive&&(t.badgeText=(0,n.getLang)("video_interactive_label")),t}const b=e=>{const{isUpcoming:t,isInteractive:s,badgeText:a}=P(e);return{additionalInfo:(0,c.getAdditionalInfo)(e),description:e.description,duration:e.duration,href:(0,d.getVideoUrl)(e),isLive:(0,u.isLiveVideo)(e),isPrivacyLocked:y(e.privacy_view),isProcessing:Boolean(e.processing),ownersRelationText:e.featured_artists?(0,n.getLang)("video_feature_relation_text"):void 0,badgeText:a,publishDate:A(e),restriction:f(e.restriction),secondaryOwners:(0,l.mapVideoToFeaturedArtists)(e),thumbSrc:(0,u.getThumbSrc)(e),title:E(e),trailerSrc:e.trailer?.mp4_360,isUpcoming:t,viewedDuration:e.viewed_duration,isInteractive:s}},I=(e,t)=>{const{isUpcoming:s,isInteractive:n,badgeText:r}=P(e);return{title:E(e),isPrivacyLocked:y(e.privacy_view),isLive:(0,u.isLiveVideo)(e),duration:e.duration,viewedDuration:e.viewed_duration,badgeText:r,isUpcoming:s,isInteractive:n,thumbSrc:(0,u.getThumbSrc)(e),restriction:f(e.restriction),href:(0,d.getVideoUrl)(e),views:void 0!==e.views?(0,p.getFormattedViews)(e.views):void 0,date:t||void 0===e.date?void 0:(0,a.decodeHTMLEntities)((0,m.getFormattedUpdatedTime)(e.date,!0))}}},191977:(e,t,s)=>{"use strict";s.d(t,{get:()=>l});var a=s(957994),n=s(805658),r=s(553608);const d="videoplayer_auth_token",_=async({refresh:e=!1,prefetch:t=!1}={})=>{const s=t?n.apiWithPrefetch:a.api,{token:_}=await s("video.getStatsToken",{env:window.__dev?"development":"production",force_refresh:e?1:0});var l;return l=_,r.bestAvailableStorage.setItem(d,l),_},l=async(e={})=>e.refresh?await _(e):r.bestAvailableStorage.getItem(d)??await _(e)},940540:(e,t,s)=>{"use strict";s.d(t,{createVideoBindingsService:()=>r});var a=s(32489),n=s(679005);const r=e=>{const t=e.createEvent(),s=e.createEvent(),r=e.createEvent(),d=e.createStore({});return(0,a.sample)({clock:t,source:d,fn:(e,{album_ids:t,video_id:s})=>(0,n.produce)(e,(e=>{t.forEach((t=>{e[s]||(e[s]={}),e[s][t]=!0}))})),target:d}),(0,a.sample)({clock:s,source:d,fn:(e,{album_id:t,video_id:s})=>{const a=!e[s]||!e[s][t];return(0,n.produce)(e,(e=>{e[s]||(e[s]={}),e[s][t]=a}))},target:d}),(0,a.sample)({clock:r,fn:()=>({}),target:d}),{$entitiesVideoBinding:d,addBindingsEvent:t,toggleBindingEvent:s,resetBindingsEvent:r}}},497206:(e,t,s)=>{"use strict";s.d(t,{createVideoBindingsService:()=>a.createVideoBindingsService});var a=s(940540)},859738:(e,t,s)=>{"use strict";s.d(t,{trackOneStatError:()=>r});var a=s(540462),n=s(636576);const r=(0,a.partConfigEnabled)("video_player_track_onestat_errors")?e=>{const t=e instanceof Error?e.name:String(e);(0,n.statlogsValueEvent)("video_player_insignificant_network_error","onestat",t)}:()=>{}},671112:(e,t,s)=>{"use strict";s.d(t,{BOOKMARKS_URL:()=>O,canAddVideoToCommunityPlaylist:()=>L,canCreateClipFromVideo:()=>x,formatTextWithLinks:()=>k,getAllPlaylistURL:()=>P,getArtistPhotos:()=>M,getLiveStartURL:()=>T,getMyVideosPage:()=>C,getOwnerVideosPageBasePath:()=>E,getOwnerVideosPageURL:()=>B,getPlaylistCreateURL:()=>I,getPlaylistURL:()=>b,getThumbSrc:()=>R,getVideoPrefix:()=>f,getWatchLaterPath:()=>A,isLiveVideo:()=>S});var a=s(898848),n=s(148636),r=s(839348),d=s(945270),_=s(971517),l=s(8520),u=s(854950),c=s(595059),p=s(666384),m=s(873900),y=s(33305),g=s(800361);const f=e=>{switch(e){case"at":return(0,g.isVideoStandalone)()?"@":"video/@";case"slash":return(0,g.isVideoStandalone)()?"/":"/video";case"doubleSlash":return(0,g.isVideoStandalone)()?"/":"/video/";case"backSlash":return(0,g.isVideoStandalone)()?"":"video/";case"prevSlash":return(0,g.isVideoStandalone)()?"":"/video";case"withoutSlash":return(0,g.isVideoStandalone)()?"":"video";default:return""}},E=()=>`${f("doubleSlash")}@`,A=()=>`${f("doubleSlash")}bookmarks`,P=e=>`${E()}${e}/playlists`,b=(e,t)=>{const s=(0,m.getIdentityRawId)({ownerId:e||0,id:t||0});return`${f("prevSlash")}/playlist/${s}`},I=()=>`${f("backSlash")}playlist/create`,T=()=>`${f("backSlash")}live/start`,C=()=>window.vk.id&&window.cur?.my_added_videos_path?.slice(1,-6)||f("backSlash"),O=`${f("doubleSlash")}bookmarks`,M=e=>{const t=[50,100,200],s={};return e.photo?e.photo.reduce(((e,s)=>(t.includes(s.width)&&(e[`photo_${s.width}`]=s.url),e)),s):s},S=({live_status:e})=>Boolean(e&&!["postlive","finished"].includes(e)),D=(e,t,s,a,n)=>n,k=(e,t=!1)=>{let s=(0,a.clean)(e);return s=(0,n.replaceHyperLinks)(s,n.linksReplacer),s=(0,r.replaceMentions)(s,t?D:void 0),s=(0,d.replaceEmailLinks)(s),s},L=e=>"short_video"!==e.type&&(!e.restriction||((0,_.isVideoExternal)(e)?1===e.restriction.can_play:1===e.restriction.can_preview)),R=e=>{const t=(e instanceof c.Video?e.data:e).image||[],s=t.filter((e=>!e.with_padding)),a=s.length?s:t;return(0,l.getPhotoSize)(a,(0,u.getImageMinWidth)(240))?.url},B=e=>{const t=E();if(!e)return t;if((0,y.isOwnerGroup)(e))return`${t}${e.screen_name}`;return`${t}${e.screen_name||e.domain||`id${e.id}`}`},x=(e,t)=>{const{duration:s,type:a,platform:n}=e,r=void 0===t?!!n:t;return s&&s>=p.VIDEO_MIN_DURATION_IN_SECONDS_FOR_VIDEO_TO_CLIP&&!r&&a&&!["live","interactive","short_video"].includes(a)}},891297:(e,t,s)=>{"use strict";s.d(t,{getFormattedBigLikesToShortCase:()=>p,getFormattedBigSubscribersToShortCase:()=>c,getFormattedBigViewsToShortCase:()=>u,getFormattedFullVideoViews:()=>y,getFormattedVideoDate:()=>m});var a=s(866467),n=s(898848),r=s(807978);const d=({count:e,localeOptions:t})=>{const{getMinNumbersLocale:s,getThousandLocale:a,getMillionLocale:r}=t,d=window.langConfig?.locale||"ru";if(e<1e3)return s?s(e):e.toString();let _=1e3,l=a();e>999999&&(_=1e6,l=r());const[u="",c=""]=(e/_).toString().split("."),p=e>=1e5&&e<1e6||0===c.length?0:(0,n.intval)(c.substring(0,1)),m=(0,n.intval)(p)>0?`${u}.${p}`:u;return`${Number(m).toLocaleString(d)}${l}`},_={getMinNumbersLocale:e=>(0,a.getLang)("video_N_views_list",e),getThousandLocale:()=>(0,a.getLang)("video_N_views_thousand"),getMillionLocale:()=>(0,a.getLang)("video_N_views_million")},l={getMinNumbersLocale:e=>(0,a.getLang)("video_N_group_members_count",e),getThousandLocale:()=>(0,a.getLang)("video_N_subscribers_thousand"),getMillionLocale:()=>(0,a.getLang)("video_N_subscribers_million")},u=e=>d({count:e,localeOptions:_}),c=e=>d({count:e,localeOptions:l}),p=e=>d({count:e,localeOptions:{getThousandLocale:()=>(0,a.getLang)("video_N_thousand"),getMillionLocale:()=>(0,a.getLang)("video_N_million")}}),m=e=>(0,a.langDate)(e*r.SECOND,(0,a.getLang)("global_date","raw").slice(0,2),0,(0,a.getLang)("months_of","raw")),y=e=>`${e.toLocaleString("ru-RU")} ${(0,a.getLang)("video_showcase_N_viewers",e).split(" ")[1]}`},590151:(e,t,s)=>{"use strict";s.d(t,{logSavedUsersAuthStart:()=>_,logSavedUsersDropAccount:()=>l,logSwitcherAccounts:()=>u});var a=s(314309);const n=new a.ProductionStatCollector,r=new a.ActionStatCollector(n),d=new a.RegistrationItemStatCollector(r);function _(e){d.logEvent(a.RegistrationItemEventTypes.AUTH_SAVED_START,a.EventScreens.START_PROCEED_AS,void 0,{force:!0},[{name:a.RegistrationFieldItemNames.SAVED_SOURCE,value:a.RegistrationFieldItemValues.SAVED_SOURCE_CAROUSEL,start_interaction_time:"",end_interaction_time:""}],e)}function l(e){d.logEvent(a.RegistrationItemEventTypes.DROP_ACCOUNT_FROM_SAVED,a.EventScreens.START_PROCEED_AS,void 0,{force:!0},[{name:a.RegistrationFieldItemNames.SAVED_SOURCE,value:a.RegistrationFieldItemValues.SAVED_SOURCE_CAROUSEL,start_interaction_time:"",end_interaction_time:""}],e)}function u(){d.logEvent(a.RegistrationItemEventTypes.POPUP_OPEN,a.EventScreens.MAIN,a.EventScreens.MULTI_ACC_SWITCHER,{force:!0})}},416362:(e,t,s)=>{"use strict";function a(e,t,s=null){e&&!window.vk?.isBanned&&window.stManager.add([window.jsc("web/article_layer.js"),"article.css"]).then((()=>{window.ArticleLayer.prepare(e,s,t)}))}s.d(t,{articlePrepare:()=>a})},358916:(e,t,s)=>{"use strict";s.d(t,{AudioPageProxy:()=>p});var a=s(434518),n=s(763812),r=s(584053),d=s(558137),_=s(523149),l=(0,n._)("_emitter"),u=(0,n._)("_globalStorage"),c=(0,n._)("_audioPage");class p{get emitter(){return(0,a._)(this,l)[l]}get events(){return(0,a._)(this,l)[l].listenable}get isInitialized(){return Boolean((0,a._)(this,c)[c])}get data(){return(0,a._)(this,c)[c]?._data||null}get readyAudio(){return(0,a._)(this,c)[c]?._readyAudio??null}get currentPlaylist(){return(0,a._)(this,c)[c]?.getPageCurrentPlaylist()}get currentSection(){return(0,a._)(this,c)[c]?._currentSection??null}get audioStartReadyAudio(){return(0,a._)(this,u)[u]?.audioStartReadyAudio??!1}set audioStartReadyAudio(e){(0,a._)(this,u)[u]={audioStartReadyAudio:e}}get ownerId(){return(0,a._)(this,c)[c]?.getOwnerId()??null}get canAddToGroup(){return Boolean((0,a._)(this,c)[c]?.canAddToGroup())}get canEditGroup(){return Boolean((0,a._)(this,c)[c]?.canEditGroup())}get contentBlock(){return(0,a._)(this,c)[c]?._els?.contentBlock??null}destroyReadyAudio(){(0,a._)(this,c)[c]?._destroyReadyAudio()}initAudioRowsAutoList(e){(0,a._)(this,c)[c]?._initAudioRowsAutoList(e)}reloadGeneralSectionData(e){(0,a._)(this,c)[c]?.reloadGeneralSectionData(e)}onUserAction(e,t){(0,a._)(this,c)[c]?.onUserAction(e,t)}constructor(){Object.defineProperty(this,u,{get:m,set:y}),Object.defineProperty(this,c,{get:g,set:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),(0,a._)(this,l)[l]=new r.Emitter}}function m(){return window.cur??null}function y(e){(0,_.default)(window.cur)&&(window.cur={...window.cur,...e})}function g(){return(0,a._)(this,u)[u]?.audioPage??null}p.ensure=(0,d.makeSharedState)("AudioPageProxy",(()=>new p),{version:5})},149510:(e,t,s)=>{"use strict";var a;s.d(t,{AudioRecomsOnboardingShowRequestedEventReason:()=>a}),function(e){e.VibeRecommendationsPlaylistPlayButton="VIBE_RECOMMENDATIONS_PLAYLIST_PLAY_BUTTON",e.RecommendationsPlaylistOpenButton="RECOMMENDATIONS_PLAYLIST_OPEN_BUTTON",e.RecommendationsPlaylistPlayButton="RECOMMENDATIONS_PLAYLIST_PLAY_BUTTON",e.SnippetsBannerOpenSnippetsPageLink="SNIPPETS_BANNER_SNIPPETS_PAGE_LINK",e.Navigation="NAVIGATION",e.AudioPageInit="AUDIO_PAGE_INIT",e.Unknown="UNKNOWN"}(a||(a={}))},275810:(e,t,s)=>{"use strict";var a;s.d(t,{AudioPageEventType:()=>a}),function(e){e.Updated="updated",e.RadioStationFollowed="radioStationFollowed",e.PodcastAddedToFavorites="podcastAddedToFavorites",e.AudioLinkCopied="audioLinkCopied",e.AudioRecomsOnboardingShowRequested="audioRecomsOboardingShowRequested"}(a||(a={}))},459899:(e,t,s)=>{"use strict";s.d(t,{AudioPageEventType:()=>n.AudioPageEventType,AudioPageProxy:()=>a.AudioPageProxy,AudioRecomsOnboardingShowRequestedEventReason:()=>r.AudioRecomsOnboardingShowRequestedEventReason});var a=s(358916),n=s(275810),r=s(149510)},997784:(e,t,s)=>{"use strict";s.d(t,{FetchService:()=>l});var a=s(346675),n=s(319756),r=s(761520),d=s(540462),_=s(139612);class l{async getAudioIdsBySource(e,t={}){const s=(0,d.partConfigEnabled)("audio_recom_playlists_starts_with_last_played_audio_web"),{audioListId:a,audioListSource:n,ref:l}=t,u={audioIds:[],lastPlayedAudioRawId:null};try{if(s&&"playlist"===n&&a){const{audios:e,last_listened_audio_id:t=null}=await this.audioApi.getAudioIdsBySource({entity_id:a,source:n,ref:l});return u.audioIds=e.map((e=>({audio_raw_id:e.audio_id,access_key:(0,_.mapAPIRawIdToAudioIdentity)(e.audio_id)?.accessKey??"",track_code:e.track_code}))),t&&(u.lastPlayedAudioRawId=t),u}const t=await r.ajax.promisifiedPost("al_audio.php?act=get_audio_ids_by_source",{...e}),d=t?.[0];Array.isArray(d)&&(u.audioIds=d)}finally{return u}}constructor(){this.audioApi=(0,n.ensureDIRootWebContainer)().resolve(a.AudioApi),this.reloadAudios=e=>new Promise(((t,s)=>{r.ajax.post("al_audio.php?act=reload_audios",{audio_ids:e},{onDone:e=>{t(e)},onFail:e=>(s(e),!1)})})),this.getAutoplayAudioIdsBySource=e=>new Promise(((t,s)=>{r.ajax.post("al_audio.php?act=get_next_audios",{...e},{onDone:e=>{t(e)},onFail:e=>(s(e),!1)})})),this.followRadiostation=(e,t)=>new Promise(((s,a)=>{r.ajax.post("al_audio.php?act=follow_radiostation",{id:e,hash:t},{onDone:e=>{s(e)},onFail:e=>(a(e),!0)})})),this.unfollowRadiostation=(e,t)=>new Promise(((s,a)=>{r.ajax.post("al_audio.php?act=unfollow_radiostation",{id:e,hash:t},{onDone:e=>{s(e)},onFail:e=>(a(e),!0)})}))}}},322100:(e,t,s)=>{"use strict";s.d(t,{ensureGroupsMusicService:()=>a.ensureGroupsMusicService,ensureMyAudioDislikesService:()=>a.ensureMyAudioDislikesService,ensureMyMusicService:()=>a.ensureMyMusicService});var a=s(83113)},882118:(e,t,s)=>{"use strict";s.d(t,{createGroupServiceAdapter:()=>c});var a=s(746573),n=s(182464),r=s(468073),d=s(824501),_=s(319756),l=s(395654),u=s(37051);function c(e){const t=(0,a.getEffectorServiceDomain)(e),s=(0,_.ensureDIRootWebContainer)().resolve(d.MusicService).groupMusicServices,{$identitiesMap:c}=(0,n.createIdentitiesMaps)({domain:t}),p=t.createEffect((async({trackedIdentity:e,groupId:t})=>{const a=(0,l.toMusicAudioIdentity)(e),n=r.Ranges.convertOwnerIdToGroupId(t);await s.get(n).add(a,{trackCode:e.trackCode});const d=s.get(n).getTarget(a);if(!d)throw new Error("Failed to add audio to group");return(0,u.toAudioIdentity)(d)})),m=t.createEffect((async({trackedIdentity:e,groupId:t})=>{const a=(0,l.toMusicAudioIdentity)(e),n=r.Ranges.convertOwnerIdToGroupId(t);await s.get(n).restore(a,{trackCode:e.trackCode});const d=s.get(n).getTarget(a);if(!d)throw new Error("Failed to restore audio to group");return(0,u.toAudioIdentity)(d)}));return{addFx:p,deleteFx:t.createEffect((async({groupId:e,audioId:t})=>{const a=r.Ranges.convertOwnerIdToGroupId(e);await s.get(a).delete((0,l.toMusicAudioIdentity)({ownerId:e,id:t}))})),restoreFx:m,$identitiesMap:c}}},871479:(e,t,s)=>{"use strict";s.d(t,{ensureGroupsMusicService:()=>u});var a=s(466915),n=s(558137),r=s(32489),d=s(882118),_=s(540462);const l=(0,n.makeSharedState)("global/audio/groupsMusic/adapter",(()=>(0,d.createGroupServiceAdapter)({domain:(0,r.createDomain)("global/audio/groupsMusic/adapter"),name:"global/audio/groupsMusic/adapter"})),{version:1}),u=()=>(0,_.partConfigEnabled)("enabled_groups_mobx_service")?l():(0,a.ensureGroupsMusicService)()},589322:(e,t,s)=>{"use strict";s.d(t,{createMyAudioDislikesServiceAdapter:()=>c});var a=s(824501),n=s(246855),r=s(746573),d=s(586049),_=s(873900),l=s(319756),u=s(395654);function c(e){const t=(0,r.getEffectorServiceDomain)(e),s=(0,l.ensureDIRootWebContainer)().resolve(a.MusicService).dislikes,{$fullIdsMap:c,fullIdsMapApi:p}=(0,d.createFullIdsMap)(t),m=t.createEffect((async({identity:e})=>{await s.activate((0,u.toMusicAudioIdentity)(e))})),y=t.createEffect((async({identity:e})=>{await s.deactivate((0,u.toMusicAudioIdentity)(e),{reason:n.MusicDislikeDeactivateReason.MyMusic})}));return s.events.on("activated",(({identity:e})=>{p.add((0,_.getIdentityRawId)(e))})),s.events.on("deactivated",(({identity:e})=>{p.remove((0,_.getIdentityRawId)(e))})),{addFx:m,removeFx:y,$identitiesMap:c}}},802640:(e,t,s)=>{"use strict";s.d(t,{ensureMyAudioDislikesService:()=>u});var a=s(498486),n=s(558137),r=s(32489),d=s(589322),_=s(540462);const l=(0,n.makeSharedState)("global/audio/myDislikes/adapter",(()=>(0,d.createMyAudioDislikesServiceAdapter)({domain:(0,r.createDomain)("global/audio/myDislikes/adapter"),name:"global/audio/myDislikes/adapter"})),{version:1}),u=()=>(0,_.partConfigEnabled)("enabled_mm_and_dislikes_mobx_services")?l():(0,a.ensureMyAudioDislikesService)()},391570:(e,t,s)=>{"use strict";s.d(t,{createMyMusicServiceAdapter:()=>y});var a=s(746573),n=s(182464),r=s(46201),d=s(786979),_=s(824501),l=s(873900),u=s(32489),c=s(319756),p=s(395654),m=s(37051);function y(e){const t=(0,a.getEffectorServiceDomain)(e),s=(0,c.ensureDIRootWebContainer)().resolve(_.MusicService).myMusic,{$identitiesMap:y,addedIdentitiesMapApi:g,removedIdentitiesMapApi:f,addToStore:E,removeFromStore:A}=(0,n.createIdentitiesMaps)({domain:t}),P=t.createStore({}),b=(0,u.createApi)(P,{add:(e,t)=>(0,r.addPairToMap)(e,{key:t.audioFullId,value:t.value}),remove:(e,t)=>(0,d.removePairFromMap)(e,t)}),I=t.createEffect((async({trackedIdentity:e})=>{const t=(0,p.toMusicAudioIdentity)(e);await s.add(t,{trackCode:e.trackCode});const a=s.getTarget(t);if(!a)throw new Error("Failed to add audio to my music");return(0,m.toAudioIdentity)(a)})),T=t.createEffect((async({identity:e})=>{await s.delete((0,p.toMusicAudioIdentity)(e))})),C=t.createEffect((async({identity:e})=>{await s.restore((0,p.toMusicAudioIdentity)(e))}));return s.events.on("added",(({source:e})=>{const t=s.getTarget(e)??e;g.add({fullId:(0,l.getIdentityRawId)((0,m.toAudioIdentity)(e)),identity:(0,m.toAudioIdentity)(t)}),b.add({audioFullId:(0,l.getIdentityRawId)((0,m.toAudioIdentity)(t)),value:(0,m.toAudioIdentity)(e)})})),s.events.on("deleted",(({target:e})=>{const t=s.getTarget(e)??e;f.add((0,l.getIdentityRawId)((0,m.toAudioIdentity)(t)))})),s.events.on("restored",(({target:e})=>{const t=s.getTarget(e)??e;f.remove((0,l.getIdentityRawId)((0,m.toAudioIdentity)(t))),g.add({fullId:(0,l.getIdentityRawId)((0,m.toAudioIdentity)(e)),identity:(0,m.toAudioIdentity)(e)})})),{addFx:I,deleteFx:T,restoreFx:C,addToStore:E,removeFromStore:A,$identitiesMap:y,$sourcesMap:P,isOwned:e=>s.isOwned(e)}}},876409:(e,t,s)=>{"use strict";s.d(t,{ensureMyMusicService:()=>u});var a=s(345997),n=s(558137),r=s(32489),d=s(540462),_=s(391570);const l=(0,n.makeSharedState)("global/audio/myMusic/adapter",(()=>(0,_.createMyMusicServiceAdapter)({domain:(0,r.createDomain)("global/audio/myMusic/adapter"),name:"global/audio/myMusic/adapter"})),{version:1}),u=()=>(0,d.partConfigEnabled)("enabled_mm_and_dislikes_mobx_services")?l():(0,a.ensureMyMusicService)()},83113:(e,t,s)=>{"use strict";s.d(t,{ensureGroupsMusicService:()=>r.ensureGroupsMusicService,ensureMyAudioDislikesService:()=>a.ensureMyAudioDislikesService,ensureMyMusicService:()=>n.ensureMyMusicService});var a=s(802640),n=s(876409),r=s(871479)},37051:(e,t,s)=>{"use strict";function a(e){return{id:e.id,ownerId:e.ownerId,accessKey:e.accessKey}}s.d(t,{toAudioIdentity:()=>a})},395654:(e,t,s)=>{"use strict";s.d(t,{toMusicAudioIdentity:()=>n});var a=s(70148);function n(e){return new a.OwnedIdentity({id:e.id,ownerId:e.ownerId,accessKey:e.accessKey})}},56885:(e,t,s)=>{"use strict";s.d(t,{hideCatalogBlock:()=>d});var a=s(983567),n=s(392358),r=s(761520);function d(e,t){r.ajax.post("/al_audio.php?act=hide_catalog_block",{block_id:e});const s=t.closest(".CatalogBlock__content");s&&(0,a.getAudioPlayer)().notify(n.events.PLACEHOLDER_REMOVE,s.dataset.id)}},933583:(e,t,s)=>{"use strict";s.d(t,{showAudioLongtapModalEffector:()=>c});var a=s(474848),n=s(725669),r=s(211413),d=s(58808),_=s(840079),l=s(345997);const u=(0,n.asyncComponent)((()=>Promise.all([s.e(91498),s.e(89631),s.e(21529),s.e(1715),s.e("langs/web/AudioLongtapModal")]).then(s.bind(s,803410))),(({AudioLongtapModal:e})=>e)),c=(e,t)=>{const s=_.AudioLongtapModalService.ensure(),n=(0,l.ensureMyMusicService)();s.setAudioElement(t),(0,r.showMessageBoxModalSuspense)((t=>(0,a.jsx)(u,{...t,audioLongtapService:s,previewsService:d.audioPreviewsService,myMusicService:n,audio:e})),{width:380,onDestroy:()=>{s.onCloseModal("click_outside")}})}},423979:(e,t,s)=>{"use strict";s.d(t,{SpecialProjectModal:()=>g});var a=s(474848),n=s(296540),r=s(694244),d=s(753457),_=s(63614),l=s(506782),u=s(308950),c=s(454154),p=s(514871),m=s(444024);const y="SpecialProjectModal__subheader",g=({title:e,text:t,button:s,style:g,image:f,backgroundImage:E,sendCloseReason:A,onClose:P})=>{const b=e=>{"A"===e.target.tagName&&A("link")};return(0,n.useEffect)((()=>{const[e]=document.getElementsByClassName(y);return e.addEventListener("click",b),()=>{e.removeEventListener("click",b)}}),[]),(0,a.jsxs)(r.ModalBox,{children:[(0,a.jsx)(d.ModalDismissButton,{onClick:P}),(0,a.jsx)(p.SpecialProjectHeader,{backgroundImage:E,image:f,style:g}),(0,a.jsxs)(_.ModalBody,{insetLevel:1,children:[(0,a.jsx)(l.ModalTextLayout,{subheader:(0,a.jsx)("span",{className:y,children:(0,m.parseReactWikiLinks)(t)}),subheaderMode:"primary",children:e}),(0,a.jsx)(u.ButtonLayout,{children:(0,a.jsx)(c.Button,{onClick:()=>{A("button"),s.action?.url&&window.nav.go(s.action.url)},size:"l",mode:"primary",children:s.title},"special-project-submit-button")})]})]})}},492065:(e,t,s)=>{"use strict";s.d(t,{showWebSpecialProjectModal:()=>d});var a=s(474848),n=s(211413),r=s(423979);const d=(e,t)=>{(0,n.showMessageBoxModal)((s=>(0,a.jsx)(r.SpecialProjectModal,{...s,...e,sendCloseReason:t})),{width:420,onDestroy:()=>{t("close")}})}},493229:(e,t,s)=>{"use strict";s.d(t,{AUDIO_STORAGE_KEYS_ENUM:()=>a});const a={AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME:"audio_preview_tooltip_show_date_time"}},513467:(e,t,s)=>{"use strict";s.d(t,{createAudioDislikesInMyMusicWebService:()=>C});var a=s(746573),n=s(586049),r=s(478455),d=s(584053),_=s(32489),l=s(278758),u=s(803111),c=s(270935),p=s(392358),m=s(679688),y=s(297420),g=s(630082),f=s(367181),E=s(909436),A=s(518051),P=s(169818),b=s(602337),I=s(322100),T=s(540462);function C(e){const t=(0,a.getEffectorServiceDomain)(e),s=new d.Emitter,A=(0,u.ensureAudioPlayerService)(),P=(0,I.ensureMyAudioDislikesService)(),b=(0,c.ensureMyAudioMusicWebService)(),C=(0,_.createEvent)(),{$fullIdsMap:S,fullIdsMapApi:D}=(0,n.createFullIdsMap)(t),{$fullIdsMap:k,fullIdsMapApi:L}=(0,n.createFullIdsMap)(t),{$fullIdsMap:R,fullIdsMapApi:B}=(0,n.createFullIdsMap)(t),x=(0,_.restore)(C,null),F=(0,_.attach)({source:x,async effect(e){if(!e)throw new Error("Audio not exists");const t=(0,r.getAudioFullId)(e);await Promise.all([b.addFx({audio:e,isNotificationDisabled:!0}),P.removeFx({identity:e})]),B.remove(t),A.updateAudioDislikeStatusFx({audioFullId:t,hasDislike:!1}),A.notifyFx({eventType:p.AudioPlayerEventType.AUDIO_RESTORE_BY_DISLIKE_ACTION,params:[t]}),s.emit(f.AudioDislikesInMyMusicWebServiceEventType.LastDislikedAudioInMyMusicRestored,{audio:e})}}),U=(0,_.attach)({source:(0,_.combine)({dislikesIdentitiesMap:P.$identitiesMap,myMusicIdentitiesMap:b.$identitiesMap,dislikeActionInitializedIdentitiesMap:S,myMusicActionInitializedIdentitiesMap:b.$initializedIdentitiesMap,isFinitePlaylist:(0,y.not)((0,g.equals)(A.$currentPlaylist.map((e=>Boolean(e?.isLive()||e?.isLoadable()))),!0)),playerCurrentAudio:A.$currentAudio,playerProgress:A.$progress}),async effect({dislikeActionInitializedIdentitiesMap:e,myMusicActionInitializedIdentitiesMap:t,dislikesIdentitiesMap:a,myMusicIdentitiesMap:n,isFinitePlaylist:d,playerCurrentAudio:_,playerProgress:l},{audio:u,audioEl:y=null,skipDeletionAudioFromMyMusic:g,needReloadTrackCode:E}){if(!u)throw new Error("Audio not exists");const I=(0,r.getAudioFullId)(u),S=_&&I===(0,r.getAudioFullId)(_)?l:0,D=Boolean(e[I]);if((0,m.hasDislike)({audio:u,dislikesIdentitiesMap:a,isDislikeActionInitialized:D}))throw new Error("Audio already disliked");const k=await O({playerService:A,audio:u,audioEl:y});try{let e=u;if(E){const t=await M(u,y);t&&(e={...u,trackCode:t})}await P.addFx({identity:u});if(!g&&(0,c.isMy)({identity:u,myMusicIdentitiesMap:n,isMyMusicActionInitialized:Boolean(t[I]),userId:window.vk.id}))try{const t=(0,T.partConfigEnabled)("enabled_mm_and_dislikes_mobx_services")&&!b?.isOwned?.(u)?n[I]:u;await b.deleteFx({audio:t}),C(u),s.emit(f.AudioDislikesInMyMusicWebServiceEventType.AudioDislikedInMyMusic,{audio:e,playlistIdentity:k,playerProgress:S}),B.add(I),A.updateAudioDislikeStatusFx({audioFullId:I,hasDislike:!0}),A.notifyFx({eventType:p.AudioPlayerEventType.AUDIO_DELETE_BY_DISLIKE_ACTION,params:[I]})}catch(e){throw new Error("Failed to delete audio from MyMusic",{cause:e})}else s.emit(f.AudioDislikesInMyMusicWebServiceEventType.AudioDisliked,{audio:e,playlistIdentity:k,playerProgress:S});const a=A.getPlaylistQueue();if(d&&a&&a?.indexOfAudio?.(u)===a?.length-1)return;A.getCurrentAudio()?.id===u.id&&A.playNextFx()}catch(e){throw new Error("Failed to add dislike to audio",{cause:e})}}}),N=(0,_.attach)({source:(0,_.combine)({dislikesIdentitiesMap:P.$identitiesMap,initializedIdentitiesMap:S,lastDislikedAudioInMyMusic:x,isCancelDeletionLastDislikedAudioInMyMusicFxPending:F.pending,dislikedAudiosInMyMusicMap:R,playerCurrentAudio:A.$currentAudio,playerProgress:A.$progress}),async effect({initializedIdentitiesMap:e,dislikesIdentitiesMap:t,lastDislikedAudioInMyMusic:a,isCancelDeletionLastDislikedAudioInMyMusicFxPending:n,dislikedAudiosInMyMusicMap:d,playerCurrentAudio:_,playerProgress:l},{audio:u,audioEl:c=null,needReloadTrackCode:y}){if(!u)throw new Error("Audio not exists");const g=(0,r.getAudioFullId)(u),E=Boolean(e[g]);if(!(0,m.hasDislike)({audio:u,dislikesIdentitiesMap:t,isDislikeActionInitialized:E}))throw new Error("Audio not disliked");const I=await O({playerService:A,audio:u,audioEl:c}),S=Boolean(a)&&a?.id===u.id;let D=u;if(y){const e=await M(u,c);e&&(D={...u,trackCode:e})}try{!E||!(g in d)||n&&S?await P.removeFx({identity:u}):(S&&(s.emit(f.AudioDislikesInMyMusicWebServiceEventType.LastDislikedAudioInMyMusicRestoreRequestedByCancelDislikeButton,{audio:u}),C(null)),(0,T.partConfigEnabled)("enabled_mm_and_dislikes_mobx_services")&&b.restoreFx?await Promise.all([b.restoreFx({identity:u}),P.removeFx({identity:u})]):await Promise.all([b.addFx({audio:u,isNotificationDisabled:!0}),P.removeFx({identity:u})]),B.remove(g),A.notifyFx({eventType:p.AudioPlayerEventType.AUDIO_RESTORE_BY_DISLIKE_ACTION,params:[g]})),s.emit(f.AudioDislikesInMyMusicWebServiceEventType.AudioDislikeRemoved,{audio:D,playlistIdentity:I,playerProgress:_&&g===(0,r.getAudioFullId)(_)?l:0}),A.updateAudioDislikeStatusFx({audioFullId:g,hasDislike:!1})}catch(e){throw new Error("Failed to remove dislike from audio",{cause:e})}}}),W=(0,_.attach)({source:(0,_.combine)({dislikesIdentitiesMap:P.$identitiesMap,dislikeActionInitializedIdentitiesMap:S,playerCurrentAudio:A.$currentAudio,playerProgress:A.$progress}),async effect({dislikesIdentitiesMap:e,dislikeActionInitializedIdentitiesMap:t,playerCurrentAudio:a,playerProgress:n},{audio:d,audioEl:_,needReloadTrackCode:l,...u}){if(!d)throw new Error("Audio not exists");const c=await O({playerService:A,audio:d,audioEl:_}),p=(0,r.getAudioFullId)(d);let y=document.querySelector(`._audio_row_${p}`);y=y==_?null:y;const g=(0,m.hasDislike)({audio:d,dislikesIdentitiesMap:e,isDislikeActionInitialized:p in t});let I=d;if(l){const e=await M(d,_);e&&(I={...d,trackCode:e})}if(g){if((0,T.partConfigEnabled)("enabled_mm_and_dislikes_mobx_services")&&b.restoreFx&&b.isOwned&&b?.isOwned(d))try{await Promise.all([P.removeFx({identity:d}),b.restoreFx({identity:d})]),_&&(_.classList.remove("audio_row__deleted"),E.AudioUtils.onRowOver(_,!1,!0)),y&&(y.classList.remove("audio_row__deleted"),E.AudioUtils.onRowOver(y,!1,!0))}catch(e){throw _&&(_.classList.add("audio_row__deleted"),E.AudioUtils.onRowOver(_,!1,!0)),y&&(y.classList.add("audio_row__deleted"),E.AudioUtils.onRowOver(_,!1,!0)),new Error('Failed to delete audio from "My Music"',{cause:e})}else await Promise.all([P.removeFx({identity:d}),b.addFx({audio:I,needReloadTrackCode:!1,...u})]);A.updateAudioDislikeStatusFx({audioFullId:p,hasDislike:!1}),s.emit(f.AudioDislikesInMyMusicWebServiceEventType.AudioDislikeRemovedByAddToMyMusicButton,{audio:I,playlistIdentity:c,playerProgress:a&&p===(0,r.getAudioFullId)(a)?n:0})}else await b.addFx({audio:I,audioEl:_,...u})}});return(0,_.sample)({clock:[U.done,N.done],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:D.add}),(0,_.sample)({clock:[U,N],filter:({audio:e})=>Boolean(e),fn:({audio:e})=>(0,r.getAudioFullId)(e),target:L.add}),(0,_.sample)({clock:[U.finally,N.finally],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:L.remove}),(0,l.reset)({clock:F.done,target:x}),{$dislikesIdentitiesMap:P.$identitiesMap,$dislikesInitializedIdentitiesMap:S,$dislikesLoadingIdentitiesMap:k,addDislikeFx:U,removeDislikeFx:N,$myMusicIdentitiesMap:b.$identitiesMap,$myMusicInitializedIdentitiesMap:b.$initializedIdentitiesMap,$myMusicLoadingIdentitiesMap:b.$loadingIdentitiesMap,addToMyMusicFx:W,deleteFromMyMusicFx:b.deleteFx,cancelDeletionLastDislikedAudioInMyMusicFx:F,events:s.listenable}}async function O({playerService:e,audio:t,audioEl:s}){if(t.album)return{id:t.album[b.AudioPlaylistTupleKeys.Id],ownerId:t.album[b.AudioPlaylistTupleKeys.OwnerId]};const a=e.getCurrentAudio();if(a&&(0,r.getAudioFullId)(a)===(0,r.getAudioFullId)(t)){const t=await e.getCurrentPlaylistFx();if(t){const e=t?.getPlaylistId(),s=t?.getPlaylistId();if(e&&s)return{id:+e,ownerId:+s}}}if(s){let e=E.AudioUtils.getContextPlaylist(s);if(e?.playlist){const t=e.playlist?.getPlaylistId(),s=e.playlist?.getPlaylistId();if(t&&s)return{id:+t,ownerId:+s}}}return null}async function M(e,t){const s=(0,A.getContextPlaylist)(t);if(!s)return null;return await(0,P.getAudioTrackCodeFromPlaylist)(s?.playlist,e)??null}},367181:(e,t,s)=>{"use strict";var a;s.d(t,{AudioDislikesInMyMusicWebServiceEventType:()=>a}),function(e){e.AudioDisliked="audioDisliked",e.AudioDislikedInMyMusic="audioDislikedInMyMusic",e.LastDislikedAudioInMyMusicRestored="lastDislikedAudioInMyMusicRestored",e.LastDislikedAudioInMyMusicRestoreRequestedByCancelDislikeButton="lastDislikedAudioInMyMusicRestoreRequestedByCancelDislikeButton",e.AudioDislikeRemoved="audioDislikeRemoved",e.AudioDislikeRemovedByAddToMyMusicButton="audioDislikeRemovedByAddToMyMusicButton"}(a||(a={}))},761178:(e,t,s)=>{"use strict";s.d(t,{ensureAudioDislikesInMyMusicWebService:()=>_,hasDislike:()=>d.hasDislike});var a=s(558137),n=s(32489),r=s(513467),d=s(679688);s(367181);const _=(0,a.makeSharedState)("global/web/audio/dislikesInMyMusic",(()=>(0,r.createAudioDislikesInMyMusicWebService)({domain:(0,n.createDomain)("global/web/audio/dislikesInMyMusic"),name:"global/web/audio/dislikesInMyMusic"})),{version:3})},550929:(e,t,s)=>{"use strict";s.d(t,{hasDislike:()=>r});var a=s(478455),n=s(482310);function r({audio:e,dislikesIdentitiesMap:t,isDislikeActionInitialized:s}){return!!e&&(!!t[(0,a.getAudioFullId)(e)]||!s&&((0,n.getAudioExtra)(e)?.dislike??!1))}},679688:(e,t,s)=>{"use strict";s.d(t,{hasDislike:()=>a.hasDislike});var a=s(550929)},964076:(e,t,s)=>{"use strict";s.d(t,{createAudioLongtapFetchService:()=>r});var a=s(32489),n=s(345997);function r(e){const t=(0,a.createDomain)("AudioLongtapModal"),s=(0,n.ensureMyMusicService)(),r=t.createStore(!1),d=t.createStore(!1),_=(0,a.attach)({effect:e.fetchAudioPreviewFx}),l=(0,a.attach)({effect:s.addFx}),u=t.createEvent();return d.reset(u),(0,a.sample)({clock:_.failData,fn:()=>!0,target:r}),(0,a.sample)({clock:_,fn:()=>!1,target:r}),(0,a.sample)({clock:l.doneData,fn:()=>!0,target:d}),(0,a.sample)({clock:l,fn:()=>!1,target:d}),{$failFetch:r,$successAddAudio:d,resetAddSuccessResult:u,fetchAudioPreviewFx:_,addAudioFx:l}}},840079:(e,t,s)=>{"use strict";s.d(t,{AudioLongtapModalService:()=>P});var a=s(392358),n=s(317216),r=s(983567),d=s(654671),_=s(927848),l=s(909436),u=s(358926),c=s(58808),p=s(957580),m=s(139612),y=s(345997),g=s(478455),f=s(964076),E=s(540462);let A=null;class P{static ensure(){return A||(A=new P,A)}async fetchPreview(e){await this.fetcher.fetchAudioPreviewFx({identity:(0,m.mapAPIRawIdToAudioIdentity)(e.fullId)}),this.previewPlayer.timelinePosition=0,this.previewPlayer.setCurrentAudio(e)}async play(e){const t={...this.getStatData(),audio:this.previewPlayer.currentAudio};this.statCollector.openModal(t),this.commonAudioWasPlaying=this.commonAudioPlayer.isPlaying(),await this.previewPlayer.play(e,this.commonAudioPlayer.getVolume()),this.commonAudioWasPlaying&&this.commonAudioPlayer.pauseByChangeChannel();const s=_.AudioLongtapTooltip.ensure();this.statCollector.start(this.getStatData()),s.canShow()&&s.disable()}setAudioElement(e){this.audioElement=e}stop(){const e=this.commonAudioPlayer.getCurrentAudio();if(this.previewPlayer.stop(),this.commonAudioWasPlaying&&e){const t=this.commonAudioPlayer.getCurrentPlaylist();this.commonAudioPlayer.resumeChannel({audio:e,playlist:t,context:void 0}),this.commonAudioWasPlaying=!1}}subscribeStop(e){this.previewPlayer.subscribe.call(this.previewPlayer,a.events.STOP_PREVIEW,e),this.previewPlayer.subscribe.call(this.previewPlayer,a.events.END_PREVIEW,e)}unsubscribeStop(e){this.previewPlayer.unsubscribe.call(this.previewPlayer,a.events.STOP_PREVIEW,e),this.previewPlayer.unsubscribe.call(this.previewPlayer,a.events.END_PREVIEW,e)}subscribeProgress(e){this.previewPlayer.subscribe.call(this.previewPlayer,a.events.PROGRESS_PREVIEW,e)}unsubscribeProgress(e){this.previewPlayer.unsubscribe.call(this.previewPlayer,a.events.PROGRESS_PREVIEW,e)}onCloseModal(e){if(this.audioElement)switch(e){case"click_exit":this.statCollector.closeBy(n.EventItemSubType.AUDIO_LONGTAP_CLICK_EXIT,this.getStatData());break;case"click_outside":this.statCollector.closeBy(n.EventItemSubType.AUDIO_LONGTAP_CLICK_OUTSIDE,this.getStatData());break;case"auto_finish":this.statCollector.closeBy(n.EventItemSubType.AUDIO_LONGTAP_AUTO_FINISH,this.getStatData())}this.audioElement=null,this.stop(),this.commonAudioWasPlaying=!1,this.previewPlayer.unsubscribe(a.events.STOP_PREVIEW,this.stop),this.previewPlayer.unsubscribe(a.events.END_PREVIEW,this.stop)}get currentAudio(){return this.previewPlayer.currentAudio}get timelinePosition(){return this.previewPlayer.timelinePosition}get playbackDuration(){return this.previewPlayer.playbackDuration}async addAudio(e){const t=(0,E.partConfigEnabled)("add_audio_to_effector_web");await this.fetcher.addAudioFx({trackedIdentity:{id:e.id,ownerId:e.owner_id,accessKey:e.accessKey,trackCode:e.trackCode},userId:window.vk.id});const s=(0,y.ensureMyMusicService)().$identitiesMap.getState()[(0,g.getAudioFullId)({id:e.id,ownerId:e.ownerId})];(0,r.getAudioPlayer)().notify(a.events.ADDED,e,s.id);const n={...this.getStatData(),audioAddedId:s.id||void 0};if(this.audioElement&&this.audioElement.classList.add("audio_row__added"),!t){l.AudioUtils.getAddRestoreInfo()[e.fullId]={state:"added",addedFullId:(0,g.getAudioFullId)({id:s.id,ownerId:s.ownerId}),audio:e}}this.statCollector.addTrack(n)}getStatData(){const e=this.commonAudioPlayer.getCurrentPlaylist(),t=e?.getPlaylistId()??void 0;return{audio:this.currentAudio,timelinePosition:this.timelinePosition,playlistId:t,playbackDuration:this.playbackDuration,volume:(0,p.unLogF)(this.commonAudioPlayer.getVolume()),snippetLength:this.previewPlayer.previewLength}}goToTrack(e){e&&(this.statCollector.goToTrack(this.getStatData()),window.nav.go(`audio${e}`))}goToArtist(e){e&&(this.statCollector.goToArtist(this.getStatData()),window.nav.go(`artist/${e}`))}constructor(){this.previewPlayer=d.PreviewAudioPlayerEffector.ensure(),this.commonAudioPlayer=(0,r.getAudioPlayer)(),this.statCollector=u.AudioLongtapStatCollectorEffector.ensure(),this.previewPlayer.subscribe(a.events.STOP_PREVIEW,this.stop),this.previewPlayer.subscribe(a.events.END_PREVIEW,this.stop),this.fetcher=(0,f.createAudioLongtapFetchService)(c.audioPreviewsService)}}},358926:(e,t,s)=>{"use strict";s.d(t,{AudioLongtapStatCollectorEffector:()=>_});var a=s(317216),n=s(314309);const r=e=>{if(!e.audio)return{event_category:e.eventCategory};const{trackCode:t,id:s,ownerId:a,albumId:n}=e.audio;return{track_code:t,audio_id:s,audio_owner_id:a,playlist_id:n,playlist_owner_id:void 0,audio_id_new:e.audioAddedId||void 0,timeline_position:e.timelinePosition,playback_duration:e.playbackDuration,volume:Math.round(100*e.volume),audio_length:e.snippetLength,event_category:e.eventCategory}};let d=null;class _{static ensure(){return d||(d=new _,d)}start(e){const t=r({...e,eventCategory:a.LongtapEventCategory.play});this.actionStatCollector.logEvent({type:a.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[a.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{event_type:a.EventItemType.START,event_subtype:a.EventItemSubType.AUDIO_LONGTAP,...t}})}openModal(e){this.audio=e.audio;const t=r(e);this.sendView(a.EventItemType.OPEN,a.EventItemSubType.AUDIO_LONGTAP_OPEN,a.LongtapEventCategory.view,t)}addTrack(e){const t=r({...e,eventCategory:a.LongtapEventCategory.action});this.actionStatCollector.logEvent({type:a.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[a.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{event_type:a.EventItemType.ADDED,event_subtype:a.EventItemSubType.AUDIO_ADD_AFTER_LONGTAP,...t}})}tipHasShown(){this.sendView(a.EventItemType.HINT,a.EventItemSubType.AUDIO_LONGTAP_HINT,a.LongtapEventCategory.view)}closeBy(e,t){if(!this.audio)return;const s=r({...t,audio:this.audio,eventCategory:a.LongtapEventCategory.play});this.actionStatCollector.logEvent({type:a.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[a.ActionProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{event_type:a.EventItemType.STOP,event_subtype:e,...s}}),this.audio=null}goToTrack(e){this.audio=e.audio;const t=r(e);this.sendView(a.EventItemType.LONGTAP_DRILLDOWN,a.EventItemSubType.AUDIO_LONGTAP_GO_TO_TRACK,a.LongtapEventCategory.nav,t)}goToArtist(e){this.audio=e.audio;const t=r(e);this.sendView(a.EventItemType.LONGTAP_DRILLDOWN,a.EventItemSubType.AUDIO_LONGTAP_GO_TO_ARTIST,a.LongtapEventCategory.nav,t)}sendView(e,t,s,n){const r={type:a.ViewProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM,[a.ViewProductionStatEventTypes.TYPE_CATALOG_AUDIO_LONGTAP_ITEM]:{...n,event_type:e,event_subtype:t,event_category:s}},d={type:e,track_code:n?.track_code};this.viewCollector.logEvent(r,d)}constructor(){this.audio=null,this.productCollector=new n.ProductionStatCollector,this.viewCollector=new n.ViewStatCollector(this.productCollector),this.actionStatCollector=new n.ActionStatCollector(this.productCollector)}}},927848:(e,t,s)=>{"use strict";s.d(t,{AudioLongtapTooltip:()=>I});var a=s(434518),n=s(763812),r=s(250598),d=s(553608),_=s(493229),l=s(358926),u=s(984745),c=s(632731),p=s(558137),m=s(459899);var y=(0,n._)("_audioPage"),g=(0,n._)("_hint"),f=(0,n._)("_tooltip"),E=(0,n._)("_isOpen"),A=(0,n._)("_disabled"),P=(0,n._)("_isUserAuthorized"),b=(0,n._)("_getTooltip");class I{getHints(){(0,a._)(this,P)[P]&&(0,a._)(this,y)[y].isInitialized&&(0,u.ensureAccountHelpHintsService)().getHelpHintsFx()}getHint(){const e=(0,u.ensureAccountHelpHintsService)().$helpHints.getState()[c.AvailableHelpHints.ACCOUNT_HINT_AUDIO_LONG_TAP_PREVIEW_WEB];return(0,a._)(this,g)[g]=e||null,(0,a._)(this,g)[g]}canShow(){if((0,a._)(this,A)[A])return!1;let e=!1;if(this.getHint()){const t=d.vkLocalStorage.getItem(_.AUDIO_STORAGE_KEYS_ENUM.AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME),s=t?JSON.parse(t):null,a=s?s.firstShow:null;if(a){const t=new Date(+a).getTime(),n=(new Date).getTime(),r=Math.abs(n-t),l=Math.ceil(r/864e5);if(l<=3&&s?.disabledDay!==l){e=!0;const t={firstShow:a,disabledDay:l};d.vkLocalStorage.setItem(_.AUDIO_STORAGE_KEYS_ENUM.AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME,JSON.stringify(t))}s?.disabledDay===l&&(e=!1)}else{e=!0;const t={firstShow:(new Date).getTime(),disabledDay:1};d.vkLocalStorage.setItem(_.AUDIO_STORAGE_KEYS_ENUM.AUDIO_PREVIEW_TOOLTIP_SHOW_DATE_TIME,JSON.stringify(t))}}return e}async show(e){e&&((0,a._)(this,f)[f]=(0,a._)(this,b)[b](e),(0,a._)(this,f)[f]&&((0,a._)(this,f)[f].show(),(0,a._)(this,E)[E]=!0,l.AudioLongtapStatCollectorEffector.ensure().tipHasShown()))}disable(){this.getHint()&&(0,u.ensureAccountHelpHintsService)().hideHelpHint({hintId:c.AvailableHelpHints.ACCOUNT_HINT_AUDIO_LONG_TAP_PREVIEW_WEB}),(0,a._)(this,A)[A]=!0}get isOpen(){return(0,a._)(this,E)[E]}constructor({audioPage:e}){Object.defineProperty(this,P,{get:T,set:void 0}),Object.defineProperty(this,b,{value:C}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),(0,a._)(this,E)[E]=!1,(0,a._)(this,A)[A]=!1,(0,a._)(this,y)[y]=e}}function T(){return Boolean(window?.vk?.id)}function C(e){const t={autoShow:!1,cls:"feature_intro_tt feature_intro_blue_tt feature_info_tooltip audio_snippet_tooltip",content:(0,a._)(this,g)[g]?.title,align:"right",centerShift:8,appendTo:document.body,autoAdjustToViewport:!0,noAutoHideOnWindowClick:!0,autoHide:!0,onHide:()=>{(0,a._)(this,E)[E]=!1,(0,a._)(this,f)[f]?.destroy()},width:286},s=new r.ElementTooltip(e,t);return window.cur?.destroy?.push((()=>{s?.destroy()})),s}I.ensure=(0,p.makeSharedState)("AudioLongtapTooltip",(()=>new I({audioPage:m.AudioPageProxy.ensure()})),{version:1})},267009:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPageMyAudioPlaylistsService:()=>l});var a=s(32489),n=s(746573),r=s(46201),d=s(786979),_=s(30899);const l=(0,s(558137).makeSharedState)("global/audio/audioPage/myPlaylists",(()=>function({config:e,myAudioPlaylistsService:t}){const s=(0,n.getEffectorServiceDomain)(e),a=s.createStore({}),_=s.createEffect((async e=>await t.createFx({...e}))),l=s.createEffect((async e=>{await t.deleteFx({...e})}));return a.on(_.done,((e,{params:t,result:s})=>(0,r.addPairToMap)(e,{key:t.blockId,value:s}))),a.on(l.done,((e,{params:t})=>(0,d.removePairFromMap)(e,t.blockId))),{createFx:_,deleteFx:l,setUserId:t.setUserId,$myAudioPlaylistsIdentitiesMap:a}}({config:{domain:(0,a.createDomain)("global/audio/audioPage/myPlaylists"),name:"global/audio/audioPage/myPlaylists"},myAudioPlaylistsService:(0,_.ensureMyAudioPlaylistsService)()})),{version:1})},785410:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPageMyAudioPlaylistsService:()=>a.ensureAudioPageMyAudioPlaylistsService});var a=s(267009)},427187:(e,t,s)=>{"use strict";s.d(t,{createAudioPageService:()=>L});var a=s(746573),n=s(586049),r=s(478455),d=s(97295),_=s(35215),l=s(468073),u=s(205337),c=s(815733),p=s(761178),m=s(32489),y=s(270935),g=s(459899),f=s(898848),E=s(909436),A=s(138586),P=s(270959),b=s(866467),I=s(593159),T=s(683234),C=s(983567),O=s(761520),M=s(261472),S=s(322100),D=s(873900),k=s(540462);function L(e){const t=(0,k.partConfigEnabled)("enabled_mm_and_dislikes_mobx_services"),s=(0,a.getEffectorServiceDomain)(e),l=g.AudioPageProxy.ensure(),u=(0,S.ensureMyMusicService)(),L=(0,p.ensureAudioDislikesInMyMusicWebService)(),U=(0,c.ensureGroupsAudioMusicWebService)(),N=s.createEvent(),W=(0,m.restore)(N,null),{$fullIdsMap:V,fullIdsMapApi:K}=(0,n.createFullIdsMap)(s),{$fullIdsMap:H,fullIdsMapApi:j}=(0,n.createFullIdsMap)(s),{$deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:$,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMapApi:G}=(0,M.createDeleteAudiosFromMyMusicForLastWeekDataIdentities)(s),q=s.createEffect((({audioEl:e,inProgress:t})=>{e&&(e.dataset["in-progress"]=(0,f.intval)(t).toString())})),Y=s.createEffect((({elements:e,inProgress:t,state:s})=>{e.forEach((e=>{if(!e)return;q({audioEl:e,inProgress:t});const a=Boolean(e.closest(".CatalogBlock__group_audios")),n=Boolean(e.closest(".CatalogBlock__my_audios_block")||e.closest(".CatalogBlock__my_audios")||a);switch(s){case"added":return void(n?a?(e.classList.add("audio_row__added"),E.AudioUtils.onRowOver(e,!1,!1)):(e.classList.remove("audio_row__deleted"),E.AudioUtils.onRowOver(e,!1,!0)):(e.classList.add("audio_row__added"),E.AudioUtils.onRowOver(e,!1,!1)));case"deleted":return void(n&&!a?(e.classList.add("audio_row__deleted"),E.AudioUtils.onRowOver(e,!1,!0)):(e.classList.remove("audio_row__added"),E.AudioUtils.onRowOver(e,!1,!1)));default:return}}))})),z=(0,m.attach)({source:(0,m.combine)({myMusicIdentitiesMap:L.$myMusicIdentitiesMap,myMusicInitializedIdentitiesMap:L.$myMusicInitializedIdentitiesMap,deletedFromMyMusicAudiosIdentitiesMap:V,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:$}),async effect({myMusicIdentitiesMap:e,myMusicInitializedIdentitiesMap:t,deletedFromMyMusicAudiosIdentitiesMap:s,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:a},{audio:n,audioEl:d,playlist:_,audioRef:u}){if(!n)throw new Error("Audio not exists");const c=(0,r.getAudioFullId)(n),p=(0,y.isMy)({identity:n,myMusicIdentitiesMap:e,isMyMusicActionInitialized:c in t,userId:window.vk.id});try{p?await L.deleteFromMyMusicFx({audioEl:d,audio:n,audioRef:u,needReloadTrackCode:!0}):(_&&l.onUserAction(n,_),await L.addToMyMusicFx({audioEl:d,audio:n,audioRef:u,isNotificationDisabled:!0,needReloadTrackCode:!0}),p?K.add(c):(c in s&&K.remove(c),c in a&&G.remove(c)),!p&&c in s?K.remove(c):p&&K.add(c))}catch(e){throw new Error(`${p?'Failed to delete audio from "My Music"':'Failed to add audio to "My music"'}`,{cause:e})}}}),X=(0,m.attach)({source:U.$identitiesMap,async effect(e,{audioEl:t,audio:s,groupId:a,playlist:n}){if(!s)throw new Error("Audio not exists");const r=(0,c.isAddedToGroup)({identity:s,groupsMusicIdentitiesMap:e,groupId:a});try{r?await U.deleteFx({audioEl:t,groupId:a,audio:s}):(n&&l.onUserAction(s,n),await U.addFx({audioEl:t,groupId:a,audio:s}),j.remove((0,d.getGroupAudioFullId)(s,a)))}catch(e){throw new Error(`${r?"Failed to delete audio from group with id":"Failed to add audio to group with id"} ${a}`,{cause:e})}}}),Q=(0,m.attach)({source:W,async effect(e,{audioEl:t,audio:s,audioRef:a=""}){if(!B(e))return window.vk&&window.vk.widget&&window.Widgets?void window.Widgets.oauth():void console.error("The user is not authorized, it is impossible to add or delete audio");if(window.cur.viewAsBox)return void window.cur.viewAsBox();if(x(t))return;const n=s||E.AudioUtils.getAudioFromEl(t,!0);if(!n)throw new Error("Audio not exists");const r=l.currentPlaylist,d=R(l),u=(0,_.isNumber)(d),c=u&&t&&!t.classList.contains("audio_row__deleted")&&Boolean(t.closest(".CatalogBlock__group_audios"));!u||c?await z({audioEl:t,audio:n,playlist:r,audioRef:a}):await X({audioEl:t,audio:n,groupId:d,playlist:r})}}),J=(0,m.attach)({source:$,async effect(e,{audioEl:t,audio:s}){if(!s)throw new Error("Audio not exists");const a=(0,r.getAudioFullId)(s),n=e[a];if(!n)throw new Error("Audio is not ready to delete all audio from the last week in My Music");(0,P.showFastBox)({title:(0,b.getLang)("audio_delete_all_title"),onHide:()=>{q({audioEl:t,inProgress:!1})}},n.message||"",(0,b.getLang)("global_delete"),(function(e){let t=(0,I.extend)({act:"delete_all"},n.data);O.ajax.post("al_audio.php",t,{showProgress:()=>(0,T.lockButton)(e),onDone:function(){let e=(0,C.getAudioPlayer)().getPlaylist(A.AudioPlaylist.TYPE_PLAYLIST,n.data.from_id,A.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,C.getAudioPlayer)().deletePlaylist(e),K.remove(a),window.nav.reload()},onFail:()=>!0})}),(0,b.getLang)("global_cancel"))}}),Z=(0,m.attach)({source:(0,m.combine)({userId:W,myMusicInitializedIdentitiesMap:L.$myMusicInitializedIdentitiesMap,myMusicIdentitiesMap:L.$myMusicIdentitiesMap,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:$}),async effect({userId:e,myMusicIdentitiesMap:s,myMusicInitializedIdentitiesMap:a,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:n},{audio:u,audioEl:c}){if(!B(e))return void console.error("The user is not authorized, it is impossible to add or delete audio");if(!u)throw new Error("Audio not exists");if(x(c))return;window.tooltips&&window.tooltips.hideAll();const p=(0,r.getAudioFullId)(u);if(p in n)return void await J({audioEl:c,audio:u});const m=R(l),g=(0,_.isNumber)(m)&&u.ownerId===m;if(!(0,y.isMy)({identity:u,myMusicIdentitiesMap:s,isMyMusicActionInitialized:p in a,userId:e})&&!g)throw new Error("Audio not added");if(u.isClaimed&&c?.remove(),g)return await U.deleteFx({audioEl:c,groupId:m,audio:u,needShowDeletedAudioRowState:!0}),u.isClaimed&&E.AudioUtils.deleteDeletedAudios(),t||q({audioEl:c,inProgress:!1}),void j.add((0,d.getGroupAudioFullId)(u,m));const[f,A]=await O.ajax.promisifiedPost("al_audio.php",{act:"delete_audio",oid:u.ownerId,aid:u.id,hash:u.deleteHash,restore:1,track_code:u.trackCode});f&&G.add({audioFullId:p,value:{data:f,message:A||""}}),await L.deleteFromMyMusicFx({audio:u,audioEl:c,forceRemoveFromStoreParams:{oldIdentity:u,newIdentity:u}}),K.add(p),u.isClaimed&&E.AudioUtils.deleteDeletedAudios(),t||q({audioEl:c,inProgress:!1})}});return t&&u.restoreFx&&u.$sourcesMap?((0,m.sample)({clock:u.addFx,fn:({trackedIdentity:e})=>({elements:F(e),inProgress:!0,state:"added"}),target:Y}),(0,m.sample)({clock:u.addFx.done,fn:({params:{trackedIdentity:e}})=>({elements:F(e),inProgress:!1}),target:Y}),(0,m.sample)({clock:u.addFx.fail,source:u.$sourcesMap,fn:(e,{params:{trackedIdentity:t}})=>{const s=(0,D.getIdentityRawId)(t);return{elements:F(t).length?F(t):F(e[s]),inProgress:!0,state:"deleted"}},target:Y}),(0,m.sample)({clock:u.deleteFx,source:u.$sourcesMap,fn:(e,{identity:t})=>{const s=(0,D.getIdentityRawId)(t);return{elements:F(t).length?F(t):F(e[s]),inProgress:!0,state:"deleted"}},target:Y}),(0,m.sample)({clock:u.deleteFx.done,source:u.$sourcesMap,fn:(e,{params:{identity:t}})=>{const s=(0,D.getIdentityRawId)(t);return{elements:F(t).length?F(t):F(e[s]),inProgress:!1,state:"deleted"}},target:Y}),(0,m.sample)({clock:u.deleteFx.fail,fn:({params:{identity:e}})=>({elements:F(e),inProgress:!1,state:"added"}),target:Y}),(0,m.sample)({clock:u.restoreFx.done,fn:({params:{identity:e}})=>({elements:F(e),inProgress:!1,state:"added"}),target:Y}),(0,m.sample)({clock:u.restoreFx.fail,fn:({params:{identity:e}})=>({elements:F(e),inProgress:!1,state:"deleted"}),target:Y}),(0,m.sample)({clock:Z,fn:({audioEl:e})=>({elements:[e],inProgress:!0,state:"deleted"}),target:Y}),(0,m.sample)({clock:Z.done,fn:({params:{audioEl:e}})=>({elements:[e],inProgress:!1}),target:Y}),(0,m.sample)({clock:Z.fail,fn:({params:{audioEl:e}})=>({elements:[e],inProgress:!1,state:"added"}),target:Y})):((0,m.sample)({clock:[Q,Z],fn:({audioEl:e})=>({audioEl:e,inProgress:!0}),target:q}),(0,m.sample)({clock:Q.finally,fn:({params:{audioEl:e}})=>({audioEl:e,inProgress:!1}),target:q})),{$myMusicIdentitiesMap:L.$myMusicIdentitiesMap,$deletedFromMyMusicAudiosIdentitiesMap:V,$deletedFromGroupAudiosIdentitiesMap:H,$deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:$,toggleAddAudioFx:Q,deleteAudioLegacyFx:Z,setUserId:N}}function R(e){if(!(0,_.isNumber)(e.ownerId))return null;return Boolean(e.ownerId&&(0,_.isNumber)(e.ownerId)&&l.Ranges.isGroupId(e.ownerId)&&e.canAddToGroup)?(0,u.convertToGroupMusicId)(e.ownerId):null}function B(e){return(0,_.isNumber)(e)&&l.Ranges.isUserId(e)}function x(e){return Boolean(e?.dataset?.["in-progress"])}function F(e){return Array.from(document.querySelectorAll(`._audio_row_${(0,r.getAudioFullId)(e)}`))}},145855:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPageService:()=>d});var a=s(558137),n=s(32489),r=s(427187);const d=(0,a.makeSharedState)("global/audio/audioPage/service",(()=>(0,r.createAudioPageService)({domain:(0,n.createDomain)("global/audio/audioPage/service"),name:"global/audio/audioPage/service"})),{version:2})},261472:(e,t,s)=>{"use strict";s.d(t,{createDeleteAudiosFromMyMusicForLastWeekDataIdentities:()=>d});var a=s(32489),n=s(46201),r=s(786979);function d(e){const t=e.createStore({});return{$deleteAudiosFromMyMusicForLastWeekDataIdentitiesMap:t,deleteAudiosFromMyMusicForLastWeekDataIdentitiesMapApi:(0,a.createApi)(t,{add:(e,t)=>(0,n.addPairToMap)(e,{key:t.audioFullId,value:t.value}),remove:(e,t)=>(0,r.removePairFromMap)(e,t)})}}},655146:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPageMyAudioPlaylistsService:()=>a.ensureAudioPageMyAudioPlaylistsService,ensureAudioPageService:()=>n.ensureAudioPageService});var a=s(785410),n=s(145855)},43769:(e,t,s)=>{"use strict";s.d(t,{createAudioPlayerService:()=>m});var a=s(32489),n=s(983567),r=s(392358),d=s(596901),_=s(423015),l=s(746573),u=s(264874),c=s(749438),p=s(8520);function m(e){const t=(0,l.getEffectorServiceDomain)(e),s=t.createEvent(),m=()=>{const e=(0,n.getAudioPlayer)();if(!e)throw new Error("Audio player does not initialize");return e.getPlaylistQueue()??null},y=t.createEvent(),g=t.createEvent(),f=t.createEvent(),E=t.createEvent(),A=t.createEvent(),P=t.createEvent(),b=t.createEvent(),I=t.createEvent(),T=t.createEvent(),C=t.createEvent(),O=t.createEvent(),M=t.createEvent(),S=t.createEvent(),D=t.createEvent(),k=t.createEvent(),L=t.createEvent(),R=t.createEvent(),B=t.createEvent(),x=t.createEvent(),F=(0,a.restore)(y,null),U=t.createStore(null,{updateFilter:(e,t)=>!(0,p.isEqual)(e,t)}),N=U.map((e=>e&&(0,_.audioTupleToAudioObject)(e)||null)),W=(0,a.restore)(g,!1),V=(0,a.restore)(C,!1),K=(0,a.restore)(O,null),H=(0,a.restore)(f,null),j=(0,a.restore)(A,0),$=(0,a.restore)(P,0),G=(0,a.restore)(b,0),q=(0,a.restore)(I,0),Y=(0,a.restore)(T,1),z=(0,a.restore)(M,!1),X=(0,a.restore)(S,!1),Q=(0,a.restore)(D,!1),J=(0,a.restore)(k,!1),Z=(0,a.restore)(L,!1),ee=t.createEffect((()=>{const e=(0,n.getAudioPlayer)();if(!e)throw new Error("Audio player does not initialize");g(e.isPlaying()),C(e.ads.isActive||!1),O(e.ads.getCurrentAd()||null),f(e.getCurrentPlaylist()||null),E(e.getCurrentAudio()||null),A(e.getCurrentProgress()??0),P(0),b(e.getCurrentBuffered()??0),I(e.getVolume()||0),T(d.AudioPlayer.podcastGetPlaybackRate()||1),M(Boolean(d.AudioPlayer.getDurationType())),S(Boolean(m()?.shuffled)),D(Boolean(e.isRepeatCurrentAudio())),k(Boolean(e.isRepeatAll())),e.subscribe(r.AudioPlayerEventType.PLAYER_IS_PLAYING_CHANGED,(e=>{g(e)})),e.subscribe(r.AudioPlayerEventType.PLAYLIST_CHANGED,(()=>{f(e.getCurrentPlaylist()||null)})),e.on(this,r.AudioPlayerEventType.PLAYLIST_CLEAR_REQUESTED,(()=>{B()})),e.on(this,r.AudioPlayerEventType.PLAYLIST_CLEARED,(()=>{f(e.getCurrentPlaylist()||null),M(Boolean(d.AudioPlayer.getDurationType())),S(m()?.shuffled??!1),T(d.AudioPlayer.podcastGetPlaybackRate()||1),D(Boolean(e.isRepeatCurrentAudio())),k(Boolean(e.isRepeatAll()))})),e.subscribe(this,r.AudioPlayerEventType.PLAYER_IS_AD_CHANGED,(t=>{C(t||!1),O(e.ads.getCurrentAd()||null)})),e.on(this,[r.AudioPlayerEventType.AD_STARTED,r.AudioPlayerEventType.AD_READY,r.AudioPlayerEventType.AD_DEINITED,r.AudioPlayerEventType.AD_COMPLETED],(()=>{C(e.ads.isActive||!1),O(e.ads.getCurrentAd()||null)})),e.on(this,[r.AudioPlayerEventType.PLAY,r.AudioPlayerEventType.PLAY_REQUESTED],(()=>{R()})),e.on(this,[r.AudioPlayerEventType.PLAY,r.AudioPlayerEventType.PLAY_REQUESTED,r.AudioPlayerEventType.CURRENT_RADIOSTATION_FOLLOW_STATUS_UPDATE,r.AudioPlayerEventType.CURRENT_AUDIO_DISLIKE_STATUS_UPDATE,r.AudioPlayerEventType.PLAYLIST_CLEARED,r.AudioPlayerEventType.CURRENT_CHANGED,r.AudioPlayerEventType.UPDATE],(e=>{E(e||null)})),e.subscribe(r.AudioPlayerEventType.CURRENT_RADIOSTATION_FOLLOW_STATUS_UPDATE,(e=>{x(e)})),e.subscribe(r.AudioPlayerEventType.CURRENT_CHANGED,(()=>{A(0)})),e.subscribe(r.AudioPlayerEventType.PROGRESS,((t,s)=>{L(!1),A(e.ads?.isActive?e.ads.getCurrentProgress():t),P(s)})),e.subscribe(r.AudioPlayerEventType.BUFFERED,(t=>{b(e.ads?.isActive?0:t)})),e.subscribe(r.AudioPlayerEventType.VOLUME,(e=>{I(e)})),e.on(this,r.AudioPlayerEventType.UPDATE,(()=>{M(Boolean(d.AudioPlayer.getDurationType()))})),e.on(this,r.AudioPlayerEventType.START_LOADING,(()=>{L(!0)})),e.on(this,r.AudioPlayerEventType.CAN_PLAY,(()=>{L(!1)})),e.on(this,r.AudioPlayerEventType.ENDED,(()=>{L(!1)})),e.on(this,r.AudioPlayerEventType.FAILED,(()=>{L(!1)})),y(e)})),te=(0,c.attachPlayer)(F,(async(e,t)=>{if(!t)return void e.playAudioItem();const{audio:s,playlist:a,context:n,byPlayerButton:r=!1}=t;e[r?"playByButton":"playAudioItem"].bind(e)({audio:s,playlist:a,context:n})})),ie=(0,c.attachPlayer)(F,((e,t)=>{if(!t)return void e.pauseByButton();const{byChangeChannel:s=!1}=t;e[s?"pauseByChangeChannel":"pauseByButton"].bind(e)()})),oe=(0,c.attachPlayer)(F,(e=>{e.resume()})),se=(0,c.attachPlayer)(F,(e=>{e.playNext()})),ae=(0,c.attachPlayer)(F,(e=>{e.playPrev()})),ne=(0,c.attachPlayer)(F,(e=>{e.playNextByButton()})),re=(0,c.attachPlayer)(F,(e=>{e.playPrevByButton()})),de=(0,c.attachPlayer)(F,((e,{audioEl:t,audio:s})=>{e.setNext(t,s)})),_e=(0,c.attachPlayer)(F,((e,t)=>{e.seek(t)})),le=(0,c.attachPlayer)(F,((e,t)=>{e.seekBySlider(t)})),ue=(0,c.attachPlayer)(F,((e,t)=>{e.setVolume(t)})),ce=(0,c.attachPlayer)(F,(e=>{e.toggleDurationType()})),pe=t.createEffect((()=>{S(m()?.shuffled??!1)})),he=(0,c.attachPlayer)(F,(e=>{e.toggleRepeatCurrentAudio(),D(Boolean(e.isRepeatCurrentAudio())),k(Boolean(e.isRepeatAll()))})),me=(0,c.attachPlayer)(F,(e=>{e.toggleRepeatAll(),D(Boolean(e.isRepeatCurrentAudio())),k(Boolean(e.isRepeatAll()))})),ye=(0,a.attach)({source:(0,a.combine)({ap:F,prevSpeed:Y}),effect({ap:e,prevSpeed:t},s){if(!e)throw new Error("Audio player does not initialize");t!==s&&(e.podcastChangePlaybackRate(1!==s&&s<t),T(d.AudioPlayer.podcastGetPlaybackRate()??1))}}),ge=(0,c.attachPlayer)(F,(e=>e.getCurrentPlaylist()??null)),fe=(0,c.attachPlayer)(F,((e,{audio:t,actionType:s,ref:a="",refEl:n=null})=>{e.podcastSetActionRef(t,s,a,n)})),Ee=(0,c.attachPlayer)(F,((e,{audioFullId:t,hasDislike:s})=>{e.updateAudioDislikeStatus(t,s)})),ve=(0,c.attachPlayer)(F,((e,t)=>e?.emitter?.emit(t.eventName,t.data))),Ae=(0,c.attachPlayer)(F,((e,{eventType:t,params:s})=>e.notify(t,...s)));return(0,a.sample)({clock:(0,u.once)(s),target:ee}),(0,a.sample)({clock:E,target:U}),{$isPlaying:W,$isAd:V,$currentAd:K,$currentPlaylist:H,$currentAudio:N,$currentAudioTuple:U,$progress:j,$duration:$,$loadingProgress:G,$volume:q,$negativeDurationTypeEnabled:z,$isShuffled:X,$isRepeatCurrentAudio:Q,$isRepeatAll:J,$playbackSpeed:Y,$isPending:Z,playFx:te,pauseFx:ie,resumeFx:oe,playNextFx:se,playPrevFx:ae,playNextByButtonFx:ne,playPrevByButtonFx:re,setNextFx:de,seekFx:_e,seekBySliderFx:le,updateVolumeFx:ue,toggleNegativeDurationTypeFx:ce,updatedIsShuffledFx:pe,toggleRepeatCurrentAudioFx:he,toggleRepeatAllFx:me,updatePlaybackSpeedFx:ye,getCurrentPlaylistFx:ge,podcastSetActionRefFx:fe,updateAudioDislikeStatusFx:Ee,emitFx:ve,notifyFx:Ae,notifyAudioStartedPlaying:R,notifyPlaylistClearRequested:B,notifyCurrentRadioStationFollowStatusUpdate:x,init:s,getCurrentAudio:()=>{const e=(0,n.getAudioPlayer)();if(!e)throw new Error("Audio player does not initialize");const t=e.getCurrentAudio();return t?(0,_.audioTupleToAudioObject)(t):null},getPlaylistQueue:m,getPlaylist:({type:e,ownerId:t,albumId:s,accessHash:a,blockId:r})=>{const d=(0,n.getAudioPlayer)();if(!d)throw new Error("Audio player does not initialize");return d.getPlaylist(e,t,s,a,r)||null}}}},803111:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerPodcastActionType:()=>d.AudioPlayerPodcastActionType,ensureAudioPlayerService:()=>_});var a=s(558137),n=s(32489),r=s(43769),d=s(807346);const _=(0,a.makeSharedState)("global/web/audio/player",(()=>(0,r.createAudioPlayerService)({domain:(0,n.createDomain)("global/web/audio/player"),name:"audio/web/audio/player"})),{version:3})},749438:(e,t,s)=>{"use strict";s.d(t,{attachPlayer:()=>n});var a=s(32489);function n(e,t){return(0,a.attach)({source:e,effect(e,s){if(!e)throw new Error("Audio player does not initialize");return t(e,s)}})}},807346:(e,t,s)=>{"use strict";s.d(t,{AudioPlayerPodcastActionType:()=>a});var a,n=s(390578);!function(e){e[e.Play=n.ACTION_PLAY]="Play",e[e.Pause=n.ACTION_PAUSE]="Pause",e[e.Seek=n.ACTION_SEEK]="Seek",e[e.TimeMaker=n.ACTION_TIME_MARKER]="TimeMaker",e[e.Heartbeat=n.ACTION_HEARTBEAT]="Heartbeat"}(a||(a={}))},829071:(e,t,s)=>{"use strict";s.d(t,{createAudioPodcastsFaveAdapter:()=>d});var a=s(20085),n=s(746573),r=s(586049);function d(e,t){const s=(0,n.getEffectorServiceDomain)(e),d=s.createEffect((async e=>{await t.activate(c(e.identity))})),_=s.createEffect((async e=>{await t.deactivate(c(e.identity))})),{fullIdsMapApi:l,$fullIdsMap:u}=(0,r.createFullIdsMap)(s);function c(e){return new a.PodcastAudioIdentity(e)}return t.events.on("activated",(({identity:e})=>{const{fullId:t}=c(e);l.add(t)})),t.events.on("deactivate",(({identity:e})=>{const{fullId:t}=c(e);l.remove(t)})),{$identitiesMap:u,deleteFx:_,addFx:d}}},767072:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPodcastsFavoritesService:()=>c});var a=s(32489),n=s(558137),r=s(425354),d=s(540462),_=s(319756),l=s(560756),u=s(829071);const c=(0,n.makeSharedState)("global/audio/podcasts/favoritesService",(()=>(0,d.partConfigEnabled)("podcast_episode_favorites_service_mobx_web")?(0,u.createAudioPodcastsFaveAdapter)({domain:(0,a.createDomain)("global/audio/podcasts/favoritesService"),name:"global/audio/podcasts/favoritesService"},(0,_.ensureDIRootWebContainer)().resolve(r.PodcastEpisodeFavoritesService)):(0,l.ensureAudioPodcastsFaveService)()),{version:1})},706226:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPodcastsFavoritesService:()=>a.ensureAudioPodcastsFavoritesService});var a=s(767072)},58808:(e,t,s)=>{"use strict";s.d(t,{audioPreviewsService:()=>a});const a=(0,s(983327).ensureAudioPreviewsService)()},943503:(e,t,s)=>{"use strict";s.d(t,{createGroupsMusicWebService:()=>E});var a=s(746573),n=s(586049),r=s(478455),d=s(97295),_=s(32489),l=s(641633),u=s(71696),c=s(803111),p=s(392358),m=s(138586),y=s(909436),g=s(322100),f=s(540462);function E(e){const t=(0,f.partConfigEnabled)("enabled_groups_mobx_service"),s=(0,a.getEffectorServiceDomain)(e),E=(0,g.ensureGroupsMusicService)(),A=(0,c.ensureAudioPlayerService)(),{$fullIdsMap:P,fullIdsMapApi:b}=(0,n.createFullIdsMap)(s),I=(0,_.attach)({source:(0,_.combine)({groupsMusicIdentitiesMap:E.$identitiesMap}),async effect({groupsMusicIdentitiesMap:e},{audio:s,groupId:a,audioEl:n=null}){if(!s)throw new Error("Audio not exists");if((0,l.isAddedToGroup)({identity:s,groupsMusicIdentitiesMap:e,groupId:a}))throw new Error(`Audio already in group with id ${a}`);const d=(0,r.getAudioFullId)(s);let _=document.querySelector(`._audio_row_${d}`);_=_==n?null:_;try{a!==s.ownerId&&n&&n.classList.add("audio_row__added"),a!==s.ownerId&&_&&_.classList.add("audio_row__added"),A.notifyFx({eventType:p.AudioPlayerEventType.ADDED,params:[d]}),a===s.ownerId&&E.restoreFx&&t?await E.restoreFx({groupId:a,trackedIdentity:s}):await E.addFx({groupId:a,trackedIdentity:s}),n&&(n.classList.remove("audio_row__deleted"),y.AudioUtils.onRowOver(n,!1,!0)),_&&(_.classList.remove("audio_row__deleted"),y.AudioUtils.onRowOver(_,!1,!0)),A.notifyFx({eventType:p.AudioPlayerEventType.MUSIC_AUDIOS_ADD,params:[s,Boolean(n)&&{audioElement:n}]})}catch(e){throw a!==s.ownerId&&n&&n.classList.remove("audio_row__added"),a!==s.ownerId&&_&&_.classList.remove("audio_row__added"),new Error(`Failed to add audio to group with id ${a}`,{cause:e})}}}),T=(0,_.attach)({source:(0,_.combine)({groupsMusicIdentitiesMap:E.$identitiesMap}),async effect({groupsMusicIdentitiesMap:e},{audio:t,groupId:s,audioEl:a=null,needShowDeletedAudioRowState:n}){if(!t)throw new Error("Audio not exists");const _=(0,d.getGroupAudioFullId)(t,s),l=(0,u.isGroupAudio)({identity:t,groupsMusicIdentitiesMap:e,groupId:s}),c=e[_];if(!l&&!c)throw new Error(`Audio not found in group with id ${s}`);const g=(0,r.getAudioFullId)(t),f=(0,r.getAudioFullId)(c??t);let P=document.querySelector(`._audio_row_${g}`);P=P==a?null:P;try{a&&!n&&a.classList.remove("audio_row__added"),P&&!n&&P.classList.remove("audio_row__added"),A.notifyFx({eventType:p.AudioPlayerEventType.REMOVED,params:[g,f]}),await E.deleteFx({groupId:s,audioId:c?c.id:t.id}),a&&n&&(a.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(a,!1,!0),a.classList.remove("audio_row__added")),P&&n&&(P.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(P,!1,!0),P.classList.remove("audio_row__added"));const e=A.getPlaylist({type:m.AudioPlaylist.TYPE_PLAYLIST,ownerId:s,albumId:m.AudioPlaylist.DEFAULT_PLAYLIST_ID});e&&e.removeAudio(f),A.notifyFx({eventType:p.AudioPlayerEventType.MUSIC_AUDIOS_DELETE,params:[t,Boolean(a)&&{audioElement:a}]})}catch(e){throw a&&a.classList.add("audio_row__added"),a&&n&&(a.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(a,!1,!0)),P&&P.classList.add("audio_row__added"),P&&n&&(P.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(P,!1,!0)),new Error(`Failed to delete audio from group with id ${s}`,{cause:e})}}});return(0,_.sample)({clock:[I,T],filter:({audio:e})=>Boolean(e),fn:({audio:e,groupId:t})=>(0,d.getGroupAudioFullId)(e,t),target:b.add}),(0,_.sample)({clock:[I.finally,T.finally],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e,groupId:t}})=>(0,d.getGroupAudioFullId)(e,t),target:b.remove}),{$loadingIdentitiesMap:P,$identitiesMap:E.$identitiesMap,addFx:I,deleteFx:T}}},815733:(e,t,s)=>{"use strict";s.d(t,{ensureGroupsAudioMusicWebService:()=>_,isAddedToGroup:()=>d.isAddedToGroup});var a=s(558137),n=s(32489),r=s(943503),d=s(641633);const _=(0,a.makeSharedState)("global/web/audio/groupsMusic",(()=>(0,r.createGroupsMusicWebService)({domain:(0,n.createDomain)("global/web/audio/groupsMusic"),name:"global/web/audio/groupsMusic"})),{version:3})},641633:(e,t,s)=>{"use strict";s.d(t,{isAddedToGroup:()=>r});var a=s(35215),n=s(97295);function r({identity:e,groupsMusicIdentitiesMap:t,groupId:s}){if(!e||!(0,a.isNumber)(s))return!1;return(0,n.getGroupAudioFullId)(e,s)in t}},71696:(e,t,s)=>{"use strict";s.d(t,{isGroupAudio:()=>d});var a=s(35215),n=s(205337),r=s(641633);function d({identity:e,groupsMusicIdentitiesMap:t,groupId:s}){return!(!e||!(0,a.isNumber)(s))&&(e.ownerId===(0,n.convertToGroupMusicId)(s)||(0,r.isAddedToGroup)({identity:e,groupsMusicIdentitiesMap:t,groupId:s}))}},995022:(e,t,s)=>{"use strict";s.d(t,{createMusicAudioMyDislikesService:()=>d});var a=s(478455),n=s(32489),r=s(761178);function d({domain:e,$audio:t,$audioEl:s}){const d=(0,r.ensureAudioDislikesInMyMusicWebService)(),_=s??e.createStore(null),l=t.map((e=>e&&e.id&&e.ownerId?{id:e.id,ownerId:e.ownerId,trackCode:e.trackCode}:null)),u=(0,n.combine)({identity:l,fullIdsMap:d.$dislikesInitializedIdentitiesMap}).map((({identity:e,fullIdsMap:t})=>Boolean(e&&t[(0,a.getAudioFullId)(e)])));return{$isAudioDisliked:(0,n.combine)({audio:t,myAudioDislikesIdentitiesMap:d.$dislikesIdentitiesMap,isDislikeActionInitialized:u}).map((({audio:e,myAudioDislikesIdentitiesMap:t,isDislikeActionInitialized:s})=>(0,r.hasDislike)({audio:e,dislikesIdentitiesMap:t,isDislikeActionInitialized:s}))),$isDislikeActionLoading:(0,n.combine)({identity:l,fullIdsMap:d.$dislikesLoadingIdentitiesMap}).map((({identity:e,fullIdsMap:t})=>Boolean(e&&t[(0,a.getAudioFullId)(e)]))),addFx:(0,n.attach)({source:(0,n.combine)({audio:t,audioEl:_}),async effect({audio:e,audioEl:t},s){await d.addDislikeFx({audio:e,audioEl:t,skipDeletionAudioFromMyMusic:s?.skipDeletionAudioFromMyMusic,needReloadTrackCode:s?.needReloadTrackCode})}}),removeFx:(0,n.attach)({source:(0,n.combine)({audio:t,audioEl:_}),async effect({audio:e,audioEl:t},s){await d.removeDislikeFx({audio:e,audioEl:t,needReloadTrackCode:s?.needReloadTrackCode})}})}}},674522:(e,t,s)=>{"use strict";s.d(t,{createMusicAudioMyDislikesService:()=>a.createMusicAudioMyDislikesService});var a=s(995022)},477227:(e,t,s)=>{"use strict";s.d(t,{createMyMusicWebService:()=>T});var a=s(746573),n=s(586049),r=s(478455),d=s(584053),_=s(32489),l=s(803111),u=s(392358),c=s(678531),p=s(432582),m=s(138586),y=s(909436),g=s(752740),f=s(972623),E=s(169818),A=s(518051),P=s(322100),b=s(540462),I=s(395654);function T(e){const t=(0,b.partConfigEnabled)("enabled_mm_and_dislikes_mobx_services"),s=(0,a.getEffectorServiceDomain)(e),E=(0,P.ensureMyMusicService)(),A=(0,l.ensureAudioPlayerService)(),T=new d.Emitter,{$fullIdsMap:O,fullIdsMapApi:M}=(0,n.createFullIdsMap)(s),{$fullIdsMap:S,fullIdsMapApi:D}=(0,n.createFullIdsMap)(s),k=(0,_.attach)({source:(0,_.combine)({myMusicIdentitiesMap:E.$identitiesMap,initializedIdentitiesMap:O}),async effect({myMusicIdentitiesMap:e,initializedIdentitiesMap:s},{audio:a,audioEl:n=null,isNotificationDisabled:d,forceAddToStoreParams:_,needReloadTrackCode:l,audioRef:m}){if(!a)throw new Error("Audio not exist");const g=Boolean(s[(0,r.getAudioFullId)(a)]);if((0,c.isMy)({identity:a,myMusicIdentitiesMap:e,isMyMusicActionInitialized:g,userId:window.vk.id}))throw new Error('Audio already in "My Music"');const f=(0,r.getAudioFullId)(a);let P=document.querySelector(`._audio_row_${f}`);P=P==n?null:P;let b=!1,O=!1;try{t||(n&&(n.closest(".CatalogBlock__my_audios_block")||n.closest(".CatalogBlock__my_audios"))&&(b=!0),P&&(P.closest(".CatalogBlock__my_audios_block")||P.closest(".CatalogBlock__my_audios"))&&(O=!0),n&&!b&&n.classList.add("audio_row__added"),P&&!O&&P.classList.add("audio_row__added")),A.notifyFx({eventType:u.AudioPlayerEventType.ADDED,params:[f]});let e=a.trackCode;const s=a.context;if(l){const t=await C(a,n,m);t&&(e=t)}const r=async()=>{_?E.addToStore(_):await E.addFx({userId:window.vk.id,trackedIdentity:{...a,ref:s,trackCode:e}})};t&&E.isOwned?E.isOwned((0,I.toMusicAudioIdentity)(a))&&E.restoreFx?await E.restoreFx({identity:a}):await r():_?E.addToStore(_):await r(),t||(n&&b&&(n.classList.remove("audio_row__deleted"),y.AudioUtils.onRowOver(n,!1,!0)),P&&O&&(P.classList.remove("audio_row__deleted"),y.AudioUtils.onRowOver(P,!1,!0))),d||T.emit(p.MyMusicWebServiceEventType.AudioAddedToMyMusic),A.notifyFx({eventType:u.AudioPlayerEventType.MUSIC_AUDIOS_ADD,params:[a,Boolean(n)&&{audioElement:n}]})}catch(e){throw t||(n&&(n.classList.remove("audio_row__added"),b&&(n.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(n,!1,!0))),P&&(P.classList.remove("audio_row__added"),O&&(P.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(n,!1,!0)))),new Error('Failed to add audio to "My Music"',{cause:e})}}}),L=(0,_.attach)({source:(0,_.combine)({myMusicIdentitiesMap:E.$identitiesMap,initializedIdentitiesMap:O}),async effect({myMusicIdentitiesMap:e,initializedIdentitiesMap:s},{audio:a,audioEl:n=null,forceRemoveFromStoreParams:d,audioRef:_,needReloadTrackCode:l}){if(!a)throw new Error("Audio not exist");const p=(0,r.getAudioFullId)(a),P=Boolean(s[p]),b=(0,c.isMy)({identity:a,myMusicIdentitiesMap:e,isMyMusicActionInitialized:P,userId:window.vk.id}),I=e[p];if(!b&&!I)throw new Error('Audio not found in "My Music"');let T=document.querySelector(`._audio_row_${p}`);T=T==n?null:T;let O=!1,M=!1;t||(n&&(n.closest(".CatalogBlock__my_audios_block")||n.closest(".CatalogBlock__my_audios"))&&(O=!0),T&&(T.closest(".CatalogBlock__my_audios_block")||T.closest(".CatalogBlock__my_audios"))&&(M=!0));const S=(0,r.getAudioFullId)(I??a);try{t||(n&&n.classList.remove("audio_row__added"),T&&T.classList.remove("audio_row__added")),A.notifyFx({eventType:u.AudioPlayerEventType.REMOVED,params:[p,S]}),d?E.removeFromStore(d):await E.deleteFx({identity:I??a}),l?C(a,n,_).then((e=>{(0,g.onAdditionalEvent)(n,a,{type:f.TYPE_REMOVED,trackCode:e||a.trackCode})})):(0,g.onAdditionalEvent)(n,a,{type:f.TYPE_REMOVED,trackCode:a.trackCode}),t||(n&&O&&(n.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(n,!1,!0)),T&&M&&(T.classList.add("audio_row__deleted"),y.AudioUtils.onRowOver(T,!1,!0)));const e=A.getPlaylist({type:m.AudioPlaylist.TYPE_PLAYLIST,ownerId:window.vk.id,albumId:m.AudioPlaylist.DEFAULT_PLAYLIST_ID});e&&e.removeAudio(S),A.notifyFx({eventType:u.AudioPlayerEventType.MUSIC_AUDIOS_DELETE,params:[a,Boolean(n)&&{audioElement:n}]})}catch(e){throw t||(n&&(O?(n.classList.remove("audio_row__deleted"),y.AudioUtils.onRowOver(n,!1,!0)):n.classList.add("audio_row__added")),T&&(M?(T.classList.remove("audio_row__deleted"),y.AudioUtils.onRowOver(n,!1,!0)):T.classList.add("audio_row__added"))),new Error('Failed to delete audio from "My Music"',{cause:e})}}});return(0,_.sample)({clock:[k.done,L.done],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:M.add}),(0,_.sample)({clock:[k,L],filter:({audio:e})=>Boolean(e),fn:({audio:e})=>(0,r.getAudioFullId)(e),target:D.add}),(0,_.sample)({clock:[k.finally,L.finally],filter:({params:{audio:e}})=>Boolean(e),fn:({params:{audio:e}})=>(0,r.getAudioFullId)(e),target:D.remove}),{$initializedIdentitiesMap:O,$loadingIdentitiesMap:S,$identitiesMap:E.$identitiesMap,addFx:k,deleteFx:L,events:T.listenable,restoreFx:E.restoreFx,isOwned:E.isOwned}}async function C(e,t,s){const a=(0,A.getContextPlaylist)(t)??{context:s,playlist:null};return await(0,E.getAudioTrackCodeFromPlaylist)(a?.playlist,e)??null}},432582:(e,t,s)=>{"use strict";var a;s.d(t,{MyMusicWebServiceEventType:()=>a}),function(e){e.AudioAddedToMyMusic="audioAddedToMyMusic"}(a||(a={}))},270935:(e,t,s)=>{"use strict";s.d(t,{ensureMyAudioMusicWebService:()=>_,isMy:()=>d.isMy});var a=s(558137),n=s(32489),r=s(477227),d=s(678531);const _=(0,a.makeSharedState)("global/web/audio/myMusic",(()=>(0,r.createMyMusicWebService)({domain:(0,n.createDomain)("global/web/audio/myMusic"),name:"global/web/audio/myMusic"})),{version:3})},678531:(e,t,s)=>{"use strict";s.d(t,{isMy:()=>n});var a=s(478455);function n({identity:e,myMusicIdentitiesMap:t,isMyMusicActionInitialized:s,userId:n}){if(!e)return!1;return(0,a.getAudioFullId)(e)in t||!s&&e.ownerId===n}},41523:(e,t,s)=>{"use strict";s.d(t,{RadiostationStatCollector:()=>_});var a=s(558137),n=s(317216),r=s(314309),d=s(847154);class _{constructor(){this.logAddAudioToMyMusic=e=>{this.actionCollector.logEvent({type:n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM,[n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM]:{tap_event:{action:n.EventItemType.AUDIO_RADIOSTATION_FOLLOW,from_player:!1},event:{nav_info:{track_code:e?.navInfo},source_info:{track_code:e?.sourceInfo},...l(e)}}})},this.logDeleteAudioFromMyMusic=e=>{this.actionCollector.logEvent({type:n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM,[n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM]:{tap_event:{action:n.EventItemType.AUDIO_RADIOSTATION_UNFOLLOW,from_player:!1},event:{nav_info:{track_code:e?.navInfo},source_info:{track_code:e?.sourceInfo},...l(e)}}})},this.logAddAudioToMyMusicInFullList=e=>{this.actionCollector.logEvent({type:n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM,[n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM]:{tap_event:{action:n.EventItemType.AUDIO_RADIOSTATION_FOLLOW,from_player:!1},event:{nav_info:{track_code:e?.sourceInfo},...l(e)}}})},this.logDeleteAudioFromMyMusicInFullList=e=>{this.actionCollector.logEvent({type:n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM,[n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM]:{tap_event:{action:n.EventItemType.AUDIO_RADIOSTATION_UNFOLLOW,from_player:!1},event:{nav_info:{track_code:e?.sourceInfo},...l(e)}}})},this.logAddAudioToMyMusicInFollowed=e=>{this.actionCollector.logEvent({type:n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM,[n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM]:{tap_event:{action:n.EventItemType.AUDIO_RADIOSTATION_FOLLOW,from_player:!1},event:{nav_info:{track_code:e?.sourceInfo},source_info:{track_code:e?.sourceInfo},...l(e)}}})},this.logDeleteAudioFromMyMusicInFollowed=e=>{this.actionCollector.logEvent({type:n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM,[n.ActionProductionStatEventTypes.TYPE_AUDIO_TAP_EVENT_ITEM]:{tap_event:{action:n.EventItemType.AUDIO_RADIOSTATION_UNFOLLOW,from_player:!1},event:{nav_info:{track_code:e?.sourceInfo},source_info:{track_code:e?.sourceInfo},...l(e)}}})},this.logClickGoto=e=>{const t={type:n.ClickProductionStatEventTypes.TYPE_AUDIO_TAP_GOTO_EVENT_ITEM,[n.ClickProductionStatEventTypes.TYPE_AUDIO_TAP_GOTO_EVENT_ITEM]:{...u(e)}};this.clickCollector.logEvent(t,{type:n.EventItemType.MUSIC_AUDIO})},this.logNavigationEventsRadiostations=e=>{const t={screen:"audio_catalog",screen_to:"audio_catalog",subtype:n.NavigationProductionStatEventTypes.GO,item:{type:n.EventItemType.CATALOG_ITEM,track_code:e.item},destination_item:{type:n.EventItemType.CATALOG_ITEM,track_code:e.destinationItem},type:n.NavigationProductionStatEventTypes.TYPE_AUDIO_DOMAIN_EVENT_ITEM,[n.NavigationProductionStatEventTypes.TYPE_AUDIO_DOMAIN_EVENT_ITEM]:{client_server_time:(0,d.getClientServerTime)((0,d.getClientTime)())}};this.navigationCollector.logEvent(t)},this.productCollector=new r.ProductionStatCollector,this.actionCollector=new r.ActionStatCollector(this.productCollector),this.clickCollector=new r.ClickStatCollector(this.productCollector),this.navigationCollector=new r.NavigationStatCollector(this.productCollector)}}function l(e){return{client_server_time:(0,d.getClientServerTime)((0,d.getClientTime)()),entities:[{type:"radio",id:e.radioStationId}],pos_ids:[e.radioPositionIndex]}}function u(e){return{event:{client_server_time:(0,d.getClientServerTime)((0,d.getClientTime)()),nav_info:{track_code:e?.navInfo},source_info:{track_code:e?.sourceInfo}},target_nav_info:{url:e?.targetInfo}}}_.ensure=(0,a.makeSharedState)("RadioStatCollector",(()=>new _),{version:1})},555870:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistLayerListener:()=>O});var a=s(434518),n=s(763812),r=s(70148),d=s(391751),_=s(384810),l=s(983567),u=s(280494),c=s(519290),p=(0,n._)("_emitter"),m=(0,n._)("_player"),y=(0,n._)("_playlistIdentity"),g=(0,n._)("_trackTuples"),f=(0,n._)("_trackRows"),E=(0,n._)("_playButton"),A=(0,n._)("_isCurrentPlayerPlaylist"),P=(0,n._)("_getCurrentPlayerTrackIdentity"),b=(0,n._)("_queryPlayButton"),I=(0,n._)("_connectEvents"),T=(0,n._)("_handlePlayButtonClick"),C=(0,n._)("_handleTrackRowClick");class O{get events(){return(0,a._)(this,p)[p].listenable}constructor({emitterFactory:e,playlistIdentity:t,trackTuples:s,trackRows:n,container:d,playButtonClassName:O}){Object.defineProperty(this,A,{get:M,set:void 0}),Object.defineProperty(this,P,{value:S}),Object.defineProperty(this,b,{value:D}),Object.defineProperty(this,I,{value:k}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),(0,a._)(this,T)[T]=()=>{if(!(0,a._)(this,m)[m].isPaused())try{let e;const t=(0,a._)(this,P)[P]();if(t)e=t;else{const t=(0,a._)(this,g)[g].at(0);t&&(e=r.OwnedIdentity.fromRawId((0,c.getAudioFullId)(t)))}if(!e)return;(0,a._)(this,p)[p].emit("play",{playlistIdentity:(0,a._)(this,y)[y],trackIdentity:e})}catch(e){console.error(e)}},(0,a._)(this,C)[C]=(e,t)=>{if(!(0,a._)(this,m)[m].isPaused())try{const s=(0,_.getAudioFromEl)(e,!1);if(!s)return;const n=(0,u.mapAudioTupleToMusicAudioIdentity)(s);(0,a._)(this,p)[p].emit("playTrack",{playlistIdentity:(0,a._)(this,y)[y],trackIdentity:n,trackPosition:t})}catch(e){console.error(e)}},(0,a._)(this,y)[y]=t,(0,a._)(this,g)[g]=s,(0,a._)(this,f)[f]=n,(0,a._)(this,E)[E]=(0,a._)(this,b)[b](d,O),(0,a._)(this,m)[m]=(0,l.getAudioPlayer)(),(0,a._)(this,p)[p]=e.create(),(0,a._)(this,I)[I]()}}function M(){const e=(0,a._)(this,m)[m].getCurrentPlaylist();if(e)try{const t=(0,u.mapPlaylistToMusicPlaylistIdentity)(e);(0,d.compareIdentities)((0,a._)(this,y)[y],t)}catch{return!1}}function S(){if(!(0,a._)(this,A)[A])return null;try{const e=(0,a._)(this,m)[m].getCurrentAudio();return e?(0,u.mapAudioTupleToMusicAudioIdentity)(e):null}catch(e){return console.error(e),null}}function D(e,t){return e.querySelector(`.${t}`)}function k(){(0,a._)(this,E)[E]&&(0,a._)(this,E)[E].addEventListener("click",(0,a._)(this,T)[T]),(0,a._)(this,f)[f].forEach(((e,t)=>{const s=t+1;e.addEventListener("click",(()=>{(0,a._)(this,C)[C](e,s)}))}))}},984578:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistLayerListener:()=>a.MusicPlaylistLayerListener});var a=s(555870)},233696:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistStatsCollector:()=>b});var a=s(434518),n=s(763812),r=s(331635),d=s(132028),_=s(694132),l=s(550490),u=s(317216),c=s(726483),p=s(298005),m=s(251234),y=s(749903),g=s(314309),f=(0,n._)("_actionCollector"),E=(0,n._)("_clickCollector"),A=(0,n._)("_logCommonPlay"),P=(0,n._)("_getSource");class b{logOpen({playlistIdentity:e}){const t={event:(0,c.collectOpenData)({playlistIdentity:e,source:(0,a._)(this,P)[P](e),navScreenProvider:this.navScreenProvider}),target_nav_info:[]},s={type:u.ClickProductionStatEventTypes.TYPE_MUSIC_PLAYLIST_TAP_GOTO,[u.ClickProductionStatEventTypes.TYPE_MUSIC_PLAYLIST_TAP_GOTO]:t};(0,a._)(this,E)[E].logEvent(s,{type:u.EventItemType.MUSIC_PLAYLIST_GOTO})}logPlay({playlistIdentity:e,trackIdentity:t}){const s=(0,p.collectPlayData)({playlistIdentity:e,source:(0,a._)(this,P)[P](e),navScreenProvider:this.navScreenProvider,trackIdentity:t});(0,a._)(this,A)[A](s)}logPlayTrack({playlistIdentity:e,trackIdentity:t,trackPosition:s}){const n=(0,m.collectPlayTrackData)({playlistIdentity:e,trackIdentity:t,trackPosition:s,source:(0,a._)(this,P)[P](e),navScreenProvider:this.navScreenProvider});(0,a._)(this,A)[A](n)}constructor(e,t){Object.defineProperty(this,A,{value:I}),Object.defineProperty(this,P,{value:T}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),this.cookie=e,this.navScreenProvider=t;const s=new g.ProductionStatCollector;(0,a._)(this,f)[f]=new g.ActionStatCollector(s),(0,a._)(this,E)[E]=new g.ClickStatCollector(s)}}function I(e){const t={event:e,type:u.EventItemSubType.MUSIC_PLAYLIST_START,target_nav_info:[]},s={type:u.ActionProductionStatEventTypes.TYPE_MUSIC_PLAYLIST_TAP_PLAY,[u.ActionProductionStatEventTypes.TYPE_MUSIC_PLAYLIST_TAP_PLAY]:t};(0,a._)(this,f)[f].logEvent(s)}function T({accessRawId:e}){return(0,y.getOwnedAudioListSource)(e,{cookie:this.cookie})}b=(0,r.__decorate)([d.scope.container(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[void 0===l.Cookie?Object:l.Cookie,void 0===_.AudioNavScreenProvider?Object:_.AudioNavScreenProvider])],b)},735754:(e,t,s)=>{"use strict";s.d(t,{collectCommonData:()=>n});var a=s(847154);function n({navScreenProvider:e,playlistIdentity:t,source:s}){return{client_server_time:(0,a.getClientServerTime)(),source_info:{track_code:s?.ref||void 0},nav_info:{track_code:e.catalogSectionId??void 0},entities:r(t)}}function r(e){return[{type:"playlist",id:e.accessRawId}]}},726483:(e,t,s)=>{"use strict";s.d(t,{collectOpenData:()=>r});var a=s(8520),n=s(735754);function r(e){return{...(0,n.collectCommonData)(e),pos_ids:function(e){const t=e?.index;return(0,a.isNumber)(t)?[t+1]:void 0}(e.source)}}},298005:(e,t,s)=>{"use strict";s.d(t,{collectPlayData:()=>n});var a=s(735754);function n(e){const t=(0,a.collectCommonData)(e);return{...t,entities:[...t.entities??[],(s=e.trackIdentity,{type:"audio",id:s.accessRawId})]};var s}},251234:(e,t,s)=>{"use strict";s.d(t,{collectPlayTrackData:()=>n});var a=s(298005);function n(e){return{...(0,a.collectPlayData)(e),pos_ids:[e.trackPosition]}}},348191:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistStatsCollector:()=>a.MusicPlaylistStatsCollector});var a=s(233696)},197689:(e,t,s)=>{"use strict";s.d(t,{AudioRowMoreTooltipApplication:()=>d});var a=s(474848),n=s(865708),r=s(530928);function d({target:e,portalRoot:t,onShownChange:s}){return(0,a.jsx)(n.AppRootProvider,{children:(0,a.jsx)(r.AudioRowMoreTooltipContainer,{onShownChange:s,target:e,portalRoot:t})})}},377360:(e,t,s)=>{"use strict";s.d(t,{AudioRowMoreTooltipController:()=>g});var a=s(434518),n=s(763812),r=s(142278),d=s(197689),_=s(584053),l=s(558137),u=s(270559),c=(0,n._)("_initiator"),p=(0,n._)("_emitter"),m=(0,n._)("_target"),y=(0,n._)("_handleShownChange");class g{get isMounted(){return this.checkIsMounted()}get events(){return(0,a._)(this,p)[p].listenable}mount(e,t){this.checkIsMounted(e)||((0,a._)(this,m)[m]=e),this.isShown=!0,(0,a._)(this,c)[c].render({target:e,portalRoot:t,onShownChange:(0,a._)(this,y)[y]})}unmount(){this.checkIsMounted()&&(0,a._)(this,c)[c].unmount(),(0,a._)(this,m)[m]=null,this.isShown=!1,(0,a._)(this,p)[p].emit(u.AudioRowMoreTooltipControllerEventType.Closed)}checkIsMounted(e){return(!e||e===(0,a._)(this,m)[m])&&(0,a._)(this,c)[c].isMounted()}constructor(){Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),this.isShown=!1,(0,a._)(this,c)[c]=(0,r.createReactInitiator)(d.AudioRowMoreTooltipApplication),(0,a._)(this,p)[p]=new _.Emitter,(0,a._)(this,m)[m]=null,(0,a._)(this,y)[y]=e=>{this.isShown=e,e||(this.unmount(),(0,a._)(this,p)[p].emit(u.AudioRowMoreTooltipControllerEventType.Closed))}}}g.ensure=(0,l.makeSharedState)("audio/audioPage/audioRow/moreTooltip/controller",(()=>new g),{version:2})},189942:(e,t,s)=>{"use strict";s.d(t,{AudioRowMoreTooltipController:()=>a.AudioRowMoreTooltipController,AudioRowMoreTooltipControllerEventType:()=>n.AudioRowMoreTooltipControllerEventType});var a=s(377360),n=s(270559)},270559:(e,t,s)=>{"use strict";var a;s.d(t,{AudioRowMoreTooltipControllerEventType:()=>a}),function(e){e.Closed="closed"}(a||(a={}))},269229:(e,t,s)=>{"use strict";s.d(t,{AudioRowMoreTooltipContainer:()=>B});var a=s(474848),n=s(507852),r=s(723723),d=s(161134),_=s(575489),l=s(485749),u=s(203788),c=s(223173),p=s(136017),m=s(715782),y=s(684540),g=s(490363),f=s(694430),E=s(168799),A=s(293721),P=s(235447),b=s(296540),I=s(866467),T=s(540462),C=s(836141),O=s(545549),M=s(35215),S=s(90345);const D=(0,T.partConfigEnabled)("audio_tooltip_copy_link_web"),k=(0,T.partConfigEnabled)("dislikes_web_enabled")||(0,T.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),L=(0,P.ensureAudioRowMoreTooltipService)(),{dislikesService:R}=L;function B({target:e,portalRoot:t=null,onShownChange:s}){const P=(0,A.useUnit)(L.setIsShowTooltip),T=(0,A.useUnit)(L.$audio),B=(0,A.useUnit)(L.$isAudioClaimed),x=(0,A.useUnit)(L.$isEpisode),F=(0,A.useUnit)(L.$isAlbum),U=(0,A.useUnit)(L.$isCurrentAlbumSnippet),N=(0,A.useUnit)(L.$isAudioHasSnippet),W=(0,A.useUnit)(L.$audioPlaylists),V=(0,A.useUnit)(L.$isShowAllPlaylists),K=(0,A.useUnit)(L.$isAudioPlaylistsFetching),H=(0,A.useUnit)(L.$loadingAddToPlaylistFullIdsMap),j=(0,A.useUnit)(L.$addedPlaylistsFullIdsMap),$=(0,A.useUnit)(L.$initializedPlaylistsFullIdsMap),G=(0,A.useUnit)(L.$currentGroupId),q=(0,A.useUnit)(R.$isAudioDisliked),Y=(0,A.useUnit)(R.$isDislikeActionLoading),z=N,X=D&&!B&&!x,Q=k&&!B&&!x,J=!B&&F&&!U,Z=!B&&!x,ee=(0,A.useUnit)(L.copyAudioLinkFx),te=(0,A.useUnit)(L.shareAudioFx),ie=(0,A.useUnit)(L.openEpisodeFx),oe=(0,A.useUnit)(L.openAlbumFx),se=(0,A.useUnit)(L.setNextInPlayerQueueFx),ae=(0,A.useUnit)(R.addFx),ne=(0,A.useUnit)(R.removeFx),re=(0,A.useUnit)(L.addAudioToNewPlaylistFx),de=(0,A.useUnit)(L.toggleAddAudioToPlaylistFx),_e=(0,A.useUnit)(L.showAllPlaylistsFx),le=(0,b.useMemo)((()=>q?"audio-show-more-tooltip-remove-dislike-button":"audio-show-more-tooltip-add-dislike-button"),[q]);return(0,b.useEffect)((()=>(P(!0),()=>{P(!1)})),[]),(0,a.jsx)(n.DropdownActionSheet,{usePortal:t??!1,width:235,trigger:"hover",restoreFocus:!1,placement:"auto-end",content:(0,a.jsxs)(a.Fragment,{children:[z&&(0,a.jsx)(n.DropdownActionSheet.Item,{before:(0,a.jsx)(_.Icon20ListPlayOutline,{className:(0,r.getColorClass)("color_icon_secondary")}),onClick:()=>((0,S.logSearchAudioClick)(S.SearchClickActionMap.LISTEN_NEXT,T?.trackCode),se()),"data-testid":"audio-row-more-tooltip-set-next-audio",children:(0,I.getLang)("audio_set_next_audio")}),X&&(0,a.jsx)(n.DropdownActionSheet.Item,{before:(0,a.jsx)(l.Icon20CopyOutline,{className:(0,r.getColorClass)("color_icon_secondary")}),onClick:()=>((0,S.logSearchAudioClick)(S.SearchClickActionMap.COPY_LINK,T?.trackCode),ee()),"data-testid":"audio-row-more-tooltip-copy-audio-link",keepOpen:!0,children:(0,I.getLang)("audio_copy_audio_link")}),x&&(0,a.jsx)(n.DropdownActionSheet.Item,{before:(0,a.jsx)(u.Icon20PodcastOutline,{className:(0,r.getColorClass)("color_icon_secondary")}),onClick:ie,"data-testid":"audio-row-more-tooltip-podcast-open-episode",children:(0,I.getLang)("audio_podcast_open_episode")}),!B&&(0,a.jsx)(n.DropdownActionSheet.Item,{before:(0,a.jsx)(c.Icon20ShareOutline,{className:(0,r.getColorClass)("color_icon_secondary")}),onClick:()=>((0,S.logSearchAudioClick)(S.SearchClickActionMap.SHARE,T?.trackCode),te()),"data-testid":"audio-row-more-tooltip-share-audio",children:(0,I.getLang)("audio_share_audio")}),Q&&(0,a.jsx)(n.DropdownActionSheet.Item,{before:q?(0,a.jsx)(p.Icon20ThumbsDown,{className:(0,r.getColorClass)("color_icon_secondary")}):(0,a.jsx)(m.Icon20ThumbsDownOutline,{className:(0,r.getColorClass)("color_icon_secondary")}),keepOpen:q,onClick:()=>{if(q)return(0,S.logSearchAudioClick)(S.SearchClickActionMap.REMOVE_DISLIKE,T?.trackCode),void ne({needReloadTrackCode:!0});(0,S.logSearchAudioClick)(S.SearchClickActionMap.DISLIKE,T?.trackCode),ae({skipDeletionAudioFromMyMusic:(0,M.isNumber)(G),needReloadTrackCode:!0})},disabled:Y,"data-testid":le,children:(0,I.getLang)("audio_action_dislike")}),J&&(0,a.jsx)(n.DropdownActionSheet.Item,{before:(0,a.jsx)(y.Icon20VinylOutline,{className:(0,r.getColorClass)("color_icon_secondary")}),onClick:()=>((0,S.logSearchAudioClick)(S.SearchClickActionMap.OPEN_ALBUM,T?.trackCode),oe()),"data-testid":"audio-row-more-tooltip-open-album",children:(0,I.getLang)("audio_open_album")}),Z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.DropdownActionSheet.Separator,{}),(0,a.jsx)(d.DropdownActionSubSheet,{before:(0,a.jsx)(g.Icon20ListPlusOutline,{className:(0,r.getColorClass)("color_icon_secondary")}),disabled:K,shown:!0,sheet:(0,a.jsx)(a.Fragment,{children:K?(0,a.jsx)(d.DropdownActionSubSheet.Item,{loading:!0,disabled:!0,keepOpen:!0,children:(0,I.getLang)("audio_action_sub_sheet_additional_loading")}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.DropdownActionSubSheet.Item,{before:(0,a.jsx)(f.Icon24Add,{className:(0,r.getColorClass)("color_icon_secondary")}),onClick:()=>((0,S.logSearchAudioClick)(S.SearchClickActionMap.ADD_TO_PLAYLIST,T?.trackCode),re()),"data-testid":"audio-row-more-tooltip-add-to-new-playlist",children:(0,I.getLang)("audio_add_to_new_pl")}),W?.map(((e,t)=>{if(!T||!e)return null;const s=(0,C.getAudioPlaylistId)(T.id,e.id),n=s in $?s in j:e.hasTargetAudio;return(0,a.jsx)(b.Fragment,{children:(0,a.jsx)(d.DropdownActionSubSheet.Item,{keepOpen:!0,loading:!!T&&s in H,before:n?(0,a.jsx)(E.Icon20Check,{className:(0,r.getColorClass)("color_icon_secondary")}):null,onClick:()=>((0,S.logSearchAudioClick)(S.SearchClickActionMap.ADD_TO_PLAYLIST,T?.trackCode),de(e)),"data-testid":"audio-row-more-tooltip-add-to-playlist",children:e.title??""})},null===e.id?t:e.id)})),V&&(0,a.jsx)(d.DropdownActionSubSheet.Item,{onClick:_e,"data-testid":"audio-row-more-tooltip-show-all-playlists",children:(0,I.getLang)("audio_row_show_all_playlists")})]})}),children:(0,I.getLang)("audio_add_to_playlist")})]})]}),shown:!0,onShownChange:s,children:(0,a.jsx)(O.ForwardElementRef,{element:e})})}},541840:(e,t,s)=>{"use strict";s.d(t,{AudioRowMoreTooltipContainer:()=>a.AudioRowMoreTooltipContainer});var a=s(269229)},530928:(e,t,s)=>{"use strict";s.d(t,{AudioRowMoreTooltipContainer:()=>a.AudioRowMoreTooltipContainer});var a=s(541840)},357319:(e,t,s)=>{"use strict";s.d(t,{AudioRowMoreTooltipController:()=>a.AudioRowMoreTooltipController,AudioRowMoreTooltipControllerEventType:()=>a.AudioRowMoreTooltipControllerEventType,ensureAudioRowMoreTooltipService:()=>n.ensureAudioRowMoreTooltipService});var a=s(189942),n=s(235447)},2884:(e,t,s)=>{"use strict";s.d(t,{createAudioPlaylistsDataService:()=>C});var a=s(761520),n=s(459899),r=s(8520),d=s(32489),_=s(810068),l=s(921832),u=s(30899),c=s(478455),p=s(586049),m=s(163374),y=s(625523),g=s(602337),f=s(909436),E=s(752740),A=s(972623),P=s(270959),b=s(30052),I=s(836141),T=s(278758);function C({domain:e,$audio:t,$audioTuple:s,$audioEl:g,$isShowTooltip:C}){const S=n.AudioPageProxy.ensure(),D=(0,u.ensureMyAudioPlaylistsService)(),k=e.createEvent(),L=t.map((e=>e&&e.id&&e.ownerId?(0,c.getAudioFullId)({id:e.id,ownerId:e.ownerId}):null)),{$audioPlaylistsDataMap:R,audioPlaylistsDataMapApi:B}=(0,l.createAudioPlaylistsDataMap)(e),{$fullIdsMap:x,fullIdsMapApi:F}=(0,p.createFullIdsMap)(e),{$fullIdsMap:U,fullIdsMapApi:N}=(0,p.createFullIdsMap)(e),{$fullIdsMap:W,fullIdsMapApi:V}=(0,p.createFullIdsMap)(e),{$fullIdsMap:K,fullIdsMapApi:H}=(0,p.createFullIdsMap)(e),j=(0,d.combine)({audioFullId:L,audioPlaylistsDataMap:R}).map((({audioFullId:e,audioPlaylistsDataMap:t})=>Boolean(e)&&(0,r.isString)(e)?t[e]??null:null)),{$audioPlaylists:$,$isShowAllPlaylists:G,$newPlaylistHash:q}=(0,y.reshape)({source:j,shape:{$audioPlaylists:e=>e?.playlists||[],$isShowAllPlaylists:e=>e?.isShowAllPlaylists||!1,$newPlaylistHash:e=>e?.newPlaylistHash||null}}),Y=(0,d.combine)({audioFullId:L,loadingFetchingFullIdsMap:x}).map((({audioFullId:e,loadingFetchingFullIdsMap:t})=>!!e&&Boolean(t[e]))),z=e.createEffect((async e=>{if(!e)throw new Error("Audio not exists");const t=M(S);try{const s=await a.ajax.promisifiedPost("al_audio.php",{act:"playlists_by_audio",owner_id:t,audio_owner_id:e.ownerId,audio_id:e.id});if(!s)throw new Error("Unknown error when fetching playlists by audio");const[n,r,d]=s;return{playlists:(n||[]).map(O),isShowAllPlaylists:r||!1,newPlaylistHash:d||null}}catch(e){throw new Error("Error when fetching playlists by audio",{cause:e})}})),X=(0,d.attach)({source:t,effect:async e=>z(e)}),Q=(0,d.attach)({source:(0,d.combine)({audioTuple:s,newPlaylistHash:q}),effect({audioTuple:e,newPlaylistHash:t}){if(!e)throw new Error("Audio not exists");if(!t)throw new Error("Playlist hash not exists");const s=M(S);f.AudioUtils.editPlaylist(s,!1,"edit",{addAudio:e,newPlaylistHash:t,onSavePlaylistDone(){k()}})}}),J=(0,d.attach)({source:(0,d.combine)({audioEl:g,addedPlaylistsFullIdsMap:W,initializedPlaylistsFullIdsMap:K,addedAudiosMap:D.$addedAudiosMap}),async effect({audioEl:e,addedPlaylistsFullIdsMap:t,initializedPlaylistsFullIdsMap:s,addedAudiosMap:a},{audio:n,playlist:r}){if(!n||!e)throw new Error("Audio not exists");const d=(0,I.getAudioPlaylistId)(n.id,r.id),_=d in s?d in t:r.hasTargetAudio;if(D.setUserId(window.vk.id),_){const e=a[(0,m.getPlaylistAudioFullId)({playlist:{id:r.id,ownerId:r.ownerId},originalAudio:n})]??{id:n.id,ownerId:window.vk.id};await D.deleteAudioFx({originalAudioIdentity:n,audioIdentity:e,playlistId:r.id})}else await D.addAudioFx({audioIdentity:n,playlistId:r.id});(0,E.onAdditionalEvent)(e,n,{type:_?A.TYPE_REMOVED:A.TYPE_ADDED,subtype:A.SUBTYPE_PLAYLIST})}}),Z=(0,d.attach)({source:t,async effect(e,t){await J({audio:e,playlist:t})}}),ee=(0,d.attach)({source:$,async effect(e,t){if(e&&t){for(const s of e){const e=(0,I.getAudioPlaylistId)(t.id,s.id);N.remove(e),V.remove(e),H.remove(e)}B.remove((0,c.getAudioFullId)(t))}}}),te=(0,d.attach)({source:t,effect(e){if(!e)throw new Error("Audio not exists");const t=M(S);(0,P.showBox)("al_audio.php?act=more_playlists_add",{owner_id:t,audio_owner_id:e.ownerId,audio_id:e.id},{params:{bodyStyle:"padding: 0px",width:560},onDone(){ee(e)}})}});return(0,d.sample)({source:j,clock:(0,d.combine)({audio:t,isShowTooltip:C}),filter:(e,{isShowTooltip:t,audio:s})=>t&&!e&&Boolean(s)&&_.Ranges.isUserId(window.vk.id),target:X}),(0,d.sample)({source:L,clock:X.doneData,filter:e=>Boolean(e),fn:(e,t)=>({audioFullId:e,playlistsData:t}),target:B.add}),(0,d.sample)({clock:z,filter:e=>Boolean(e),fn:e=>(0,c.getAudioFullId)({id:e.id,ownerId:e.ownerId}),target:F.add}),(0,d.sample)({clock:z.finally,filter:({params:e})=>Boolean(e),fn:({params:e})=>{const t=e;return(0,c.getAudioFullId)({id:t.id,ownerId:t.ownerId})},target:F.remove}),(0,d.sample)({clock:J,filter:({audio:e,playlist:t})=>Boolean(e)&&Boolean(t),fn:({audio:e,playlist:t})=>(0,I.getAudioPlaylistId)(e.id,t.id),target:N.add}),(0,d.sample)({clock:J.finally,filter:({params:{audio:e,playlist:t}})=>Boolean(e)&&Boolean(t),fn:({params:e})=>{const{audio:t,playlist:s}=e;return(0,I.getAudioPlaylistId)(t.id,s.id)},target:N.remove}),(0,d.sample)({source:(0,d.combine)({addedPlaylistsFullIdsMap:W,initializedPlaylistsFullIdsMap:K}),clock:J.done,filter:(e,{params:{audio:t,playlist:s}})=>Boolean(t)&&Boolean(s),fn:({addedPlaylistsFullIdsMap:e,initializedPlaylistsFullIdsMap:t},{params:s})=>{const{audio:a,playlist:n}=s,r=(0,I.getAudioPlaylistId)(a.id,n.id);return{added:r in t?r in e:n.hasTargetAudio,audioPlaylistId:r}},target:[H.add.prepend((({audioPlaylistId:e})=>e)),(0,b.condition)({if:({added:e})=>e,then:V.remove.prepend((({audioPlaylistId:e})=>e)),else:V.add.prepend((({audioPlaylistId:e})=>e))})]}),(0,T.reset)({clock:k,target:[R,x,U,K,W]}),{$audioPlaylists:$,$isShowAllPlaylists:G,$isAudioPlaylistsFetching:Y,$loadingAddToPlaylistFullIdsMap:U,$addedPlaylistsFullIdsMap:W,$initializedPlaylistsFullIdsMap:K,addAudioToNewPlaylistFx:Q,toggleAddAudioToPlaylistFx:Z,showAllPlaylistsFx:te}}function O(e){return{ownerId:+e[g.AudioPlaylistTupleKeys.OwnerId],id:+e[g.AudioPlaylistTupleKeys.Id],title:e[g.AudioPlaylistTupleKeys.Title]||null,hasTargetAudio:e[g.AudioPlaylistTupleKeys.HasTargetAudio]||!1,actionHash:e[g.AudioPlaylistTupleKeys.ActionHash]||null}}function M(e){let t;return t=(0,r.isNumber)(e.ownerId)&&e.ownerId<0&&e.canEditGroup?e.ownerId:window.vk.id,t}},836141:(e,t,s)=>{"use strict";function a(e,t){return`${e}_${t}`}s.d(t,{getAudioPlaylistId:()=>a})},775784:(e,t,s)=>{"use strict";s.d(t,{createAudioPlaylistsDataService:()=>a.createAudioPlaylistsDataService});var a=s(2884)},921832:(e,t,s)=>{"use strict";s.d(t,{createAudioPlaylistsDataMap:()=>d});var a=s(32489),n=s(46201),r=s(786979);function d(e){const t=e.createStore({});return{$audioPlaylistsDataMap:t,audioPlaylistsDataMapApi:(0,a.createApi)(t,{add:(e,{audioFullId:t,playlistsData:s})=>(0,n.addPairToMap)(e,{key:t,value:s}),remove:(e,t)=>(0,r.removePairFromMap)(e,t)})}}},602337:(e,t,s)=>{"use strict";var a;s.d(t,{AudioPlaylistTupleKeys:()=>a}),function(e){e[e.OwnerId=0]="OwnerId",e[e.Id=1]="Id",e[e.Title=2]="Title",e[e.HasTargetAudio=3]="HasTargetAudio",e[e.ActionHash=4]="ActionHash"}(a||(a={}))},832486:(e,t,s)=>{"use strict";s.d(t,{createAudioRowMoreTooltipService:()=>g});var a=s(746573),n=s(35215),r=s(584053),d=s(32489),_=s(810780),l=s(909436),u=s(459899),c=s(674522),p=s(775784),m=s(803111),y=s(991590);function g(e){const t=(0,a.getEffectorServiceDomain)(e),s=u.AudioPageProxy.ensure(),g=(0,m.ensureAudioPlayerService)(),E=new r.Emitter,A=(0,d.createEvent)(),P=t.createEvent(),b=t.createEvent(),I=(0,d.restore)(P,!1),T=t.createStore(null),C=t.createStore(null),O=t.createStore(null),M=t.createStore(null),S=t.createStore(null),D=(0,d.restore)(b,null),{$audioPlaylists:k,$isShowAllPlaylists:L,$isAudioPlaylistsFetching:R,$loadingAddToPlaylistFullIdsMap:B,$addedPlaylistsFullIdsMap:x,$initializedPlaylistsFullIdsMap:F,addAudioToNewPlaylistFx:U,toggleAddAudioToPlaylistFx:N,showAllPlaylistsFx:W}=(0,p.createAudioPlaylistsDataService)({domain:t,$audio:C,$audioEl:T,$audioTuple:O,$isShowTooltip:I}),V=C.map((e=>!!e&&Boolean(e?.isClaimed))),K=C.map((e=>!!e&&Boolean(l.AudioUtils.isPodcast(e)))),H=C.map((e=>!!e&&Boolean(e?.album))),j=C.map((e=>!!e&&Boolean(e?.isCurrentAlbumSnippet))),$=(0,d.combine)({audioEl:T,audio:C}).map((({audioEl:e,audio:t})=>{if(!e||!t)return!1;const s=l.AudioUtils.getContextPlaylist(e,!0),[a,n]=l.AudioUtils.contextSplit(s);if(!a||"my_audios_block"===n)return Boolean(t?.isInSnippet);switch(a){case"search_results":case"catalog":case"album_page":case"my":case"module":case"user_list":case"group_list":case"edit_playlist":return!0}return Boolean(t?.isInSnippet)})),G=(0,c.createMusicAudioMyDislikesService)({domain:t,$audio:C,$audioEl:T}),q=(0,d.attach)({source:(0,d.combine)({audio:C,audioLinkPathname:M,audioAccessKey:S}),async effect({audio:e,audioLinkPathname:t,audioAccessKey:s}){if(!e)throw new Error("Audio not exist");t?await l.AudioUtils.copyAudioLink(t):await l.AudioUtils.copyAudioLinkByIdentity(e,s??""),E.emit(y.AudioRowMoreTooltipServiceEventType.AudioLinkCopied,e)}}),Y=(0,d.attach)({source:(0,d.combine)({audioEl:T,currentAudio:C}),effect:({audioEl:e,currentAudio:t})=>{const a=t||s.readyAudio;if(!e||!a)throw new Error("Audio not exist");a&&l.AudioUtils.shareAudio(e??!1,a)}}),z=(0,d.attach)({source:(0,d.combine)({audioEl:T,currentAudio:C}),effect:({audioEl:e,currentAudio:t})=>{const a=t||s.readyAudio;if(!e||!a)throw new Error("Audio not exist");a&&l.AudioUtils.openEpisode(e??!1,a)}}),X=(0,d.attach)({source:(0,d.combine)({audioEl:T,currentAudio:C}),effect:({audioEl:e,currentAudio:t})=>{const a=t||s.readyAudio;if(!e||!a)throw new Error("Audio not exist");a&&l.AudioUtils.showAudioAlbum(e??!1,a)}}),Q=(0,d.attach)({source:(0,d.combine)({audioEl:T,audio:C}),effect:({audioEl:e,audio:t})=>{if(!e||!t)throw new Error("Audio not exist");t&&g.setNextFx({audioEl:e,audio:t})}}),J=(0,d.attach)({source:C,async effect(e){if(!e)throw new Error("Audio not exists");const t=s.ownerId&&(0,n.isNumber)(s.ownerId)&&s.ownerId<0&&s.canAddToGroup&&s.ownerId!==e.ownerId;b(t?-s.ownerId:null)}});return(0,_.spread)({source:A.map(f),targets:{audioEl:T,audioTuple:O,audio:C,audioLinkPathname:M,audioAccessKey:S}}),s.events.on(u.AudioPageEventType.Updated,(()=>{J()})),{init:A,$audio:C,$audioEl:T,$isAudioClaimed:V,$isEpisode:K,$isAlbum:H,$isCurrentAlbumSnippet:j,$isAudioHasSnippet:$,$audioPlaylists:k,$isShowAllPlaylists:L,$isAudioPlaylistsFetching:R,$loadingAddToPlaylistFullIdsMap:B,$addedPlaylistsFullIdsMap:x,$initializedPlaylistsFullIdsMap:F,$currentGroupId:D,setIsShowTooltip:P,copyAudioLinkFx:q,shareAudioFx:Y,openEpisodeFx:z,openAlbumFx:X,setNextInPlayerQueueFx:Q,addAudioToNewPlaylistFx:U,toggleAddAudioToPlaylistFx:N,showAllPlaylistsFx:W,dislikesService:G,events:E.listenable}}function f(e){return{audioEl:e.audioEl??null,audio:e.audio??null,audioTuple:e.audioTuple,audioLinkPathname:e?.audioLinkPathname||e.audio?.trackPageId||null,audioAccessKey:e?.audioAccessKey||null}}},991590:(e,t,s)=>{"use strict";var a;s.d(t,{AudioRowMoreTooltipServiceEventType:()=>a}),function(e){e.AudioLinkCopied="audioLinkCopied"}(a||(a={}))},235447:(e,t,s)=>{"use strict";s.d(t,{ensureAudioRowMoreTooltipService:()=>d});var a=s(558137),n=s(32489),r=s(832486);const d=(0,a.makeSharedState)("audio/audioPage/audioRow/moreTooltip",(()=>(0,r.createAudioRowMoreTooltipService)({domain:(0,n.createDomain)("audio/audioPage/audioRow/moreTooltip"),name:"audio/audioPage/audioRow/moreTooltip"})),{version:3})},545549:(e,t,s)=>{"use strict";s.d(t,{ForwardElementRef:()=>a});const a=(0,s(296540).forwardRef)((function({element:e,getRootRef:t},s){return t&&n(t,e),n(s,e),null}));function n(e,t){e&&("function"==typeof e?e(t):e.current=t)}},863024:(e,t,s)=>{"use strict";s.d(t,{SaveUserForQuickLoginBox:()=>g});var a=s(474848),n=s(296540),r=s(866467),d=s(314309),_=s(211413),l=s(694244),u=s(782174),c=s(63614),p=s(303800),m=s(908242),y=s(454154);const g=({logoutUrl:e,onLogout:t,onClose:s})=>{const[g,f]=(0,n.useState)(!0),E=()=>{d.vkConnectNavigationCollector.logCancelOnExit(),s()};return(0,n.useEffect)((()=>{d.vkConnectNavigationCollector.logSaveLoginModalShow()}),[]),(0,a.jsxs)(l.ModalBox,{children:[(0,a.jsx)(u.ModalHeader,{onClose:E,closeAriaLabel:(0,r.getLang)("global_close"),children:(0,r.getLang)("vkconnect_logout_save_user_dialog_title")}),(0,a.jsx)(c.ModalBody,{insetLevel:1,children:(0,a.jsx)(p.Div,{children:(0,a.jsx)(_.SettingsCellSwitch,{description:(0,r.getLang)("vkconnect_logout_save_user_dialog_description_text"),checked:g,onChange:e=>f(e.target.checked),children:(0,r.getLang)("vkconnect_logout_save_user_dialog_description_title")})})}),(0,a.jsx)(m.ModalFooter,{actions:[(0,a.jsx)(y.Button,{size:"s",mode:"secondary",onClick:E,children:(0,r.getLang)("global_cancel")},"close"),(0,a.jsx)(y.Button,{size:"s",mode:"primary",onClick:()=>{let s="&save_user=0";g&&(s="&save_user=1"),t(`${e}${s}`)},children:(0,r.getLang)("global_head_logout")},"logout")]})]})}},996473:(e,t,s)=>{"use strict";s.d(t,{logout:()=>u,logoutForVKVideoStandalone:()=>m,logoutWithDialog:()=>p});var a=s(474848),n=s(957994),r=s(863024),d=s(211413),_=s(638112),l=s(586138);const u=(e,t)=>{(0,n.removeLoginCache)(e,t)},c=e=>{u(),window.location.href=e},p=(e,t=c)=>{(0,n.login)("check_user_saved").then((s=>{const{feature_enabled:n,is_user_saved:_}=s;n&&!_?(0,d.showMessageBoxModal)((s=>(0,a.jsx)(r.SaveUserForQuickLoginBox,{...s,logoutUrl:e,onLogout:t})),{width:420}):t(e)})).catch((()=>{t(e)}))},m=e=>{p(e,(()=>{(0,_.onVKVideoLogout)(e,l.VK_WEB_VKVIDEO_APP_ID,"al_video.php",c)}))}},556351:(e,t,s)=>{"use strict";s.d(t,{writeLogout:()=>_});var a=s(636576),n=s(146175),r=s(64323),d=s(239895);const _=(e="unknown",t="",s="")=>{if(!t)return;let _=0;try{const e=(0,n.imDbGet)(window.vk.id);Object.entries(e).forEach((function(e){const t=e[0],s=e[1];t.startsWith("draft_")&&(s.txt||s.attaches&&s.attaches.length)&&_++}))}catch(e){}s&&((0,r.logSwitcherDropAccount)(s),localStorage.setItem(d.NOTIFY_SWITCH_KEY,"0")),(0,r.prepareLogSwitchAccountEvent)(),(0,a.statlogsValueEvent)("logout_stat",e,t,_)}},541839:(e,t,s)=>{"use strict";s.d(t,{TOOLTIP_CLASSES_DEFAULT:()=>r,helpHintTooltip:()=>d});var a=s(761520),n=s(250598);const r="feature_intro_tt feature_intro_blue_tt feature_info_tooltip",d=(e,t,s={})=>{let d;const _={...{autoShow:!1,cls:r,content:t.content,withCloseButton:!0,noAutoHideOnWindowClick:!0,onHide:()=>{d?.destroy()},width:230},...s,onDestroy:()=>{var e;"isServerSideHideDisabled"in(e=t)&&e.isServerSideHideDisabled||a.ajax.post("al_index.php",{act:"help_hints_hide",hash:t.helpHintHash,hint_id:t.helpHintId}),t.onHideRequestSent?.(),s.onDestroy&&s.onDestroy()}};return"helpHintId"in t&&(_.helpHintId=t.helpHintId,_.skipShow=Boolean(t.skipShow)),d=new n.ElementTooltip(e,_),window.cur?.destroy?.push((()=>{d?.destroy()})),{tooltip:d}}},965494:(e,t,s)=>{"use strict";s.d(t,{EcoPlateAnalytics:()=>l,EcoPlateAnalyticsContext:()=>u});var a=s(317216),n=s(314309),r=s(19589),d=s(296540),_=s(511897);class l{updateThemeField(){this.theme=r.colorScheme.getMode()===r.ColorSchemeMode.Auto?"system":r.colorScheme.getMode()}init(e,t,s,a){this.securityStatus=e===_.AccountSecurityLevelEnumNames.HAVE_ISSUES?"critical_vulnerabilities":e===_.AccountSecurityLevelEnumNames.HAVE_RECOMMENDATIONS?"protection_recommendations":"securely_protected",this.nftAvatar=t,this.isVerified=s,this.multiaccId=a,this.unsubscribeThemeListener=r.colorScheme.subscribe((()=>{this.updateThemeField()}))}getCommonFields(){return{multiacc_id:this.multiaccId,metadata:JSON.stringify({security_status:this.securityStatus,theme:this.theme,nft_avatar:this.nftAvatar,is_verified:this.isVerified}),options:[{names:a.VkidEcosystemNavigationItem.AVATAR,values:a.VkidEcosystemNavigationItemPlace.ECOSYSTEM},{names:a.VkidEcosystemNavigationItem.VKID_LK,values:a.VkidEcosystemNavigationItemPlace.ECOSYSTEM},{names:a.VkidEcosystemNavigationItem.BALANCE,values:a.VkidEcosystemNavigationItemPlace.VK},{names:a.VkidEcosystemNavigationItem.QR_SIGN_IN,values:a.VkidEcosystemNavigationItemPlace.VK},{names:a.VkidEcosystemNavigationItem.SETTINGS,values:a.VkidEcosystemNavigationItemPlace.VK},{names:a.VkidEcosystemNavigationItem.THEME,values:a.VkidEcosystemNavigationItemPlace.VK},{names:a.VkidEcosystemNavigationItem.HELP,values:a.VkidEcosystemNavigationItemPlace.VK},{names:a.VkidEcosystemNavigationItem.LOGOUT,values:a.VkidEcosystemNavigationItemPlace.VK},{names:a.VkidEcosystemNavigationItem.SWITCHER,values:a.VkidEcosystemNavigationItemPlace.MULTIACCOUNT}]}}logTopNavItemClick(e){e!==a.VkidEcosystemNavigationItemEventType.LOGOUT?n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.TAP,item:e,...this.getCommonFields()}):n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.LOGOUT,...this.getCommonFields()},{force:!0})}logThemeChange(){n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.THEME_CHANGED,item:a.VkidEcosystemNavigationItem.THEME,...this.getCommonFields()})}logTopNavToggle(e){n.vkIdEcosystemNavigationCollector.logEvent({event:e?a.VkidEcosystemNavigationItemEventType.OPEN:a.VkidEcosystemNavigationItemEventType.CLOSE,...this.getCommonFields()})}logApiError(){n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.ERROR_API,...this.getCommonFields()})}logSwitcherError(){n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.ERROR_SWITCHER,...this.getCommonFields()})}logMultiaccAddAnotherTap(){n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.ADD_ANOTHER_ACCOUNT_TAP,...this.getCommonFields()})}logMultaccSwitchAccountTap(){n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.SWITCH_ACCOUNT_TAP,...this.getCommonFields()})}logMultaccDropAccountTap(){n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.DROP_ACCOUNT_TAP,...this.getCommonFields()})}logSecurityRecommShow(){n.vkIdEcosystemNavigationCollector.logEvent({event:a.VkidEcosystemNavigationItemEventType.SECURITY_RECCOMENDATION_SHOW,...this.getCommonFields()})}unsubscribe(){this.unsubscribeThemeListener()}constructor(){this.updateThemeField()}}const u=(0,d.createContext)(void 0)},64323:(e,t,s)=>{"use strict";s.d(t,{logSwitchAccountEvent:()=>g,logSwitchAccountTapEvent:()=>m,logSwitcherAddAnotherTapEvent:()=>c,logSwitcherDropAccount:()=>p,logTopNavElements:()=>f,prepareLogSwitchAccountEvent:()=>y});var a=s(314309),n=s(338761);const r=new a.ProductionStatCollector,d=new a.ActionStatCollector(r),_=new a.RegistrationItemStatCollector(d),l=new n.VkConnectNavigationCollector;function u(e,t){const s=[],n=d.productionStatCollector.getCurrentTime(!1);return s.push({name:a.RegistrationFieldItemNames.TO_SWITCHER_FROM,value:e,start_interaction_time:n,end_interaction_time:n}),0===t&&s.push({name:a.RegistrationFieldItemNames.NAME_MULTIACC_ADD_ACCOUNT_TYPE,value:a.RegistrationFieldItemValues.ADD_ACCOUNT_CREATE_MULTIACC,start_interaction_time:n,end_interaction_time:n}),s}function c(e,t,s){_.logEvent(a.RegistrationItemEventTypes.MULTIACC_ADD_ANOTHER_ACCOUNT_TAP,a.EventScreens.MULTI_ACC_SWITCHER,a.EventScreens.NOWHERE,{force:!0},u(t,s),void 0,void 0,e)}function p(e,t="profile"){e&&(_.logEvent(a.RegistrationItemEventTypes.MULTIACC_DROP_ACCOUNT_TAP,a.EventScreens.MULTI_ACC_SWITCHER,a.EventScreens.NOWHERE,{force:!0},u(t),void 0,void 0,e),_.logEvent(a.RegistrationItemEventTypes.MULTIACC_DROP_ACCOUNT,a.EventScreens.MULTI_ACC_SWITCHER,a.EventScreens.NOWHERE,{force:!0},u(t),void 0,void 0,e))}function m(e,t){e&&_.logEvent(a.RegistrationItemEventTypes.SWITCH_ACCOUNT_TAP,a.EventScreens.MULTI_ACC_SWITCHER,a.EventScreens.NOWHERE,{force:!0},u(t),void 0,void 0,e)}function y(){window.vk.id&&sessionStorage.setItem("LOG_ACC_SWITCH",String(window.vk.id))}function g(e,t,s,n){e&&t&&s&&(_.logEvent(a.RegistrationItemEventTypes.SWITCH_FROM_ACCOUNT,a.EventScreens.MULTI_ACC_SWITCHER,a.EventScreens.NOWHERE,{force:!0},u(n),void 0,t,e),_.logEvent(a.RegistrationItemEventTypes.SWITCH_TO_ACCOUNT,a.EventScreens.MULTI_ACC_SWITCHER,a.EventScreens.NOWHERE,{force:!0},u(n),void 0,s,e))}function f(e){l.logTopNavElements(e)}},239895:(e,t,s)=>{"use strict";s.d(t,{APP_NAME:()=>a,LAST_ACC_ID_KEY:()=>d,LOG_ACC_SWITCH_KEY:()=>r,NOTIFY_SWITCH_KEY:()=>n});const a="EcosystemMultiAccountsEntry",n="multiacc_should_show_notifier",r="multacc_should_send_analytics",d="multiacc_last_id"},596706:(e,t,s)=>{"use strict";s.d(t,{init:()=>u});var a=s(338329),n=s(530107),r=s(246429),d=s(862566),_=s(984745),l=s(298077);const u=()=>{(0,a.init)(),(0,n.tqi)().setHandler("Common/nav_go",(e=>{e.payload.event?.target&&window.nav.go(e.payload.event.target,e.payload.event,JSON.parse(e.payload.dataAttrs?.options||"{}"))}),!1),(0,n.tqi)().setHandler("Common/cur_box_hide",(()=>{(0,r.curBox)()?.hide()}),!1),(0,n.tqi)().setHandler("Common/show_menu_settings",(e=>{const t=e.payload.dataAttrs?.type?Number(e.payload.dataAttrs.type):void 0;(0,d.loadMenuSettingsBox)(t)}),!1),(0,n.tqs)().setHandler("HelpHints/init",(({payload:{target:e}})=>{e?.remove(),(0,_.ensureAccountHelpHintsService)().initialize({viewerId:window.vk?.id,logErrorFn:l.logError})}),!0)}},170001:(e,t,s)=>{"use strict";s.d(t,{FEED_OFFLINE_MODE_FIELD:()=>a,PageCacheState:()=>n});const a="feed_offline_mode_state";var n;!function(e){e.Active="active",e.Inactive="inactive",e[e.Unset="%%pageCacheState%%"]="Unset"}(n||(n={}))},892369:(e,t,s)=>{"use strict";s.d(t,{handleSWResponse:()=>_,handleSWTimingsMessage:()=>d});var a=s(596181),n=s(558137);const r=(0,n.makeSharedState)("feed_with_offline_mode_sw_timings_data",(()=>({})),{version:1}),d=e=>{r().timings=e},_=()=>{const e=Date.now(),{timings:t}=r();if(!t?.lastTimestamp)return;const{lastTimestamp:s,...n}=t;(e=>{const{gettingFromCache:t,fetching:s,gettingFromCacheOnError:n,puttingIntoCache:r,postingFeedStateMessage:d,responding:_}=e;new a.DevNullStatCollector(new a.CustomStatCollector).logEvent({key:"feed_with_offline_mode_sw_content_timings",value:t,value2:s,value3:n,value4:r,value5:d,value6:_})})({...n,responding:e-s})}},954961:(e,t,s)=>{"use strict";s.d(t,{isPageCacheStateActive:()=>n,setPageCacheState:()=>r});var a=s(170001);const n=()=>window.vk.pageCacheState===a.PageCacheState.Active,r=e=>{window.vk.pageCacheState=e}},457498:(e,t,s)=>{"use strict";var a;function n(e){return e.type?`profile_tooltip__${e.type}`:"profile_tooltip"}function r(e){return e.type?`profile_tooltip_all__${e.type}`:"profile_tooltip"}s.d(t,{GiftRef:()=>a,getAllGiftsRefInTooltip:()=>r,getGiftRefInTooltip:()=>n}),function(e){e.PROFILE_BUTTON="profile_button",e.PROFILE_MODULE="profile_module",e.PROFILE_TOOLTIP="profile_tooltip",e.PROFILE_TOOLTIP_ALL="profile_tooltip_all"}(a||(a={}))},687903:(e,t,s)=>{"use strict";s.d(t,{default:()=>l,unpackStore:()=>u});var a=s(740342),n=s(469004),r=s(593159),d=s(755119);function _(e,t){if(!t)return n.ls.get(e);n.ls.set(e,t)}function l(e={},t={}){const s=(0,a.debounce)(_,300);let l=(0,r.extend)({},e),u=[],c=[];return t.store&&(l=n.ls.get(t.key)||l),{get:()=>l,set(e){return e(l).then((e=>(l=e,t.store&&s(t.key,e),this.emit(),this))).catch(d.dummyCatch)},setState(e){return this.set((t=>(t=(0,r.extend)(t,e),this.emit(),Promise.resolve(t))))},stash(){u.push(l),l=(0,r.extend)({},e),this.emit()},reset(){l=(0,r.extend)({},e),this.emit()},unmount(){l={},e=!1,c=[]},pop(){u.length>0&&(l=u.pop(),this.emit())},emit(){c.length>0&&c.forEach((e=>e(this)))},subscribe(e){c.includes(e)||c.push(e)},unsubscribe(e){c=c.filter((t=>t!==e))},mutate(e){e(l),t.store&&s(t.key,l),this.emit()}}}function u(e){return function(e){return!!e.get}(e)?e.get():e}},755119:(e,t,s)=>{"use strict";function a(e=!1){console.trace(),e||window.alert("Вы поймали баг исчезнувшего lastMsg. Пожалуйста откройте консоль (Cmd + Option + I), остановите выполнение JS на странице (F8+cmd+\\) и свяжитесь с командой сообщений на вебе.")}function n(e){return console.error(e),Promise.reject(e)}s.d(t,{dummyCatch:()=>n,showDebugAlert:()=>a})},902403:(e,t,s)=>{"use strict";s.d(t,{getErrorText:()=>r,logImError:()=>n});var a=s(298077);function n(e,t=""){console.error(e);const s=e=>{(0,a.logError)(e,{environment:"im"})};if(e instanceof Error){const a=new Error(r(e,t));return a.name=e.name,a.stack=e.stack,s(a)}return s(new Error(r(e,t)))}function r(e,t=""){if(e instanceof Error)return t?`${t}: ${e.message}`:e.message;if("string"==typeof e||"number"==typeof e)return t?`${t}: ${e}`:`${e}`;if(e&&"api_error"===e.type){const s=JSON.stringify(e.error);return t?`${t}: ${s}`:s}if(e instanceof Object){let s="";try{s=JSON.stringify(e)}catch(e){s=`Error data ${e}`}return t?`${t}: ${s}`:s}return t}},120101:(e,t,s)=>{"use strict";s.d(t,{isVKCOMProfileRedesignedEnabled:()=>c,markLiveInStoriesFinished:()=>y,markSeenStoriesInProfile:()=>m,showFansBox:()=>p,showOwnerGiftsBox:()=>E,showSendGiftBox:()=>g,showSendSelectedGiftInBirthdayBox:()=>f,showSilentModeBox:()=>A});var a=s(270959),n=s(246429),r=s(457498),d=s(636576),_=s(540462),l=s(792242),u=s(67631);function c(){return(0,_.partConfigEnabled)("redesign_web_profile_feature")}function p(e,t,s,n={},r=""){return window.cur.viewAsBox?window.cur.viewAsBox():!(0,a.showBox)("al_fans.php",{act:"box",tab:t||"fans",oid:e,from:r},{cache:1,stat:["page_help.css",window.jsc("web/fansbox.js")],params:{...n}},s)}function m(e){"profile"===window.cur.module&&window.Profile?.markSeenStories&&window.Profile.markSeenStories(e)}function y(e){"profile"===window.cur.module&&window.Profile?.markLiveInStoriesFinished&&window.Profile.markLiveInStoriesFinished(e)}function g(e,t,s,d,_){const l=(0,n.getBoxLayerWrap)();l&&(window.cur.gftbxWasScroll=l.scrollTop,l.scrollTop=0);_&&_<0?(0,u.giftStickerProducts)([-_],[e],{ref:d??r.GiftRef.PROFILE_BUTTON,gift_ref:d??r.GiftRef.PROFILE_BUTTON}):(0,a.showBox)("al_gifts.php",{act:"get_gift_box",mid:e,fr:e===t?1:0,ref:d??r.GiftRef.PROFILE_BUTTON,gift:_??null},{stat:["gifts.css",window.jsc("web/wide_dd.js"),"wide_dd.css"],cache:1},s)}function f(e,t,s=r.GiftRef.PROFILE_BUTTON){(0,d.statlogsValueEvent)("gifts_tooltip_action",0,"gift_click",t),(0,a.showBox)("al_gifts.php",{act:"get_gift_box",mid:e,gift:t,ref:s})}function E(e,t,s){return!(0,a.showBox)("al_gifts.php",{act:"box",tab:s||"received",mid:e},{cache:1,stat:["gifts.css",window.jsc("web/gifts.js")]},t)}function A(e,t,s,a){(0,l.showSilentModeEnabledFormBox)({csrf:s,endDate:e,callsMailSend:t,redirectOnClose:!1,redirectOnSubmit:!1,onSubmit:a})}},646367:(e,t,s)=>{"use strict";s.r(t),s.d(t,{showAskQuestionBox:()=>p,showMyQuestionsBox:()=>c});var a=s(754866),n=s(246429),r=s(131393),d=s(680960),_=s(540462),l=s(148230),u=s(508611);function c(e){if(!(0,_.partConfigEnabled)("profile_questions_enabled"))return;if(window.cur.viewAsBox)return void window.cur.viewAsBox();if(window.MyQuestionsBox?.isMounted())return;e?.ref&&(0,u.logQuestionsOpeningEvent)(window.vk.id,e.ref,l.QuestionAnalyticBoxName.myQuestions);const t=document.querySelector("#box_layer_wrap"),s=document.querySelector("#box_loader");(0,a.show)(t),(0,a.show)(s),(0,n.refreshBoxLoaderCoords)(),Promise.all([(0,r.getQuestions)(),window.stManager.add([window.jsc("web/my_questions.js")]),new Promise(((e,t)=>{window.ajax.post("al_questions.php",{act:"load_ask_my_questions_box_lang_keys"},{onDone:()=>{e()},onFail:()=>(t(),!0)})}))]).then((([n])=>{window.boxQueue.count()||(0,a.hide)(t),(0,a.hide)(s),window.MyQuestionsBox.init(n.count,n.items,n.profiles,n.next_from,{onClose:e?.onClose,fromElement:e?.fromElement})})).catch((e=>{(0,a.hide)(t),(0,a.hide)(s),(0,d.logQuestionError)({error:e,additionalText:"An error occurred while loading data for my_questions.js"})}))}function p(e,t){if(!(0,_.partConfigEnabled)("profile_questions_enabled"))return;if(e===window.vk.id)return void c({ref:t?.ref,fromElement:t?.fromElement});if(window.cur.viewAsBox)return void window.cur.viewAsBox();if(window.AskQuestionBox?.isMounted())return;if(!e)return void(0,d.logQuestionError)({error:"Empty toUserId has been passed to showAskQuestionBox"});t?.ref&&(0,u.logQuestionsOpeningEvent)(e,t.ref,l.QuestionAnalyticBoxName.askQuestion);const s=document.querySelector("#box_layer_wrap"),p=document.querySelector("#box_loader");(0,a.show)(s),(0,a.show)(p),(0,n.refreshBoxLoaderCoords)(),Promise.all([(0,r.getUsers)([e]),window.stManager.add([window.jsc("web/ask_question.js")]),new Promise(((e,t)=>{window.ajax.post("al_questions.php",{act:"load_ask_question_box_lang_keys"},{onDone:()=>{e()},onFail:()=>(t(),!0)})}))]).then((([e])=>{(0,a.hide)(s),(0,a.hide)(p);const n=e[0];n&&window.AskQuestionBox.init(n,t?.fromElement)})).catch((e=>{(0,a.hide)(s),(0,a.hide)(p),(0,d.logQuestionError)({error:e,additionalText:"An error occurred while loading data for ask_question.js"})}))}},792242:(e,t,s)=>{"use strict";s.d(t,{showSilentModeEnabledFormBox:()=>_,showSilentModeEndFormBox:()=>l,showSilentModeFormBox:()=>d});var a=s(474848),n=s(725669),r=s(281356);function d(e){const t=(0,n.asyncComponent)((()=>Promise.all([s.e(91498),s.e(89631),s.e(73214),s.e("langs/web/SilentModeForms")]).then(s.bind(s,544993))),(({SilentModeForm:e})=>e));(0,r.showMessageBoxModalSuspense)((s=>(0,a.jsx)(t,{...s,...e})),{width:400})}function _(e){const t=(0,n.asyncComponent)((()=>Promise.all([s.e(91498),s.e(89631),s.e(73214),s.e("langs/web/SilentModeForms")]).then(s.bind(s,828186))),(({SilentModeEnabledForm:e})=>e));(0,r.showMessageBoxModalSuspense)((s=>(0,a.jsx)(t,{...s,...e})),{width:400})}function l(e,t){const d=(0,n.asyncComponent)((()=>Promise.all([s.e(91498),s.e(89631),s.e(73214),s.e("langs/web/SilentModeForms")]).then(s.bind(s,734350))),(({SilentModeEndForm:e})=>e));(0,r.showMessageBoxModalSuspense)((t=>(0,a.jsx)(d,{...t,...e})),{width:400,onDestroy:t})}},90345:(e,t,s)=>{"use strict";s.d(t,{EventItemType:()=>n.EventItemType,SearchClickActionMap:()=>n.SearchClickActionMap,getTrackCodeFromElement:()=>d,logEvent:()=>_,logSearchAudioClick:()=>u,logSearchClipClick:()=>l,logSearchPlaylistClickOut:()=>c});var a=s(314309),n=s(317216),r=s(843570);const d=(e,t)=>e?t&&e.dataset?.[t]?e.dataset?.[t]||"":e.dataset?.trackCode?e.dataset?.trackCode||"":d(e.parentElement,t):"",_=e=>{e.track_code&&a.searchStatsCollector.logEvent(e)},l=e=>{/^search$|^clips\/search$|^search\?|^clips\/search\?|^search\/clips$|^search\/clips?$/g.test(window?.mvcur?.mvPrevLoc?.[0]??"")&&window?.mvcur?.mvShown&&a.searchStatsCollector.logEvent({action:e,type:n.EventItemType.CLIP,track_code:(0,r.getVideoTrackCode)()})},u=(e,t="")=>{_({action:e,track_code:t,type:n.EventItemType.MUSIC_AUDIO})},c=e=>{a.searchStatsCollector.logOutOfSerpEvent({type:n.EventItemType.MUSIC_PLAYLIST,action:e})}},843570:(e,t,s)=>{"use strict";s.d(t,{getVideoTrackCode:()=>r,pickTrackCodeFromURL:()=>n});var a=s(231450);const n=()=>{setTimeout((()=>a.TRACK_CODE_TYPES.some((e=>(e=>{const t=window.nav.objLoc[e];if(!t)return!1;const s={...window.nav.objLoc};return delete s[e],window.nav.setLoc(s,{replace:!0}),history.replaceState({...history.state,[e]:t},""),!0})(e)))))},r=()=>window?.Videoview?.getMvData()?.track_code??window.mvcur?.options?.addParams?.track_code??""},862566:(e,t,s)=>{"use strict";async function a(e){const{showMenuSettingsBox:t}=await Promise.all([s.e(91498),s.e(89631),s.e(6694),s.e("langs/web/menu_settings")]).then(s.bind(s,641921));t(e)}s.d(t,{loadMenuSettingsBox:()=>a})},187403:(e,t,s)=>{"use strict";s.d(t,{initColorSchemeDropdowns:()=>d});var a=s(19589),n=s(64323),r=s(428374);function d(){document.querySelectorAll(".SettingsColorSchemeDropdown").forEach((e=>{!function(e){if(e.dataset.inited)return;e.dataset.inited="1";let t=e.dataset.value,s=JSON.parse(e.dataset.items||"[]");a.ColorScheme.isSchemesAutoSwitchingSupported()||(t===a.ColorSchemeMode.Auto&&(t=a.ColorSchemeMode.Light),s=s.filter((([e])=>e!==a.ColorSchemeMode.Auto)));const d=new r.InlineDropdown(e,{selected:t,items:s,onSelect(t){a.colorScheme.setMode(t),(0,n.logTopNavElements)("theme");const s=e.dataset.hash;window.ajax.post("al_settings.php?act=a_save_color_scheme_mode",{mode:t,hash:s})}}),_=a.colorScheme.subscribe((()=>{e&&d?d.val(a.colorScheme.getMode(),!0):_()}))}(e)}))}},944041:(e,t,s)=>{"use strict";s.d(t,{getCache:()=>l,getPackByStickerId:()=>y,getSticker:()=>c,getStickers:()=>p,updateCache:()=>u});var a=s(761520),n=s(353679),r=s(612831),d=s(440487),_=s(469004);const l=()=>{if(!window.stickersCache){const e=_.ls.get("stickers_cache");window.stickersCache={...n.DEFAULT_CACHE,...e}}return window.stickersCache},u=e=>{window.stickersCache={...l(),...e}},c=e=>l().stickers.get(e),p=e=>{const{stickers:t}=l();return e.map((e=>t.get(e)))},m=e=>{const t=c(e);if(!t||!t.pack_id)return null;const s=(0,d.getProductFromCache)(t.pack_id);return s&&(0,r.isBasePack)(s)?s:null},y=e=>{const t=m(e);return t?Promise.resolve(t):new Promise((t=>{a.ajax.post("stickers.php",{act:"get_products",sticker_ids:[e]},{onDone(s){(0,d.cacheProductsData)(s),t(m(e))},onFail:e=>(console.error(e),t(null),!0)})}))}},416577:(e,t,s)=>{"use strict";s.d(t,{Cart:()=>l});var a=s(761520),n=s(433409),r=s(353679),d=s(440487),_=s(246429);class l{static create(e,t=[]){const s=e.map((e=>({product_id:e,amount:1})));return new l(s,t)}copy(){const e=new l(this.getItems(),this.getRecipientIds());return e.setOrder(this.getOrder()),e}getItems(){return Array.from(this.items.values())}setItems(e){this.items=new Map(e.map((e=>[e.product_id,e])))}loadItems(){const e=Array.from(this.items.keys());return(0,d.getProducts)(e).then((()=>{for(const e of Array.from(this.items.values()))e.product=(0,d.getProductFromCache)(e.product_id)}))}getProducts(){return(0,d.getProductsFromCache)(Array.from(this.items.keys()))}hasProduct(e){return this.items.has(e)}addProduct(e,t=!1){if(!this.hasProduct(e)){const s={product_id:e,amount:1};t?this.setItems([...this.getItems(),s]):this.setItems([s,...this.getItems()]),this.onChange&&this.onChange()}}removeProduct(e){this.hasProduct(e)&&(this.items.delete(e),this.onChange&&this.onChange())}getRecipientIds(e=!1){return this.recipientIds.size?Array.from(this.recipientIds.values()):this.isGift&&e?[r.SAMPLE_RECIPIENT_ID]:[]}setRecipientIds(e){this.recipientIds=new Set(e)}hasRecipientId(e){return this.recipientIds.has(e)}addRecipientId(e){this.hasRecipientId(e)||(this.recipientIds.add(e),this.onChange&&this.onChange())}removeRecipientId(e){this.hasRecipientId(e)&&(this.recipientIds.delete(e),this.onChange&&this.onChange())}setOrder(e){if(this._order=e,e){this.recipientIds.clear();for(const t of e.items)t.recipient_id!==r.SAMPLE_RECIPIENT_ID&&this.recipientIds.add(t.recipient_id)}}loadOrder(e){const t=e.items.map((e=>e.product_id));return(0,d.getProducts)(t).then((t=>({...e,items:e.items.map(((e,s)=>({...e,product:t[s]})))})),(()=>e))}getOrder(){return this._order}getRecipientsMap(){return this.recipients}getRecipients(){return Array.from(this.recipients.values())}getRecipientById(e){return this.recipients.get(e)}addRecipients(e){this.recipients=new Map([...this.getRecipients(),...e].map((e=>[e[0],e])))}getJSON(){return JSON.stringify({items:this.getItems().map((e=>({...e,product:void 0}))),recipient_ids:this.getRecipientIds(!0)})}isLoaded(){return null!==this.getOrder()}cancelLoad(){this.loadTimeout&&(window.clearTimeout(this.loadTimeout),this.loadTimeout=null),this.loadCancellationToken&&(this.loadCancellationToken.cancel(),this.loadCancellationToken=null)}load(e=!1){return this.cancelLoad(),new Promise((t=>{this.loadTimeout=window.setTimeout((()=>{this.loadCancellationToken=new n.AjaxCancellationToken,a.ajax.post("stickers.php",{act:"preview_products_order",cart:this.getJSON(),with_suggested_recipients:e?1:0},{cancellationToken:this.loadCancellationToken,onDone:e=>{(0,d.cacheProductsData)(e),Promise.all([this.loadItems(),this.loadOrder(e.order)]).then((([,s])=>{this.setOrder(s),e.recipients&&this.addRecipients(e.recipients),t(this)}),(()=>{}))},onFail:e=>(e&&window.__dev&&console.error(e),t(this),!0)})}),300)}))}order({ignoreEmptyError:e,emptyErrorLoader:t,...s}={}){return new Promise((n=>{a.ajax.post("stickers.php",{act:"order_products",cart:this.getJSON(),hash:s.hash||this.getOrder()?.hash,message:s.message,is_private:s.is_private?1:0,ref:s.ref,gift_ref:s.gift_ref,v:s.v,random_sticker_pack_attempt_id:s.randomStickerPackAttemptId},{onDone:e=>{requestAnimationFrame((()=>{(0,_.hideBoxLoader)()})),(0,d.cacheProductsData)(e),e.result.random_selector_result=e.random_selector_result,Promise.all([this.loadOrder(e.order),this.loadOrder(e.result)]).then((([e,t])=>{this.setOrder(e),n(t)}),(()=>{}))},onFail:s=>!s&&e?(t&&requestAnimationFrame((()=>{(0,_.showBoxLoader)()})),!0):(s&&console.error(s),n(null),!0)})}))}constructor(e,t=[]){this.loadTimeout=null,this.loadCancellationToken=null,this.isGift=!1,this.onChange=null,this._order=null,this.setItems(e),this.recipientIds=new Set(t),this.recipients=new Map}}},25221:(e,t,s)=>{"use strict";s.d(t,{StickerProductsGift:()=>M});var a=s(474848),n=s(296540),r=s(694244),d=s(782174),_=s(63614),l=s(303800),u=s(700272),c=s(945206),p=s(944048),m=s(908242),y=s(817590),g=s(246429),f=s(102088),E=s(866467),A=s(612831),P=s(847771),b=s(212125),I=s(890221),T=s(150445),C=s(764557),O=s(8520);const M=({cart:e,options:{ref:t,gift_ref:s},closeBox:M,updateBox:S})=>{const[D,k]=(0,b.useCart)(e),L=!D.isLoaded()&&k;(0,n.useEffect)((()=>{S()}),[L]);const R=D.getRecipientIds(),B=D.getOrder(),x=B&&!B.error&&B.items.find((e=>!e.error&&!(0,P.isSampleOrderItem)(e))),[F,U]=function(e){if(!e)return[null,null];let t;for(const s of e.items){const{product:e}=s;if(e&&(0,A.isPackProduct)(e)){t=e;break}}let s=e.items.filter((({product:e})=>e?.can_gift));const a=s.filter((e=>!e.error&&!(0,P.isSampleOrderItem)(e)));a.length&&(s=a);const n=new A.ProductsByType(s.map((e=>e.product))),r=n.pack.values().next().value,d=Array.from(n.style);let _="",l="";if(1===d.length)_=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_title_1_style"),"title",d[0].title),r?l=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_description_with_pack"),"title",r.title):t&&(l=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_description_for_pack"),"title",t.title));else if(r){if(_=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_title_pack"),"title",r.title),d.length)switch(d.length){case 2:l=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_description_with_2_styles"),"title1",d[0].title,"title2",d[1].title);break;case 3:l=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_description_with_3_styles"),"title1",d[0].title,"title2",d[1].title,"title3",d[2].title);break;case 4:l=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_description_with_3_styles_and_1_more"),"title1",d[0].title,"title2",d[1].title,"title3",d[2].title);break;default:const e=d.length-3;l=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_description_with_3_styles_and_n_more",e),"title1",d[0].title,"title2",d[1].title,"title3",d[2].title,"n",e)}}else if(d.length){switch(d.length){case 2:_=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_title_2_styles"),"title1",d[0].title,"title2",d[1].title);break;case 3:_=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_title_3_styles"),"title1",d[0].title,"title2",d[1].title,"title3",d[2].title);break;case 4:_=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_title_3_styles_and_1_more"),"title1",d[0].title,"title2",d[1].title,"title3",d[2].title);break;default:const e=d.length-3;_=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_title_3_styles_and_n_more",e),"title1",d[0].title,"title2",d[1].title,"title3",d[2].title,"n",e)}t&&(l=(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_description_for_pack"),"title",t.title))}d.length?l+=" "+(0,E.getLang)("purchases_stickers_gift_description_styles"):l+=" "+(0,E.getLang)("purchases_stickers_gift_description");return[_,l]}(B),[,N]=(0,n.useState)(null);(0,n.useLayoutEffect)((()=>{const e=D.getRecipients();if(N(window.WideDropdown.init("StickerProductsGiftRecipientsDropdown",{defaultItems:e,items:e,noResult:(0,E.getLang)("gifts_nobody_found"),introText:(0,E.getLang)("gifts_start_typing_recipient"),maxItems:20,onChange:(e,t)=>{1===e?D.addRecipientId(+t):D.removeRecipientId(+t)}})),R.length)for(const e of R){const t=D.getRecipientById(e);t&&window.WideDropdown.select("StickerProductsGiftRecipientsDropdown",!1,t)}else window.WideDropdown.focus("StickerProductsGiftRecipientsDropdown");return()=>{window.WideDropdown.deinit("StickerProductsGiftRecipientsDropdown")}}),[L]);const[W,V]=(0,n.useState)(""),[K,H]=(0,n.useState)(!1),[j,$]=(0,n.useState)(!1),G=()=>{j||($(!0),D.order({message:W,is_private:K,ref:t,gift_ref:s}).then((e=>{$(!1),e&&!e.error&&((0,g.showDoneBox)(function(e,t){const s=new A.ProductsByType(e.items.filter((e=>!e.error)).map((e=>e.product))),a=function(e){const t=e.getPack(),s=e.getStyles();if(t)return s.length?(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_products_pack_and_styles",s.length),"title",t.title,"styles_num",s.length):(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_products_pack"),"title",t.title);if(s.length)switch(s.length){case 1:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_products_1_style"),"title",s[0].title);case 2:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_products_2_styles"),"title1",s[0].title,"title2",s[1].title);case 3:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_products_3_styles"),"title1",s[0].title,"title2",s[1].title,"title3",s[2].title);case 4:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_products_3_styles_and_1_more"),"title1",s[0].title,"title2",s[1].title,"title3",s[2].title);default:{const e=s.length-3;return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_products_3_styles_and_n_more",e),"title1",s[0].title,"title2",s[1].title,"title3",s[2].title,"n",e)}}return null}(s);if(!a)return null;const n=new Set;for(const s of e.items){const{error:e,recipient_id:a}=s;if(e)continue;const r=t(a);r&&n.add(r)}const r=function(e,t){const s=Array.from(e.values());switch(s.length){case 0:return null;case 1:{const e=1===t?(0,E.getLang)("purchases_stickers_gift_result_1_recipient_single","raw"):(0,E.getLang)("purchases_stickers_gift_result_1_recipient_multiple","raw");return(0,f.langStr)((0,E.langSex)(s[0][8],e),"name",s[0][8])}case 2:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_2_recipients",t),"name1",s[0][8],"name2",s[1][8]);case 3:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_3_recipients",t),"name1",s[0][8],"name2",s[1][8],"name3",s[2][8]);case 4:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_4_recipients",t),"name1",s[0][8],"name2",s[1][8],"name3",s[2][8],"name4",s[3][8]);case 5:return(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_result_5_recipients",t),"name1",s[0][8],"name2",s[1][8],"name3",s[2][8],"name4",s[3][8],"name5",s[4][8]);default:{const e=s.length-4,a=1===t?(0,E.getLang)("purchases_stickers_gift_result_4_recipients_and_n_more_single"):(0,E.getLang)("purchases_stickers_gift_result_4_recipients_and_n_more_multiple");return(0,f.langStr)(a,"name1",s[0][8],"name2",s[1][8],"name3",s[2][8],"name4",s[3][8],"n",e)}}return null}(n,s.getCount());if(!r)return null;return(0,f.langStr)(r,"products",a)}(e,(e=>D.getRecipientById(e)))),M())}),(()=>{})))};return(0,n.useEffect)((()=>{window.WideDropdown.disable("StickerProductsGiftRecipientsDropdown",j)}),[j]),(0,a.jsxs)(r.ModalBox,{"data-testid":"sticker-gift-modal",children:[(0,a.jsx)(d.ModalHeader,{onClose:M,closeAriaLabel:(0,E.getLang)("global_close"),children:(0,E.getLang)("purchases_stickers_gift_box_title")}),(0,a.jsx)(_.ModalBody,{insetLevel:2,children:L?(0,a.jsx)(l.Div,{children:(0,a.jsx)(u.Spinner,{stretched:!0})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.default,{order:B,forceValid:!x}),(0,a.jsx)("h1",{className:"StickerProductsGift__productsTitle",children:(0,O.decodeHTMLEntities)(F||"")}),(0,a.jsx)("p",{className:"StickerProductsGift__productsDescription",children:(0,O.decodeHTMLEntities)(U||"")}),B&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("dl",{className:"StickerProductsGift__price",children:[(0,a.jsx)("dt",{className:"StickerProductsGift__priceLabel",children:(0,E.getLang)("purchases_gift_price_label")})," ",(0,a.jsx)("dd",{className:"StickerProductsGift__priceValue",children:(0,E.getLang)("global_n_votes",B.price.current)})]}),(0,a.jsx)("div",{className:"StickerProductsGift__balance",children:(0,f.langStr)((0,E.getLang)("gifts_you_have_X_votes"),"votes",(0,E.getLang)("global_n_votes",B.balance))})]}),(0,a.jsxs)("div",{className:"StickerProductsGift__recipients",children:[(0,a.jsx)("label",{className:"StickerProductsGift__recipientsLabel",htmlFor:"StickerProductsGiftRecipientsInput",children:(0,E.getLang)("gifts_receiver")}),(0,a.jsxs)("div",{className:"wdd StickerProductsGift__recipientsDropdown",id:"StickerProductsGiftRecipientsDropdown",children:[(0,a.jsx)("div",{className:"fl_r wdd_arr"}),(0,a.jsx)("input",{className:"wdd_text fl_l",id:"StickerProductsGiftRecipientsInput",placeholder:(0,E.getLang)("gifts_choose_recipients")})]})]}),(0,a.jsxs)("div",{className:"StickerProductsGift__message",children:[(0,a.jsx)("label",{className:"StickerProductsGift__messageLabel",htmlFor:"StickerProductsGiftMessageInput",children:(0,E.getLang)("purchases_gift_your_message")}),(0,a.jsx)(c.Textarea,{id:"StickerProductsGiftMessageInput",rows:3,value:W,onChange:e=>V(e.currentTarget.value),onResize:()=>S(),disabled:j})]}),(0,a.jsx)(p.Checkbox,{noPadding:!0,stretched:!1,checked:K,disabled:j,onChange:()=>H(!K),children:(0,E.getLang)("gifts_receiver_only")})]})}),(0,a.jsx)(m.ModalFooter,{before:(0,a.jsx)("div",{className:"StickerProductsGift__footerNote",children:!k&&B&&(0,a.jsxs)("div",{className:"StickerProductsGift__details",children:[(0,E.getLang)("purchases_stickers_gift_details_label"),(0,a.jsx)(y.HintIcon,{gap:"l",tooltip:{placement:"top",...(0,T.stickerProductsGiftDetails)({order:B,recipients:D.getRecipientsMap()})}})]})}),actions:(0,a.jsx)(C.default,{className:"StickerProductsGift__gift",mode:x?"primary":"secondary",size:"m",loading:k||j,disabled:!x,price:B?.price,text:x?(0,f.langStr)((0,E.getLang)("purchases_stickers_gift_send_for"),"price",(0,E.getLang)("global_n_votes",B?.price.current)):(0,E.getLang)("purchases_stickers_gift_send"),onClick:()=>G()})})]})}},150445:(e,t,s)=>{"use strict";s.d(t,{stickerProductsGiftDetails:()=>p});var a=s(474848),n=s(296540),r=s(8520),d=s(373080),_=s(102088),l=s(866467),u=s(847771),c=s(612831);const p=({order:e,recipients:t})=>{const s=function(e){if(!e)return null;let t=e.items.filter((({product:e})=>e?.can_gift));const s=t.filter((e=>!e.error&&!(0,u.isSampleOrderItem)(e)));s.length&&(t=s);const a=[],n=[];for(const e of t){const{product:t}=e;t&&((0,c.isPackProduct)(t)?a.push(e):(0,c.isStyleProduct)(t)&&n.push(e))}const r=n.reduce(((e,t)=>e+(t.price?.current||0)),0);if(a.length){const e=a.reduce(((e,t)=>e+(t.price?.current||0)),0);return n.length?(0,_.langStr)((0,l.getLang)("purchases_stickers_gift_details_summary_pack_with_styles",n.length),"pack_price_sum",(0,l.getLang)("global_n_votes",e),"styles_num",n.length,"styles_price_sum",(0,l.getLang)("global_n_votes",r)):(0,_.langStr)((0,l.getLang)("purchases_stickers_gift_details_summary_pack"),"pack_price_sum",(0,l.getLang)("global_n_votes",e))}if(n.length)return(0,_.langStr)((0,l.getLang)("purchases_stickers_gift_details_summary_styles",n.length),"styles_num",n.length,"styles_price_sum",(0,l.getLang)("global_n_votes",r));return null}(e)||"",p=new Map;for(const s of e.items){const{error:e,product:a,recipient_id:n}=s;if(e)continue;const r=t.get(n);if(!r)continue;let d=p.get(r);d||(d=new c.ProductsByType,p.set(r,d)),d.add(a)}const y=Array.from(p.entries()),g=y.length,f={maxWidth:291,text:y.map((([e,t])=>(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(d.InnerHTML,{Component:"span",children:e[1]}),": ",(0,r.decodeHTMLEntities)(m(t)||"")," "]},e[0])))};return f[s&&g?"header":"text"]=(0,a.jsx)(d.InnerHTML,{children:s}),f};function m(e){const t=e.getPack(),s=e.getStyles();let a="";return s.length&&(a=s.map((e=>(0,_.langStr)((0,l.getLang)("purchases_stickers_gift_details_recipient_style_title"),"title",e.title))).join(", ")),t?a?(0,_.langStr)((0,l.getLang)("purchases_stickers_gift_details_recipient_pack_and_styles"),"pack_title",t.title,"style_titles",a):(0,_.langStr)((0,l.getLang)("purchases_stickers_gift_details_recipient_pack"),"title",t.title):a?(0,_.langStr)((0,l.getLang)("purchases_stickers_gift_details_recipient_styles"),"style_titles",a):null}},890221:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var a=s(474848),n=s(8520),r=s(612831),d=s(847771);const _={s:56,m:96,l:168},l="sticker-products-gifts-icon",u=({order:e,forceValid:t=!1})=>{const s=new Map,u=new Map;if(e)for(const t of e.items){const{product:e}=t;e&&((0,r.isPackProduct)(e)?s.has(e)?s.get(e)?.push(t):s.set(e,[t]):(0,r.isStyleProduct)(e)&&(u.has(e)?u.get(e)?.push(t):u.set(e,[t])))}const c=s.keys().next().value,p=(c?1:0)+u.size,m=p>1?p>2?"s":"m":"l",y=_[m],g=Array.from(u.entries());t||g.sort((([,e],[,t])=>t.filter((e=>!e.error)).length-e.filter((e=>!e.error)).length));const f=g.slice(0,3);let E=g.slice(3),A=!0;if(!t){const e=E.filter((([,e])=>e.find((e=>!e.error))));e.length?E=e:A=!1}return(0,a.jsxs)("ul",{className:"StickerProductsGiftIcons",children:[c&&(0,a.jsx)("li",{"data-testid":l,className:(0,n.classNames)("StickerProductsGiftIcons__icon",`StickerProductsGiftIcons__icon--${m}`,"StickerProductsGiftIcons__icon--pack",{"StickerProductsGiftIcons__icon--invalid":!t&&!s.get(c)?.find((e=>!e.error))}),style:{backgroundImage:`url(${(0,d.getStickerPackIconUrl)(c,y,y)})`}},c.id),f.map((([e,s])=>(0,a.jsx)("li",{"data-testid":l,className:(0,n.classNames)("StickerProductsGiftIcons__icon",`StickerProductsGiftIcons__icon--${m}`,"StickerProductsGiftIcons__icon--style",{"StickerProductsGiftIcons__icon--invalid":!t&&!s.find((e=>!e.error))}),style:{backgroundImage:`url(${(0,d.getStickerPackIconUrl)(e,y,y)})`}},e.id))),E.length?(0,a.jsxs)("li",{"data-testid":l,className:(0,n.classNames)("StickerProductsGiftIcons__icon",`StickerProductsGiftIcons__icon--${m}`,"StickerProductsGiftIcons__icon--more",{"StickerProductsGiftIcons__icon--invalid":!A}),children:["+",E.length]},"more"):null]})}},764557:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(474848),n=s(296540),r=s(454154),d=s(8520),_=s(866467);const l=({className:e,price:t,text:s,placeholder:l,...u})=>{let c=(0,n.useMemo)((()=>{if(t){let e;t.current!==t.regular&&t.regular&&(e=(0,a.jsx)("span",{className:"StickersPriceButton__regular",children:t.current?t.regular:(0,_.langStr)((0,_.getLang)("purchases_stickers_n_for_m"),"%n","","%m",(0,_.getLang)("global_n_votes",t.regular))},"regular"));const n=(0,a.jsx)("span",{className:"StickersPriceButton__current",children:t.current?(0,_.getLang)("global_n_votes",t.current):(0,_.getLang)("purchases_for_free_btn").toLowerCase()},"current");return s?s.split(/(\{regular_price\}|\{price\})/).map(((t,s)=>"{regular_price}"===t?e:"{price}"===t?n:t?(0,a.jsx)("span",{className:"StickersPriceButton__label",children:t},`label${s}`):void 0)):[e,n]}return[l]}),[s,l,t?.regular,t?.current]);return(0,a.jsx)(r.Button,{className:(0,d.classNames)("StickersPriceButton",e),...u,children:c})}},614098:(e,t,s)=>{"use strict";var a;s.d(t,{REGULAR_SIZES:()=>r,SIZE_512:()=>n,STICKER_ICON_CLASS:()=>_,STICKER_ROW_CLASS:()=>d,StickerSize:()=>a}),function(e){e[e.SMALL=128]="SMALL",e[e.MIDDLE=168]="MIDDLE",e[e.BIG=208]="BIG"}(a||(a={}));const n=512,r=[64,128,256,352,n],d="stickerRow",_="stickerIcon"},212125:(e,t,s)=>{"use strict";s.d(t,{useCart:()=>n});var a=s(296540);const n=e=>{const[t,s]=(0,a.useState)(e),[n,r]=(0,a.useState)(null),d=(0,a.useCallback)((()=>{const e=t.load();r(e),e.then((t=>{s(t),r((t=>t===e?null:t))}),(()=>{}))}),[t]);return(0,a.useEffect)((()=>(t.onChange=d,t.isLoaded()||d(),()=>{t.onChange=null,t.cancelLoad()})),[t]),[t,null!==n]}},440487:(e,t,s)=>{"use strict";s.d(t,{activateProduct:()=>m,cacheProductsData:()=>r,getProduct:()=>p,getProductFromCache:()=>d,getProducts:()=>c,getProductsFromCache:()=>_,updateUserProductState:()=>y});var a=s(761520),n=s(944041);const r=(e,t=[])=>{const s=(0,n.getCache)();if(e.stickers){const{stickers:t}=s;for(const s of e.stickers)t.has(s.id)?t.set(s.id,{...t.get(s.id),...s}):t.set(s.id,s)}if(e.products)for(const t of e.products)s.products.set(t.id,t),s.productPromises.delete(t.id);for(const e of t)s.products.has(e)||s.products.set(e,null),s.productPromises.delete(e);e.emoji&&window.Emoji&&window.Emoji.updateTabs(e.emoji.stickers,e.emoji.keywords,!0),(0,n.updateCache)(s)},d=e=>(0,n.getCache)().products.get(e),_=e=>{const t=(0,n.getCache)().products;return e.map((e=>t.get(e)))};function l(){let{productsPromise:e}=(0,n.getCache)();return e||(e=new Promise((e=>setTimeout((()=>{const t=(0,n.getCache)().productIdsQueue,s=Array.from(t);t.clear(),(0,n.updateCache)({productIdsQueue:t,productsPromise:void 0}),a.ajax.post("stickers.php",{act:"get_products",product_ids:s},{onDone(t){r(t,s),e([])},onFail:t=>(console.error(t),r({},s),e([]),!0)})}),300))),(0,n.updateCache)({productsPromise:e})),e}const u=e=>{if(!e.length)return Promise.resolve([]);const{productPromises:t,productIdsQueue:s}=(0,n.getCache)(),a=new Set;for(const n of e)if(t.has(n)){const e=t.get(n);e&&a.add(e)}else{s.add(n);const e=l();t.set(n,e),a.add(e)}return(0,n.updateCache)({productIdsQueue:s,productPromises:t}),Promise.all(a).then((()=>_(e)))},c=(e,t=!0)=>{const s=t?e.filter((e=>void 0===d(e))):e;return s.length?u(s).then((()=>_(e))):Promise.resolve(_(e))},p=(e,t=!0)=>{if(t){const t=d(e);if(void 0!==t)return Promise.resolve(t)}return u([e]).then((()=>d(e)))},m=e=>new Promise((t=>{a.ajax.post("stickers.php",{act:"activate_product",product_id:e.id,hash:e.csrf_hash},{onDone(e){r(e),t()},onFail:e=>(console.error(e),t(),!0)})})),y=(e,t,s,n=!0)=>new Promise((d=>{a.ajax.post("stickers.php",{act:"update_user_product_state",product_ids:[e],key:t,value:s},{onDone(e){n&&r(e),d()},onFail:e=>(console.error(e),d(),!0)})}))},67631:(e,t,s)=>{"use strict";s.d(t,{giftStickerProducts:()=>m,giftStickersCart:()=>p});var a=s(474848),n=s(440961),r=s(865708),d=s(270959),_=s(416577),l=s(177838),u=s(944041),c=s(25221);function p(e,t){const{productsGiftLock:s}=(0,u.getCache)();if(s)return null;let _;(0,u.updateCache)({productsGiftLock:!0});const p={...t};function m(){return _?.bodyNode.querySelector(".StickersProductsGift")}function y(){_?.hide()}function g(){_?.updateBoxCoords()}return(0,l.showLoader)(),e.isGift=!0,Promise.all([e.load(!0),window.stManager.add(["stickers.css",window.jsc("web/wide_dd.js"),"wide_dd.css"])]).then((([e])=>{(0,l.hideLoader)(),_=new d.MessageBox({hideButtons:!0,bodyStyle:"padding: 0; background: none;",width:450,onShow(){!function(e){const t=m();t&&n.render((0,a.jsx)(r.AppRootProvider,{children:(0,a.jsx)(c.StickerProductsGift,{cart:e,options:p,closeBox:y,updateBox:g})}),t)}(e),requestAnimationFrame((()=>{g()}))},onHideAttempt:()=>(function(){const e=m();e&&n.unmountComponentAtNode(e)}(),!0),onHide(){(0,u.updateCache)({productsGiftLock:!1})}}),_.content('<div class="StickersProductsGift"></div>'),_.show()}),(()=>{})),{hide:y}}function m(e,t=[],s){return p(_.Cart.create(e,t),s)}},177838:(e,t,s)=>{"use strict";s.d(t,{findClosestStickerSize:()=>P,getBoxLayerWrap:()=>m,getLangCode:()=>A,getPurchaseResult:()=>f,hideLoader:()=>g,showLoader:()=>y,updateStickersFromQueue:()=>E});var a=s(102088),n=s(866467),r=s(19589),d=s(754866),_=s(246429),l=s(612831),u=s(614098),c=s(847771);function p(){return document.querySelector("#box_loader")}function m(){return document.querySelector("#box_layer_wrap")}function y(){const e=p();(0,_.refreshBoxLoaderCoords)(),(0,d.show)(e),(0,d.show)(m())}function g(){(0,d.hide)(p())}function f(e){const t=new l.ProductsByType(e.items.filter((e=>!e.error)).map((e=>e.product))),s=t.getPack(),r=t.getStyles();if(s)return r.length?(0,a.langStr)((0,n.getLang)("purchases_stickers_purchase_result_pack_and_styles",r.length),"pack_title",s.title,"n",r.length):(0,a.langStr)((0,n.getLang)("purchases_stickers_purchase_result_pack"),"title",s.title);if(r.length)switch(r.length){case 1:return(0,a.langStr)((0,n.getLang)("purchases_stickers_purchase_result_1_style"),"title",r[0].title);case 2:return(0,a.langStr)((0,n.getLang)("purchases_stickers_purchase_result_2_styles"),"title1",r[0].title,"title2",r[1].title);case 3:return(0,a.langStr)((0,n.getLang)("purchases_stickers_purchase_result_3_styles"),"title1",r[0].title,"title2",r[1].title,"title3",r[2].title);case 4:return(0,a.langStr)((0,n.getLang)("purchases_stickers_purchase_result_3_styles_and_1_more"),"title1",r[0].title,"title2",r[1].title,"title3",r[2].title);default:const e=r.length-3;return(0,a.langStr)((0,n.getLang)("purchases_stickers_purchase_result_3_styles_and_n_more",e),"title1",r[0].title,"title2",r[1].title,"title3",r[2].title,"n",e)}return null}function E(e){!function(e){const t=r.colorScheme.isDarkScheme()?"data-src-dark":"data-src-light";e.querySelectorAll(`.sticker_img[${t}]`).forEach((e=>{const s=e.getAttribute(t);s&&(e.src=s)}))}(e)}const A=()=>window.vk.lang||"ru",P=e=>e>u.SIZE_512?((0,c.logStickersError)("Нет размера стикера больше 512px"),u.SIZE_512):u.REGULAR_SIZES.find((t=>t>=e))},288478:(e,t,s)=>{"use strict";s.d(t,{injectTimestampIntoParamsObj:()=>d,makeWrappedImporter:()=>r});var a=s(8520),n=s(703280);function r(e){let t=null;return s=>{if(!(0,n.isStoryPerfStatsEnabledOnDesktopWeb)())return;const r=performance.now();t||(t=(0,a.asyncImportLoader)(e,3),t.then((()=>{}))),t.then((e=>s(e,r)),(()=>{}))}}function d(e,t=performance.now()){return{...e,time:e.time??t}}},703280:(e,t,s)=>{"use strict";s.d(t,{isStoryPerfStatsEnabledOnDesktopWeb:()=>d});var a=s(540462);const n=()=>(0,a.partConfigEnabled)("tech_stories_metrics_web"),r=()=>(0,a.partConfigEnabled)("tech_stories_metrics_web_mvk");function d(){return n()&&r()}},194065:(e,t,s)=>{"use strict";s.d(t,{trackHideViewerLoader:()=>m,trackShowViewerLoader:()=>p,trackStoryClosed:()=>u,trackStoryDownloadEnd:()=>l,trackStoryDownloadFailure:()=>c,trackStoryOpened:()=>d,trackStoryOpeningStart:()=>r,trackStoryViewerClosed:()=>_});var a=s(288478);const n=(0,a.makeWrappedImporter)((()=>Promise.all([s.e(12334),s.e("langs/web/stories-perf-metrics")]).then(s.bind(s,166756)))),r=e=>{n(((t,s)=>{t.trackStoryOpeningStart((0,a.injectTimestampIntoParamsObj)(e,s))}))},d=e=>{n(((t,s)=>{t.trackStoryOpened((0,a.injectTimestampIntoParamsObj)(e,s))}))},_=e=>{n(((t,s)=>{t.trackStoryViewerClosed((0,a.injectTimestampIntoParamsObj)(e,s))}))},l=e=>{n(((t,s)=>{t.trackStoryDownloadEnd((0,a.injectTimestampIntoParamsObj)(e,s))}))},u=e=>{n(((t,s)=>{t.trackStoryClosed((0,a.injectTimestampIntoParamsObj)(e,s))}))},c=e=>{n(((t,s)=>{t.trackStoryDownloadFailure((0,a.injectTimestampIntoParamsObj)(e,s))}))},p=e=>{n(((t,s)=>{t.trackShowViewerLoader((0,a.injectTimestampIntoParamsObj)(e,s))}))},m=e=>{n(((t,s)=>{t.trackHideViewerLoader((0,a.injectTimestampIntoParamsObj)(e,s))}))}},55090:(e,t,s)=>{"use strict";s.d(t,{isWidget:()=>a});const a=()=>window.vk.widget},450927:(e,t,s)=>{"use strict";function a(){return window.stManager.add([window.jsc("web/video.js")])}function n(){return window.VideoUpload?Promise.resolve():Promise.all([s.e(91498),s.e(89631),s.e(50560),s.e(85172),s.e(762),s.e(21529),s.e(76495),s.e(62203),s.e(23089),s.e(36509),s.e(43316),s.e(4926),s.e(7790),s.e(7365),s.e(92010),s.e(65767),s.e(20508),s.e(90176),s.e(32758),s.e(19129),s.e(79934),s.e(51943),s.e("langs/web/VideoUpload")]).then(s.bind(s,193773)).then((({initVideoUpload:e,VideoUpload:t,VideoUploadSubtitles:s,VideoInlineUpload:a})=>{!window.VideoUpload&&t&&(window.VideoUpload=t),!window.VideoUploadSubtitles&&s&&(window.VideoUploadSubtitles=s),!window.VideoInlineUpload&&a&&(window.VideoInlineUpload=a),e()}))}function r(){return window.stManager.add([window.jsc("web/video_showcase.js")])}function d(){return window.stManager.add([window.jsc("web/indexer.js")])}function _(){return window.stManager.add([window.jsc("web/grid_sorter.js")])}s.d(t,{getGridSorterModule:()=>_,getIndexerModule:()=>d,getVideoModule:()=>a,getVideoShowcaseModule:()=>r,getVideoUploadModule:()=>n})},826619:(e,t,s)=>{"use strict";s.d(t,{CreatePlaylistRequestOrigin:()=>M,PlaylistFormEvents:()=>O,VideoAddToPlaylistActionSheetEvents:()=>T,VideoCardAddButtonEvents:()=>C,VideoOrderEvents:()=>I,checkVideoIsPreloaded:()=>P,createPlaylistPopup:()=>f,getAdditionalInfo:()=>c.getAdditionalInfo,getFormattedBigViewsToShortCase:()=>c.getFormattedBigViewsToShortCase,getFormattedPostponePublishDateTime:()=>c.getFormattedPostponePublishDateTime,getFormattedUpdatedTime:()=>c.getFormattedUpdatedTime,getOwnerForShortVideo:()=>S,getVideoTrackCode:()=>y,idlizeCall:()=>m,isMediaHlsSupported:()=>b,logClipClick:()=>g,redirectToRedesignedForm:()=>k,saveShortVideoData:()=>D,startLiveVideoPopup:()=>A,uploadVideoPopup:()=>E});var a=s(450927),n=s(317216),r=s(314309),d=s(468073),_=s(957994),l=s(573825),u=s(863726),c=s(856289),p=s(540462);const m=(e,t=1e3)=>{const s=()=>{setTimeout((()=>e()),t)};return"function"==typeof window.requestIdleCallback?window.requestIdleCallback(s,{timeout:5e3}):s()},y=()=>window?.Videoview?.getMvData()?.track_code||window.mvcur?.options?.addParams?.track_code,g=(e,t)=>{r.shortVideoStatsCollector.logEvent({type:n.EventItemType.CLIP,action:e,track_code:t})},f=async({event:e,ownerId:t,videoId:s,videoOwnerId:n,requestOrigin:r,onClose:d})=>{window.Video||await(0,a.getVideoModule)(),window.Video.createAlbum(e,t,s,n,r,d)},E=(e,t,s)=>{window.VideoUpload.showBox({aid:t,from:"video",oid:e,disabled:s})},A=(e,t)=>{let s;if((0,p.partConfigEnabled)("video_live_start_link")){const e=window.nav.strLoc;s=()=>window.nav.setLoc(t??e),window.nav.setLoc((0,c.getLiveStartURL)())}window.cur.webcast_settings?window.VideoUpload.showLiveVideoLeaveWarning(e,{onDestroy:s}):window.VideoUpload.showLiveTypeModal(e,{onDestroy:s})},P=e=>Object.keys(window.ajaxCache).some((t=>t.startsWith("/al_video.php?act=video_box")&&t.includes(`&video=${e}`))),b=()=>window.MediaSource&&MediaSource.isTypeSupported&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),I={START_LOADING:"VideoOrderEvents/START_LOADING",END_LOADING:"VideoOrderEvents/END_LOADING"},T={INIT:"VideoAddToPlaylistActionSheetEvents/INIT",SHOW:"VideoAddToPlaylistActionSheetEvents/SHOW",HIDE:"VideoAddToPlaylistActionSheetEvents/HIDE"},C={SET_ADD:"VideoCardAddButtonEvents/SET_ADD",SET_ADDED:"VideoCardAddButtonEvents/SET_ADDED",SHOW:"VideoCardAddButtonEvents/SHOW",HIDE:"VideoCardAddButtonEvents/HIDE"},O={CREATE:"PlaylistFormEvents/CREATE",UPDATE:"PlaylistFormEvents/UPDATE",DELETE:"PlaylistFormEvents/DELETE"},M={VIDEO_PLAYLISTS_MODAL:"CreatePlaylistRequestOrigin/VIDEO_PLAYLISTS_MODAL",NEW_PLAYLIST_PAGE:"CreatePlaylistRequestOrigin/NEW_PLAYLIST_PAGE",VIDEO_CATALOG:"CreatePlaylistRequestOrigin/VIDEO_CATALOG"},S=async e=>{if(d.Ranges.isUserId(e)){const[t]=await(0,_.api)("users.get",{user_ids:`${e}`,fields:"is_closed,photo_50,photo_100,first_name,last_name,screen_name,domain"});return t}{const{groups:t}=await(0,_.api)("groups.getById",{group_ids:String(Math.abs(e)),fields:"is_closed,photo_50,photo_100,name,screen_name"});return t?.[0]??null}},D=(e,t)=>{const s=new l.ShortVideoUploadService;s.setOwner(t),s.setFiles(e)},k=e=>{if(!location.pathname.includes(u.CLIPS_SECTIONS.UPLOAD)){const t=d.Ranges.isGroupId(e)?d.Ranges.convertGroupIdToOwnerId(e):e;window.nav.go(`${u.BASE_ROUTE}/upload${t}`)}}},755330:(e,t,s)=>{"use strict";s.d(t,{Ranges:()=>a.Ranges});var a=s(810068)},220428:(e,t,s)=>{"use strict";s.d(t,{DIRootWebProvider:()=>a.DIRootWebProvider});var a=s(319756)},863726:(e,t,s)=>{"use strict";s.d(t,{BASE_ROUTE:()=>a.BASE_ROUTE,CLIPS_SECTIONS:()=>a.CLIPS_SECTIONS,EXCLUDED_SECTIONS:()=>a.EXCLUDED_SECTIONS,PUBLISH_STAT_LOG_SECTIONS:()=>a.PUBLISH_STAT_LOG_SECTIONS,ROUTES:()=>a.ROUTES,getArtistUrl:()=>n.getArtistUrl,getClipsGridSoundUrl:()=>n.getClipsGridSoundUrl,getCompilationUrl:()=>n.getCompilationUrl,getEffectUrl:()=>n.getEffectUrl,getFeedTopUrl:()=>n.getFeedTopUrl,getFeedUrl:()=>n.getFeedUrl,getHashtagUrl:()=>n.getHashtagUrl,getMarketUrl:()=>n.getMarketUrl,getMusicUrl:()=>n.getMusicUrl,getOwnerClipsUrl:()=>n.getOwnerClipsUrl,getOwnerProfileUrl:()=>n.getOwnerProfileUrl,getOwnerUrl:()=>n.getOwnerUrl,getPlaceUrl:()=>n.getPlaceUrl,getPlaylistUrl:()=>n.getPlaylistUrl,getPopupClipUrl:()=>n.getPopupClipUrl,getPostponedClipsUrl:()=>n.getPostponedClipsUrl,getPublishedClipsUrl:()=>n.getPublishedClipsUrl,getSharedClipFullUrl:()=>n.getSharedClipFullUrl,getStatisticsUrl:()=>n.getStatisticsUrl,usePath:()=>d.usePath,useRoute:()=>r.useRoute});var a=s(942765),n=s(120197),r=s(223347),d=s(902875)},942765:(e,t,s)=>{"use strict";s.d(t,{BASE_ROUTE:()=>n,BASE_SINGLE_CLIP_ROUTE:()=>r,CLIPS_SECTIONS:()=>d,CLIP_POPUP_QUERY_PARAMETER:()=>p,CLIP_QUERY_PARAMETER:()=>c,EXCLUDED_SECTIONS:()=>_,PUBLISH_STAT_LOG_SECTIONS:()=>u,ROUTES:()=>l});var a=s(317849);const n="/clips",r="/clip",d={TOP:"top",SUBSCRIPTIONS:"subscriptions",MY:"my",OWNER:"owner",HASHTAG:"hashtag",UPLOAD:"upload",MUSIC:"music",COMPILATION:"compilation",EFFECT:"effect",POSTPONED:"postponed",PLAYLIST:"playlist",PLACE:"place",SEARCH:"search",SEARCH_SECTION:"search_section"},_=[(0,a.partConfigEnabled)("clips_web_upload_form")?"":d.UPLOAD],l={[d.SEARCH]:`${n}/search`,[d.MY]:[`${n}${window.vk.id}`,`${n}/id${window.vk.id}`],[d.SUBSCRIPTIONS]:`${n}/subscriptions`,[d.UPLOAD]:`${n}/upload(-?\\d+)`,[d.MUSIC]:`${n}/music/(-?\\d+_\\d+)`,[d.HASHTAG]:`${n}/hashtag/(.*)`,[d.COMPILATION]:`${n}/compilation/(\\d+)`,[d.POSTPONED]:`${n}/postponed`,[d.PLAYLIST]:`${n}/playlist/(-?\\d+_\\d+)`,[d.EFFECT]:`${n}/effect/(-?\\d+_-?\\d+)`,[d.PLACE]:`${n}/place/(\\d+)`,[d.OWNER]:[`${n}(-?\\d+)`,`${n}/id(\\d+)`,`${n}/club(\\d+)`,`${n}/([0-9a-z_.-]+)`],[d.TOP]:[`${r}(-?\\d+_\\d+)?`,`${r}`,`${n}`]},u={[d.TOP]:"rec",[d.SUBSCRIPTIONS]:"subscriptions",[d.MY]:"myclips"},c="clip",p="z"},120197:(e,t,s)=>{"use strict";s.d(t,{getArtistUrl:()=>O,getClipsGridSoundUrl:()=>m,getCompilationUrl:()=>P,getEffectUrl:()=>I,getFeedClipUrl:()=>d,getFeedTopUrl:()=>l,getFeedUrl:()=>_,getHashtagUrl:()=>b,getLoginUrl:()=>L,getMarketUrl:()=>D,getMusicUrl:()=>T,getOwnerClipsUrl:()=>E,getOwnerProfileUrl:()=>A,getOwnerUrl:()=>u,getPlaceUrl:()=>S,getPlaylistUrl:()=>C,getPopupClipUrl:()=>p,getPostponedClipsUrl:()=>g,getPublishedClipsUrl:()=>f,getSharedClipFullUrl:()=>c,getStatisticsUrl:()=>y,getUploadUrl:()=>M,isUploadPage:()=>k});var a=s(538522),n=s(755330),r=s(942765);const d=(e,t="")=>e===r.CLIPS_SECTIONS.TOP?`${r.BASE_SINGLE_CLIP_ROUTE}${t}`:`${location.pathname}${t}`,_=(e,t="")=>"top"===e?`${t}`:"top"===e||"subscriptions"===e?`?${r.CLIP_QUERY_PARAMETER}=${t}`:`${r.BASE_ROUTE}`,l=()=>`${r.BASE_ROUTE}`,u=e=>`/${r.BASE_ROUTE}${e}`,c=e=>`${window.location.origin}/clip${e}`,p=e=>`?${r.CLIP_POPUP_QUERY_PARAMETER}=${r.CLIP_QUERY_PARAMETER}${e}`,m=e=>`${r.BASE_ROUTE}/music/${e}`,y=(e=0)=>`/clips_stats#owner_id=${e}`,g=e=>`${r.BASE_ROUTE}/postponed/${n.Ranges.isGroupId(+e)?"club"+Math.abs(+e):e}`,f=e=>{const t=Number(e)?e:`/${e}`;return`${r.BASE_ROUTE}${t}`},E=e=>`${r.BASE_ROUTE}/${e}`,A=e=>`/${e}`,P=e=>`${r.BASE_ROUTE}/compilation/${e}`,b=e=>`${r.BASE_ROUTE}/hashtag/${e}`,I=e=>`${r.BASE_ROUTE}/effect/${e}`,T=e=>`${r.BASE_ROUTE}/music/${e}`,C=(e,t)=>`${r.BASE_ROUTE}/playlist/${e}_${t}`,O=e=>`/artist/${e}`,M=e=>`${r.BASE_ROUTE}/upload${e}`,S=e=>`${r.BASE_ROUTE}/place/${e}`,D=(e,t)=>`${n.Ranges.isGroupId(e)?`club${n.Ranges.convertOwnerIdToGroupId(e)}`:`id${e}`}?w=product${(0,a.joinRawId)({ownerId:e,itemId:t})}&ref=clips&ref_screen=clips`,k=e=>e.includes(`${r.BASE_ROUTE}/${r.CLIPS_SECTIONS.UPLOAD}`),L=e=>`/login${e?`?to=${btoa(e)}`:""}`},902875:(e,t,s)=>{"use strict";s.d(t,{usePath:()=>_});var a=s(899631),n=s(864175),r=s(296540),d=s(120197);const _=e=>{const t=(0,a.useLocation)(),{navigate:s}=(0,n.useNavigate)();return{pushPathToCurrentLoc:(0,r.useCallback)((t=>{window.cur.onAfterReset=(e,t)=>(t.module=e.module,t.urlAttachmentTimeHash=e.urlAttachmentTimeHash,t),s((0,d.getFeedClipUrl)(e,t))}),[t.pathname])}}},223347:(e,t,s)=>{"use strict";s.d(t,{useRoute:()=>d});var a=s(263290),n=s(899631),r=s(942765);function d(){const e=(0,a.useQuery)(),t=(0,n.useLocation)(),s=t.pathname.match(new RegExp("\\/clip(-?\\d+_\\d+)$"))?.[1],d=Boolean(e[r.CLIP_POPUP_QUERY_PARAMETER]);return{activeClipId:e[r.CLIP_QUERY_PARAMETER]||s||"",isPopupOpened:d}}},749903:(e,t,s)=>{"use strict";s.d(t,{getOwnedAudioListSource:()=>r});var a=s(70148),n=s(391751);function r(e,t){const s=function({cookie:e}){const t=e.get(d);if(!t)return null;try{const e=JSON.parse(t);return e||null}catch{return null}}(t);if(!s||!s.ref)return null;const r=a.OwnedIdentity.fromRawId(e),_=a.OwnedIdentity.fromRawId(s.list_id);return(0,n.compareIdentities)(r,_)?s:null}const d="remixaudio_last_list_ref"},658474:(e,t,s)=>{"use strict";s.d(t,{useRefreshModalCoordinates:()=>r});var a=s(296540),n=s(927593);function r(e,t){const s=(0,a.useRef)(0);(0,a.useEffect)((()=>{t()}),[]),(0,n.useResize)(e,(e=>{!function(e,t,s){(function(e,t){const s=window.visualViewport;if(!s)return!1;return function(e,t){return Math.min(e.clientHeight,t.current)}(e,t)>=s.height})(e,t)||s()}(e,s,t),s.current=e.clientHeight}))}},927593:(e,t,s)=>{"use strict";s.d(t,{useResize:()=>r});var a=s(296540),n=s(634444);function r(e,t){const s=(0,n.useStableCallback)(t);(0,a.useEffect)((()=>{const t=e?.current;if(!t)return;const a=new ResizeObserver((()=>s(t)));return a.observe(t),()=>a.disconnect()}),[e])}},736521:(e,t,s)=>{"use strict";s.d(t,{AudioListModalHeaderSkeleton:()=>u});var a=s(474848),n=s(303800),r=s(724648),d=s(157643),_=s(194528),l=s(582192);function u(){return(0,a.jsx)(n.Div,{mode:"vertical",paddingTop:8,paddingBottom:0,spacing:8,children:(0,a.jsx)(n.Div,{mode:"vertical",paddingTop:12,paddingBottom:0,spacing:12,children:(0,a.jsxs)(r.Flex,{direction:"column",children:[(0,a.jsxs)(r.Flex,{direction:"row",justify:"space-between",children:[(0,a.jsx)(d.Skeleton,{width:156,height:156,borderRadius:10}),(0,a.jsxs)(r.Flex,{direction:"column",align:"stretch",children:[(0,a.jsx)(_.Spacing,{size:6}),(0,a.jsx)(r.Flex.Item,{alignSelf:"end",flex:"fixed",flexBasis:0,children:(0,a.jsxs)(r.Flex,{direction:"row",gap:16,children:[(0,a.jsx)(d.Skeleton,{width:16,height:16,circle:!0}),(0,a.jsx)(d.Skeleton,{width:16,height:16,circle:!0})]})}),(0,a.jsx)(d.Skeleton,{width:166,height:16,borderRadius:4}),(0,a.jsx)(_.Spacing,{size:4}),(0,a.jsxs)(r.Flex,{align:"center",children:[(0,a.jsx)(d.Skeleton,{width:16,height:16,circle:!0}),(0,a.jsx)(_.Spacing,{mode:"vertical",size:6}),(0,a.jsx)(d.Skeleton,{height:8,width:40,borderRadius:2})]}),(0,a.jsx)(_.Spacing,{size:4}),(0,a.jsx)(d.Skeleton,{width:187,height:8,borderRadius:2}),(0,a.jsx)(_.Spacing,{size:30}),(0,a.jsx)(d.Skeleton,{width:330,height:16,borderRadius:4})]})]}),(0,a.jsx)(_.Spacing,{size:36}),(0,a.jsx)(d.Skeleton,{width:502,height:16,borderRadius:4}),(0,a.jsx)(_.Spacing,{size:12}),(0,a.jsx)(d.Skeleton,{width:502,height:16,borderRadius:4}),(0,a.jsx)(_.Spacing,{size:12}),(0,a.jsx)(d.Skeleton,{width:502,height:16,borderRadius:4}),(0,a.jsx)(_.Spacing,{size:16}),(0,a.jsx)(l.Separator,{wide:!0})]})})})}},221062:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistModalContentSkeleton:()=>_});var a=s(474848),n=s(194528),r=s(195589),d=s(736521);function _(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.AudioListModalHeaderSkeleton,{}),(0,a.jsx)(r.AudioListItemsSkeleton,{count:5,hasHeader:!0,hasFooter:!0}),(0,a.jsx)(n.Spacing,{size:20})]})}},887205:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistModalLayout:()=>l});var a=s(474848),n=s(296540),r=s(694244),d=s(753457),_=s(658474);function l({children:e,...t}){const{onClose:s,refreshCoordinates:l=(()=>{})}=t,u=(0,n.useRef)(null);return(0,_.useRefreshModalCoordinates)(u,l),(0,a.jsxs)(r.ModalBox,{width:542,getRef:u,children:[(0,a.jsx)(d.ModalDismissButton,{onClick:s}),e]})}},658247:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistModalLayout:()=>a.MusicPlaylistModalLayout});var a=s(887205)},896809:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistModalFallback:()=>d});var a=s(474848),n=s(989732),r=s(658247);function d(){return(0,a.jsx)(r.MusicPlaylistModalLayout,{children:(0,a.jsx)(n.MusicPlaylistFallback,{})})}},176317:(e,t,s)=>{"use strict";s.d(t,{showMusicPlaylistModal:()=>p});var a=s(474848),n=s(8520),r=s(837293),d=s(835077),_=s(220428),l=s(589694),u=s(896809);const c=(0,r.lazyModule)({loader:async()=>{const{MusicPlaylistModal:e}=await Promise.all([s.e(91498),s.e(89631),s.e(21529),s.e(96158),s.e(47541),s.e(75908),s.e(33641),s.e("langs/web/audio_modals_MusicTrackList")]).then(s.bind(s,788339));return e},name:"MusicPlaylistModal",DefaultLoading:l.MusicPlaylistModalSkeleton,DefaultLoadingError:u.MusicPlaylistModalFallback});function p(e,t={}){return(0,d.showMessageBoxModal)((({onClose:t,refreshCoordinates:s})=>(0,a.jsx)(_.DIRootWebProvider,{children:(0,a.jsx)(c,{...e,onClose:t,onDeleted:m(t),refreshCoordinates:s,loading:(0,a.jsx)(l.MusicPlaylistModalSkeleton,{})})})),{...t,width:542,hideOnBGClick:!0,fullscreen:!1,featureFlags:{keepInPhotoView:!0},zLayer:y(e.identity)})}function m(e){return(0,n.debounce)(e,300)}function y(e){return`audio_playlist${e.accessRawId}`}},589694:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistModalSkeleton:()=>d});var a=s(474848),n=s(658247),r=s(221062);function d(){return(0,a.jsx)(n.MusicPlaylistModalLayout,{children:(0,a.jsx)(r.MusicPlaylistModalContentSkeleton,{})})}},694132:(e,t,s)=>{"use strict";s.d(t,{AudioNavScreenModalType:()=>u,AudioNavScreenPageType:()=>l,AudioNavScreenProvider:()=>p});var a=s(434518),n=s(763812),r=s(331635),d=s(132028);const _=(0,s(558137).makeSharedState)("domains/audio/AudioNavScreenState",(()=>({page:null,catalogSectionId:null,modals:[]})),{version:1});var l,u;!function(e){e.Catalog="audio_catalog",e.Artist="music_artist",e.Album="music_album",e.Playlist="music_playlist",e.Track="music_track",e.SnippetsFeed="music_snippets_list",e.Podcast="podcast_podcast"}(l||(l={})),function(e){e.Album="music_album_popup",e.Playlist="music_playlist_popup",e.Longtap="music_longtap_preview_popup",e.PodcastEpisode="podcast_episode_popup"}(u||(u={}));var c=(0,n._)("_clearModal");class p{get isModal(){return!!_().modals.length}get screen(){const e=_(),t=e.modals[0];return t||e.page}get catalogSectionId(){return"audio_catalog"!==this.screen?null:_().catalogSectionId}setPage(e,t){const s=_();s.page=e,s.catalogSectionId=t??null}clearPage(){const e=_();e.page=null,e.catalogSectionId=null}pushModal(e){_().modals.unshift(e)}popModal(e){const t=_();t.modals[0]===e?t.modals.shift():(0,a._)(this,c)[c]()}constructor(){Object.defineProperty(this,c,{value:m})}}function m(){_().modals=[]}p=(0,r.__decorate)([d.scope.global()],p)},841376:(e,t,s)=>{"use strict";s.d(t,{AudioEntityToggleService:()=>g});var a=s(434518),n=s(763812),r=s(331635),d=s(327813),_=s(70916),l=s(74270),u=s(558137),c=(0,n._)("_activating"),p=(0,n._)("_deactivating"),m=(0,n._)("_pending"),y=(0,n._)("_state");class g{get events(){return this.emitter.listenable}get pending(){return(0,a._)(this,m)[m]}get state(){return(0,a._)(this,y)[y]}async activate(e,t){this.assertRequestsAllowed?.();const s=(0,a._)(this,c)[c].get(e);if(s)return s;if(await(0,a._)(this,p)[p].get(e),!0===(0,a._)(this,y)[y].get(e))return;const n=this.forceActivate(e,t);try{(0,a._)(this,c)[c].set(e,n),await n}finally{(0,a._)(this,c)[c].delete(e)}}async deactivate(e,t){this.assertRequestsAllowed?.();const s=(0,a._)(this,p)[p].get(e);if(s)return s;if(await(0,a._)(this,c)[c].get(e),!1===(0,a._)(this,y)[y].get(e))return;const n=this.forceDeactivate(e,t);try{(0,a._)(this,p)[p].set(e,n),await n}finally{(0,a._)(this,p)[p].delete(e)}}async toggle(e,t,s){if(this.assertRequestsAllowed?.(),(0,a._)(this,m)[m].has(e))return;const n=(0,a._)(this,y)[y].get(e),r=s??!n;return r!==n?r?this.activate(e,t.activate):this.deactivate(e,t.deactivate):void 0}setState(e,t){(0,a._)(this,y)[y].set(e,t)}assertRequestsAllowed(){}async forceActivate(e,t){try{(0,a._)(this,m)[m].add(e),this.emitter.emit("activate",{identity:e,params:t}),await this.requestActivate(e,t),this.setState(e,!0)}finally{(0,a._)(this,m)[m].delete(e)}this.emitter.emit("activated",{identity:e,params:t})}async forceDeactivate(e,t){try{(0,a._)(this,m)[m].add(e),this.emitter.emit("deactivate",{identity:e,params:t}),await this.requestDeactivate(e,t),this.setState(e,!1)}finally{(0,a._)(this,m)[m].delete(e)}this.emitter.emit("deactivated",{identity:e,params:t})}constructor(e,t={}){Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0});const s=function(e,{sharedStateConfig:t}){if(!t)return f(e);const{key:s,version:a}=t,n=(0,u.makeSharedState)(s,(()=>({})),{version:a})();n.current||(n.current=f(e));return n.current}(e,t);this.emitter=s.emitter,(0,a._)(this,c)[c]=s.activating,(0,a._)(this,p)[p]=s.deactivating,(0,a._)(this,m)[m]=s.pending,(0,a._)(this,y)[y]=s.state,(0,d.makeObservable)(this)}}function f(e){return{emitter:e.create(),activating:new _.ObservableIdentityMap,deactivating:new _.ObservableIdentityMap,pending:new l.ObservableIdentitySet,state:new _.ObservableIdentityMap}}(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof Identity?Object:Identity,"undefined"==typeof ActivateParams?Object:ActivateParams]),(0,r.__metadata)("design:returntype",Promise)],g.prototype,"activate",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof Identity?Object:Identity,"undefined"==typeof DeactivateParams?Object:DeactivateParams]),(0,r.__metadata)("design:returntype",Promise)],g.prototype,"deactivate",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof Identity?Object:Identity,"undefined"==typeof IAudioEntityToggleActionToggleParams?Object:IAudioEntityToggleActionToggleParams,Boolean]),(0,r.__metadata)("design:returntype",Promise)],g.prototype,"toggle",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof Identity?Object:Identity,Boolean]),(0,r.__metadata)("design:returntype",void 0)],g.prototype,"setState",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof Identity?Object:Identity,"undefined"==typeof ActivateParams?Object:ActivateParams]),(0,r.__metadata)("design:returntype",Promise)],g.prototype,"forceActivate",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof Identity?Object:Identity,"undefined"==typeof DeactivateParams?Object:DeactivateParams]),(0,r.__metadata)("design:returntype",Promise)],g.prototype,"forceDeactivate",null)},329286:(e,t,s)=>{"use strict";s.d(t,{MusicLyricsService:()=>u});var a=s(331635),n=s(327813),r=s(132028),d=s(346675),_=s(503234),l=s(582170);class u{get(e){const t=this.hasLyrics(e);return t?this.lyricsCache.get(e):!1===t?null:void 0}hasLyrics(e){return this.hasLyricsCache.get(e)}async ensure(e){const t=this.get(e);if(t||null===t)return t;const s=await this.fetch(e);return this.setLyrics(e,s),s}setHasLyrics(e,t){this.hasLyricsCache.set(e,t)}async fetch(e){const t=await this.api.getLyrics({audio_id:e.accessRawId});return(0,_.toMusicLyricsData)(t)}setLyrics(e,t){this.lyricsCache.set(e,t),this.setHasLyrics(e,!!t)}constructor(e){this.api=e;const t=(0,l.ensureStuffing)();this.lyricsCache=t.lyricsCache,this.hasLyricsCache=t.hasLyricsCache,(0,n.makeAutoObservable)(this)}}u=(0,a.__decorate)([r.scope.container(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===d.AudioApi?Object:d.AudioApi])],u)},582170:(e,t,s)=>{"use strict";s.d(t,{ensureStuffing:()=>r});var a=s(558137),n=s(70916);function r(){const e=(0,a.makeSharedState)("domains/audio/MusicLyricsService/stuffing",(()=>({})),{version:1})();return e.current||(e.current={lyricsCache:new n.ObservableIdentityMap,hasLyricsCache:new n.ObservableIdentityMap}),e.current}},503234:(e,t,s)=>{"use strict";function a(e){return e.lyrics?.timestamps?{kind:"karaoke",karaoke:e.lyrics.timestamps.map((e=>({begin:e.begin,end:e.end,text:e.line??null})))}:e.lyrics?.text?{kind:"text",text:e.lyrics.text}:null}s.d(t,{toMusicLyricsData:()=>a})},41102:(e,t,s)=>{"use strict";s.d(t,{MusicAudioOwningService:()=>b});var a=s(434518),n=s(763812),r=s(331635),d=s(327813),_=s(70916),l=s(74270),u=s(558137),c=s(70148),p=s(467585),m=(0,n._)("_ownerId"),y=(0,n._)("_authService"),g=(0,n._)("_emitter"),f=(0,n._)("_targets"),E=(0,n._)("_sources"),A=(0,n._)("_deletedTargets"),P=(0,n._)("_pendingIdentities");class b{get ownerId(){return"currentUser"===(0,a._)(this,m)[m]?(0,a._)(this,y)[y].userId??0:(0,a._)(this,m)[m]}get events(){return(0,a._)(this,g)[g].listenable}has(e){const t=this.getTarget(e);return!(!t||(0,a._)(this,A)[A].has(t))}getTarget(e){return this.isOwned(e)?e:(0,a._)(this,f)[f].get(e)}getSource(e){return(0,a._)(this,E)[E].get(e)}isOwned(e){return this.ownerId===e.ownerId}isDeleted(e){const t=this.getTarget(e);return!!t&&(0,a._)(this,A)[A].has(t)}checkPending(e){return(0,a._)(this,P)[P].has(this.getPendingIdentity(e))}async add(e,t){if(this.assertIsNotOwnedSource(e),this.assertWriteAllowed(),!t.force){const s=this.getTarget(e);if(s)try{return await this.restore(s,t),s}catch{}}this.markPending(e);const{trackCode:s}=t;let n;try{(0,a._)(this,g)[g].emit("add",{source:e,trackCode:s,params:t});const{newAudioId:r}=await this.requestAdd(e,s);if(null==r)throw new Error("Missing audio ID in response from audio.add api method");n=this.createIdentity(r),this.setCache(e,n),(0,a._)(this,g)[g].emit("added",{source:e,target:n,trackCode:s,params:t})}finally{this.unmarkPending(e)}return n}async delete(e,t){const s=this.getTarget(e);this.assertIsOwnedTarget(s),this.assertWriteAllowed(),this.markPending(s),(0,a._)(this,g)[g].emit("delete",{target:s,params:t??{}}),this.markAsDeleted(s);try{await this.api.delete({audio_id:s.id,owner_id:s.ownerId}),(0,a._)(this,g)[g].emit("deleted",{target:s,params:t??{}})}catch(e){throw this.unmarkAsDeleted(s),e}finally{this.unmarkPending(s)}}async restore(e,t){const s=this.getTarget(e);this.assertIsOwnedTarget(s),this.assertWriteAllowed(),this.markPending(s),(0,a._)(this,g)[g].emit("restore",{target:s,params:t??{}}),this.unmarkAsDeleted(s);try{await this.api.restore({audio_id:s.id,owner_id:s.ownerId}),(0,a._)(this,g)[g].emit("restored",{target:s,params:t??{}})}catch(e){if(e?.error?.error_code===p.AudioApiRestoreErrorCode.Expired){const e=this.getSource(s);e&&this.deleteCache(e)}throw e}finally{this.unmarkPending(s)}}assertWriteAllowed(){(0,a._)(this,y)[y].assertAuthorized()}setCache(e,t){(0,a._)(this,f)[f].set(e,t),(0,a._)(this,E)[E].set(t,e),this.unmarkAsDeleted(t)}deleteCache(e){const t=(0,a._)(this,f)[f].get(e);t&&((0,a._)(this,f)[f].delete(e),(0,a._)(this,E)[E].delete(t),this.unmarkAsDeleted(t))}markPending(e){(0,a._)(this,P)[P].add(this.getPendingIdentity(e))}unmarkPending(e){(0,a._)(this,P)[P].delete(this.getPendingIdentity(e))}markAsDeleted(e){(0,a._)(this,A)[A].add(e)}unmarkAsDeleted(e){(0,a._)(this,A)[A].delete(e)}createIdentity(e){return new c.OwnedIdentity({id:e,ownerId:this.ownerId})}assertIsOwnedTarget(e){if(!e||e.ownerId!==this.ownerId)throw new Error("Target identity is not owned")}assertIsNotOwnedSource(e){if(!e||e.ownerId===this.ownerId)throw new Error("Source identity is owned")}getPendingIdentity(e){return this.getTarget(e)??e}constructor(e){Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0});const t=function({sharedStateConfig:e,emitterFactory:t}){if(!e)return I(t);const{key:s,version:a}=e,n=(0,u.makeSharedState)(s,(()=>({})),{version:a})();n.current||(n.current=I(t));return n.current}(e);(0,a._)(this,m)[m]=e.ownerId,(0,a._)(this,y)[y]=e.authService,this.api=e.api,(0,a._)(this,g)[g]=t.emitter,(0,a._)(this,f)[f]=t.targets,(0,a._)(this,E)[E]=t.sources,(0,a._)(this,A)[A]=t.deletedTargets,(0,a._)(this,P)[P]=t.pendingIdentities,(0,d.makeObservable)(this)}}function I(e){return{emitter:e.create(),targets:new _.ObservableIdentityMap,sources:new _.ObservableIdentityMap,deletedTargets:new l.ObservableIdentitySet,pendingIdentities:new l.ObservableIdentitySet}}(0,r.__decorate)([d.computed,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],b.prototype,"ownerId",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof IMusicAudioIdentity?Object:IMusicAudioIdentity,"undefined"==typeof IMusicAudioIdentity?Object:IMusicAudioIdentity]),(0,r.__metadata)("design:returntype",void 0)],b.prototype,"setCache",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof IMusicAudioIdentity?Object:IMusicAudioIdentity]),(0,r.__metadata)("design:returntype",void 0)],b.prototype,"deleteCache",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof IMusicAudioIdentity?Object:IMusicAudioIdentity]),(0,r.__metadata)("design:returntype",void 0)],b.prototype,"markPending",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof IMusicAudioIdentity?Object:IMusicAudioIdentity]),(0,r.__metadata)("design:returntype",void 0)],b.prototype,"unmarkPending",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof IMusicAudioIdentity?Object:IMusicAudioIdentity]),(0,r.__metadata)("design:returntype",void 0)],b.prototype,"markAsDeleted",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof IMusicAudioIdentity?Object:IMusicAudioIdentity]),(0,r.__metadata)("design:returntype",void 0)],b.prototype,"unmarkAsDeleted",null)},467585:(e,t,s)=>{"use strict";var a;s.d(t,{AudioApiRestoreErrorCode:()=>a}),function(e){e[e.Expired=15]="Expired"}(a||(a={}))},246855:(e,t,s)=>{"use strict";var a;s.d(t,{MusicDislikeDeactivateReason:()=>a}),function(e){e.MyMusic="MyMusic"}(a||(a={}))},824501:(e,t,s)=>{"use strict";s.d(t,{MusicService:()=>O});var a=s(434518),n=s(763812),r=s(331635),d=s(132028),_=s(74270),l=s(481120),u=s(495488),c=s(447044),p=s(685434),m=s(329286),y=s(323706),g=s(246855),f=s(139845),E=(0,n._)("_myMusic"),A=(0,n._)("_dislikes"),P=(0,n._)("_groupMusicServices"),b=(0,n._)("_playlistsFollowing"),I=(0,n._)("_lyrics"),T=(0,n._)("_playlistItemsServices"),C=(0,n._)("_connectLikeEvents");class O{get myMusic(){return(0,a._)(this,E)[E]}get dislikes(){return(0,a._)(this,A)[A]}get groupMusicServices(){return(0,a._)(this,P)[P]}get playlistsFollowing(){return(0,a._)(this,b)[b]}get lyrics(){return(0,a._)(this,I)[I]}get playlistItemsServices(){return(0,a._)(this,T)[T]}constructor(e,t,s,n,r,d){Object.defineProperty(this,C,{value:M}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),(0,a._)(this,E)[E]=e,(0,a._)(this,A)[A]=t,(0,a._)(this,P)[P]=s,(0,a._)(this,b)[b]=n,(0,a._)(this,I)[I]=d,(0,a._)(this,T)[T]=r,(0,a._)(this,C)[C]()}}function M(){const{myMusic:e,dislikes:t}=this,s=new _.ObservableIdentitySet;e.events.on("add",(({source:e})=>{t.state.has(e)&&t.deactivate(e,{reason:g.MusicDislikeDeactivateReason.MyMusic})})),e.events.on("restore",(({target:e})=>{t.state.has(e)&&t.deactivate(e,{reason:g.MusicDislikeDeactivateReason.MyMusic})})),t.events.on("activate",(({identity:t})=>{e.has(t)&&e.delete(t,{reason:f.MyMusicDeleteReason.Dislike})})),t.events.on("deactivate",(({identity:t,params:{reason:a}})=>{a!==g.MusicDislikeDeactivateReason.MyMusic&&s.has(t)&&e.restore(t)})),e.events.on("deleted",(({target:e,params:t})=>{t.reason===f.MyMusicDeleteReason.Dislike&&s.add(e)})),e.events.on("restored",(({target:e})=>{s.delete(e)}))}O=(0,r.__decorate)([d.scope.global(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[void 0===u.MyMusicService?Object:u.MyMusicService,void 0===c.MusicDislikesService?Object:c.MusicDislikesService,void 0===l.GroupMusicServices?Object:l.GroupMusicServices,void 0===p.MusicPlaylistFollowingService?Object:p.MusicPlaylistFollowingService,void 0===y.MusicPlaylistItemsServices?Object:y.MusicPlaylistItemsServices,void 0===m.MusicLyricsService?Object:m.MusicLyricsService])],O)},139845:(e,t,s)=>{"use strict";var a;s.d(t,{MyMusicDeleteReason:()=>a}),function(e){e.Dislike="Dislike"}(a||(a={}))},725377:(e,t,s)=>{"use strict";s.d(t,{GroupMusicService:()=>_});var a=s(331635),n=s(327813),r=s(468073),d=s(41102);class _ extends d.MusicAudioOwningService{get groupId(){return r.Ranges.convertOwnerIdToGroupId(this.ownerId)}async requestAdd(e,t){const s=await this.api.add({audio_id:e.id,owner_id:e.ownerId,access_key:e.accessKey,group_id:this.groupId,track_code:t});return{newAudioId:s.items?.[0]?.new_audio_id}}constructor(e){const{groupId:t}=e;if(t<1)throw new Error("[GroupMusicServices] groupId is not group id");super({ownerId:r.Ranges.convertGroupIdToOwnerId(t),api:e.api,authService:e.authService,emitterFactory:e.emitterFactory,sharedStateConfig:{key:`domains/audio/GroupsMusicService/${t}/stuffing`,version:1}}),(0,n.makeObservable)(this)}}(0,a.__decorate)([n.computed,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],_.prototype,"groupId",null)},481120:(e,t,s)=>{"use strict";s.d(t,{GroupMusicServices:()=>c});var a=s(331635),n=s(327813),r=s(132028),d=s(346675),_=s(951652),l=s(26530),u=s(725377);class c{get(e){let t=this.services.get(e);return t||(t=this.create(e),this.services.set(e,t)),t}create(e){return new u.GroupMusicService({groupId:e,api:this.api,authService:this.authService,emitterFactory:this.emitterFactory})}constructor(e,t,s){this.api=e,this.authService=t,this.emitterFactory=s,this.services=new Map,(0,n.makeAutoObservable)(this)}}c=(0,a.__decorate)([r.scope.global(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===d.AudioApi?Object:d.AudioApi,void 0===_.AuthService?Object:_.AuthService,void 0===l.EmitterFactory?Object:l.EmitterFactory])],c)},447044:(e,t,s)=>{"use strict";s.d(t,{MusicDislikesService:()=>u});var a=s(331635),n=s(132028),r=s(26530),d=s(951652),_=s(346675),l=s(841376);class u extends l.AudioEntityToggleService{assertRequestsAllowed(){this.authService.ensureUserId()}async requestActivate(e){await this.api.addDislike({audio_ids:e.rawId})}async requestDeactivate(e){await this.api.removeDislike({audio_ids:e.rawId})}constructor(e,t,s){super(e,{sharedStateConfig:{key:"domains/audio/MusicDislikesService/stuffing",version:1}}),this.authService=t,this.api=s}}u=(0,a.__decorate)([n.scope.global(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===r.EmitterFactory?Object:r.EmitterFactory,void 0===d.AuthService?Object:d.AuthService,void 0===_.AudioApi?Object:_.AudioApi])],u)},685434:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistFollowingService:()=>p});var a=s(331635),n=s(327813),r=s(132028),d=s(951652),_=s(346675),l=s(26530),u=s(70148),c=s(214495);class p{get events(){return this.emitter.listenable}has(e){const t=this.getTarget(e);return!(!t||this.unfollowedTargets.has(t))}getTarget(e){return this.isMine(e)?e:this.targets.get(e)}getSource(e){return this.sources.get(e)}isMine(e){return this.myId===e.ownerId}checkPending(e){return this.pendingIdentities.has(this.getPendingIdentity(e))}async follow(e,t){const{ref:s}=t;let a;this.assertIsNotMineSource(e),this.assertWriteAllowed(),this.markPending(e);try{this.emitter.emit("follow",{source:e,ref:s});const t=await this.api.followPlaylist({playlist_id:e.id,owner_id:e.ownerId,access_key:e.accessKey,ref:s??void 0});a=new u.OwnedIdentity({id:t.playlist_id,ownerId:t.owner_id,accessKey:t.access_key}),this.setCache(e,a),this.emitter.emit("followed",{source:e,target:a,ref:s})}finally{this.unmarkPending(e)}return a}async unfollow(e){const t=this.getTarget(e);this.assertIsMineTarget(t),this.assertWriteAllowed(),this.markPending(t),this.emitter.emit("unfollow",{target:t}),this.markAsDeleted(t);try{await this.api.deletePlaylist({playlist_id:t.id,owner_id:t.ownerId}),this.emitter.emit("unfollowed",{target:t})}catch(e){throw this.unmarkAsDeleted(t),e}finally{this.unmarkPending(t)}}setCache(e,t){this.targets.set(e,t),this.sources.set(t,e),this.unmarkAsDeleted(t)}assertWriteAllowed(){this.authService.assertAuthorized()}get myId(){return this.authService.userId??0}markPending(e){this.pendingIdentities.add(this.getPendingIdentity(e))}unmarkPending(e){this.pendingIdentities.delete(this.getPendingIdentity(e))}markAsDeleted(e){this.unfollowedTargets.add(e)}unmarkAsDeleted(e){this.unfollowedTargets.delete(e)}assertIsMineTarget(e){if(!e||e.ownerId!==this.myId)throw new Error("Target identity is not mine")}assertIsNotMineSource(e){if(!e||e.ownerId===this.myId)throw new Error("Source identity is mine")}getPendingIdentity(e){return this.getTarget(e)??e}constructor(e,t,s){this.authService=e,this.api=t;const a=(0,c.ensureStuffing)(s);this.emitter=a.emitter,this.targets=a.targets,this.sources=a.sources,this.unfollowedTargets=a.unfollowedTargets,this.pendingIdentities=a.pendingIdentities,(0,n.makeAutoObservable)(this)}}p=(0,a.__decorate)([r.scope.global(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===d.AuthService?Object:d.AuthService,void 0===_.AudioApi?Object:_.AudioApi,void 0===l.EmitterFactory?Object:l.EmitterFactory])],p)},214495:(e,t,s)=>{"use strict";s.d(t,{ensureStuffing:()=>d});var a=s(558137),n=s(70916),r=s(74270);function d(e){const t=(0,a.makeSharedState)("domains/audio/MusicPlaylistFollowingService/stuffing",(()=>({})),{version:1})();return t.current||(t.current=function(e){return{emitter:e.create(),targets:new n.ObservableIdentityMap,sources:new n.ObservableIdentityMap,unfollowedTargets:new r.ObservableIdentitySet,pendingIdentities:new r.ObservableIdentitySet}}(e)),t.current}},913130:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistItemsService:()=>u});var a=s(327813),n=s(70916),r=s(70148),d=s(391751),_=s(768035),l=s(922224);class u{get isInitialized(){return this._isInitialized}get hasFetching(){return this._hasFetching}get togglingEvents(){return this.emitter.listenable}has(e){return this.targets.has(e)||this.sources.has(e)}checkToggling(e){return this.togglingIdentities.has(e)}async toggle(e,t){const s=void 0!==t?t:!this.has(e);await this[s?"add":"remove"](e)}async add(e){let t;this.assertWriteAllowed(),this.assertIsInitialized(),this.assertIsNotOwnedTarget(e);try{this.markToggling(e);const s=await this.api.addToPlaylist({playlist_id:this.identity.id,owner_id:this.identity.ownerId,audio_ids:e.accessRawId}),n=s[0]?.audio_id,d=s[0]?.track_code;if(null==n||!d)throw this.logError("Missing audio ID or tracking data in response from audio.addToPlaylist api method");t=new r.OwnedIdentity({id:n,ownerId:this.identity.ownerId});const _={identity:t,trackCode:d??""};return(0,a.runInAction)((()=>{this.addToCache(e,_)})),_}finally{this.unmarkToggling(e)}}async remove(e){const t=this.sources.get(e)??e,s=this.targets.get(e);this.assertWriteAllowed(),this.assertIsInitialized(),this.assertIsOwnedTarget(s);const{id:n,ownerId:r}=this.identity;try{this.markToggling(e),await this.api.removeFromPlaylist({playlist_id:n,owner_id:r,audio_ids:s.accessRawId}),(0,a.runInAction)((()=>{this.removeFromCache(t,s)}))}finally{this.unmarkToggling(e)}}async ensure(){return this.isInitialized?this.items:this.fetch()}async fetch(){try{this.markFetching(),this.clearCache();const{audios:e}=await this.api.getAudioIdsBySource({source:"playlist",entity_id:this.identity.rawId,ref:this.context.ref??void 0});return(0,a.runInAction)((()=>{this.addItemsFromApi(e),this._isInitialized=!0})),this.items}catch(e){throw this.logError("Error when trying to initialize items in a music playlist",e)}finally{this.unmarkFetching()}}addItemsFromApi(e){const t=new n.ObservableIdentityMap(this.sources);for(const s of e){const e=u.createItemIdentityFromApi(s);if(!e)break;const a={identity:e,trackCode:s.track_code},n=a.identity,r=t.get(n)??n;this.addToCache(r,a)}return this.items}addToCache(e,t){this.targets.set(e,t.identity),this.sources.set(t.identity,e);this.items.some((e=>(0,d.compareIdentities)(e.identity,t.identity)))||this.items.push(t)}removeFromCache(e,t){this.targets.delete(e),this.sources.delete(t);const s=this.items.findIndex((e=>(0,d.compareIdentities)(e.identity,t)));s>=0&&this.items.splice(s,1)}clearCache(){this.sources.clear(),this.targets.clear(),this.items.length=0}markFetching(){this._hasFetching=!0}unmarkFetching(){this._hasFetching=!1}markToggling(e){this.togglingIdentities.add(e)}unmarkToggling(e){this.togglingIdentities.delete(e)}assertWriteAllowed(){this.authService.assertAuthorized()}assertIsInitialized(){if(!this.isInitialized)throw this.logError("Music playlist are not initialized")}assertIsNotOwnedTarget(e){if(!e||this.has(e))throw this.logError("Target identity are already in playlist")}assertIsOwnedTarget(e){if(!e||!this.has(e))throw this.logError("Target identity is not in playlist")}logError(e,t){const s=new Error(e,{cause:t});return this.errorLogger.log(s),s}static createItemIdentityFromApi({audio_id:e}){try{return new r.OwnedIdentity((0,_.parseRawId)(e))}catch(e){return console.error("Invalid audio rawId"),null}}constructor({identity:e,context:t,api:s,authService:n,emitterFactory:r,errorLogger:d}){this.items=[],this._isInitialized=!1,this._hasFetching=!1,this.identity=e,this.context=t,this.api=s,this.authService=n,this.errorLogger=d;const _=(0,l.ensureStuffing)({identity:e,context:t,emitterFactory:r});this.emitter=_.emitter,this.targets=_.targets,this.sources=_.sources,this.togglingIdentities=_.pendingIdentities,(0,a.makeAutoObservable)(this)}}},922224:(e,t,s)=>{"use strict";s.d(t,{ensureStuffing:()=>d});var a=s(558137),n=s(70916),r=s(74270);function d({identity:e,context:t,emitterFactory:s}){const d=(0,a.makeSharedState)(`domains/audio/IMusicPlaylistItemsService/${e.fullId}/${t.ref}/stuffing`,(()=>({})),{version:1})();return d.current||(d.current=function(e){return{emitter:e.create(),sources:new n.ObservableIdentityMap,targets:new n.ObservableIdentityMap,pendingIdentities:new r.ObservableIdentitySet}}(s)),d.current}},323706:(e,t,s)=>{"use strict";s.d(t,{MusicPlaylistItemsServices:()=>m});var a=s(331635),n=s(327813),r=s(132028),d=s(346675),_=s(951652),l=s(26530),u=s(955060),c=s(913130),p=s(811207);class m{provide(e,t){const{getContextKey:s}=m;let a=this.provideContextMap(e).get(s(t));return a||this.createCached(e,t)}createCached(e,t){const{getContextKey:s}=m,a=this.provideContextMap(e),n=this.create(e,t);return a.set(s(t),n),n}create(e,t){const{api:s,authService:a,emitterFactory:n,errorLogger:r}=this;return new c.MusicPlaylistItemsService({identity:e,context:t,api:s,authService:a,emitterFactory:n,errorLogger:r})}provideContextMap(e){let t=this.entities.get(e);return t||(t=(0,n.observable)(new Map),this.entities.set(e,t)),t}static getContextKey(e){return e.ref}constructor(e,t,s,a){this.api=e,this.authService=t,this.emitterFactory=s,this.errorLogger=a,this.entities=(0,p.ensureStuffing)().entities,(0,n.makeAutoObservable)(this)}}m=(0,a.__decorate)([r.scope.global(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===d.AudioApi?Object:d.AudioApi,void 0===_.AuthService?Object:_.AuthService,void 0===l.EmitterFactory?Object:l.EmitterFactory,void 0===u.ErrorLogger?Object:u.ErrorLogger])],m)},811207:(e,t,s)=>{"use strict";s.d(t,{ensureStuffing:()=>r});var a=s(558137),n=s(70916);function r(){const e=(0,a.makeSharedState)("domains/audio/MusicPlaylistItemsServices/stuffing",(()=>({})),{version:1})();return e.current||(e.current={entities:new n.ObservableIdentityMap}),e.current}},495488:(e,t,s)=>{"use strict";s.d(t,{MyMusicService:()=>u});var a=s(331635),n=s(132028),r=s(346675),d=s(951652),_=s(26530),l=s(41102);class u extends l.MusicAudioOwningService{async requestAdd(e,t){const s=await this.api.add({audio_id:e.id,owner_id:e.ownerId,access_key:e.accessKey,track_code:t});return{newAudioId:s.items?.[0]?.new_audio_id}}constructor(e,t,s){super({ownerId:"currentUser",api:e,authService:t,emitterFactory:s,sharedStateConfig:{key:"domains/audio/MyMusicService/stuffing",version:1}})}}u=(0,a.__decorate)([n.scope.global(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===r.AudioApi?Object:r.AudioApi,void 0===d.AuthService?Object:d.AuthService,void 0===_.EmitterFactory?Object:_.EmitterFactory])],u)},425354:(e,t,s)=>{"use strict";s.d(t,{PodcastEpisodeFavoritesService:()=>l});var a=s(331635),n=s(132028),r=s(26530),d=s(972573),_=s(841376);class l extends _.AudioEntityToggleService{async requestActivate(e){await this.audioApi.addPodcastEpisode({owner_id:e.ownerId,episode_id:e.id})}async requestDeactivate(e){await this.audioApi.removePodcastEpisode({owner_id:e.ownerId,episode_id:e.id})}constructor(e,t){super(e,{sharedStateConfig:{key:"domains/audio/PodcastEpisodeFavoritesService/stuffing",version:1}}),this.audioApi=t}}l=(0,a.__decorate)([n.scope.global(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===r.EmitterFactory?Object:r.EmitterFactory,void 0===d.FaveApi?Object:d.FaveApi])],l)},20085:(e,t,s)=>{"use strict";s.d(t,{PodcastAudioIdentity:()=>n});var a=s(70148);class n extends a.OwnedIdentity{constructor(e){super(e),this.podcastId=e.podcastId}}},573825:(e,t,s)=>{"use strict";s.d(t,{ShortVideoUploadService:()=>d});var a=s(331635),n=s(558137),r=s(132028);class d{get owner(){return this.ensureData().owner}get files(){return this.ensureData().files}get uploadData(){return this.ensureData().uploadData}get entryPoint(){return this.ensureData().entryPoint}setOwner(e){this.ensureData().owner=e}setUploadData(e){this.ensureData().uploadData=e}setFiles(e){this.ensureData().files=e}setEntryPoint(e){this.ensureData().entryPoint=e}resetFiles(){this.ensureData().files=(new DataTransfer).files}resetOwner(){this.ensureData().owner=void 0}resetUploadData(){this.ensureData().uploadData=[]}resetEntryPoint(){this.ensureData().entryPoint=""}reset(){this.resetOwner(),this.resetFiles(),this.resetUploadData(),this.resetEntryPoint()}constructor(){this.ensureData=(0,n.makeSharedState)("domains/shortVideo/upload/data",(()=>({owner:void 0,files:(new DataTransfer).files,uploadData:[],entryPoint:""})),{version:3})}}d=(0,a.__decorate)([r.scope.global()],d)},73573:(e,t,s)=>{"use strict";s.d(t,{VideoGroup:()=>n});var a=s(327813);class n{get data(){return this._data}get name(){return this._data.name}constructor(e){this._data=e,(0,a.makeAutoObservable)(this,{},{autoBind:!0})}}},23893:(e,t,s)=>{"use strict";s.d(t,{VideoOwnerStore:()=>_});var a=s(327813),n=s(468073),r=s(73573),d=s(805373);class _{static isVideoGroup(e){return e instanceof r.VideoGroup}static isVideoUser(e){return e instanceof d.VideoUser}getById(e){if(n.Ranges.isGroupId(e)){const t=n.Ranges.convertOwnerIdToGroupId(e);return this.groupsStore.getById(t)}if(n.Ranges.isUserId(e))return this.usersStore.getById(e)}constructor(e,t){this.groupsStore=e,this.usersStore=t,(0,a.makeAutoObservable)(this)}}},852487:(e,t,s)=>{"use strict";s.d(t,{VideoPlayerConfigProvider:()=>l});var a=s(331635),n=s(327813),r=s(882044),d=s(955060),_=s(132028);class l{isLoading(e){return Boolean(this.requestMap.get(e))}async request(e){return this.abortController=new AbortController,this.videoApi.getPlayerConfig(e,{signal:this.abortController?.signal})}async fetch(e){this.reset();try{const t=await this.request(e);return this.configMap.set(e.module,t.config),t.config}catch(e){return this.errorLogger.log(new Error("Video player config fetching failed",{cause:e})),null}finally{this.requestMap.delete(e.module)}}async ensure(e){const t=this.requestMap.get(e.module);if(t)return t;const s=this.configMap.get(e.module);if(s)return s;const a=this.fetch(e);return this.requestMap.set(e.module,a),a}reset(){this.configMap.clear(),this.requestMap.clear(),this.abortController?.abort()}constructor(e,t){this.videoApi=e,this.errorLogger=t,this.abortController=null,this.configMap=new Map,this.requestMap=new Map,(0,n.makeAutoObservable)(this)}}l=(0,a.__decorate)([_.scope.container(),(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[void 0===r.VideoApi?Object:r.VideoApi,void 0===d.ErrorLogger?Object:d.ErrorLogger])],l)},805373:(e,t,s)=>{"use strict";s.d(t,{VideoUser:()=>n});var a=s(327813);class n{get data(){return this._data}get name(){return`${this._data.first_name} ${this._data.last_name}`}constructor(e){this._data=e,(0,a.makeAutoObservable)(this,{},{autoBind:!0})}}},595059:(e,t,s)=>{"use strict";s.d(t,{Video:()=>d});var a=s(327813),n=s(873900),r=s(23893);class d{static createRawId(e){return(0,n.getIdentityRawId)(e)}get rawId(){const{id:e,owner_id:t}=this.data;return d.createRawId({id:e,ownerId:t})}get data(){return this._data}get owner(){return this.ownerStore instanceof r.VideoOwnerStore?this.ownerStore.getById(this._data.owner_id):this.ownerStore?.getOwner(this._data.owner_id)}get isFavorite(){return this.favoriteService?.getIsFavorite(this._data.id)||this._data.is_favorite}constructor(e,t,s){this._data=e,this.ownerStore=t,this.favoriteService=s,(0,a.makeAutoObservable)(this,{},{autoBind:!0})}}},70916:(e,t,s)=>{"use strict";s.d(t,{ObservableIdentityMap:()=>p});var a=s(434518),n=s(763812),r=s(331635),d=s(327813),_=(0,n._)("_identities"),l=(0,n._)("_ensureIdentity");let u=Symbol.iterator,c=Symbol.toStringTag;class p{get size(){return this.store.size}has(e){return this.store.has(e.fullId)}get(e){return this.store.get(e.fullId)}set(e,t){return(0,a._)(this,_)[_].set(e.fullId,e),this.store.set(e.fullId,t),this}delete(e){return(0,a._)(this,_)[_].delete(e.fullId),this.store.delete(e.fullId)}clear(){return(0,a._)(this,_)[_].clear(),this.store.clear()}forEach(e,t){this.store.forEach(((s,n)=>{e.call(t,s,(0,a._)(this,l)[l](n),this)}))}*keys(){for(const e of this.store.keys())yield(0,a._)(this,l)[l](e)}values(){return this.store.values()}*entries(){for(const[e,t]of this.store.entries())yield[(0,a._)(this,l)[l](e),t]}[u](){return this.entries()}get[c](){return"ObservableIdentityMap"}constructor(e){Object.defineProperty(this,l,{value:m}),Object.defineProperty(this,_,{writable:!0,value:void 0}),this.store=new Map,(0,a._)(this,_)[_]=new Map,(0,d.runInAction)((()=>{for(const[t,s]of e??[])this.set(t,s)})),(0,d.makeObservable)(this)}}function m(e){const t=(0,a._)(this,_)[_].get(e);if(!t)throw new Error("IdentityMap inconsistency");return t}(0,r.__decorate)([d.observable.shallow,(0,r.__metadata)("design:type","undefined"==typeof Map?Object:Map)],p.prototype,"store",void 0),(0,r.__decorate)([d.computed,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],p.prototype,"size",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof T?Object:T,"undefined"==typeof V?Object:V]),(0,r.__metadata)("design:returntype",Object)],p.prototype,"set",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["undefined"==typeof T?Object:T]),(0,r.__metadata)("design:returntype",Boolean)],p.prototype,"delete",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],p.prototype,"clear",null),(0,r.__decorate)([d.action,(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Function,Object]),(0,r.__metadata)("design:returntype",void 0)],p.prototype,"forEach",null)},74270:(e,t,s)=>{"use strict";s.d(t,{ObservableIdentitySet:()=>r});var a=s(331635),n=s(327813);class r{get size(){return this.store.size}has(e){return this.store.has(e.fullId)}add(e){return this.store.set(e.fullId,e),this}delete(e){return this.store.delete(e.fullId)}clear(){return this.store.clear()}forEach(e,t){this.store.forEach((s=>{e.call(t,s,s,this)}))}values(){return this.store.values()}keys(){return this.values()}*entries(){for(const e of this.store.values())yield[e,e]}[Symbol.iterator](){return this.values()}get[Symbol.toStringTag](){return"ObservableIdentitySet"}union(){throw new Error("Not implemented yet!")}intersection(){throw new Error("Not implemented yet!")}difference(){throw new Error("Not implemented yet!")}symmetricDifference(){throw new Error("Not implemented yet!")}isSubsetOf(){throw new Error("Not implemented yet!")}isSupersetOf(){throw new Error("Not implemented yet!")}isDisjointFrom(){throw new Error("Not implemented yet!")}constructor(e){this.store=new Map,(0,n.runInAction)((()=>{for(const t of e??[])this.add(t)})),(0,n.makeObservable)(this)}}(0,a.__decorate)([n.observable.shallow,(0,a.__metadata)("design:type","undefined"==typeof Map?Object:Map)],r.prototype,"store",void 0),(0,a.__decorate)([n.computed,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],r.prototype,"size",null),(0,a.__decorate)([n.action,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",["undefined"==typeof T?Object:T]),(0,a.__metadata)("design:returntype",Object)],r.prototype,"add",null),(0,a.__decorate)([n.action,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",["undefined"==typeof T?Object:T]),(0,a.__metadata)("design:returntype",Boolean)],r.prototype,"delete",null),(0,a.__decorate)([n.action,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],r.prototype,"clear",null),(0,a.__decorate)([n.action,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[Function,Object]),(0,a.__metadata)("design:returntype",void 0)],r.prototype,"forEach",null)},26530:(e,t,s)=>{"use strict";s.d(t,{EmitterFactory:()=>c});var a=s(434518),n=s(763812),r=s(331635),d=s(132028),_=s(584053),l=s(955060),u=(0,n._)("_logger");class c{create(e={}){return new _.Emitter({catchListener:e=>{if(!(e instanceof Error))throw e;(0,a._)(this,u)[u].log(e)},...e})}constructor(e){Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,a._)(this,u)[u]=e}}c=(0,r.__decorate)([d.scope.global(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[void 0===l.ErrorLogger?Object:l.ErrorLogger])],c)},230414:(e,t,s)=>{"use strict";s.d(t,{MediaFocus:()=>c});var a=s(331635),n=s(327813),r=s(558137),d=s(235901),_=s(204739);const l=(0,r.makeSharedState)("media-focus",(()=>({instance:null})),{version:1}),u=(0,r.makeSharedState)("media-focus/stuffing",(()=>({mediaSessionController:new d.MediaSessionController,channels:(0,n.observable)(new Map)})),{version:1});class c{static ensure(){const e=l();return e.instance||(e.instance=new c),e.instance}createUncontrolledChannel(e){return this.createChannel(e,{pause:p,resume:p})}createChannel(e,t){if(this.channels.has(e))throw new Error(`MediaFocusChannel id ${e} already registered`);const s=new _.MediaFocusChannel(e,t);return(0,n.runInAction)((()=>{this.channels.set(e,s)})),s.events.on("start",(()=>this.handleChannelStart(s))),s.events.on("stop",(()=>this.handleChannelStop(s))),this.updateGlobals(),s}get activeChannels(){return[...this.channels.values()].filter((e=>e.active))}get lastActiveChannel(){return[...this.activeChannels].sort(((e,t)=>t.activatedAt-e.activatedAt)).at(0)}updateGlobals(){this.updateMediaSession()}pauseLowerPriority(e){for(const t of this.activeChannels)t.id===e.id||t.config.priority<e.config.priority||t.pause()}resumeHighestPriority(e){const t=[...this.channels.values()].filter((t=>t.paused&&t.id!==e.id)).sort(((e,t)=>e.config.priority-t.config.priority)).at(0);t&&t.resume()}updateMediaSession(){const e=this.mediaSessionController,t=this.channels.get("calls"),s=t?.active?t:this.lastActiveChannel;s&&e.current!==s.mediaSession&&e.setCurrent(s.mediaSession)}constructor(){this.handleChannelStart=e=>{this.channels.get(e.id)===e&&(this.pauseLowerPriority(e),this.updateGlobals())},this.handleChannelStop=e=>{this.channels.get(e.id)===e&&(this.resumeHighestPriority(e),this.updateGlobals())};const e=u();this.mediaSessionController=e.mediaSessionController,this.channels=e.channels,(0,n.makeObservable)(this)}}function p(){throw new Error("This channel can not be paused or resumed")}(0,a.__decorate)([n.computed,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],c.prototype,"activeChannels",null),(0,a.__decorate)([n.computed,(0,a.__metadata)("design:type",Function),(0,a.__metadata)("design:paramtypes",[]),(0,a.__metadata)("design:returntype",void 0)],c.prototype,"lastActiveChannel",null)},204739:(e,t,s)=>{"use strict";s.d(t,{MediaFocusChannel:()=>l});var a=s(331635),n=s(327813),r=s(584053),d=s(709282),_=s(460424);class l{get events(){return this.emitter.listenable}createAction(e,t){return(...s)=>{if(this.currentAction)throw new Error(`Unexpected action ${e} call while another action ${this.currentAction} is in progress`);try{this.currentAction=e;const a=(0,n.runInAction)((()=>t(...s)));return this.emitter.emit(e),a}finally{this.currentAction=null}}}constructor(e,t){this.emitter=new r.Emitter,this.currentAction=null,this.mediaSession=new d.MediaSessionObject,this.active=!1,this.paused=!1,this.activatedAt=0,this.start=this.createAction("start",(()=>{this.active||(this.active=!0,this.activatedAt=+new Date,this.paused=!1)})),this.stop=this.createAction("stop",(()=>{this.active&&(this.active=!1,this.paused=!1)})),this.pause=this.createAction("pause",(()=>{this.paused||(this.actions.pause(),this.paused=!0)})),this.resume=this.createAction("resume",(()=>{this.paused&&(this.actions.resume(),this.paused=!1)})),this.id=e,this.config=_.CONFIGS[e],this.actions=t,(0,n.makeObservable)(this)}}(0,a.__decorate)([n.observable],l.prototype,"active",void 0),(0,a.__decorate)([n.observable],l.prototype,"paused",void 0),(0,a.__decorate)([n.observable],l.prototype,"activatedAt",void 0)},235901:(e,t,s)=>{"use strict";s.d(t,{MediaSessionController:()=>p});var a=s(434518),n=s(763812),r=(0,n._)("_native"),d=(0,n._)("_supportedActions"),_=(0,n._)("_current"),l=(0,n._)("_setActionHandler"),u=(0,n._)("_applyNative"),c=(0,n._)("_handleChangeCurrentData");class p{get current(){return(0,a._)(this,_)[_]}setCurrent(e){(0,a._)(this,_)[_]?.events.off("change",(0,a._)(this,c)[c]),(0,a._)(this,_)[_]=e,e.events.on("change",(0,a._)(this,c)[c]),(0,a._)(this,u)[u](e)}constructor(){if(Object.defineProperty(this,l,{value:m}),Object.defineProperty(this,u,{value:y}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),(0,a._)(this,r)[r]=null,(0,a._)(this,d)[d]=["nexttrack","pause","play","previoustrack","seekbackward","seekforward","seekto","skipad","stop","hangup","enterpictureinpicture"],(0,a._)(this,_)[_]=null,(0,a._)(this,c)[c]=({diff:{metadata:e,playbackState:t,actionHandler:s,positionState:n,cameraActive:d,microphoneActive:_}})=>{const u=(0,a._)(this,r)[r];u&&(void 0!==e&&(u.metadata=e),t&&(u.playbackState=t),s&&(0,a._)(this,l)[l](s[0],s[1]),void 0!==n&&u.setPositionState(n??void 0),void 0!==d&&"setCameraActive"in u&&u.setCameraActive(d),void 0!==_&&"setMicrophoneActive"in u&&u.setMicrophoneActive(_))},"undefined"==typeof window||!("mediaSession"in window.navigator))return;const e=window.navigator.mediaSession;(0,a._)(this,r)[r]=e,"setCameraActive"in e&&(0,a._)(this,d)[d].push("togglecamera"),"setMicrophoneActive"in e&&(0,a._)(this,d)[d].push("togglemicrophone")}}function m(e,t){const s=(0,a._)(this,r)[r];if(s)try{s.setActionHandler(e,t)}catch(e){t&&console.error(e)}}function y(e){const t=(0,a._)(this,r)[r];if(t){t.metadata=e.metadata,t.playbackState=e.playbackState,t.setPositionState(e.positionState),"setCameraActive"in t&&t.setCameraActive(e.cameraActive),"setMicrophoneActive"in t&&t.setMicrophoneActive(e.microphoneActive);for(const t of(0,a._)(this,d)[d]){const s=e.actionHandlers.get(t)??null;(0,a._)(this,l)[l](t,s)}}}},709282:(e,t,s)=>{"use strict";s.d(t,{MediaSessionObject:()=>g});var a=s(434518),n=s(763812),r=s(584053),d=(0,n._)("_emitter"),_=(0,n._)("_actionHandlers"),l=(0,n._)("_positionState"),u=(0,n._)("_metadata"),c=(0,n._)("_playbackState"),p=(0,n._)("_cameraActive"),m=(0,n._)("_microphoneActive"),y=(0,n._)("_emitChange");class g{get events(){return(0,a._)(this,d)[d].listenable}get metadata(){return(0,a._)(this,u)[u]}set metadata(e){(0,a._)(this,u)[u]=e,(0,a._)(this,y)[y]({metadata:e})}get playbackState(){return(0,a._)(this,c)[c]}set playbackState(e){(0,a._)(this,c)[c]=e,(0,a._)(this,y)[y]({playbackState:e})}get actionHandlers(){return(0,a._)(this,_)[_]}get positionState(){return(0,a._)(this,l)[l]}get cameraActive(){return(0,a._)(this,p)[p]}get microphoneActive(){return(0,a._)(this,m)[m]}setPositionState(e){(0,a._)(this,l)[l]=e,(0,a._)(this,y)[y]({positionState:e})}setActionHandler(e,t){this.actionHandlers.set(e,t),(0,a._)(this,y)[y]({actionHandler:[e,t]})}setCameraActive(e){(0,a._)(this,p)[p]=e,(0,a._)(this,y)[y]({cameraActive:e})}setMicrophoneActive(e){(0,a._)(this,m)[m]=e,(0,a._)(this,y)[y]({microphoneActive:e})}constructor(){Object.defineProperty(this,y,{value:f}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),(0,a._)(this,d)[d]=new r.Emitter,(0,a._)(this,_)[_]=new Map,(0,a._)(this,u)[u]=null,(0,a._)(this,c)[c]="none",(0,a._)(this,p)[p]=!1,(0,a._)(this,m)[m]=!1}}function f(e){(0,a._)(this,d)[d].emit("change",{diff:e})}},460424:(e,t,s)=>{"use strict";s.d(t,{CONFIGS:()=>a});const a={calls:{priority:0},video:{priority:1},audio:{priority:2}}},756314:(e,t,s)=>{"use strict";s.d(t,{MediaPlayersSwitch:()=>p});var a,n=s(434518),r=s(763812),d=s(558137),_=s(26530),l=s(516993);!function(e){e.ChannelAutoResume="CHANNEL_AUTO_RESUME",e.Unknown="UNKNOWN"}(a||(a={}));const u=(0,d.makeSharedState)("media-players-switch",(()=>({instance:null})),{version:0});var c=(0,r._)("_resume");class p{static ensure(e){const t=u();return t.instance||(t.instance=new p(e.resolve(_.EmitterFactory))),t.instance}connect(e){const t=new l.MediaPlayersSwitchChannel(e,this.emitterFactory),s=this.handlePlay.bind(this,t),a=this.handleStop.bind(this,t),n=this.handleMute.bind(this,t),r=this.handleUnmute.bind(this,t);t.events.on("play",s),t.events.on("stop",a),t.events.on("mute",n),t.events.on("unmute",r);return{emit:t.emitter.emit.bind(t.emitter),disconnect:()=>{t.events.off("play",s),t.events.off("stop",a),t.events.off("mute",n),t.events.off("unmute",r),this.activeChannel===t&&(this.activeChannel=null),this.mutedChannel===t&&(this.mutedChannel=null)}}}resume(e={reason:"UNKNOWN"}){return(0,n._)(this,c)[c]({...e,reason:e.reason??"UNKNOWN"})}autoResume(e){(0,n._)(this,c)[c]({...e,reason:"CHANNEL_AUTO_RESUME"})}pause(e={}){this.activeChannel&&!this.activeChannel.state.isPaused&&this.mutedChannel&&!this.mutedChannel.state.isPaused&&(e.initiatedByCalls?this.activeChannel.pauseByCalls(e):(this.activeChannel.pause(e),this.mutedChannel.pause(e)))}stop(e={}){this.activeChannel&&(this.activeChannel.stop(e),this.activeChannel=null)}handlePlay(e,t=!1){t?(e!==this.mutedChannel&&this.mutedChannel?.state.isPlaying&&this.mutedChannel.pause({}),this.mutedChannel=e):(e!==this.activeChannel&&this.activeChannel?.state.isPlaying&&this.activeChannel.pause({}),this.activeChannel=e)}handleMute(e){e!==this.mutedChannel&&this.mutedChannel?.state.isPlaying&&this.mutedChannel.pause({}),this.activeChannel===e&&(this.activeChannel=null),this.mutedChannel=e}handleUnmute(e){e!==this.activeChannel&&this.activeChannel?.state.isPlaying&&this.activeChannel.pause({}),this.mutedChannel===e&&(this.mutedChannel=null),this.activeChannel=e}handleStop(e){e===this.activeChannel&&(this.activeChannel=null),e===this.mutedChannel&&(this.mutedChannel=null)}constructor(e){Object.defineProperty(this,c,{value:m}),this.emitterFactory=e,this.activeChannel=null,this.mutedChannel=null}}function m(e){!this.activeChannel||this.activeChannel.state.isPlaying||e.initiatedByCalls&&!this.activeChannel.state.isPausedByCalls||this.activeChannel.resume(e)}},516993:(e,t,s)=>{"use strict";s.d(t,{MediaPlayersSwitchChannel:()=>u});var a=s(434518),n=s(763812),r=(0,n._)("_connectEvents"),d=(0,n._)("_handlePlay"),_=(0,n._)("_handlePause"),l=(0,n._)("_handleStop");class u{get events(){return this.emitter.listenable}get state(){return this._state}set state(e){this._state={...this._state,...e},(this._state.isPlaying||this._state.isPaused||this._state.isPausedByCalls)&&(this._state.isIdle=!1)}pauseByCalls(e){this.state={isPausedByCalls:!0},this.pause(e)}constructor(e,t){Object.defineProperty(this,r,{value:c}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),this.emitterFactory=t,this._state={isIdle:!0,isPlaying:!1,isPaused:!1,isPausedByCalls:!1},this.emitter=this.emitterFactory.create(),(0,a._)(this,d)[d]=()=>{this.state={isPlaying:!0,isPaused:!1,isPausedByCalls:!1}},(0,a._)(this,_)[_]=()=>{this.state={isPlaying:!1,isPaused:!0}},(0,a._)(this,l)[l]=()=>{this.state={isPlaying:!1,isPaused:!1,isPausedByCalls:!1}},this.resume=e.resume.bind(this),this.pause=e.pause.bind(this),this.stop=e.stop.bind(this),(0,a._)(this,r)[r]()}}function c(){const{events:e}=this;e.on("play",(0,a._)(this,d)[d]),e.on("pause",(0,a._)(this,_)[_]),e.on("stop",(0,a._)(this,l)[l])}},749216:(e,t,s)=>{"use strict";s.d(t,{MyTracker:()=>p});var a=s(434518),n=s(763812),r=s(331635),d=s(132028),_=s(951652),l=s(130653),u=s(164865);var c=(0,n._)("_activityCounters");class p{ensureActivityCounter({counterId:e="2579437",activityId:t,timespentType:s="screen",strict:n=!0}){const r=`${e}/${t}`;let d=(0,a._)(this,c)[c].get(r);if(d&&d.timespentType!==s)throw new Error(`ActivityCounter ${r} already registered with another timespentType (created: ${d.timespentType}, given: ${s})`);return d||(d=new u.MyTrackerActivityCounter({tmr:this.tmr,authService:this.authService,counterId:e,activityId:t,timespentType:s,strict:n}),(0,a._)(this,c)[c].set(r,d)),d}constructor(e,t){Object.defineProperty(this,c,{writable:!0,value:void 0}),this.authService=e,this.tmr=t,(0,a._)(this,c)[c]=new Map}}p=(0,r.__decorate)([d.scope.global(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[void 0===_.AuthService?Object:_.AuthService,void 0===l.Tmr?Object:l.Tmr])],p)},164865:(e,t,s)=>{"use strict";s.d(t,{MyTrackerActivityCounter:()=>m});var a=s(434518),n=s(763812),r=(0,n._)("_authService"),d=(0,n._)("_tmr"),_=(0,n._)("_isActiveTimespent"),l=(0,n._)("_tmrStartTimespent"),u=(0,n._)("_tmrStopTimespent"),c=(0,n._)("_tmrIncrement"),p=(0,n._)("_userId");class m{get isActiveTimespent(){return(0,a._)(this,_)[_]}startTimespent(){if(this.isActiveTimespent){if(this.strict)throw new Error("ActivityCounter already started")}else(0,a._)(this,l)[l](),(0,a._)(this,_)[_]=!0}stopTimespent(){if(this.isActiveTimespent)(0,a._)(this,u)[u](),(0,a._)(this,_)[_]=!1;else if(this.strict)throw new Error("ActivityCounter is not started")}increment(){(0,a._)(this,c)[c]()}constructor({authService:e,tmr:t,counterId:s,activityId:n,timespentType:m,strict:A}){Object.defineProperty(this,l,{value:y}),Object.defineProperty(this,u,{value:g}),Object.defineProperty(this,c,{value:f}),Object.defineProperty(this,p,{get:E,set:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),(0,a._)(this,_)[_]=!1,(0,a._)(this,r)[r]=e,(0,a._)(this,d)[d]=t,this.counterId=s,this.activityId=n,this.timespentType=m,this.strict=A}}function y(){(0,a._)(this,d)[d].push({id:this.counterId,type:"startTimespent",activity:this.activityId,userId:(0,a._)(this,p)[p],canUseInBackground:"service"===this.timespentType})}function g(){(0,a._)(this,d)[d].push({id:this.counterId,type:"stopTimespent",activity:this.activityId,userId:(0,a._)(this,p)[p],canUseInBackground:"service"===this.timespentType})}function f(){(0,a._)(this,d)[d].push({id:this.counterId,type:"incrementEventTimespent",activity:this.activityId,userId:(0,a._)(this,p)[p]})}function E(){return(0,a._)(this,r)[r].userId??0}},346675:(e,t,s)=>{"use strict";s.d(t,{AudioApi:()=>d});var a=s(331635),n=s(132028),r=s(641569);class d extends r.ApiNamespace{get namespace(){return"audio"}constructor(...e){super(...e),this.add=this.makeMethod("add"),this.delete=this.makeMethod("delete"),this.restore=this.makeMethod("restore"),this.createPlaylist=this.makeMethod("createPlaylist"),this.followPlaylist=this.makeMethod("followPlaylist"),this.deletePlaylist=this.makeMethod("deletePlaylist"),this.savePlaylistAsCopy=this.makeMethod("savePlaylistAsCopy"),this.addToPlaylist=this.makeMethod("addToPlaylist"),this.removeFromPlaylist=this.makeMethod("removeFromPlaylist"),this.get=this.makeMethod("get"),this.getById=this.makeMethod("getById"),this.getPlaylistById=this.makeMethod("getPlaylistById"),this.getPlaylists=this.makeMethod("getPlaylists"),this.searchPlaylists=this.makeMethod("searchPlaylists"),this.getPlaylistByIdExtended=this.makeMethod("getPlaylistById"),this.editPlaylist=this.makeMethod("editPlaylist"),this.getAudioIdsBySource=this.makeMethod("getAudioIdsBySource"),this.getAudioPreviewUrl=this.makeMethod("getAudioPreviewUrl"),this.getSnippets=this.makeMethod("getSnippets"),this.getSearchSuggestions=this.makeMethod("getSearchSuggestions"),this.getStreamMixAudios=this.makeMethod("getStreamMixAudios"),this.search=this.makeMethod("search"),this.addDislike=this.makeMethod("addDislike"),this.removeDislike=this.makeMethod("removeDislike"),this.followRadioStation=this.makeMethod("followRadioStation"),this.unfollowRadioStation=this.makeMethod("unfollowRadioStation"),this.getLyrics=this.makeMethod("getLyrics"),this.getFullscreenBanner=this.makeMethod("getFullscreenBanner"),this.consumeFullscreenBanner=this.makeMethod("consumeFullscreenBanner"),this.getSpecialProject=this.makeMethod("getSpecialProject"),this.consumeSpecialProject=this.makeMethod("consumeSpecialProject")}}d=(0,a.__decorate)([n.scope.global()],d)},972573:(e,t,s)=>{"use strict";s.d(t,{FaveApi:()=>d});var a=s(331635),n=s(641569),r=s(132028);class d extends n.ApiNamespace{get namespace(){return"fave"}constructor(...e){super(...e),this.addArticle=this.makeMethod("addArticle"),this.addClassified=this.makeMethod("addClassified"),this.addClip=this.makeMethod("addClip"),this.addGroup=this.makeMethod("addGroup"),this.addLink=this.makeMethod("addLink"),this.addNarrative=this.makeMethod("addNarrative"),this.addPage=this.makeMethod("addPage"),this.addPodcastEpisode=this.makeMethod("addPodcastEpisode"),this.addPost=this.makeMethod("addPost"),this.addProduct=this.makeMethod("addProduct"),this.addTag=this.makeMethod("addTag"),this.addUser=this.makeMethod("addUser"),this.addVideo=this.makeMethod("addVideo"),this.checkLink=this.makeMethod("checkLink"),this.editTag=this.makeMethod("editTag"),this.get=this.makeMethod("get"),this.getPages=this.makeMethod("getPages"),this.getTags=this.makeMethod("getTags"),this.removeArticle=this.makeMethod("removeArticle"),this.removeClassified=this.makeMethod("removeClassified"),this.removeClip=this.makeMethod("removeClip"),this.removeGroup=this.makeMethod("removeGroup"),this.removeLink=this.makeMethod("removeLink"),this.removeNarrative=this.makeMethod("removeNarrative"),this.removePage=this.makeMethod("removePage"),this.removePodcastEpisode=this.makeMethod("removePodcastEpisode"),this.removePost=this.makeMethod("removePost"),this.removeProduct=this.makeMethod("removeProduct"),this.removeTag=this.makeMethod("removeTag"),this.removeUser=this.makeMethod("removeUser"),this.removeVideo=this.makeMethod("removeVideo"),this.reorderTags=this.makeMethod("reorderTags"),this.setPageTags=this.makeMethod("setPageTags"),this.setTags=this.makeMethod("setTags")}}d=(0,a.__decorate)([r.scope.global()],d)},882044:(e,t,s)=>{"use strict";s.d(t,{VideoApi:()=>d});var a=s(331635),n=s(132028),r=s(641569);class d extends r.ApiNamespace{get namespace(){return"video"}constructor(...e){super(...e),this.get=this.makeMethod("get"),this.search=this.makeMethod("search"),this.edit=this.makeMethod("edit"),this.save=this.makeMethod("save"),this.delete=this.makeMethod("delete"),this.add=this.makeMethod("add"),this.getAlbums=this.makeMethod("getAlbums"),this.getAlbumById=this.makeMethod("getAlbumById"),this.getAlbumsByVideo=this.makeMethod("getAlbumsByVideo"),this.addToAlbum=this.makeMethod("addToAlbum"),this.addAlbum=this.makeMethod("addAlbum"),this.editAlbum=this.makeMethod("editAlbum"),this.deleteAlbum=this.makeMethod("deleteAlbum"),this.removeFromAlbum=this.makeMethod("removeFromAlbum"),this.getGroupsForUploading=this.makeMethod("getGroupsForUploading"),this.encodeProgress=this.makeMethod("encodeProgress"),this.getPrivacyDictionary=this.makeMethod("getPrivacyDictionary"),this.reportComment=this.makeMethod("reportComment"),this.getPlaylistUpdateInfo=this.makeMethod("getPlaylistUpdateInfo"),this.getPlaylistThumbUploadUrl=this.makeMethod("getPlaylistThumbUploadUrl"),this.savePlaylistThumb=this.makeMethod("savePlaylistThumb"),this.savePlaylistAdditionalThumb=this.makeMethod("savePlaylistAdditionalThumb"),this.getGroupSettings=this.makeMethod("getGroupSettings"),this.reorderAlbums=this.makeMethod("reorderAlbums"),this.restore=this.makeMethod("restore"),this.stopStreaming=this.makeMethod("stopStreaming"),this.getComments=this.makeMethod("getComments"),this.getComment=this.makeMethod("getComment"),this.agreeDisclaimer=this.makeMethod("agreeDisclaimer"),this.saveGroupSettings=this.makeMethod("saveGroupSettings"),this.deleteComment=this.makeMethod("deleteComment"),this.restoreComment=this.makeMethod("restoreComment"),this.editComment=this.makeMethod("editComment"),this.createComment=this.makeMethod("createComment"),this.getStatsToken=this.makeMethod("getStatsToken",!0),this.getPlayerConfig=this.makeMethod("getPlayerConfig"),this.saveUploadedThumb=this.makeMethod("saveUploadedThumb"),this.subscribeChooseRelevantAuthors=this.makeMethod("subscribeChooseRelevantAuthors"),this.subscribeGetRelevantAuthors=this.makeMethod("subscribeGetRelevantAuthors"),this.getThumbUploadUrl=this.makeMethod("getThumbUploadUrl"),this.viewSegments=this.makeMethod("viewSegments"),this.subscribeToAlbum=this.makeMethod("subscribeToAlbum"),this.unsubscribeFromAlbum=this.makeMethod("unsubscribeFromAlbum"),this.moderAction=this.makeMethod("moderAction"),this.updateMovieInfo=this.makeMethod("updateMovieInfo"),this.getMovieInfo=this.makeMethod("getMovieInfo"),this.getMovieInfoDropdownData=this.makeMethod("getMovieInfoDropdownData")}}d=(0,a.__decorate)([n.scope.global()],d)},382010:(e,t,s)=>{"use strict";s.d(t,{usePatchChildrenRef:()=>d});var a=s(296540),n=s(697157);const r=e=>"string"==typeof e.type,d=e=>{const t=(0,a.isValidElement)(e)&&(r(e)?e.ref:e.props.getRootRef),s=(0,n.useExternRef)(t);return(0,a.useEffect)((()=>{s.current||console.error("Кажется, в children передан компонент, который не поддерживает свойство getRootRef. Мы не можем получить ссылку на корневой dom-элемент этого компонента")}),[e?.type,s]),[s,(0,a.isValidElement)(e)?(0,a.cloneElement)(e,{[r(e)?"ref":"getRootRef"]:s}):e]}},960126:(e,t,s)=>{"use strict";s.d(t,{getLottieManager:()=>a});const a=(0,s(8520).asyncImportLoader)((async()=>{const{LottieManager:e}=await Promise.all([s.e(33013),s.e(23666),s.e("langs/web/rlottie")]).then(s.bind(s,535130));return e}))},687741:(e,t,s)=>{"use strict";s.d(t,{createAccountGetHelpHintsFx:()=>u,createAccountGetInfoFx:()=>r,createAccountGetPrivacySettingsFx:()=>m,createAccountGetProfileInfoFx:()=>l,createAccountHideHelpHintFx:()=>c,createAccountSetInfoFx:()=>d,createAccountShowHelpHintFx:()=>p,createAccountUnbanFx:()=>y});var a=s(32489),n=s(412554);const r=e=>(0,n.createApiEffect)("account.getInfo",e),d=e=>(0,a.attach)({effect:(0,n.createApiEffect)("account.setInfo",e),mapParams:({query:e,...t})=>({...t,query:{...e,value:_(e.value)}})});function _(e){return"boolean"==typeof e?e?"1":"0":"number"==typeof e?String(e):e}const l=e=>(0,n.createApiEffect)("account.getProfileInfo",e),u=e=>(0,n.createApiEffect)("account.getHelpHints",e),c=e=>(0,n.createApiEffect)("account.hideHelpHint",e),p=e=>(0,n.createApiEffect)("account.showHelpHint",e),m=e=>(0,n.createApiEffect)("account.getPrivacySettings",e),y=e=>(0,n.createApiEffect)("account.unban",e)},580352:(e,t,s)=>{"use strict";s.d(t,{createAudioAddDislikeFx:()=>P,createAudioAddFx:()=>c,createAudioAddToPlaylistFx:()=>C,createAudioCreatePlaylistFx:()=>y,createAudioDeleteFx:()=>p,createAudioDeletePlaylistFx:()=>g,createAudioFollowRadioStationFx:()=>I,createAudioGetAudioIdsBySourceFx:()=>d,createAudioGetAudioPreviewFx:()=>u,createAudioGetByIdFx:()=>n,createAudioGetFx:()=>_,createAudioGetPlaylistByIdFx:()=>r,createAudioGetSearchSuggestionsFx:()=>E,createAudioGetSnippetsFx:()=>f,createAudioGetStreamMixAudiosFx:()=>A,createAudioRemoveDislikeFx:()=>b,createAudioRemoveFromPlaylistFx:()=>O,createAudioRestoreFx:()=>m,createAudioSearchFx:()=>l,createAudioUnfollowRadioStationFx:()=>T});var a=s(412554);const n=e=>(0,a.createApiEffect)("audio.getById",e),r=e=>(0,a.createApiEffect)("audio.getPlaylistById",e),d=e=>(0,a.createApiEffect)("audio.getAudioIdsBySource",e),_=e=>(0,a.createApiEffect)("audio.get",e),l=e=>(0,a.createApiEffect)("audio.search",e),u=e=>(0,a.createApiEffect)("audio.getAudioPreviewUrl",e),c=e=>(0,a.createApiEffect)("audio.add",e),p=e=>(0,a.createApiEffect)("audio.delete",e),m=e=>(0,a.createApiEffect)("audio.restore",e),y=e=>(0,a.createApiEffect)("audio.createPlaylist",e),g=e=>(0,a.createApiEffect)("audio.deletePlaylist",e),f=e=>(0,a.createApiEffect)("audio.getSnippets",e),E=e=>(0,a.createApiEffect)("audio.getSearchSuggestions",e),A=e=>(0,a.createApiEffect)("audio.getStreamMixAudios",e),P=e=>(0,a.createApiEffect)("audio.addDislike",e),b=e=>(0,a.createApiEffect)("audio.removeDislike",e),I=e=>(0,a.createApiEffect)("audio.followRadioStation",e),T=e=>(0,a.createApiEffect)("audio.unfollowRadioStation",e),C=e=>(0,a.createApiEffect)("audio.addToPlaylist",e),O=e=>(0,a.createApiEffect)("audio.removeFromPlaylist",e)},278116:(e,t,s)=>{"use strict";s.d(t,{createFaveAddGroupFx:()=>l,createFaveAddPodcastEpisodeFx:()=>c,createFaveAddProductFx:()=>d,createFaveAddVideoFx:()=>n,createFaveRemoveGroupFx:()=>u,createFaveRemovePodcastEpisodeFx:()=>p,createFaveRemoveProductFx:()=>_,createFaveRemoveVideoFx:()=>r});var a=s(412554);const n=e=>(0,a.createApiEffect)("fave.addVideo",e),r=e=>(0,a.createApiEffect)("fave.removeVideo",e),d=e=>(0,a.createApiEffect)("fave.addProduct",e),_=e=>(0,a.createApiEffect)("fave.removeProduct",e),l=e=>(0,a.createApiEffect)("fave.addGroup",e),u=e=>(0,a.createApiEffect)("fave.removeGroup",e),c=e=>(0,a.createApiEffect)("fave.addPodcastEpisode",e),p=e=>(0,a.createApiEffect)("fave.removePodcastEpisode",e)},335797:(e,t,s)=>{"use strict";s.d(t,{useEntitiesStore:()=>n,useNotNullEntitiesStore:()=>r});var a=s(293721);const n=(e,t)=>(0,a.useStoreMap)({store:e,keys:[t],fn:(e,[t])=>e[t],defaultValue:null}),r=(e,t)=>(0,a.useStoreMap)({store:e,keys:[t],fn:(e,[t])=>{const s=e[t];if(null==s)throw new Error("Empty value entity store");return s}})},978746:(e,t,s)=>{"use strict";s.d(t,{ensureAccountInfoService:()=>d});var a=s(32489),n=s(264040);let r;function d(){if(!r){const e=(0,a.createDomain)("global/account/info");r=(0,n.createAccountInfoService)({domain:e})}return r}},503505:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPlaylistsService:()=>d});var a=s(32489),n=s(558137),r=s(990996);const d=(0,n.makeSharedState)("global/audio/playlists",(()=>(0,r.createAudioPlaylistsService)({domain:(0,a.createDomain)("global/audio/playlists"),name:"global/audio/playlists"})),{version:1})},983327:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPreviewsService:()=>d});var a=s(32489),n=s(536673);let r;function d(){if(!r){const e=(0,a.createDomain)("global/audio/audioPreviews");r=(0,n.createAudioPreviewsService)({domain:e})}return r}},308227:(e,t,s)=>{"use strict";s.d(t,{ensureAudiosService:()=>d});var a=s(32489),n=s(110957);let r;function d(){if(!r){const e=(0,a.createDomain)("global/audio/audios");r=(0,n.createAudiosService)({domain:e})}return r}},466915:(e,t,s)=>{"use strict";s.d(t,{ensureGroupsMusicService:()=>d});var a=s(32489),n=s(558137),r=s(413678);const d=(0,n.makeSharedState)("global/audio/groupsMusic",(()=>(0,r.createGroupsMusicService)({domain:(0,a.createDomain)("global/audio/groupsMusic"),name:"global/audio/groupsMusic"})),{version:3})},498486:(e,t,s)=>{"use strict";s.d(t,{ensureMyAudioDislikesService:()=>d});var a=s(32489),n=s(558137),r=s(328568);const d=(0,n.makeSharedState)("global/audio/myDislikes",(()=>(0,r.createMyAudioDislikesService)({domain:(0,a.createDomain)("global/audio/myDislikes"),name:"global/audio/myDislikes"})),{version:1})},30899:(e,t,s)=>{"use strict";s.d(t,{ensureMyAudioPlaylistsService:()=>_});var a=s(32489),n=s(558137),r=s(131084),d=s(503505);const _=(0,n.makeSharedState)("global/audio/myPlaylists",(()=>(0,r.createMyAudioPlaylistsService)({config:{domain:(0,a.createDomain)("global/audio/myPlaylists"),name:"global/audio/myPlaylists"},audioPlaylistsService:(0,d.ensureAudioPlaylistsService)()})),{version:2})},797612:(e,t,s)=>{"use strict";s.d(t,{ensureMyAudioRadioStationsService:()=>d});var a=s(32489),n=s(558137),r=s(197796);const d=(0,n.makeSharedState)("global/audio/myRadioStations",(()=>(0,r.createMyAudioRadioStationsService)({domain:(0,a.createDomain)("global/audio/myRadioStations"),name:"global/audio/myRadioStations"})),{version:1})},345997:(e,t,s)=>{"use strict";s.d(t,{ensureMyMusicService:()=>d});var a=s(32489),n=s(558137),r=s(944374);const d=(0,n.makeSharedState)("global/audio/myMusic",(()=>(0,r.createMyMusicService)({domain:(0,a.createDomain)("global/audio/myMusic"),name:"global/audio/myMusic"})),{version:2})},560756:(e,t,s)=>{"use strict";s.d(t,{ensureAudioPodcastsFaveService:()=>d});var a=s(32489),n=s(558137),r=s(213059);const d=(0,n.makeSharedState)("global/fave/audio/podcasts",(()=>(0,r.createAudioPodcastsFaveService)({domain:(0,a.createDomain)("global/fave/audio/podcasts"),name:"global/fave/audio/podcasts"})),{version:1})},984745:(e,t,s)=>{"use strict";s.d(t,{ensureAccountHelpHintsService:()=>c});var a=s(32489),n=s(558137),r=s(687741),d=s(746573),_=s(782399),l=s(603025),u=s(679005);const c=(0,n.makeSharedState)("global/account/helpHints",(()=>(e=>{const t=(0,d.getEffectorServiceDomain)(e),s=t.createStore({}),n=t.createStore({viewerId:0}),c=t.createEvent("helpHints/initialize"),p=t.createEvent("helpHints/reload"),m=t.createEvent("helpHints/logError"),y=t.createEvent("helpHints/hide"),g=t.createEvent("helpHints/show"),f=(0,r.createAccountGetHelpHintsFx)({domain:t});let E=null;const A=async()=>{const{items:e}=await f({query:{}});return e.reduce(((e,t)=>(e[t.id]=t,e)),{})},P=(0,a.attach)({name:"helpHints/getHelpHintsFx",source:s,effect:t.createEffect((e=>Object.keys(e).length?Promise.resolve(e):E||(E=A().finally((()=>{E=null})),E)))}),b=t.createEffect("helpHints/reloadHelpHintsFx");b.use((()=>A()));const I=(0,a.attach)({name:"helpHints/hideHelpHintFx",effect:(0,r.createAccountHideHelpHintFx)({domain:t}),mapParams:({hintId:e})=>({query:{hint_id:e}})}),T=(0,a.attach)({name:"helpHints/showHelpHintFx",effect:(0,r.createAccountShowHelpHintFx)({domain:t}),mapParams:e=>({query:{hint_id:e}})}),C=t.createEffect("helpHints/logErrorFx");return C.use((({error:e,logErrorFn:t})=>{let s=null,a=null;t?((0,_.isNetworkError)(e)?s=e.error:(0,l.isApiError)(e)?(s=new Error(e.type),a=e.error):s=e,s&&t(s,{environment:"global/account/helpHints",data:a})):console.error(e)})),(0,a.sample)({clock:c,target:n}),(0,a.sample)({clock:c,source:P.pending,filter:e=>!e,target:P}),(0,a.sample)({clock:p,target:b}),(0,a.sample)({clock:[P.doneData,b.doneData],target:s}),(0,a.sample)({clock:y,target:I}),(0,a.sample)({clock:y,source:s,filter:(e,{isOptimistic:t})=>Boolean(t),fn:(e,{hintId:t})=>(0,u.produce)(e,(e=>{delete e[t]})),target:s}),(0,a.sample)({clock:g,target:T}),(0,a.sample)({clock:I.done,source:s,filter:(e,{params:{isOptimistic:t}})=>!t,fn:(e,{params:{hintId:t}})=>(0,u.produce)(e,(e=>{delete e[t]})),target:s}),(0,a.sample)({clock:T.done,target:p}),(0,a.sample)({clock:m,source:n,fn:({logErrorFn:e},t)=>({error:t,logErrorFn:e}),target:C}),(0,a.sample)({clock:[P.failData,b.failData,T.failData,I.failData],target:m}),{initialize:c,canShow:e=>Boolean(s.getState()[e]),getHelpHintsFx:P,$helpHints:s,hideHelpHint:y,showHelpHint:g}})({domain:(0,a.createDomain)("global/account/helpHints"),name:"global/account/helpHints"})),{version:1})},264040:(e,t,s)=>{"use strict";s.d(t,{createAccountInfoService:()=>d});var a,n=s(32489),r=s(687741);!function(e){e[e.Pending=0]="Pending",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"}(a||(a={}));const d=({domain:e})=>{const t=e.createStore({}),s=e.createStore(0),a=(0,r.createAccountGetInfoFx)({domain:e}),d=(0,r.createAccountSetInfoFx)({domain:e}),_=e.createEffect((()=>a({query:{}})));s.on(a,((e,t)=>t.query.fields?e:e<=0?1:void 0)).on(a.finally,((e,t)=>t.params.query.fields||"done"!==t.status?e:1)),t.on(a.finally,((e,t)=>"done"===t.status?{...e,...t.result}:e)).on(d.done,((e,t)=>{const{result:s,params:{query:{name:a,value:n}}}=t;return s&&a in e?{...e,[a]:n}:e}));const l=e.createEvent();return(0,n.sample)({clock:l,source:s,filter:e=>2!==e,target:_}),{$accountInfo:t,getInfoFx:a,setInfoFx:d,initEvent:l}}},848040:(e,t,s)=>{"use strict";function a({id:e,ownerId:t,accessKey:s}){return`${t}_${e}${s?`_${s}`:""}`}s.d(t,{getAudioAccessId:()=>a})},478455:(e,t,s)=>{"use strict";function a({id:e,ownerId:t}){return`${t}_${e}`}s.d(t,{getAudioFullId:()=>a})},680033:(e,t,s)=>{"use strict";function a(e){const t={id:e.id,ownerId:e.owner_id,accessKey:e.access_key,releaseAudioId:e.release_audio_id};return{...t,identity:t,title:e.title,author:_(e),artwork:d(e.album?.thumb),duration:e.duration,url:e.url||null,isExplicit:e.is_explicit}}function n(e){if(!e.track_code)throw new Error("track_code is not defined");return{...a(e),trackCode:e.track_code}}s.d(t,{mapAPIAudioArtistToAudioDataArtistInfo:()=>l,mapAPIAudioToAudioData:()=>a,mapAPIAudioToAudioDataAuthor:()=>_,mapAPIAudioToTrackedAudioData:()=>n});const r=[["photo_34",34],["photo_68",68],["photo_135",135],["photo_270",270],["photo_300",300],["photo_600",600],["photo_1200",1200]];function d(e){const t=[];if(!e)return t;for(const[s,a]of r){const n=e[s];n&&t.push({src:n,size:a})}return t}function _(e){return{main:e?.main_artists?.map(u)??[],feat:e?.featured_artists?.map(u)??[],raw:e.artist}}function l(e){return{id:e.id,name:e.name}}function u(e){return{name:e.name}}},139612:(e,t,s)=>{"use strict";function a(e){const[t,s,a]=e.split("_");if(!s||!t)throw new Error(`Invalid audio_id: ${e}`);return{id:parseInt(s,10),ownerId:parseInt(t,10),accessKey:a}}s.d(t,{mapAPIRawIdToAudioIdentity:()=>a})},234386:(e,t,s)=>{"use strict";s.d(t,{mapAPIRawIdTrackedToTrackedAudioIdentity:()=>n});var a=s(139612);function n(e){return{...(0,a.mapAPIRawIdToAudioIdentity)(e.audio_id),trackCode:e.track_code}}},488150:(e,t,s)=>{"use strict";var a;s.d(t,{AudioType:()=>a}),function(e){e.MusicTrack="music_track",e.MusicSnippet="music_snippet",e.PodcastEpisode="podcast_episode",e.PodcastTrailer="podcast_trailer",e.Radio="radio"}(a||(a={}))},346127:(e,t,s)=>{"use strict";s.d(t,{mapAPIAudioToMusicAudioData:()=>r,mapAPIAudioToTrackedMusicAudioData:()=>d});var a=s(680033),n=s(796674);function r(e,t){return{...(0,a.mapAPIAudioToAudioData)(t),..._(e,t),...(0,n.mapAPIAudioToTrackedMusicAudioState)(t)}}function d(e,t){return{...(0,a.mapAPIAudioToTrackedAudioData)(t),..._(e,t),...(0,n.mapAPIAudioToTrackedMusicAudioState)(t)}}function _(e,t){return{type:e,hasLyrics:t.has_lyrics??!1,author:(s=t,{...(0,a.mapAPIAudioToAudioDataAuthor)(s),main:s?.main_artists?.map(l)??[],feat:s?.featured_artists?.map(l)??[]})};var s}function l(e){return{name:e.name,id:e.id}}},796674:(e,t,s)=>{"use strict";function a(e){return{disliked:e.dislike??!1}}s.d(t,{mapAPIAudioToTrackedMusicAudioState:()=>a})},280481:(e,t,s)=>{"use strict";function a({id:e,ownerId:t,podcastId:s}){return`${t}_${Number.isFinite(s)?s:e}`}s.d(t,{getPodcastAudioFullId:()=>a})},990996:(e,t,s)=>{"use strict";s.d(t,{createAudioPlaylistsService:()=>f});var a=s(32489),n=s(580352),r=s(594241),d=s(46201),_=s(786979),l=s(865409),u=s(234386),c=s(393344),p=s(121574),m=s(169134),y=s(836222),g=s(746573);function f(e){const t=(0,g.getEffectorServiceDomain)(e),s=(0,n.createAudioGetPlaylistByIdFx)({domain:t}),f=(0,n.createAudioGetAudioIdsBySourceFx)({domain:t}),E=(0,c.createAudioPlaylistsCreateFx)({domain:t}),A=(0,p.createAudioPlaylistsDeleteFx)({domain:t}),P=(0,m.createAddAudioFx)({domain:t}),b=(0,y.createDeleteAudioFx)({domain:t}),I=t.createStore({}),T=t.createStore({}),C=t.createEffect((async({id:e,ownerId:t})=>{const a=await s({query:{playlist_id:e,owner_id:t}});return(0,l.mapAPIPlaylistToAudioPlaylistData)(a)})),O=(0,a.attach)({source:I,async effect(e,t){const s=e[(0,r.getAudioPlaylistFullId)(t)];return s||C(t)}}),M=t.createEffect((async e=>(await f({query:{source:"playlist",entity_id:(0,r.getAudioPlaylistFullId)(e)}})).audios.map(u.mapAPIRawIdTrackedToTrackedAudioIdentity))),S=(0,a.attach)({source:T,async effect(e,t){const s=e[(0,r.getAudioPlaylistFullId)(t)];return s||M(t)}});return I.on(C.done,((e,{result:t})=>({...e,[(0,r.getAudioPlaylistFullId)(t)]:t}))),T.on(M.done,((e,{params:t,result:s})=>({...e,[(0,r.getAudioPlaylistFullId)(t)]:s}))),I.on(E.done,((e,{result:t})=>(0,d.addPairToMap)(e,{key:(0,r.getAudioPlaylistFullId)(t),value:t}))),I.on(A.done,((e,{params:t})=>(0,_.removePairFromMap)(e,(0,r.getAudioPlaylistFullId)({id:t.id,ownerId:t.ownerId})))),{$playlistDataEntities:I,$playlistAudioIdsEntities:T,createFx:E,deleteFx:A,addAudioFx:P,deleteAudioFx:b,fetchPlaylistFx:C,ensurePlaylistFx:O,fetchPlaylistAudioIdsFx:M,ensurePlaylistAudioIdsFx:S}}},169134:(e,t,s)=>{"use strict";s.d(t,{createAddAudioFx:()=>r});var a=s(580352),n=s(848040);function r({domain:e}){const t=(0,a.createAudioAddToPlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,playlistId:s,audioIdentity:a})=>{const r=await t({query:{owner_id:e,playlist_id:s,audio_ids:(0,n.getAudioAccessId)(a)}}),d=r?.[0]?.audio_id;if(!d)throw new Error("Error when trying to add audio to a playlist");return{id:d,ownerId:e}}))}},393344:(e,t,s)=>{"use strict";s.d(t,{createAudioPlaylistsCreateFx:()=>d});var a=s(580352),n=s(865409),r=s(478455);function d({domain:e}){const t=(0,a.createAudioCreatePlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,audios:s,title:a,description:d})=>{const _=s.map(r.getAudioFullId).join(","),l=await t({query:{owner_id:e,audio_ids:_,title:a,description:d}});return(0,n.mapAPIPlaylistToAudioPlaylistData)(l)}))}},121574:(e,t,s)=>{"use strict";s.d(t,{createAudioPlaylistsDeleteFx:()=>n});var a=s(580352);function n({domain:e}){const t=(0,a.createAudioDeletePlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,id:s})=>{await t({query:{owner_id:e,playlist_id:s}})}))}},836222:(e,t,s)=>{"use strict";s.d(t,{createDeleteAudioFx:()=>r});var a=s(580352),n=s(478455);function r({domain:e}){const t=(0,a.createAudioRemoveFromPlaylistFx)({domain:e});return e.createEffect((async({ownerId:e,playlistId:s,audioIdentity:a})=>{await t({query:{owner_id:e,playlist_id:s,audio_ids:(0,n.getAudioFullId)(a)}})}))}},536673:(e,t,s)=>{"use strict";s.d(t,{createAudioPreviewsService:()=>_});var a=s(32489),n=s(580352),r=s(65047),d=s(478455);function _({domain:e}){const t=(0,n.createAudioGetAudioPreviewFx)({domain:e}),s=e.createStore({}),_=e.createEffect((async({identity:e})=>{const s=await t({query:{audio_id:(0,d.getAudioFullId)(e),preview_type:"longtap"}});return(0,r.mapApiAudioPreviewToAudioPreviewData)(s)}));return(0,a.sample)({clock:_.done,source:s,fn:(e,{params:t,result:s})=>{const{id:a,ownerId:n}=t.identity,r=(0,d.getAudioFullId)({id:a,ownerId:n});return{...e,[r]:s}},target:s}),{fetchAudioPreviewFx:_,$audioPreviewEntities:s}}},241024:(e,t,s)=>{"use strict";s.d(t,{createAudioVkMixService:()=>n});var a=s(399452);function n(e){const t=e.createStore([]),s=(0,a.createAudioVkMixFetchNextFx)(e);return t.on(s.doneData,((e,t)=>t.length?[...e,...t]:e)),{$lists:t,fetchNextFx:s}}},399452:(e,t,s)=>{"use strict";s.d(t,{createAudioVkMixFetchNextFx:()=>n});var a=s(580352);function n(e){const t=(0,a.createAudioGetStreamMixAudiosFx)({domain:e});return e.createEffect((async({id:e,count:s=1,isSessionLaunched:a=!1,isSessionFeatureEnabled:n=!1})=>await t({query:{mix_id:e,count:s,...n?{append:a?1:0}:{}}})))}},110957:(e,t,s)=>{"use strict";s.d(t,{createAudiosService:()=>u});var a=s(32489),n=s(580352),r=s(848040),d=s(346127),_=s(488150),l=s(478455);function u({domain:e}){const t=(0,n.createAudioGetByIdFx)({domain:e}),s=(0,n.createAudioGetFx)({domain:e}),u=(0,n.createAudioSearchFx)({domain:e}),p=e.createStore({}),m=e.createEffect((async e=>{if(!e.length)return[];return(await t({query:{audios:e.map(r.getAudioAccessId).join(",")}})).map((e=>(0,d.mapAPIAudioToMusicAudioData)(_.AudioType.MusicTrack,e)))})),y=e.createEffect((async e=>{let t;t=e.q?await u({query:{owner_id:e.ownerId,count:e.count,offset:e.offset,q:e.q}}):await s({query:{owner_id:e.ownerId,count:e.count,offset:e.offset}});const a=t.items.map((e=>(0,d.mapAPIAudioToMusicAudioData)(_.AudioType.MusicTrack,e)));return{count:t.count,audios:a}})),g=(0,a.attach)({source:p,async effect(e,t){if(!t.length)return[];let s=[],a=[];for(const n of t){const t=e[(0,l.getAudioFullId)(n)];t?s.push(t):a.push(n)}if(!a.length)return s;const n=await m(a),r=c(n);s=[];for(const d of t){const _=(0,l.getAudioFullId)(d),u=r[_]??e[_];if(!u)throw console.error("AudioData not found in entities",{identity:d,fullId:_,audio:u,fetched:n,fetchedEntities:r,entities:e,identities:t,missing:a,result:s}),new Error("AudioData not found in entities");s.push(u)}return s}});return p.on(m.done,((e,{result:t})=>({...e,...c(t)}))),p.on(y.done,((e,{result:t})=>({...e,...c(t.audios)}))),{$audioEntities:p,fetchAudiosFx:m,ensureAudiosFx:g,searchAudiosFx:y}}function c(e){return e.reduce(((e,t)=>(e[(0,l.getAudioFullId)(t)]=t,e)),{})}},413678:(e,t,s)=>{"use strict";s.d(t,{createGroupsMusicService:()=>m});var a=s(32489),n=s(61108),r=s(12204),d=s(896588),_=s(506535),l=s(720222),u=s(746573),c=s(97295),p=s(205337);function m(e){const t=(0,u.getEffectorServiceDomain)(e),s=(0,n.createGroupsMusicAddFx)({domain:t}),m=(0,r.createGroupsMusicRestoreFx)({domain:t}),y=(0,d.createGroupsMusicDeleteFx)({domain:t}),{$addedIdentitiesMap:g,$removedIdentitiesMap:f,$identitiesMap:E,removeFromAllIdentitiesMaps:A,removedIdentitiesMapApi:P,addedIdentitiesMapApi:b}=(0,l.createIdentitiesMaps)({domain:t}),I=(0,a.attach)({source:(0,a.combine)({addedIdentitiesMap:g,removedIdentitiesMap:f}),mapParams:(e,t)=>({...e,...t}),effect:(0,a.createEffect)((async({groupId:e,trackedIdentity:t,addedIdentitiesMap:a,removedIdentitiesMap:n})=>{let r,d;const l=(0,p.convertToGroupMusicId)(e);if(l===t.ownerId)r=t,d=(0,c.getGroupAudioFullId)({id:t.id,ownerId:l},l);else{const e=(0,c.getGroupAudioFullId)({id:t.id,ownerId:t.ownerId},l);if(!(e in a))return await s({trackedIdentity:t,groupId:l});if(r=a[e],d=(0,c.getGroupAudioFullId)({id:r.id,ownerId:l},l),!(d in n))return await s({trackedIdentity:t,groupId:l})}const u=(0,c.getGroupAudioFullId)({id:t.id,ownerId:t.ownerId},l);try{return await m({audioId:r.id,groupId:l}),{id:r.id,ownerId:l}}catch(e){const a=e;if(a?.error?.error_code===_.GROUPS_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE)return A({addedGroupAudioFullId:u,removedGroupAudioFullId:d}),await s({trackedIdentity:t,groupId:l});throw a}}))});return(0,a.sample)({clock:I.done,source:g,filter:(e,{params:{groupId:t,trackedIdentity:s}})=>t===s.ownerId&&!((0,c.getGroupAudioFullId)(s,t)in e),fn:(e,{params:{groupId:t,trackedIdentity:s},result:a})=>({groupAudioFullId:(0,c.getGroupAudioFullId)(s,t),identity:a}),target:b.add}),(0,a.sample)({clock:s.done,fn:({params:{groupId:e,trackedIdentity:{id:t,ownerId:s}},result:a})=>{const n=(0,p.convertToGroupMusicId)(e);return{groupAudioFullId:(0,c.getGroupAudioFullId)({id:t,ownerId:s},n),identity:a}},target:b.add}),(0,a.sample)({clock:m.done,fn:({params:{groupId:e,audioId:t}})=>{const s=(0,p.convertToGroupMusicId)(e);return(0,c.getGroupAudioFullId)({id:t,ownerId:s},s)},target:P.remove}),(0,a.sample)({clock:y.done,fn:({params:{groupId:e,audioId:t}})=>{const s=(0,p.convertToGroupMusicId)(e);return(0,c.getGroupAudioFullId)({id:t,ownerId:s},s)},target:P.add}),{addFx:I,deleteFx:y,$identitiesMap:E}}},61108:(e,t,s)=>{"use strict";s.d(t,{createGroupsMusicAddFx:()=>d});var a=s(580352),n=s(468073),r=s(205337);function d({domain:e}){const t=(0,a.createAudioAddFx)({domain:e});return e.createEffect((async({trackedIdentity:e,groupId:s})=>{const{id:a,ownerId:d,accessKey:_,trackCode:l}=e,u=(0,r.convertToGroupMusicId)(s),c=await t({query:{audio_id:a,owner_id:d,access_key:_,track_code:l,group_id:n.Ranges.convertOwnerIdToGroupId(u)}}),p=c.items?.[0]?.new_audio_id;if(null==p)throw new Error("[GroupsMusicAddFx] addFx - missing audio ID in response from audio.add api method");return{id:p,ownerId:u}}))}},896588:(e,t,s)=>{"use strict";s.d(t,{createGroupsMusicDeleteFx:()=>r});var a=s(580352),n=s(205337);function r({domain:e}){const t=(0,a.createAudioDeleteFx)({domain:e});return e.createEffect((async({audioId:e,groupId:s})=>{await t({query:{audio_id:e,owner_id:(0,n.convertToGroupMusicId)(s)}})}))}},506535:(e,t,s)=>{"use strict";s.d(t,{GROUPS_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE:()=>a});const a=15},12204:(e,t,s)=>{"use strict";s.d(t,{createGroupsMusicRestoreFx:()=>n});var a=s(580352);function n({domain:e}){const t=(0,a.createAudioRestoreFx)({domain:e});return e.createEffect((async({audioId:e,groupId:s})=>{await t({query:{audio_id:e,owner_id:s}})}))}},205337:(e,t,s)=>{"use strict";s.d(t,{convertToGroupMusicId:()=>n});var a=s(468073);function n(e){return a.Ranges.isGroupId(e)?e:a.Ranges.convertGroupIdToOwnerId(e)}},216856:(e,t,s)=>{"use strict";function a(e){return+e.split("_")?.[0]}s.d(t,{extractGroupIdFromGroupAudioFullId:()=>a})},97295:(e,t,s)=>{"use strict";s.d(t,{getGroupAudioFullId:()=>r});var a=s(478455),n=s(205337);function r({id:e,ownerId:t},s){return`${(0,n.convertToGroupMusicId)(s)}_${(0,a.getAudioFullId)({id:e,ownerId:t})}`}},720222:(e,t,s)=>{"use strict";s.d(t,{createIdentitiesMaps:()=>u});var a=s(32489),n=s(810780),r=s(46201),d=s(786979),_=s(97295),l=s(216856);const u=({domain:e})=>{const t=e.createStore({}),s=e.createStore({}),u=(0,a.createEvent)(),c=(0,a.combine)(t,s,((e,t)=>Object.entries(e).reduce(((e,[s,a])=>((0,_.getGroupAudioFullId)(a,(0,l.extractGroupIdFromGroupAudioFullId)(s))in t||(e[s]=a),e)),{}))),p=(0,a.createApi)(t,{add:(e,{groupAudioFullId:t,identity:s})=>(0,r.addPairToMap)(e,{key:t,value:s}),remove:(e,t)=>(0,d.removePairFromMap)(e,t)}),m=(0,a.createApi)(s,{add:(e,t)=>(0,r.addPairToMap)(e,{key:t,value:!0}),remove:(e,t)=>(0,d.removePairFromMap)(e,t)});return(0,a.sample)({clock:u,target:(0,n.spread)({targets:{addedGroupAudioFullId:p.remove,removedGroupAudioFullId:m.remove}})}),{$addedIdentitiesMap:t,$removedIdentitiesMap:s,$identitiesMap:c,addedIdentitiesMapApi:p,removedIdentitiesMapApi:m,removeFromAllIdentitiesMaps:u}}},328568:(e,t,s)=>{"use strict";s.d(t,{createMyAudioDislikesService:()=>u});var a=s(746573),n=s(373945),r=s(8683),d=s(32489),_=s(478455),l=s(586049);function u(e){const t=(0,a.getEffectorServiceDomain)(e),s=(0,n.createAddFx)({domain:t}),u=(0,r.createRemoveFx)({domain:t}),{fullIdsMapApi:c,$fullIdsMap:p}=(0,l.createFullIdsMap)(t);return(0,d.sample)({clock:s.done,fn:({params:{identity:e}})=>(0,_.getAudioFullId)(e),target:c.add}),(0,d.sample)({clock:u.done,fn:({params:{identity:e}})=>(0,_.getAudioFullId)(e),target:c.remove}),{addFx:s,removeFx:u,$identitiesMap:p}}},373945:(e,t,s)=>{"use strict";s.d(t,{createAddFx:()=>r});var a=s(580352),n=s(478455);function r({domain:e}){const t=(0,a.createAudioAddDislikeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{audio_ids:(0,n.getAudioFullId)(e)}})}))}},8683:(e,t,s)=>{"use strict";s.d(t,{createRemoveFx:()=>r});var a=s(580352),n=s(478455);function r({domain:e}){const t=(0,a.createAudioRemoveDislikeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{audio_ids:(0,n.getAudioFullId)(e)}})}))}},131084:(e,t,s)=>{"use strict";s.d(t,{createMyAudioPlaylistsService:()=>l});var a=s(32489),n=s(615955),r=s(746573),d=s(178246),_=s(163374);function l({config:e,audioPlaylistsService:t}){const s=(0,r.getEffectorServiceDomain)(e),{$addedAudiosMap:l,addedAudiosMapApi:u}=(0,d.createAddedAudiosMap)(s),c=s.createEvent(),p=(0,a.restore)(c,null),m=s.createStore({},{updateFilter:(e,t)=>!(0,n.shallowEqual)(e,t),serialize:"ignore"}),y=(0,a.attach)({source:p,async effect(e,s){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To create a playlist, set the userId using setUserId.");return t.createFx({...s,ownerId:e})}}),g=(0,a.attach)({source:p,async effect(e,s){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To delete a playlist, set the userId using setUserId.");return t.deleteFx({...s,ownerId:e})}}),f=(0,a.attach)({source:p,async effect(e,s){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To add audio to playlist, set the userId using setUserId.");return t.addAudioFx({...s,ownerId:e})}}),E=(0,a.attach)({source:p,async effect(e,s){if(!e)throw new Error("[MyAudioPlaylistsService] UserId not set. To delete audio from playlist, set the userId using setUserId.");return t.deleteAudioFx({...s,ownerId:e})}});return(0,a.sample)({clock:(0,a.combine)({playlistDataEntities:t.$playlistDataEntities,userId:p}),fn:({playlistDataEntities:e,userId:t})=>t?Object.entries(e).reduce(((e,[s,a])=>(a.ownerId===t&&(e[s]=a),e)),{}):{},target:m}),(0,a.sample)({clock:f.done,source:p,fn:(e,{params:t,result:s})=>({originalPlaylistAudioFullId:(0,_.getPlaylistAudioFullId)({originalAudio:t.audioIdentity,playlist:{id:t.playlistId,ownerId:e}}),addedIdentity:s}),target:u.add}),(0,a.sample)({clock:E.done,source:p,fn:(e,{params:t})=>(0,_.getPlaylistAudioFullId)({originalAudio:t.originalAudioIdentity,playlist:{id:t.playlistId,ownerId:e}}),target:u.remove}),{createFx:y,deleteFx:g,addAudioFx:f,deleteAudioFx:E,setUserId:c,$myAudioPlaylistsIdentitiesMap:m,$addedAudiosMap:l}}},178246:(e,t,s)=>{"use strict";s.d(t,{createAddedAudiosMap:()=>d});var a=s(32489),n=s(46201),r=s(786979);function d(e){const t=e.createStore({});return{$addedAudiosMap:t,addedAudiosMapApi:(0,a.createApi)(t,{add:(e,{originalPlaylistAudioFullId:t,addedIdentity:s})=>(0,n.addPairToMap)(e,{key:t,value:s}),remove:(e,t)=>(0,r.removePairFromMap)(e,t)})}}},163374:(e,t,s)=>{"use strict";s.d(t,{getPlaylistAudioFullId:()=>r});var a=s(848040),n=s(594241);function r({playlist:e,originalAudio:t}){return`PLAYLIST_${(0,n.getAudioPlaylistFullId)(e)}AUDIO_${(0,a.getAudioAccessId)(t)}`}},197796:(e,t,s)=>{"use strict";s.d(t,{createMyAudioRadioStationsService:()=>u});var a=s(746573),n=s(294219),r=s(685065),d=s(32489),_=s(478455),l=s(586049);function u(e){const t=(0,a.getEffectorServiceDomain)(e),s=(0,n.createFollowFx)({domain:t}),u=(0,r.creatUnfollowFx)({domain:t}),{fullIdsMapApi:c,$fullIdsMap:p}=(0,l.createFullIdsMap)(t);return(0,d.sample)({clock:s.done,fn:({params:{identity:e}})=>(0,_.getAudioFullId)(e),target:c.add}),(0,d.sample)({clock:u.done,fn:({params:{identity:e}})=>(0,_.getAudioFullId)(e),target:c.remove}),{followFx:s,unfollowFx:u,$identitiesMap:p}}},294219:(e,t,s)=>{"use strict";s.d(t,{createFollowFx:()=>n});var a=s(580352);function n({domain:e}){const t=(0,a.createAudioFollowRadioStationFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{station_id:e.id}})}))}},685065:(e,t,s)=>{"use strict";s.d(t,{creatUnfollowFx:()=>n});var a=s(580352);function n({domain:e}){const t=(0,a.createAudioUnfollowRadioStationFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{station_id:e.id}})}))}},944374:(e,t,s)=>{"use strict";s.d(t,{createMyMusicService:()=>p});var a=s(32489),n=s(606066),r=s(245666),d=s(478794),_=s(838325),l=s(478455),u=s(182464),c=s(746573);function p(e){const t=(0,c.getEffectorServiceDomain)(e),s=(0,n.createAddFx)({domain:t}),p=(0,r.createRestoreFx)({domain:t}),m=(0,d.createDeleteFx)({domain:t}),{$addedIdentitiesMap:y,$removedIdentitiesMap:g,$identitiesMap:f,addedIdentitiesMapApi:E,removedIdentitiesMapApi:A,addToStore:P,removeFromStore:b,removeFromAllIdentitiesMaps:I}=(0,u.createIdentitiesMaps)({domain:t}),T=(0,a.attach)({source:(0,a.combine)({addedIdentitiesMap:y,removedIdentitiesMap:g}),mapParams:(e,t)=>({...e,...t}),effect:(0,a.createEffect)((async({userId:e,trackedIdentity:t,addedIdentitiesMap:a,removedIdentitiesMap:n})=>{let r,d;if(e===t.ownerId)r=t,d=(0,l.getAudioFullId)({id:t.id,ownerId:e});else{const _=(0,l.getAudioFullId)({id:t.id,ownerId:t.ownerId});if(!(_ in a))return await s({trackedIdentity:t,userId:e});if(r=a[_],d=(0,l.getAudioFullId)({id:r.id,ownerId:e}),!(d in n))return await s({trackedIdentity:t,userId:e})}const u=(0,l.getAudioFullId)({id:t.id,ownerId:t.ownerId});try{return await p({identity:{id:r.id,ownerId:e}}),{id:r.id,ownerId:e}}catch(a){const n=a;if(n?.error?.error_code===_.MY_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE)return I({addedFullId:u,removedFullId:d}),await s({trackedIdentity:t,userId:e});throw n}}))});return(0,a.sample)({clock:T.done,source:y,filter:(e,{params:{userId:t,trackedIdentity:s}})=>t===s.ownerId&&!((0,l.getAudioFullId)(s)in e),fn:(e,{params:{trackedIdentity:t},result:s})=>({fullId:(0,l.getAudioFullId)(t),identity:s}),target:E.add}),(0,a.sample)({clock:s.done,fn:({params:{trackedIdentity:{id:e,ownerId:t}},result:s})=>({fullId:(0,l.getAudioFullId)({id:e,ownerId:t}),identity:s}),target:E.add}),(0,a.sample)({clock:p.done,fn:({params:{identity:e}})=>(0,l.getAudioFullId)(e),target:A.remove}),(0,a.sample)({clock:m.done,fn:({params:{identity:e}})=>(0,l.getAudioFullId)(e),target:A.add}),{addFx:T,deleteFx:m,addToStore:P,removeFromStore:b,$identitiesMap:f}}},606066:(e,t,s)=>{"use strict";s.d(t,{createAddFx:()=>n});var a=s(580352);function n({domain:e}){const t=(0,a.createAudioAddFx)({domain:e});return e.createEffect((async({trackedIdentity:e,userId:s})=>{const{id:a,ownerId:n,accessKey:r,trackCode:d,ref:_}=e,l=await t({query:{audio_id:a,owner_id:n,access_key:r,track_code:d,ref:_}}),u=l.items?.[0]?.new_audio_id;if(null==u)throw new Error("[MyMusicService] addFx - missing audio ID in response from audio.add api method");return{id:u,ownerId:s}}))}},478794:(e,t,s)=>{"use strict";s.d(t,{createDeleteFx:()=>n});var a=s(580352);function n({domain:e}){const t=(0,a.createAudioDeleteFx)({domain:e});return e.createEffect((async({identity:e})=>{const{id:s,ownerId:a}=e;await t({query:{audio_id:s,owner_id:a}})}))}},838325:(e,t,s)=>{"use strict";s.d(t,{MY_MUSIC_RESTORE_FX_EXPIRED_ERROR_CODE:()=>a});const a=15},245666:(e,t,s)=>{"use strict";s.d(t,{createRestoreFx:()=>n});var a=s(580352);function n({domain:e}){const t=(0,a.createAudioRestoreFx)({domain:e});return e.createEffect((async({identity:e})=>{const{id:s,ownerId:a}=e;await t({query:{audio_id:s,owner_id:a}})}))}},182464:(e,t,s)=>{"use strict";s.d(t,{createIdentitiesMaps:()=>l});var a=s(32489),n=s(478455),r=s(810780),d=s(46201),_=s(786979);const l=({domain:e})=>{const t=e.createStore({}),s=e.createStore({}),l=(0,a.createEvent)(),u=(0,a.createEvent)(),c=(0,a.createEvent)(),p=(0,a.combine)(t,s,((e,t)=>Object.entries(e).reduce(((e,[s,a])=>((0,n.getAudioFullId)(a)in t||(e[s]=a),e)),{}))),m=(0,a.createApi)(t,{add:(e,{fullId:t,identity:s})=>(0,d.addPairToMap)(e,{key:t,value:s}),remove:(e,t)=>(0,_.removePairFromMap)(e,t)}),y=(0,a.createApi)(s,{add:(e,t)=>(0,d.addPairToMap)(e,{key:t,value:!0}),remove:(e,t)=>(0,_.removePairFromMap)(e,t)});return(0,a.sample)({clock:l,source:t,fn:(e,{oldIdentity:t,newIdentity:s})=>{const a=(0,n.getAudioFullId)(t),r=(0,n.getAudioFullId)(s);return{addToStoreParams:{identity:s,fullId:a},removeFromStoreFullId:e[a]?(0,n.getAudioFullId)(e[a]):r}},target:(0,r.spread)({targets:{addToStoreParams:m.add,removeFromStoreFullId:y.remove}})}),(0,a.sample)({clock:u,filter:({newIdentity:e})=>Boolean(e),target:(0,r.spread)({targets:{oldIdentity:m.remove.prepend((e=>(0,n.getAudioFullId)(e))),newIdentity:y.remove.prepend((e=>(0,n.getAudioFullId)(e)))}})}),(0,a.sample)({clock:c,target:(0,r.spread)({targets:{addedFullId:m.remove,removedFullId:y.remove}})}),{$addedIdentitiesMap:t,$removedIdentitiesMap:s,$identitiesMap:p,addedIdentitiesMapApi:m,removedIdentitiesMapApi:y,addToStore:l,removeFromStore:u,removeFromAllIdentitiesMaps:c}}},586049:(e,t,s)=>{"use strict";s.d(t,{createFullIdsMap:()=>d});var a=s(32489),n=s(46201),r=s(786979);function d(e){const t=e.createStore({});return{$fullIdsMap:t,fullIdsMapApi:(0,a.createApi)(t,{add:(e,t)=>(0,n.addPairToMap)(e,{key:t,value:!0}),remove:(e,t)=>(0,r.removePairFromMap)(e,t)})}}},46201:(e,t,s)=>{"use strict";function a(e,t){return t.key in e?e:{...e,[t.key]:t.value}}s.d(t,{addPairToMap:()=>a})},594241:(e,t,s)=>{"use strict";function a({id:e,ownerId:t}){return`${t}_${e}`}s.d(t,{getAudioPlaylistFullId:()=>a})},786979:(e,t,s)=>{"use strict";function a(e,t){if(!(t in e))return e;const{[t]:s,...a}=e;return a}s.d(t,{removePairFromMap:()=>a})},865409:(e,t,s)=>{"use strict";function a(e){return{id:e.id,ownerId:e.owner_id,title:e.title,description:e.description,length:e.count}}s.d(t,{mapAPIPlaylistToAudioPlaylistData:()=>a})},65047:(e,t,s)=>{"use strict";s.d(t,{mapApiAudioPreviewToAudioPreviewData:()=>a});const a=e=>{const{url:t,clip_from:s,clip_to:a}=e;return{url:t||"",clip:{from:s||0,to:a||0}}}},213059:(e,t,s)=>{"use strict";s.d(t,{createAudioPodcastsFaveService:()=>u});var a=s(746573),n=s(33383),r=s(354491),d=s(32489),_=s(586049),l=s(280481);function u(e){const t=(0,a.getEffectorServiceDomain)(e),s=(0,n.createAddFx)({domain:t}),u=(0,r.createDeleteFx)({domain:t}),{fullIdsMapApi:c,$fullIdsMap:p}=(0,_.createFullIdsMap)(t);return(0,d.sample)({clock:s.done,fn:({params:{identity:e}})=>(0,l.getPodcastAudioFullId)(e),target:c.add}),(0,d.sample)({clock:u.done,fn:({params:{identity:e}})=>(0,l.getPodcastAudioFullId)(e),target:c.remove}),{addFx:s,deleteFx:u,$identitiesMap:p}}},33383:(e,t,s)=>{"use strict";s.d(t,{createAddFx:()=>n});var a=s(278116);function n({domain:e}){const t=(0,a.createFaveAddPodcastEpisodeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{owner_id:e.ownerId,episode_id:e.podcastId}})}))}},354491:(e,t,s)=>{"use strict";s.d(t,{createDeleteFx:()=>n});var a=s(278116);function n({domain:e}){const t=(0,a.createFaveRemovePodcastEpisodeFx)({domain:e});return e.createEffect((async({identity:e})=>{await t({query:{owner_id:e.ownerId,episode_id:e.podcastId}})}))}},412554:(e,t,s)=>{"use strict";s.d(t,{createApiEffect:()=>n,createPrefetchEffect:()=>r});var a=s(957994);const n=(e,{domain:t})=>t.createEffect((({query:t,controller:s,config:n,options:r})=>{const d=s?.signal;return(0,a.api)(e,t,n,{signal:d,...r})})),r=(e,{domain:t,apiWithPrefetch:s=a.api})=>t.createEffect((({query:t,controller:a,config:n,options:r})=>{const d=a?.signal;return s(e,t,n,{signal:d,...r})}))},603025:(e,t,s)=>{"use strict";s.d(t,{isApiError:()=>a});const a=e=>!!e&&"type"in e&&"api_error"===e.type},782399:(e,t,s)=>{"use strict";s.d(t,{isNetworkError:()=>a});const a=e=>"network_error"===e?.type},632731:(e,t,s)=>{"use strict";var a;s.d(t,{AvailableHelpHints:()=>a}),function(e){e.ACCOUNT_HINT_MINI_APPS_BUTTON_MVK_PROFILE="mini_apps:button_mvk_profile",e.ACCOUNT_HINT_MINI_APPS_BUTTON_MVK_APP_MENU="mini_apps:button_mvk_app_menu",e.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU="mini_apps:counter_toggle_in_action_menu",e.ACCOUNT_HINT_MINI_APPS_COUNTER_TOGGLE_IN_ACTION_MENU_INTRO="mini_apps:counter_toggle_in_action_menu_intro",e.ACCOUNT_HINT_MINI_APPS_OPEN_CATALOG_WITH_BADGES="mini_apps:open_catalog_with_badges",e.ACCOUNT_HINT_MINI_APPS_CATALOG_SECTION_WITH_BADGES="mini_apps:catalog_section_with_badges",e.ACCOUNT_HINT_SUPERAPP_RECOMMEND_ACTION_IN_MENU="superapp:recommend_action_in_menu",e.ACCOUNT_HINT_SUPERAPP_SHOW_RECOMMEND_ACTION="superapp:show_recommend_action",e.ACCOUNT_HINT_MINI_APPS_NAV_BUTTONS_THIRD_PARTY_BUTTONS="mini_apps:nav_buttons_third_party_buttons",e.ACCOUNT_HINT_POSTING_EDITOR_ONLINE_BOOKING="posting:editor_online_booking",e.ACCOUNT_HINT_PROFILE_SERVICES_MENU_BANNER="profile:services_menu_banner",e.ACCOUNT_HINT_PROFILE_SERVICES_ONBOARDING="profile:services_onboarding",e.ACCOUNT_HINT_MVK_PWA_TABBAR="mvk:pwa_tabbar",e.ACCOUNT_HINT_SUPERAPP_MVK_SHOWCASE="superapp:mvk_showcase",e.ACCOUNT_HINT_IM_INTEGRATION_APPS_TOOLTIP_ON_PICKER="superapp:im_integration_apps_tooltip_on_picker",e.ACCOUNT_HINT_IM_INTEGRATION_PICKER_APPS_BANNER="superapp:im_integration_picker_apps_banner",e.ACCOUNT_HINT_IM_INTEGRATION_PICKER_GAMES_BANNER="superapp:im_integration_picker_games_banner",e.ACCOUNT_HINT_FRIENDS_FOLLOWERS_MODE_FORCIBLY_ENABLED_ONBOARDING="friends:followers_mode_forcibly_enabled_onboarding",e.ACCOUNT_HINT_FRIENDS_FOLLOWERS_MODE_CAN_BE_ENABLED_ONBOARDING="friends:followers_mode_can_be_enabled_onboarding",e.ACCOUNT_HINT_FRIENDS_FOLLOWERS_MODE_ABOUT_MODAL_IMAGES="friends:followers_mode_about_modal_images",e.ACCOUNT_HINT_IM_INTEGRATION_CATALOG_ONBOARDING="superapp:im_integration_catalog_onboarding",e.ACCOUNT_HINT_PROFILE_PASSKEY_ONBOARDING_WEB="profile:passkey_onboarding_web",e.ACCOUNT_HINT_VIDEO_INTERACTIVE_VIDEO_ONBOARDING="video:interactive_video_onboarding",e.ACCOUNT_HINT_VIDEO_INTERACTIVE_INTERACTIVE_TIME_INDICATOR="video:interactive_time_indicator",e.ACCOUNT_HINT_CLIPS_WEB_UPLOAD_VIDEO_AS_CLIP="clips:upload_video_as_clip_web",e.AUTHOR_LIKE_ONBOARDING_HINT="feed:author_like_onboarding",e.GROUP_LIKE_ONBOARDING_HINT="feed:group_like_onboarding",e.ACCOUNT_HINT_COMMUNITY_REVIEW_TOOLTIP_MVK="community:review:tooltip_mvk",e.ACCOUNT_HINT_GROUPS_EDIT_MARKET_EXTRACTED_SETTINGS_HINT="groups:edit:market_extracted_settings_checkbox_hint",e.ACCOUNT_HINT_GROUPS_MAIN_MARKET_ACTION_EXTRACTED_SETTINGS_HINT="groups:main:market_action_extracted_settings_hint",e.ACCOUNT_HINT_GROUPS_DONUT_GOALS_ONBOARDING="groups:donut_goals_onboarding",e.ACCOUNT_HINT_GROUPS_REDESIGN_ONBOARDING="group:redesign_onboarding_mvk",e.ACCOUNT_HINT_GROUPS_TABS_ORDER_ONBOARDING="group:onboarding_tab_order",e.ACCOUNT_HINT_VIDEO_PIN="video:pin",e.ACCOUNT_HINT_VIDEO_WATCH_LATER_BUTTON="video:watch_later_button",e.ACCOUNT_HINT_VIDEO_WATCH_LATER_ACTION="video:watch_later_action",e.ACCOUNT_HINT_VIDEO_WATCH_LATER_MENU="video:watch_later_menu",e.ACCOUNT_HINT_VIDEO_GROUP_CROP_COVER="video:group_crop_cover",e.ACCOUNT_HINT_VIDEO_MULTIPLE_VOLUME="video:multiple_volume",e.ACCOUNT_HINT_VIDEO_SUBTITLES_KAZ_LANG="video:subtitles_kaz_lang",e.ACCOUNT_HINT_MVK_VIDEO_FILTERS="mvk:video_filters",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PROFILE_MVK="profile:photo_flow_onboarding_banner_profile_mvk",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_SHOW_ALL_MVK="profile:photo_flow_onboarding_banner_show_all_mvk",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PHOTO__MVK="profile:photo_flow_onboarding_banner_photo__mvk",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_MOBILE_QUESTION_MVK="profile:photo_flow_onboarding_banner_mobile_question_mvk",e.ACCOUNT_HINT_PROFILE_OWNER_CONTENT_TABS_SETTINGS="profile:redesign_owner_content_tabs_settings",e.ACCOUNT_HINT_PROFILE_SERVICES_ONBOARDING_WEB="profile:services_onboarding_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PROFILE_WEB="profile:photo_flow_onboarding_banner_profile_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_SHOW_ALL_WEB="profile:photo_flow_onboarding_banner_show_all_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_PHOTO__WEB="profile:photo_flow_onboarding_banner_photo__web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_BANNER_MOBILE_QUESTION_WEB="profile:photo_flow_onboarding_banner_mobile_question_web",e.ACCOUNT_HINT_PROFILE_PHOTO_FLOW_ONBOARDING_TOOLTIP_MOVE_PHOTO="profile:photo_flow_onboarding_tooltip_move_photo",e.ACCOUNT_HINT_ARTICLES_MOBILE_EDITOR="articles:mobile_editor",e.ACCOUNT_HINT_ADSEDIT_SITE_REMOVAL_POPUP="adsedit:site_removal_popup",e.ACCOUNT_HINT_ADSEDIT_COMMUNITY_REMOVAL_POPUP="adsedit:community_removal_popup",e.ACCOUNT_HINT_ADSEDIT_COMMUNITY_AND_SITE_REMOVAL_POPUP="adsedit:community_and_site_removal_popup",e.ACCOUNT_HINT_STICKERS_UGC_SETTINGS_UNSEEN="stickers:ugc_settings_unseen",e.ACCOUNT_HINT_AUDIO_STUDIO_SHOW_PRESENT_MINIAPP_MODAL="audio_studio:show_present_miniapp_modal",e.ACCOUNT_HINT_AUDIO_STUDIO_SHOW_ANNUAL_RESULT_BANNER="audio_studio:show_annual_result_banner",e.ACCOUNT_HINT_AUDIO_LONG_TAP_PREVIEW_WEB="audio:longtap_preview_web",e.ACCOUNT_HINT_BANNED_RESET_SESSIONS="banned:can_not_reset_sessions",e.ACCOUNT_HINT_CLIPS_FORCE_UPLOAD_VIDEO_AS_CLIP="clips:force_upload_video_as_clip",e.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP="posting:editor_photo_attachements_crop",e.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP_ZOOM="posting:editor_photo_attachements_crop_zoom",e.ACCOUNT_HINT_SMB_YCLIENTS_ONLINE_BOOKING="smb:yclients:online_booking",e.UNBAN_SECURITY_RECOMMENDATION_HINT="feed:after_auth:unban_security_recommendation",e.ACCOUNT_HINT_SETTINGS_BOOKING="smb:yclients:group_settings_online_booking",e.ACCOUNT_HINT_VIDEO_ATTACH_SHORT_VIDEO="video:attach_short_video",e.ACCOUNT_HINT_STORIES_EDITOR_TEXT_CREATING_WEB="stories:editor_text_creating_web",e.ACCOUNT_HINT_VIDEO_SMART_CROP="video:smart_crop",e.ACCOUNT_HINT_GROUP_SETTINGS_MONETIZATION_ADBLOGGER="group_settings:monetization_adblogger",e.ACCOUNT_HINT_CLIPS_VIDEO_TO_CLIPS_APP_ENTRYPOINT_WEB="clips:video_to_clips_app_entrypoint_web",e.ACCOUNT_HINT_PRIVACY_FOLLOWERS_MODE_MODAL_PIC="privacy:followers_mode_modal_pic",e.ACCOUNT_HINT_FEED_POSTING_NEXT_BUTTON_WEB="feed:posting_next_button_web",e.ACCOUNT_HINT_FEED_POSTING_NEXT_BUTTON_MVK="feed:posting_next_button_mvk",e.ACCOUNT_HINT_FEED_POSTING_PHOTO_WITH_MARKET_ON_GRID_WEB="feed:posting_photo_with_market_on_grid_web",e.ACCOUNT_HINT_VIDEO_GROUP_OWNER_SJM_MONETIZATION_BANNER_ONBOARDING="video:group_owner_cjm_monetization_banner_onboarding",e.ACCOUNT_HINT_VIDEO_GROUP_OWNER_CJM_GROUPS_ONBOARDING_CTA="video:group_owner_cjm_groups_onboarding_cta",e.ACCOUNT_HINT_FEED_POSTING_CROP_ZOOM_WEB="feed:posting_crop_zoom_web",e.ACCOUNT_HINT_FEED_POSTING_CROP_ZOOM_MVK="feed:posting_crop_zoom_mvk",e.ACCOUNT_HINT_STORIES_CREATOR_FEED_WEB="stories:creator_feed_web",e.ACCOUNT_HINT_STORIES_CREATOR_CHANGE_AUTHOR_WEB="stories:creator_change_author_web",e.ACCOUNT_HINT_STORIES_CREATOR_FEED_MVK="stories:creator_feed_mvk"}(a||(a={}))},746573:(e,t,s)=>{"use strict";s.d(t,{getEffectorServiceDomain:()=>r});var a=s(32489),n=s(418562);const r=e=>{const t=e?.name||(0,n.default)();return e?.domain?e.domain.createDomain(t):(0,a.createDomain)(t)}},538522:(e,t,s)=>{"use strict";s.d(t,{joinFullId:()=>a,joinRawId:()=>n});const a=(e,t)=>`${e}_${t}`,n=({ownerId:e,itemId:t,externalId:s})=>[e,t,s].filter(Boolean).join("_")},70148:(e,t,s)=>{"use strict";s.d(t,{OwnedIdentity:()=>r});var a=s(768035),n=s(873900);class r{static fromRawId(e){const t=(0,a.parseRawId)(e);return new r(t)}get rawId(){return(0,n.getIdentityRawId)(this)}get accessRawId(){return(0,n.getIdentityAccessRawId)(this)}get fullId(){return this.rawId}constructor(e){this.id=e.id,this.ownerId=e.ownerId,this.accessKey=e.accessKey}}},843161:(e,t,s)=>{"use strict";s.d(t,{SingleIdentity:()=>a});class a{get fullId(){return this.id}constructor(e){this.id=e.id}}},391751:(e,t,s)=>{"use strict";function a(...e){if(e.length<2)return!0;const t=e[0].fullId;return e.every((e=>e.fullId===t))}s.d(t,{compareIdentities:()=>a})},873900:(e,t,s)=>{"use strict";function a({id:e,ownerId:t}){return`${t}_${e}`}function n(e){const{accessKey:t}=e,s=a(e);return t?`${s}_${t}`:s}s.d(t,{getIdentityAccessRawId:()=>n,getIdentityRawId:()=>a})},768035:(e,t,s)=>{"use strict";s.d(t,{parseRawId:()=>n});var a=s(8520);function n(e){const t=e.split("_"),s=t[0]&&parseInt(t[0],10),n=t[1]&&parseInt(t[1],10);if(!(0,a.isNumber)(n)||!(0,a.isNumber)(s))throw new Error(`Invalid rawId: ${e}`);return{id:n,ownerId:s,accessKey:t[2]}}},33305:(e,t,s)=>{"use strict";s.d(t,{getOwnerFullName:()=>_,getOwnerHref:()=>d,getOwnerShortName:()=>l,isOwnerGroup:()=>r,isOwnerUser:()=>n});var a=s(74605);const n=e=>!!e&&"first_name"in e,r=e=>!!e&&"name"in e;function d(e,t=!1){let s="/";return e&&(r(e)?s+=e.screen_name||`club${e.id}`:s+=e.screen_name||e.domain||`id${e.id}`),t?window.location.origin+s:s}function _(e){let t="";return e?(e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim()}`),e.maiden_name&&e.sex===a.BaseSexEnumNames.FEMALE&&(t+=` (${e.maiden_name.trim()})`),t):t}function l(e){let t="";return e.first_name&&(t+=e.first_name.trim()),e.last_name&&(t+=` ${e.last_name.trim().slice(0,1)}.`),t}},926505:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Embedded:()=>a});var a=function(){function e(e){var t=this;this.receiver=!1,this._requestId=1,this._requests={},this._onMessage=function(e){if(e.origin===t.origin&&e.data&&e.data.embeddedName===t.name){t.target=e.source;var s=e.data,a=s.response;if(a){var n=t._requests[a];n&&n(s.data),t._requests[a]=null}else s.request&&s.action&&Promise.resolve(t.onMessage(s.action,s.data)).then((function(e){t._sendResponse(s.request,s.action,e)}))}},this.name=e.name,this.target=e.target,this.origin=e.origin||"https://"+e.host,this.receiver=e.receiver||!1,this.onMessage=e.onMessage,window.addEventListener("message",this._onMessage,!1)}return e.prototype._sendResponse=function(e,t,s){this.target&&this.target.postMessage({embeddedName:this.name,action:t,response:e,data:s},this.origin)},e.prototype.sendMessage=function(e,t){var s=this;if(void 0===t&&(t={}),!this.target)return Promise.reject();var a=this._requestId,n=new Promise((function(e){s._requestId++,s._requests[a]=e}));return this.target.postMessage({embeddedName:this.name,action:e,data:t,request:a},this.origin),n},e.prototype.destroy=function(){window.removeEventListener("message",this._onMessage,!1),this.target=void 0},e}()},490363:(e,t,s)=>{"use strict";s.d(t,{Icon20ListPlusOutline:()=>a});var a=(0,s(844990).makeIcon)("Icon20ListPlusOutline","list_plus_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="list_plus_outline_20"><path fill-rule="evenodd" d="M2 4.75A.75.75 0 0 1 2.75 4h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.75m0 5A.75.75 0 0 1 2.75 9h8.5a.75.75 0 0 1 0 1.5h-8.5A.75.75 0 0 1 2 9.75M15.5 11a.75.75 0 0 1 .75.75V14h2.25a.75.75 0 0 1 0 1.5h-2.25v2.25a.75.75 0 0 1-1.5 0V15.5H12.5a.75.75 0 0 1 0-1.5h2.25v-2.25a.75.75 0 0 1 .75-.75M2 14.75a.75.75 0 0 1 .75-.75H8a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1-.75-.75" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},203788:(e,t,s)=>{"use strict";s.d(t,{Icon20PodcastOutline:()=>a});var a=(0,s(844990).makeIcon)("Icon20PodcastOutline","podcast_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" id="podcast_outline_20"><g fill="none" fill-rule="evenodd"><path d="M0 0h20v20H0z" opacity=".4" /><path fill="currentColor" fill-rule="nonzero" d="M10 5a4 4 0 0 1 4 4v3c0 1.953-1.4 3.578-3.25 3.93v1.32a.75.75 0 1 1-1.5 0v-1.32A4 4 0 0 1 6 12V9a4 4 0 0 1 4-4m0 1.5A2.5 2.5 0 0 0 7.5 9v3a2.5 2.5 0 0 0 4.502 1.498l-.13.002H10.45a.75.75 0 1 1 0-1.5h2.05v-1.5h-2.05a.75.75 0 1 1 0-1.5h2.05A2.5 2.5 0 0 0 10 6.5M10 2a7 7 0 0 1 6.938 6.065A1.5 1.5 0 0 1 18 9.5v3a1.5 1.5 0 0 1-3 0v-3c0-.428.18-.815.468-1.088a5.5 5.5 0 0 0-5.247-4.908L10 3.5a5.5 5.5 0 0 0-5.469 4.912c.29.273.469.66.469 1.088v3a1.5 1.5 0 0 1-3 0v-3a1.5 1.5 0 0 1 1.062-1.435A7 7 0 0 1 10 2" /></g></symbol>',20,20,!1,void 0)},223173:(e,t,s)=>{"use strict";s.d(t,{Icon20ShareOutline:()=>a});var a=(0,s(844990).makeIcon)("Icon20ShareOutline","share_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="share_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M9.764 4.753a.25.25 0 0 1 .402-.198l6.742 5.247a.25.25 0 0 1 0 .395l-6.747 5.25a.25.25 0 0 1-.402-.198v-3.136a.75.75 0 0 0-.75-.75c-2.456 0-4.342.913-5.832 2.197.266-1.454.824-2.577 1.57-3.426 1.066-1.212 2.58-1.941 4.385-2.228a.75.75 0 0 0 .632-.741zm1.324-1.381c-1.15-.895-2.824-.075-2.824 1.38v1.791c-1.81.394-3.434 1.225-4.643 2.6-1.352 1.538-2.117 3.68-2.117 6.445a.75.75 0 0 0 1.329.477c1.362-1.655 3.059-2.942 5.426-3.167v2.35c0 1.456 1.674 2.277 2.823 1.382l6.747-5.25c.9-.7.9-2.061 0-2.762z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},136017:(e,t,s)=>{"use strict";s.d(t,{Icon20ThumbsDown:()=>a});var a=(0,s(844990).makeIcon)("Icon20ThumbsDown","thumbs_down_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="thumbs_down_20"><path fill-rule="evenodd" d="m14.725 12.63-1.944 4.52a2.232 2.232 0 0 1-4.283-.883v-2.326a.285.285 0 0 0-.285-.285H4.498c-2.105 0-3.556-2.111-2.8-4.076l2.076-5.4A3.4 3.4 0 0 1 6.947 2h4.849a3.2 3.2 0 0 1 3.2 3.2v6.114c0 .453-.092.9-.271 1.316M16.745 2a.75.75 0 0 0-.75.75v8.5a.75.75 0 0 0 1.5 0v-8.5a.75.75 0 0 0-.75-.75" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},715782:(e,t,s)=>{"use strict";s.d(t,{Icon20ThumbsDownOutline:()=>a});var a=(0,s(844990).makeIcon)("Icon20ThumbsDownOutline","thumbs_down_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="thumbs_down_outline_20"><path fill-rule="evenodd" d="M10.762 18.503c.898 0 1.711-.532 2.07-1.355l1.77-4.057c.058-.134.097-.224.132-.317.152-.4.24-.823.261-1.251.005-.1.005-.198.005-.345v-4.46c0-.673 0-1.223-.037-1.671-.037-.463-.118-.882-.317-1.272a3.25 3.25 0 0 0-1.42-1.42c-.391-.2-.81-.28-1.273-.318C11.506 2 10.955 2 10.282 2h-2.47c-.829 0-1.433 0-1.974.197a3.25 3.25 0 0 0-1.254.826c-.395.42-.633.975-.96 1.736l-.994 2.32c-.387.902-.698 1.626-.89 2.218-.196.6-.306 1.166-.2 1.726a3.25 3.25 0 0 0 1.378 2.09c.473.319 1.036.441 1.665.498.62.057 1.408.057 2.389.057h1.531v2.578a2.26 2.26 0 0 0 2.26 2.258Zm.695-1.955a.759.759 0 0 1-1.454-.303V13.2c0-.571-.463-1.034-1.034-1.034h-1.96c-1.027 0-1.747-.001-2.29-.05-.543-.05-.803-.141-.963-.249a1.75 1.75 0 0 1-.742-1.125c-.036-.19-.017-.465.152-.983.169-.52.452-1.18.857-2.125l.93-2.167c.399-.93.534-1.215.724-1.417a1.75 1.75 0 0 1 .675-.445c.26-.095.576-.106 1.587-.106h2.311c.713 0 1.202 0 1.581.032.37.03.57.085.713.159.33.168.598.435.765.765.074.144.13.343.16.713.03.38.031.869.031 1.581v4.411c0 .17 0 .23-.003.29-.013.27-.069.537-.165.79-.02.055-.045.11-.113.267l-1.761 4.04ZM16.75 2a.75.75 0 0 0-.75.75v8.5a.75.75 0 0 0 1.5 0v-8.5a.75.75 0 0 0-.75-.75" /></symbol>',20,20,!1,void 0)},684540:(e,t,s)=>{"use strict";s.d(t,{Icon20VinylOutline:()=>a});var a=(0,s(844990).makeIcon)("Icon20VinylOutline","vinyl_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="vinyl_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M10 7.5a2.5 2.5 0 0 0-1.768.732A2.5 2.5 0 0 0 7.5 10c0 .69.28 1.315.732 1.768A2.5 2.5 0 0 0 10 12.5a2.5 2.5 0 0 0 1.768-.732A2.5 2.5 0 0 0 12.5 10a2.5 2.5 0 0 0-.732-1.768A2.5 2.5 0 0 0 10 7.5m-.707 1.793A1 1 0 0 1 10 9a1 1 0 0 1 .707.293A1 1 0 0 1 11 10a1 1 0 0 1-.293.707A1 1 0 0 1 10 11a1 1 0 0 1-.707-.293A1 1 0 0 1 9 10a1 1 0 0 1 .293-.707" clip-rule="evenodd" /><path fill="currentColor" d="M10.21 6.006a4 4 0 0 0-4.205 4.2.75.75 0 0 1-.71.787.75.75 0 0 1-.788-.71 5.5 5.5 0 0 1 5.78-5.775.75.75 0 0 1-.078 1.497m5.283 3.712a.75.75 0 0 0-1.498.077 4 4 0 0 1-4.204 4.2.75.75 0 0 0-.079 1.498 5.5 5.5 0 0 0 4.175-1.602 5.5 5.5 0 0 0 1.606-4.173" /><path fill="currentColor" fill-rule="evenodd" d="M10 1.5a8.47 8.47 0 0 0-6.01 2.49C2.45 5.528 1.5 7.653 1.5 10s.951 4.472 2.49 6.01C5.528 17.55 7.653 18.5 10 18.5s4.472-.951 6.01-2.49c1.539-1.538 2.49-3.663 2.49-6.01s-.951-4.472-2.49-6.01A8.47 8.47 0 0 0 10 1.5M5.05 5.05A6.97 6.97 0 0 1 10 3c1.933 0 3.681.782 4.95 2.05A6.97 6.97 0 0 1 17 10a6.97 6.97 0 0 1-2.05 4.95A6.97 6.97 0 0 1 10 17a6.97 6.97 0 0 1-4.95-2.05A6.97 6.97 0 0 1 3 10c0-1.933.782-3.681 2.05-4.95" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},126645:function(e){e.exports=function(){"use strict";var e=function(){return e=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},e.apply(this,arguments)},t=1,s=7,a=96*t,n=96*t,r=25,d=function(e,t,a,n,d){if(e<s&&t<s)return!1;if(e>=a-s&&t<s)return!1;if(e<s&&t>=a-s)return!1;if(d){var _=s+2;a<=r&&_--;var l=(a-2*s-_)/2-1;return a<=r&&l++,!(e>s+l&&e<a-s-l-1&&t>s+l&&t<a-s-l-1)&&0<=e&&e<a&&0<=t&&t<a&&n[t][e]}return n[t]&&n[t][e]},_=function(e,t,s,a,n){return void 0===n&&(n=!0),{l:d(e-1,t,s,a,n),r:d(e+1,t,s,a,n),t:d(e,t-1,s,a,n),b:d(e,t+1,s,a,n),current:d(e,t,s,a,n)}},l=function(e,n){if("number"!=typeof n.qrSize)throw new Error("Size should be a number");if("string"!=typeof n.className)throw new Error("Classname should be a string");for(var l=2*t,u=12.7*t,c=12.8*t,p=14.7*t,m=14.8*t,y=15.9*t,g=28.6*t,f=30.5*t,E=84.7776815*t,A=87.3*t,P=71.4*t,b=42.9*t,I=87.2*t,T=85.2*t,C=85.3*t,O=69.5*t,M=98*t,S=100*t,D=[],k=0,L=0,R=0,B=0,x=0;x<e.size;x++){k=0;for(var F=0;F<e.size;F++){R=F+k,k+=a,B=x+L;var U=_(F,x,e.size,e.modules,n.isShowLogo),N="",W="";U.current?(W=!(W=W||U.l||U.r||U.t||U.b?"":"empty")&&U.l&&U.r||U.t&&U.b?"rect":"")||(W+=U.l?"l":U.r?"r":"",(W+=U.t?"t":U.b?"b":"")||(W="empty")):W=!(W=!(W=!(W=!W&&U.l&&U.t&&d(F-1,x-1,e.size,e.modules,n.isShowLogo)?"n_lt":"")&&U.l&&U.b&&d(F-1,x+1,e.size,e.modules,n.isShowLogo)?"n_lb":"")&&U.r&&U.t&&d(F+1,x-1,e.size,e.modules,n.isShowLogo)?"n_rt":"")&&U.r&&U.b&&d(F+1,x+1,e.size,e.modules,n.isShowLogo)?"n_rb":"",W&&(N='<use xlink:href="#'+W+"-"+n.suffix+'"/>',D.push('<g transform="translate('+R+","+B+')">'+N+"</g>"))}L+=a}var V="",K=(e.size-3*s)/2*a+a*s-10;e.size<=r&&(V="scale(0.85)",K+=50);var H=(e.size-s)*n.incTileSize;D.push('<use fill-rule="evenodd" transform="translate(0,0)" xlink:href="#point-'+n.suffix+'"/>'),D.push('<use fill-rule="evenodd" transform="translate('+H+',0)" xlink:href="#point-'+n.suffix+'"/>'),D.push('<use fill-rule="evenodd" transform="translate(0,'+H+')" xlink:href="#point-'+n.suffix+'"/>'),n.isShowLogo&&(n.logoData?D.push('\n        <image\n          preserveAspectRatio="xMidYMid slice" clip-path="url(#logo-mask-'+n.suffix+')"\n          style="width: 750px; height: 750px;" width="750" height="750"\n          transform="translate('+K+","+K+") "+V+'"\n          xlink:href="'+n.logoData+'"\n        />\n      '):D.push('\n        <use style="width: 750px; height: 750px;" width="750" height="750"\n          fill="none"\n          fill-rule="evenodd"\n          transform="translate('+K+","+K+") "+V+'" xlink:href="#vk_logo-'+n.suffix+'"\n        />\n      '));var j=99*e.size,$="",G="translate(0,0)";if(n.isShowBackground){var q=(n.qrSize-40)/n.qrSize,Y=j/n.qrSize*21;$='\n      <rect\n        x="0"\n        width="'+j+'"\n        height="'+j+'"\n        rx="'+Math.ceil(j/(n.qrSize/36))+'"\n        fill="'+n.backgroundColor+'"\n      />',G="translate("+Y+", "+Y+") scale("+q+")"}var z="M0,0 L66,0 C"+E+",-3.44940413e-15 "+S+",15.2223185 "+S+",34 L"+S+",66 C"+S+","+E+" "+E+","+S+" 66,"+S+" L0,"+S+" L0,0 Z",X="M0,0 L"+S+",0 L"+S+",66 C"+S+","+E+" "+E+","+S+" 66,"+S+" L0,"+S+" L0,0 Z";return'\n  <svg\n    version="1.1"\n    viewBox="0 0 '+j+" "+j+'"\n    width="'+n.qrSize+'px"\n    height="'+n.qrSize+'px"\n    '+(n.className?'class="'+n.className+'"':"")+'\n    xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n  >\n    <defs>\n      <rect id="rect-'+n.suffix+'" width="100" height="100" fill="'+n.foregroundColor+'"/>\n      <path\n        id="empty-'+n.suffix+'"\n        d="M0,'+g+"v"+b+"C0,"+A+","+c+","+S+","+g+","+S+"h"+b+"c"+y+",0,"+g+"-"+c+","+g+"-"+g+"V"+g+"C"+S+","+u+","+I+",0,"+P+",0H"+g+" C"+c+",0,0,"+c+",0,"+g+'z"\n        fill="'+n.foregroundColor+'"\n      />\n      <path id="b-'+n.suffix+'" d="'+z+'" transform="rotate(-90 50 50)" fill="'+n.foregroundColor+'"/>\n      <path id="r-'+n.suffix+'" d="'+z+'" transform="rotate(-180 50 50)" fill="'+n.foregroundColor+'"/>\n      <path id="l-'+n.suffix+'" d="'+z+'" fill="'+n.foregroundColor+'"/>\n      <path id="t-'+n.suffix+'" d="'+z+'" transform="rotate(90 50 50)" fill="'+n.foregroundColor+'"/>\n      <path id="l-'+n.suffix+'" d="'+X+'" transform="rotate(-90 50 50)" fill="'+n.foregroundColor+'"/>\n      <path id="lt-'+n.suffix+'" d="'+X+'" fill="'+n.foregroundColor+'"/>\n      <path id="lb-'+n.suffix+'" d="'+X+'" transform="rotate(-90 50 50)" fill="'+n.foregroundColor+'"/>\n      <path id="rb-'+n.suffix+'" d="'+X+'" transform="rotate(-180 50 50)" fill="'+n.foregroundColor+'"/>\n      <path id="rt-'+n.suffix+'" d="'+X+'" transform="rotate(90 50 50)" fill="'+n.foregroundColor+'"/>\n      <path\n        id="n_lt-'+n.suffix+'"\n        d="M'+f+","+l+"V0H0v"+f+"h"+l+"C"+l+","+p+","+m+","+l+","+f+","+l+'z"\n        fill="'+n.foregroundColor+'"\n      />\n      <path\n        id="n_lb-'+n.suffix+'"\n        d="M'+l+","+O+"H0V"+S+"h"+f+"v-"+l+"C"+p+","+M+","+l+","+T+","+l+","+O+'z"\n        fill="'+n.foregroundColor+'"\n      />\n      <path\n        id="n_rt-'+n.suffix+'"\n        d="M'+M+","+f+"h"+l+"V0H"+O+"v"+l+"C"+C+","+l+","+M+","+m+","+M+","+f+'z"\n        fill="'+n.foregroundColor+'"\n      />\n      <path id="n_rb-'+n.suffix+'"\n        d="M'+O+","+M+"v"+l+"H"+S+"V"+O+"h-"+l+"C"+M+","+C+","+T+","+M+","+O+","+M+'z"\n        fill="'+n.foregroundColor+'"\n      />\n      <path\n        id="point-'+n.suffix+'"\n        fill="'+n.foregroundColor+'"\n        d="M600.001786,457.329333 L600.001786,242.658167 C600.001786,147.372368 587.039517,124.122784 581.464617,118.535383 C575.877216,112.960483 552.627632,99.9982143 457.329333,99.9982143 L242.670667,99.9982143 C147.372368,99.9982143 124.122784,112.960483 118.547883,118.535383 C112.972983,124.122784 99.9982143,147.372368 99.9982143,242.658167 L99.9982143,457.329333 C99.9982143,552.627632 112.972983,575.877216 118.547883,581.464617 C124.122784,587.027017 147.372368,600.001786 242.670667,600.001786 L457.329333,600.001786 C552.627632,600.001786 575.877216,587.027017 581.464617,581.464617 C587.039517,575.877216 600.001786,552.627632 600.001786,457.329333 Z M457.329333,0 C653.338333,0 700,46.6616668 700,242.658167 C700,438.667167 700,261.332833 700,457.329333 C700,653.338333 653.338333,700 457.329333,700 C261.332833,700 438.667167,700 242.670667,700 C46.6616668,700 0,653.338333 0,457.329333 C0,261.332833 0,352.118712 0,242.658167 C0,46.6616668 46.6616668,0 242.670667,0 C438.667167,0 261.332833,0 457.329333,0 Z M395.996667,200 C480.004166,200 500,220.008332 500,303.990835 C500,387.998334 500,312.001666 500,395.996667 C500,479.991668 480.004166,500 395.996667,500 C312.001666,500 387.998334,500 304.003333,500 C220.008332,500 200,479.991668 200,395.996667 C200,312.001666 200,350.906061 200,303.990835 C200,220.008332 220.008332,200 304.003333,200 C387.998334,200 312.001666,200 395.996667,200 Z"\n      />\n      <g id="vk_logo-'+n.suffix+'">\n        <path\n          fill="'+n.logoColor+'"\n          d="M83.3334 363.333C83.3334 231.34 83.3334 165.343 124.338 124.338C165.343 83.3333 231.34              83.3333 363.333 83.3333H386.667C518.66 83.3333 584.657 83.3333 625.662 124.338C666.667 165.343              666.667 231.34 666.667 363.333V386.667C666.667 518.66 666.667 584.657 625.662 625.662C584.657              666.667 518.66 666.667 386.667 666.667H363.333C231.34 666.667 165.343 666.667 124.338 625.662C83.3334              584.657 83.3334 518.66 83.3334 386.667V363.333Z"\n        />\n        <path\n          fill="#FFF"\n          d="M394.907 508.681C263.293 508.681 183.442 417.365 180.313 265.625H246.972C249.05 377.09              299.763 424.323 338.638 434.036V265.625H402.519V361.82C440.016 357.664 479.264 313.909              492.456 265.625H555.333C545.27 325 502.543 368.754 472.353 386.803C502.566 401.395 551.177              439.593 569.926 508.681H500.815C486.222 462.498 450.476 426.728 402.542 421.872V508.681H394.907Z"\n        />\n      </g>\n      <clipPath id="logo-mask-'+n.suffix+'">\n        <rect x="0" y="0" width="750" height="750" />\n      </clipPath>\n    </defs>\n\n    '+$+'\n\n    <g transform="'+G+'">\n      '+D.join("\n")+"\n    </g>\n  </svg>"},u=function(){function e(t,s,a,n){if(this.version=t,this.errorCorrectionLevel=s,this.mask=n,this.modules=[],this.isFunction=[],t<e.MIN_VERSION||t>e.MAX_VERSION)throw"Version value out of range";if(n<-1||n>7)throw"Mask value out of range";this.size=4*t+17;for(var r=[],d=0;d<this.size;d++)r.push(!1);for(d=0;d<this.size;d++)this.modules.push(r.slice()),this.isFunction.push(r.slice());this.drawFunctionPatterns();var _=this.addEccAndInterleave(a);if(this.drawCodewords(_),-1==n){var l=1e9;for(d=0;d<8;d++){this.applyMask(d),this.drawFormatBits(d);var u=this.getPenaltyScore();u<l&&(n=d,l=u),this.applyMask(d)}}if(n<0||n>7)throw"Assertion error";this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}return e.encodeText=function(t,s){var a=p.makeSegments(t);return e.encodeSegments(a,s)},e.encodeBinary=function(t,s){var a=p.makeBytes(t);return e.encodeSegments([a],s)},e.encodeSegments=function(t,s,a,n,r,d){if(void 0===a&&(a=1),void 0===n&&(n=40),void 0===r&&(r=-1),void 0===d&&(d=!0),!(e.MIN_VERSION<=a&&a<=n&&n<=e.MAX_VERSION)||r<-1||r>7)throw"Invalid value";var _,l;for(_=a;;_++){var u=8*e.getNumDataCodewords(_,s),c=p.getTotalBits(t,_);if(c<=u){l=c;break}if(_>=n)throw"Data too long"}for(var m=0,g=[e.Ecc.MEDIUM,e.Ecc.QUARTILE,e.Ecc.HIGH];m<g.length;m++){var f=g[m];d&&l<=8*e.getNumDataCodewords(_,f)&&(s=f)}for(var E=new y,A=0,P=t;A<P.length;A++){var b=P[A];E.appendBits(b.mode.modeBits,4),E.appendBits(b.numChars,b.mode.numCharCountBits(_));for(var I=0,T=b.getData();I<T.length;I++){var C=T[I];E.array.push(C)}}if(E.array.length!=l)throw"Assertion error";var O=8*e.getNumDataCodewords(_,s);if(E.array.length>O)throw"Assertion error";if(E.appendBits(0,Math.min(4,O-E.array.length)),E.appendBits(0,(8-E.array.length%8)%8),E.array.length%8!=0)throw"Assertion error";for(var M=236;E.array.length<O;M^=253)E.appendBits(M,8);for(var S=[];8*S.length<E.array.length;)S.push(0);return E.array.forEach((function(e,t){return S[t>>>3]|=e<<7-(7&t)})),new e(_,s,S,r)},e.prototype.getModule=function(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]},e.prototype.drawCanvas=function(e,t,s){if(e<=0||t<0)throw"Value out of range";var a=(this.size+2*t)*e;s.width=a,s.height=a;for(var n=s.getContext("2d"),r=-t;r<this.size+t;r++)for(var d=-t;d<this.size+t;d++)n.fillStyle=this.getModule(d,r)?"#000000":"#FFFFFF",n.fillRect((d+t)*e,(r+t)*e,e,e)},e.prototype.toSvgString=function(e){if(e<0)throw"Border must be non-negative";for(var t=[],s=0;s<this.size;s++)for(var a=0;a<this.size;a++)this.getModule(a,s)&&t.push("M"+(a+e)+","+(s+e)+"h1v1h-1z");return'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '+(this.size+2*e)+" "+(this.size+2*e)+'" stroke="none">\n\t<rect width="100%" height="100%" fill="#FFFFFF"/>\n\t<path d="'+t.join(" ")+'" fill="#000000"/>\n</svg>\n'},e.prototype.drawFunctionPatterns=function(){for(var e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);var t=this.getAlignmentPatternPositions(),s=t.length;for(e=0;e<s;e++)for(var a=0;a<s;a++)0==e&&0==a||0==e&&a==s-1||e==s-1&&0==a||this.drawAlignmentPattern(t[e],t[a]);this.drawFormatBits(0),this.drawVersion()},e.prototype.drawFormatBits=function(e){for(var t=this.errorCorrectionLevel.formatBits<<3|e,s=t,a=0;a<10;a++)s=s<<1^1335*(s>>>9);var n=21522^(t<<10|s);if(n>>>15!=0)throw"Assertion error";for(a=0;a<=5;a++)this.setFunctionModule(8,a,c(n,a));for(this.setFunctionModule(8,7,c(n,6)),this.setFunctionModule(8,8,c(n,7)),this.setFunctionModule(7,8,c(n,8)),a=9;a<15;a++)this.setFunctionModule(14-a,8,c(n,a));for(a=0;a<8;a++)this.setFunctionModule(this.size-1-a,8,c(n,a));for(a=8;a<15;a++)this.setFunctionModule(8,this.size-15+a,c(n,a));this.setFunctionModule(8,this.size-8,!0)},e.prototype.drawVersion=function(){if(!(this.version<7)){for(var e=this.version,t=0;t<12;t++)e=e<<1^7973*(e>>>11);var s=this.version<<12|e;if(s>>>18!=0)throw"Assertion error";for(t=0;t<18;t++){var a=c(s,t),n=this.size-11+t%3,r=Math.floor(t/3);this.setFunctionModule(n,r,a),this.setFunctionModule(r,n,a)}}},e.prototype.drawFinderPattern=function(e,t){for(var s=-4;s<=4;s++)for(var a=-4;a<=4;a++){var n=Math.max(Math.abs(a),Math.abs(s)),r=e+a,d=t+s;0<=r&&r<this.size&&0<=d&&d<this.size&&this.setFunctionModule(r,d,2!=n&&4!=n)}},e.prototype.drawAlignmentPattern=function(e,t){for(var s=-2;s<=2;s++)for(var a=-2;a<=2;a++)this.setFunctionModule(e+a,t+s,1!=Math.max(Math.abs(a),Math.abs(s)))},e.prototype.setFunctionModule=function(e,t,s){this.modules[t][e]=s,this.isFunction[t][e]=!0},e.prototype.addEccAndInterleave=function(t){var s=this.version,a=this.errorCorrectionLevel;if(t.length!=e.getNumDataCodewords(s,a))throw"Invalid argument";for(var n=e.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][s],r=e.ECC_CODEWORDS_PER_BLOCK[a.ordinal][s],d=Math.floor(e.getNumRawDataModules(s)/8),_=n-d%n,l=Math.floor(d/n),u=[],c=new m(r),p=0,y=0;p<n;p++){var g=t.slice(y,y+l-r+(p<_?0:1));y+=g.length;var f=c.getRemainder(g);p<_&&g.push(0),u.push(g.concat(f))}var E=[];for(p=0;p<u[0].length;p++)for(var A=0;A<u.length;A++)(p!=l-r||A>=_)&&E.push(u[A][p]);if(E.length!=d)throw"Assertion error";return E},e.prototype.drawCodewords=function(t){if(t.length!=Math.floor(e.getNumRawDataModules(this.version)/8))throw"Invalid argument";for(var s=0,a=this.size-1;a>=1;a-=2){6==a&&(a=5);for(var n=0;n<this.size;n++)for(var r=0;r<2;r++){var d=a-r,_=a+1&2?n:this.size-1-n;!this.isFunction[_][d]&&s<8*t.length&&(this.modules[_][d]=c(t[s>>>3],7-(7&s)),s++)}}if(s!=8*t.length)throw"Assertion error"},e.prototype.applyMask=function(e){if(e<0||e>7)throw"Mask value out of range";for(var t=0;t<this.size;t++)for(var s=0;s<this.size;s++){var a=void 0;switch(e){case 0:a=(s+t)%2==0;break;case 1:a=t%2==0;break;case 2:a=s%3==0;break;case 3:a=(s+t)%3==0;break;case 4:a=(Math.floor(s/3)+Math.floor(t/2))%2==0;break;case 5:a=s*t%2+s*t%3==0;break;case 6:a=(s*t%2+s*t%3)%2==0;break;case 7:a=((s+t)%2+s*t%3)%2==0;break;default:throw"Assertion error"}!this.isFunction[t][s]&&a&&(this.modules[t][s]=!this.modules[t][s])}},e.prototype.getPenaltyScore=function(){for(var t=0,s=0;s<this.size;s++){for(var a=[0,0,0,0,0,0,0],n=!1,r=0,d=0;d<this.size;d++)this.modules[s][d]==n?5==++r?t+=e.PENALTY_N1:r>5&&t++:(e.addRunToHistory(r,a),!n&&e.hasFinderLikePattern(a)&&(t+=e.PENALTY_N3),n=this.modules[s][d],r=1);e.addRunToHistory(r,a),n&&e.addRunToHistory(0,a),e.hasFinderLikePattern(a)&&(t+=e.PENALTY_N3)}for(d=0;d<this.size;d++){a=[0,0,0,0,0,0,0],n=!1;var _=0;for(s=0;s<this.size;s++)this.modules[s][d]==n?5==++_?t+=e.PENALTY_N1:_>5&&t++:(e.addRunToHistory(_,a),!n&&e.hasFinderLikePattern(a)&&(t+=e.PENALTY_N3),n=this.modules[s][d],_=1);e.addRunToHistory(_,a),n&&e.addRunToHistory(0,a),e.hasFinderLikePattern(a)&&(t+=e.PENALTY_N3)}for(s=0;s<this.size-1;s++)for(d=0;d<this.size-1;d++)(n=this.modules[s][d])==this.modules[s][d+1]&&n==this.modules[s+1][d]&&n==this.modules[s+1][d+1]&&(t+=e.PENALTY_N2);for(var l=0,u=0,c=this.modules;u<c.length;u++)for(var p=0,m=c[u];p<m.length;p++)(n=m[p])&&l++;var y=this.size*this.size;return t+=(Math.ceil(Math.abs(20*l-10*y)/y)-1)*e.PENALTY_N4},e.prototype.getAlignmentPatternPositions=function(){if(1==this.version)return[];for(var e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((this.size-13)/(2*e-2)),s=[6],a=this.size-7;s.length<e;a-=t)s.splice(1,0,a);return s},e.getNumRawDataModules=function(t){if(t<e.MIN_VERSION||t>e.MAX_VERSION)throw"Version number out of range";var s=(16*t+128)*t+64;if(t>=2){var a=Math.floor(t/7)+2;s-=(25*a-10)*a-55,t>=7&&(s-=36)}return s},e.getNumDataCodewords=function(t,s){return Math.floor(e.getNumRawDataModules(t)/8)-e.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t]*e.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t]},e.addRunToHistory=function(e,t){t.pop(),t.unshift(e)},e.hasFinderLikePattern=function(e){var t=e[1];return t>0&&e[2]==t&&e[4]==t&&e[5]==t&&e[3]==3*t&&Math.max(e[0],e[6])>=4*t},e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e}();function c(e,t){return!!(e>>>t&1)}var p=function(){function e(e,t,s){if(this.mode=e,this.numChars=t,this.bitData=s,t<0)throw"Invalid argument";this.bitData=s.slice()}return e.makeBytes=function(t){for(var s=new y,a=0,n=t;a<n.length;a++){var r=n[a];s.appendBits(r,8)}return new e(e.Mode.BYTE,t.length,s.array)},e.makeNumeric=function(t){if(!this.NUMERIC_REGEX.test(t))throw"String contains non-numeric characters";for(var s=new y,a=0;a<t.length;){var n=Math.min(t.length-a,3);s.appendBits(parseInt(t.substr(a,n),10),3*n+1),a+=n}return new e(e.Mode.NUMERIC,t.length,s.array)},e.makeAlphanumeric=function(t){if(!this.ALPHANUMERIC_REGEX.test(t))throw"String contains unencodable characters in alphanumeric mode";var s,a=new y;for(s=0;s+2<=t.length;s+=2){var n=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s));n+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s+1)),a.appendBits(n,11)}return s<t.length&&a.appendBits(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s)),6),new e(e.Mode.ALPHANUMERIC,t.length,a.array)},e.makeSegments=function(t){return""==t?[]:this.NUMERIC_REGEX.test(t)?[e.makeNumeric(t)]:this.ALPHANUMERIC_REGEX.test(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]},e.makeEci=function(t){var s=new y;if(t<0)throw"ECI assignment value out of range";if(t<128)s.appendBits(t,8);else if(t<16384)s.appendBits(2,2),s.appendBits(t,14);else{if(!(t<1e6))throw"ECI assignment value out of range";s.appendBits(6,3),s.appendBits(t,21)}return new e(e.Mode.ECI,0,s.array)},e.prototype.getData=function(){return this.bitData.slice()},e.getTotalBits=function(e,t){for(var s=0,a=0,n=e;a<n.length;a++){var r=n[a],d=r.mode.numCharCountBits(t);if(r.numChars>=1<<d)return 1/0;s+=4+d+r.bitData.length}return s},e.toUtf8ByteArray=function(e){e=encodeURI(e);for(var t=[],s=0;s<e.length;s++)"%"!=e.charAt(s)?t.push(e.charCodeAt(s)):(t.push(parseInt(e.substr(s+1,2),16)),s+=2);return t},e.NUMERIC_REGEX=/^[0-9]*$/,e.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,e.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",e}(),m=function(){function e(t){if(this.coefficients=[],t<1||t>255)throw"Degree out of range";for(var s=this.coefficients,a=0;a<t-1;a++)s.push(0);s.push(1);var n=1;for(a=0;a<t;a++){for(var r=0;r<s.length;r++)s[r]=e.multiply(s[r],n),r+1<s.length&&(s[r]^=s[r+1]);n=e.multiply(n,2)}}return e.prototype.getRemainder=function(t){for(var s=this.coefficients.map((function(e){return 0})),a=function(t){var a=t^s.shift();s.push(0),n.coefficients.forEach((function(t,n){return s[n]^=e.multiply(t,a)}))},n=this,r=0,d=t;r<d.length;r++)a(d[r]);return s},e.multiply=function(e,t){if(e>>>8!=0||t>>>8!=0)throw"Byte out of range";for(var s=0,a=7;a>=0;a--)s=s<<1^285*(s>>>7),s^=(t>>>a&1)*e;if(s>>>8!=0)throw"Assertion error";return s},e}(),y=function(){function e(){this.array=[]}return e.prototype.appendBits=function(e,t){if(t<0||t>31||e>>>t!=0)throw"Value out of range";for(var s=t-1;s>=0;s--)this.array.push(e>>>s&1)},e}();(function(e){var t=function(){function e(e,t){this.ordinal=e,this.formatBits=t}return e.LOW=new e(0,1),e.MEDIUM=new e(1,0),e.QUARTILE=new e(2,3),e.HIGH=new e(3,2),e}();e.Ecc=t})(u||(u={})),function(e){var t=function(){function e(e,t){this.modeBits=e,this.numBitsCharCount=t}return e.prototype.numCharCountBits=function(e){return this.numBitsCharCount[Math.floor((e+7)/17)]},e.NUMERIC=new e(1,[10,12,14]),e.ALPHANUMERIC=new e(2,[9,11,13]),e.BYTE=new e(4,[8,16,16]),e.KANJI=new e(8,[8,10,12]),e.ECI=new e(7,[0,0,0]),e}();e.Mode=t}(p||(p={}));var g=128,f="#ffffff",E="#000000",A="#07f";function P(t,s,a,r){if("string"!=typeof t)throw new TypeError("Enter text for encoding");var d=e(e(e({},"object"==typeof s&&null!==s?s:{}),"object"==typeof r&&null!==r?r:{}),{qrSize:"object"==typeof s&&null!==s&&"number"==typeof s.qrSize?s.qrSize:s,className:"object"==typeof s&&null!==s&&"string"==typeof s.className?s.className:a}),_=[u.Ecc.LOW,u.Ecc.MEDIUM,u.Ecc.QUARTILE,u.Ecc.HIGH],c={qrSize:"number"==typeof d.qrSize?d.qrSize:g,className:"string"==typeof d.className?d.className:a||"",isShowLogo:!!d.isShowLogo||!1,isShowBackground:!!d.isShowBackground||!1,foregroundColor:"string"==typeof d.foregroundColor?d.foregroundColor:E,backgroundColor:"string"==typeof d.backgroundColor?d.backgroundColor:f,logoColor:"string"==typeof d.logoColor?d.logoColor:A,suffix:d.suffix?d.suffix.toString():"0",logoData:"string"==typeof d.logoData?d.logoData:null,ecc:"number"==typeof d.ecc&&_[d.ecc]?d.ecc:3,incTileSize:"number"==typeof d.incTileSize?d.incTileSize:n},m=p.makeSegments(t),y=u.encodeSegments(m,_[c.ecc],1,40,-1,!0);return l(y,c)}return{createQR:P}}()},859887:(e,t)=>{"use strict";function s(e){return navigator.clipboard?function(e){return navigator.clipboard.writeText(e).then((function(){return!0}))}(e):function(e){return new Promise((function(t,s){var a=document.createElement("textarea"),n=document.createRange();a.value=e,a.style.position="fixed",a.contentEditable="true",document.body.appendChild(a),a.focus(),a.select(),n.selectNodeContents(a);var r=window.getSelection();r&&(r.removeAllRanges(),r.addRange(n)),a.setSelectionRange(0,999999);try{document.execCommand("copy")?t(!0):s(new Error("copy failed"))}catch(e){s(e)}r&&r.removeAllRanges(),document.body.removeChild(a)}))}(e)}Object.defineProperty(t,"copyTextToClipboard",{enumerable:!0,get:function(){return s}})},551009:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a={root:"SpecialProjectHeader__root--l5iD3",singleImage:"SpecialProjectHeader__singleImage--cIeyU"}},106605:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a={root:"renderAvatarToString__root--RZJW5"}},788940:(e,t,s)=>{"use strict";var a=s(296540),n=s(19888);var r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},d=n.useSyncExternalStore,_=a.useRef,l=a.useEffect,u=a.useMemo,c=a.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,s,a,n){var p=_(null);if(null===p.current){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=u((function(){function e(e){if(!l){if(l=!0,d=e,e=a(e),void 0!==n&&m.hasValue){var t=m.value;if(n(t,e))return _=t}return _=e}if(t=_,r(d,e))return t;var s=a(e);return void 0!==n&&n(t,s)?t:(d=e,_=s)}var d,_,l=!1,u=void 0===s?null:s;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]}),[t,s,a,n]);var y=d(e,p[0],p[1]);return l((function(){m.hasValue=!0,m.value=y}),[y]),c(y),y}},69242:(e,t,s)=>{"use strict";e.exports=s(788940)},391943:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)}},913469:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},543407:(e,t,s)=>{"use strict";let a;s.d(t,{default:()=>r});const n=new Uint8Array(16);function r(){if(!a&&(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(n)}},338823:(e,t,s)=>{"use strict";s.d(t,{unsafeStringify:()=>n});s(766382);const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function n(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}},418562:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(391943),n=s(543407),r=s(338823);const d=function(e,t,s){if(a.default.randomUUID&&!t&&!e)return a.default.randomUUID();const d=(e=e||{}).random||(e.rng||n.default)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,t){s=s||0;for(let e=0;e<16;++e)t[s+e]=d[e];return t}return(0,r.unsafeStringify)(d)}},766382:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(913469);const n=function(e){return"string"==typeof e&&a.default.test(e)}},43014:(e,t,s)=>{"use strict";s.d(t,{persist:()=>_});var a=s(32489),n=new Map,r=e=>(t,s)=>e(s,t.ref),d=(0,a.createEvent)();function _(e){var{adapter:t,store:s,source:_=s,target:l=s,clock:u=_,done:c,fail:p=d,finally:m,pickup:y,context:g,key:f,keyPrefix:E="",contract:A}=e;if(!t)throw Error("Adapter is not defined");if(!_)throw Error("Store or source is not defined");if(!l)throw Error("Target is not defined");if(!f&&_.shortName===_.id)throw Error("Key or name is not defined");if(_===l&&!a.is.store(_))throw Error("Source must be different from target");void 0===e.def&&a.is.store(_)&&(e.def=_.defaultState);var P="factory"in t?t(e):t,b=f||_.shortName,I=function(e,t){var s=n.get(e);void 0===s&&(s=new Map,n.set(e,s));var r=s.get(t);return void 0!==r||(r=(0,a.createStore)(null,{serialize:"ignore"}),s.set(t,r)),r}(P.keyArea||P,E+b),T=(0,a.createNode)(),C=()=>(0,a.clearNode)(T),O=e=>({status:t="fail",params:s,result:a,error:n})=>"done"===t?{status:t,key:b,keyPrefix:E,operation:e,value:"get"===e?a:s}:{status:t,key:b,keyPrefix:E,operation:e,value:s,error:n};return(0,a.withRegion)(T,(()=>{var e,t=(0,a.createStore)({ref:void 0},{serialize:"ignore"}),s=P(E+b,(e=>D(e))),n=(0,a.attach)({source:t,effect:r(s.get)}),d=(0,a.attach)({source:t,effect:r(s.set)}),f=(0,a.createEffect)((e=A,t=>!e||void 0===t||("isData"in e?e.isData(t):e(t))?t:(()=>{throw"getErrorMessages"in e?e.getErrorMessages(t):void 0})())),T=(0,a.createEvent)(),C=T.filterMap((({status:e,key:t,keyPrefix:s,operation:a,value:n})=>"done"===e?{key:t,keyPrefix:s,operation:a,value:n}:void 0)),M=T.filterMap((({status:e,key:t,keyPrefix:s,operation:a,error:n,value:r})=>"fail"===e?{key:t,keyPrefix:s,operation:a,error:n,value:r}:void 0)),S=(0,a.createEvent)(),D=n;t.updates.watch((()=>{D=(e=>{try{return(0,a.scopeBind)(e,{safe:!0})}catch(t){return e}})(n)})),(0,a.sample)({source:_,clock:u,target:S}),(0,a.guard)({source:(0,a.sample)(I,S,((e,t)=>[t,e])),filter:([e,t])=>e!==t,target:d.prepend((([e])=>e))}),(0,a.forward)({from:[n.doneData,d],to:I}),(0,a.sample)({source:(0,a.merge)([n.doneData,I]),target:f}),(0,a.forward)({from:f.doneData,to:l}),(0,a.forward)({from:[n.finally.map(O("get")),d.finally.map(O("set")),f.fail.map(O("validate"))],to:T}),(0,a.forward)({from:M,to:p}),c&&(0,a.forward)({from:C,to:c}),m&&(0,a.forward)({from:T,to:m}),g&&t.on(g,(({ref:e},t)=>({ref:void 0===t?e:t}))),y?((0,a.forward)({from:y,to:n.prepend((()=>{}))}),t.on(y,(({ref:e},t)=>({ref:void 0===t?e:t})))):n()})),C.unsubscribe=C}d.watch((e=>console.error(e.error)))},225604:(e,t,s)=>{"use strict";s.d(t,{persist:()=>l});var a=s(43014),n=s(719888),r=s(764318);function d(e){return function(){try{return"undefined"!=typeof localStorage}catch(e){return!0}}()?(0,r.storage)({storage:()=>localStorage,sync:!0,...e}):(0,n.nil)({keyArea:"local"})}d.factory=!0;var _,l=e=>(0,a.persist)({adapter:d,..._,...e})},719888:(e,t,s)=>{"use strict";function a({keyArea:e=""}={}){var t=()=>({get(){},set(){}});return t.keyArea=e,t.noop=!0,t}s.d(t,{nil:()=>a}),a.factory=!0},764318:(e,t,s)=>{"use strict";function a({storage:e,sync:t=!1,serialize:s=JSON.stringify,deserialize:a=JSON.parse,timeout:n,def:r}){var d=(d,_)=>{var l,u,c,p=()=>c.setItem(d,s(u)),m=e=>{l=clearTimeout(l),e&&p(),"undefined"!=typeof removeEventListener&&removeEventListener("beforeunload",m)};return t&&"undefined"!=typeof addEventListener&&addEventListener("storage",(s=>{s.storageArea===e()&&(s.key===d&&_("force"===t?void 0:s.newValue),null===s.key&&_(null))})),{get(t){m();var s=void 0!==t?t:e().getItem(d);return null===s?void 0!==r?r:t:a(s)},set(t){u=t,c=e(),void 0===n?p():l||(l=setTimeout(m,n,1),"undefined"!=typeof addEventListener&&addEventListener("beforeunload",m))}}};try{d.keyArea=e()}catch(e){}return d}s.d(t,{storage:()=>a}),a.factory=!0},202732:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(280702),n=s(41917);const r=(0,a.default)(n.default,"DataView")},20180:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(280702),n=s(41917);const r=(0,a.default)(n.default,"Promise")},439857:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(280702),n=s(41917);const r=(0,a.default)(n.default,"Set")},601275:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(935917),n=s(25668),r=s(529875);function d(e){var t=-1,s=null==e?0:e.length;for(this.__data__=new a.default;++t<s;)this.add(e[t])}d.prototype.add=d.prototype.push=n.default,d.prototype.has=r.default;const _=d},93265:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var a=s(277919),n=s(591532),r=s(42),d=s(173061),_=s(144105),l=s(487681);function u(e){var t=this.__data__=new a.default(e);this.size=t.size}u.prototype.clear=n.default,u.prototype.delete=r.default,u.prototype.get=d.default,u.prototype.has=_.default,u.prototype.set=l.default;const c=u},243988:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=s(41917).default.Uint8Array},753631:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(280702),n=s(41917);const r=(0,a.default)(n.default,"WeakMap")},102634:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){for(var s=-1,a=null==e?0:e.length,n=0,r=[];++s<a;){var d=e[s];t(d,s,e)&&(r[n++]=d)}return r}},550423:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var a=s(159520),n=s(241788),r=s(292049),d=s(74616),_=s(925353),l=s(118719),u=Object.prototype.hasOwnProperty;const c=function(e,t){var s=(0,r.default)(e),c=!s&&(0,n.default)(e),p=!s&&!c&&(0,d.default)(e),m=!s&&!c&&!p&&(0,l.default)(e),y=s||c||p||m,g=y?(0,a.default)(e.length,String):[],f=g.length;for(var E in e)!t&&!u.call(e,E)||y&&("length"==E||p&&("offset"==E||"parent"==E)||m&&("buffer"==E||"byteLength"==E||"byteOffset"==E)||(0,_.default)(E,f))||g.push(E);return g}},976912:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){for(var s=-1,a=t.length,n=e.length;++s<a;)e[n+s]=t[s];return e}},463736:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){for(var s=-1,a=null==e?0:e.length;++s<a;)if(t(e[s],s,e))return!0;return!1}},652851:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(152528),n=s(166984),r=Object.prototype.hasOwnProperty;const d=function(e,t,s){var d=e[t];r.call(e,t)&&(0,n.default)(d,s)&&(void 0!==s||t in e)||(0,a.default)(e,t,s)}},152528:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(684171);const n=function(e,t,s){"__proto__"==t&&a.default?(0,a.default)(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}},833831:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(976912),n=s(292049);const r=function(e,t,s){var r=t(e);return(0,n.default)(e)?r:(0,a.default)(r,s(e))}},509789:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){return null!=e&&t in Object(e)}},974846:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(979672),n=s(753098);const r=function(e){return(0,n.default)(e)&&"[object Arguments]"==(0,a.default)(e)}},891038:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(343244),n=s(753098);const r=function e(t,s,r,d,_){return t===s||(null==t||null==s||!(0,n.default)(t)&&!(0,n.default)(s)?t!=t&&s!=s:(0,a.default)(t,s,r,d,e,_))}},343244:(e,t,s)=>{"use strict";s.d(t,{default:()=>f});var a=s(93265),n=s(608967),r=s(480402),d=s(937265),_=s(935861),l=s(292049),u=s(74616),c=s(118719),p="[object Arguments]",m="[object Array]",y="[object Object]",g=Object.prototype.hasOwnProperty;const f=function(e,t,s,f,E,A){var P=(0,l.default)(e),b=(0,l.default)(t),I=P?m:(0,_.default)(e),T=b?m:(0,_.default)(t),C=(I=I==p?y:I)==y,O=(T=T==p?y:T)==y,M=I==T;if(M&&(0,u.default)(e)){if(!(0,u.default)(t))return!1;P=!0,C=!1}if(M&&!C)return A||(A=new a.default),P||(0,c.default)(e)?(0,n.default)(e,t,s,f,E,A):(0,r.default)(e,t,I,s,f,E,A);if(!(1&s)){var S=C&&g.call(e,"__wrapped__"),D=O&&g.call(t,"__wrapped__");if(S||D){var k=S?e.value():e,L=D?t.value():t;return A||(A=new a.default),E(k,L,s,f,A)}}return!!M&&(A||(A=new a.default),(0,d.default)(e,t,s,f,E,A))}},500759:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(93265),n=s(891038);const r=function(e,t,s,r){var d=s.length,_=d,l=!r;if(null==e)return!_;for(e=Object(e);d--;){var u=s[d];if(l&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++d<_;){var c=(u=s[d])[0],p=e[c],m=u[1];if(l&&u[2]){if(void 0===p&&!(c in e))return!1}else{var y=new a.default;if(r)var g=r(p,m,c,e,t,y);if(!(void 0===g?(0,n.default)(m,p,3,r,y):g))return!1}}return!0}},289717:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(979672),n=s(5254),r=s(753098),d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d["[object Arguments]"]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d["[object Map]"]=d["[object Number]"]=d["[object Object]"]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1;const _=function(e){return(0,r.default)(e)&&(0,n.default)(e.length)&&!!d[(0,a.default)(e)]}},952141:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(544943),n=s(256474),r=s(929008),d=s(292049),_=s(792263);const l=function(e){return"function"==typeof e?e:null==e?r.default:"object"==typeof e?(0,d.default)(e)?(0,n.default)(e[0],e[1]):(0,a.default)(e):(0,_.default)(e)}},17064:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(897271),n=s(733938),r=Object.prototype.hasOwnProperty;const d=function(e){if(!(0,a.default)(e))return(0,n.default)(e);var t=[];for(var s in Object(e))r.call(e,s)&&"constructor"!=s&&t.push(s);return t}},708823:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(523149),n=s(897271),r=s(981493),d=Object.prototype.hasOwnProperty;const _=function(e){if(!(0,a.default)(e))return(0,r.default)(e);var t=(0,n.default)(e),s=[];for(var _ in e)("constructor"!=_||!t&&d.call(e,_))&&s.push(_);return s}},544943:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(500759),n=s(997960),r=s(945997);const d=function(e){var t=(0,n.default)(e);return 1==t.length&&t[0][2]?(0,r.default)(t[0][0],t[0][1]):function(s){return s===e||(0,a.default)(s,e,t)}}},256474:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var a=s(891038),n=s(877500),r=s(217511),d=s(386586),_=s(909396),l=s(945997),u=s(930901);const c=function(e,t){return(0,d.default)(e)&&(0,_.default)(t)?(0,l.default)((0,u.default)(e),t):function(s){var d=(0,n.default)(s,e);return void 0===d&&d===t?(0,r.default)(s,e):(0,a.default)(t,d,3)}}},769084:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(966318),n=s(837346),r=s(687465);const d=function(e,t,s){for(var d=-1,_=t.length,l={};++d<_;){var u=t[d],c=(0,a.default)(e,u);s(c,u)&&(0,n.default)(l,(0,r.default)(u,e),c)}return l}},82199:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(966318);const n=function(e){return function(t){return(0,a.default)(t,e)}}},837346:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(652851),n=s(687465),r=s(925353),d=s(523149),_=s(930901);const l=function(e,t,s,l){if(!(0,d.default)(e))return e;for(var u=-1,c=(t=(0,n.default)(t,e)).length,p=c-1,m=e;null!=m&&++u<c;){var y=(0,_.default)(t[u]),g=s;if("__proto__"===y||"constructor"===y||"prototype"===y)return e;if(u!=p){var f=m[y];void 0===(g=l?l(f,y,m):void 0)&&(g=(0,d.default)(f)?f:(0,r.default)(t[u+1])?[]:{})}(0,a.default)(m,y,g),m=m[y]}return e}},159520:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){for(var s=-1,a=Array(e);++s<e;)a[s]=t(s);return a}},764099:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){return e.has(t)}},684171:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(280702);const n=function(){try{var e=(0,a.default)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}()},608967:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(601275),n=s(463736),r=s(764099);const d=function(e,t,s,d,_,l){var u=1&s,c=e.length,p=t.length;if(c!=p&&!(u&&p>c))return!1;var m=l.get(e),y=l.get(t);if(m&&y)return m==t&&y==e;var g=-1,f=!0,E=2&s?new a.default:void 0;for(l.set(e,t),l.set(t,e);++g<c;){var A=e[g],P=t[g];if(d)var b=u?d(P,A,g,t,e,l):d(A,P,g,e,t,l);if(void 0!==b){if(b)continue;f=!1;break}if(E){if(!(0,n.default)(t,(function(e,t){if(!(0,r.default)(E,t)&&(A===e||_(A,e,s,d,l)))return E.push(t)}))){f=!1;break}}else if(A!==P&&!_(A,P,s,d,l)){f=!1;break}}return l.delete(e),l.delete(t),f}},480402:(e,t,s)=>{"use strict";s.d(t,{default:()=>p});var a=s(700241),n=s(243988),r=s(166984),d=s(608967),_=s(164877),l=s(729959),u=a.default?a.default.prototype:void 0,c=u?u.valueOf:void 0;const p=function(e,t,s,a,u,p,m){switch(s){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!p(new n.default(e),new n.default(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,r.default)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var y=_.default;case"[object Set]":var g=1&a;if(y||(y=l.default),e.size!=t.size&&!g)return!1;var f=m.get(e);if(f)return f==t;a|=2,m.set(e,t);var E=(0,d.default)(y(e),y(t),a,u,p,m);return m.delete(e),E;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},937265:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(719042),n=Object.prototype.hasOwnProperty;const r=function(e,t,s,r,d,_){var l=1&s,u=(0,a.default)(e),c=u.length;if(c!=(0,a.default)(t).length&&!l)return!1;for(var p=c;p--;){var m=u[p];if(!(l?m in t:n.call(t,m)))return!1}var y=_.get(e),g=_.get(t);if(y&&g)return y==t&&g==e;var f=!0;_.set(e,t),_.set(t,e);for(var E=l;++p<c;){var A=e[m=u[p]],P=t[m];if(r)var b=l?r(P,A,m,t,e,_):r(A,P,m,e,t,_);if(!(void 0===b?A===P||d(A,P,s,r,_):b)){f=!1;break}E||(E="constructor"==m)}if(f&&!E){var I=e.constructor,T=t.constructor;I==T||!("constructor"in e)||!("constructor"in t)||"function"==typeof I&&I instanceof I&&"function"==typeof T&&T instanceof T||(f=!1)}return _.delete(e),_.delete(t),f}},719042:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(833831),n=s(214792),r=s(327422);const d=function(e){return(0,a.default)(e,r.default,n.default)}},883973:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(833831),n=s(283511),r=s(241865);const d=function(e){return(0,a.default)(e,r.default,n.default)}},997960:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(909396),n=s(327422);const r=function(e){for(var t=(0,n.default)(e),s=t.length;s--;){var r=t[s],d=e[r];t[s]=[r,d,(0,a.default)(d)]}return t}},315647:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=(0,s(40367).default)(Object.getPrototypeOf,Object)},214792:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(102634),n=s(613153),r=Object.prototype.propertyIsEnumerable,d=Object.getOwnPropertySymbols;const _=d?function(e){return null==e?[]:(e=Object(e),(0,a.default)(d(e),(function(t){return r.call(e,t)})))}:n.default},283511:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(976912),n=s(315647),r=s(214792),d=s(613153);const _=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)(0,a.default)(t,(0,r.default)(e)),e=(0,n.default)(e);return t}:d.default},935861:(e,t,s)=>{"use strict";s.d(t,{default:()=>T});var a=s(202732),n=s(168335),r=s(20180),d=s(439857),_=s(753631),l=s(979672),u=s(281121),c="[object Map]",p="[object Promise]",m="[object Set]",y="[object WeakMap]",g="[object DataView]",f=(0,u.default)(a.default),E=(0,u.default)(n.default),A=(0,u.default)(r.default),P=(0,u.default)(d.default),b=(0,u.default)(_.default),I=l.default;(a.default&&I(new a.default(new ArrayBuffer(1)))!=g||n.default&&I(new n.default)!=c||r.default&&I(r.default.resolve())!=p||d.default&&I(new d.default)!=m||_.default&&I(new _.default)!=y)&&(I=function(e){var t=(0,l.default)(e),s="[object Object]"==t?e.constructor:void 0,a=s?(0,u.default)(s):"";if(a)switch(a){case f:return g;case E:return c;case A:return p;case P:return m;case b:return y}return t});const T=I},285054:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var a=s(687465),n=s(241788),r=s(292049),d=s(925353),_=s(5254),l=s(930901);const u=function(e,t,s){for(var u=-1,c=(t=(0,a.default)(t,e)).length,p=!1;++u<c;){var m=(0,l.default)(t[u]);if(!(p=null!=e&&s(e,m)))break;e=e[m]}return p||++u!=c?p:!!(c=null==e?0:e.length)&&(0,_.default)(c)&&(0,d.default)(m,c)&&((0,r.default)(e)||(0,n.default)(e))}},925353:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=/^(?:0|[1-9]\d*)$/;const n=function(e,t){var s=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==s||"symbol"!=s&&a.test(e))&&e>-1&&e%1==0&&e<t}},897271:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=Object.prototype;const n=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||a)}},909396:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(523149);const n=function(e){return e==e&&!(0,a.default)(e)}},164877:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){var t=-1,s=Array(e.size);return e.forEach((function(e,a){s[++t]=[a,e]})),s}},945997:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){return function(s){return null!=s&&(s[e]===t&&(void 0!==t||e in Object(s)))}}},733938:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=(0,s(40367).default)(Object.keys,Object)},981493:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){var t=[];if(null!=e)for(var s in Object(e))t.push(s);return t}},40367:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e,t){return function(s){return e(t(s))}}},25668:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},529875:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){return this.__data__.has(e)}},729959:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){var t=-1,s=Array(e.size);return e.forEach((function(e){s[++t]=e})),s}},591532:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(277919);const n=function(){this.__data__=new a.default,this.size=0}},42:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}},173061:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){return this.__data__.get(e)}},144105:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){return this.__data__.has(e)}},487681:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(277919),n=s(168335),r=s(935917);const d=function(e,t){var s=this.__data__;if(s instanceof a.default){var d=s.__data__;if(!n.default||d.length<199)return d.push([e,t]),this.size=++s.size,this;s=this.__data__=new r.default(d)}return s.set(e,t),this.size=s.size,this}},217511:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(509789),n=s(285054);const r=function(e,t){return null!=e&&(0,n.default)(e,t,a.default)}},929008:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){return e}},241788:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(974846),n=s(753098),r=Object.prototype,d=r.hasOwnProperty,_=r.propertyIsEnumerable;const l=(0,a.default)(function(){return arguments}())?a.default:function(e){return(0,n.default)(e)&&d.call(e,"callee")&&!_.call(e,"callee")}},238446:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});var a=s(389610),n=s(5254);const r=function(e){return null!=e&&(0,n.default)(e.length)&&!(0,a.default)(e)}},74616:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(41917),n=s(624639),r="object"==typeof exports&&exports&&!exports.nodeType&&exports,d=r&&"object"==typeof module&&module&&!module.nodeType&&module,_=d&&d.exports===r?a.default.Buffer:void 0;const l=(_?_.isBuffer:void 0)||n.default},5254:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},118719:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(289717),n=s(552789),r=s(364841),d=r.default&&r.default.isTypedArray;const _=d?(0,n.default)(d):a.default},269592:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){return void 0===e}},327422:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(550423),n=s(17064),r=s(238446);const d=function(e){return(0,r.default)(e)?(0,a.default)(e):(0,n.default)(e)}},241865:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(550423),n=s(708823),r=s(238446);const d=function(e){return(0,r.default)(e)?(0,a.default)(e,!0):(0,n.default)(e)}},478672:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},596034:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(952141),n=s(478672),r=s(141470);const d=function(e,t){return(0,r.default)(e,(0,n.default)((0,a.default)(t)))}},141470:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(45572),n=s(952141),r=s(769084),d=s(883973);const _=function(e,t){if(null==e)return{};var s=(0,a.default)((0,d.default)(e),(function(e){return[e]}));return t=(0,n.default)(t),(0,r.default)(e,s,(function(e,s){return t(e,s[0])}))}},792263:(e,t,s)=>{"use strict";s.d(t,{default:()=>_});var a=s(770805),n=s(82199),r=s(386586),d=s(930901);const _=function(e){return(0,r.default)(e)?(0,a.default)((0,d.default)(e)):(0,n.default)(e)}},613153:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(){return[]}},624639:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=function(){return!1}}}]);try{stManager?.done("dist/web/chunks/common.be6af40b.js")}catch(e){}